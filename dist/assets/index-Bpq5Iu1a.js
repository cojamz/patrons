(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function A_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ep={exports:{}},pl={},wp={exports:{}},W={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bo=Symbol.for("react.element"),D_=Symbol.for("react.portal"),x_=Symbol.for("react.fragment"),O_=Symbol.for("react.strict_mode"),N_=Symbol.for("react.profiler"),R_=Symbol.for("react.provider"),I_=Symbol.for("react.context"),L_=Symbol.for("react.forward_ref"),$_=Symbol.for("react.suspense"),U_=Symbol.for("react.memo"),M_=Symbol.for("react.lazy"),nf=Symbol.iterator;function F_(t){return t===null||typeof t!="object"?null:(t=nf&&t[nf]||t["@@iterator"],typeof t=="function"?t:null)}var Sp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pp=Object.assign,Cp={};function as(t,e,n){this.props=t,this.context=e,this.refs=Cp,this.updater=n||Sp}as.prototype.isReactComponent={};as.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};as.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kp(){}kp.prototype=as.prototype;function oc(t,e,n){this.props=t,this.context=e,this.refs=Cp,this.updater=n||Sp}var ic=oc.prototype=new kp;ic.constructor=oc;Pp(ic,as.prototype);ic.isPureReactComponent=!0;var rf=Array.isArray,Tp=Object.prototype.hasOwnProperty,lc={current:null},bp={key:!0,ref:!0,__self:!0,__source:!0};function Ap(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)Tp.call(e,r)&&!bp.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:bo,type:t,key:o,ref:i,props:s,_owner:lc.current}}function G_(t,e){return{$$typeof:bo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ac(t){return typeof t=="object"&&t!==null&&t.$$typeof===bo}function V_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var sf=/\/+/g;function ta(t,e){return typeof t=="object"&&t!==null&&t.key!=null?V_(""+t.key):e.toString(36)}function di(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case bo:case D_:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+ta(i,0):r,rf(s)?(n="",t!=null&&(n=t.replace(sf,"$&/")+"/"),di(s,e,n,"",function(u){return u})):s!=null&&(ac(s)&&(s=G_(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(sf,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",rf(t))for(var l=0;l<t.length;l++){o=t[l];var a=r+ta(o,l);i+=di(o,e,n,a,s)}else if(a=F_(t),typeof a=="function")for(t=a.call(t),l=0;!(o=t.next()).done;)o=o.value,a=r+ta(o,l++),i+=di(o,e,n,a,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function zo(t,e,n){if(t==null)return t;var r=[],s=0;return di(t,r,"","",function(o){return e.call(n,o,s++)}),r}function B_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var je={current:null},fi={transition:null},W_={ReactCurrentDispatcher:je,ReactCurrentBatchConfig:fi,ReactCurrentOwner:lc};function Dp(){throw Error("act(...) is not supported in production builds of React.")}W.Children={map:zo,forEach:function(t,e,n){zo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return zo(t,function(){e++}),e},toArray:function(t){return zo(t,function(e){return e})||[]},only:function(t){if(!ac(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};W.Component=as;W.Fragment=x_;W.Profiler=N_;W.PureComponent=oc;W.StrictMode=O_;W.Suspense=$_;W.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W_;W.act=Dp;W.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Pp({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=lc.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)Tp.call(e,a)&&!bp.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:bo,type:t.type,key:s,ref:o,props:r,_owner:i}};W.createContext=function(t){return t={$$typeof:I_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:R_,_context:t},t.Consumer=t};W.createElement=Ap;W.createFactory=function(t){var e=Ap.bind(null,t);return e.type=t,e};W.createRef=function(){return{current:null}};W.forwardRef=function(t){return{$$typeof:L_,render:t}};W.isValidElement=ac;W.lazy=function(t){return{$$typeof:M_,_payload:{_status:-1,_result:t},_init:B_}};W.memo=function(t,e){return{$$typeof:U_,type:t,compare:e===void 0?null:e}};W.startTransition=function(t){var e=fi.transition;fi.transition={};try{t()}finally{fi.transition=e}};W.unstable_act=Dp;W.useCallback=function(t,e){return je.current.useCallback(t,e)};W.useContext=function(t){return je.current.useContext(t)};W.useDebugValue=function(){};W.useDeferredValue=function(t){return je.current.useDeferredValue(t)};W.useEffect=function(t,e){return je.current.useEffect(t,e)};W.useId=function(){return je.current.useId()};W.useImperativeHandle=function(t,e,n){return je.current.useImperativeHandle(t,e,n)};W.useInsertionEffect=function(t,e){return je.current.useInsertionEffect(t,e)};W.useLayoutEffect=function(t,e){return je.current.useLayoutEffect(t,e)};W.useMemo=function(t,e){return je.current.useMemo(t,e)};W.useReducer=function(t,e,n){return je.current.useReducer(t,e,n)};W.useRef=function(t){return je.current.useRef(t)};W.useState=function(t){return je.current.useState(t)};W.useSyncExternalStore=function(t,e,n){return je.current.useSyncExternalStore(t,e,n)};W.useTransition=function(){return je.current.useTransition()};W.version="18.3.1";wp.exports=W;var $e=wp.exports;const v=A_($e);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j_=$e,z_=Symbol.for("react.element"),H_=Symbol.for("react.fragment"),Y_=Object.prototype.hasOwnProperty,Q_=j_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K_={key:!0,ref:!0,__self:!0,__source:!0};function xp(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)Y_.call(e,r)&&!K_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:z_,type:t,key:o,ref:i,props:s,_owner:Q_.current}}pl.Fragment=H_;pl.jsx=xp;pl.jsxs=xp;Ep.exports=pl;var of=Ep.exports,Ga={},Op={exports:{}},ct={},Np={exports:{}},Rp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(x,M){var U=x.length;x.push(M);e:for(;0<U;){var ee=U-1>>>1,he=x[ee];if(0<s(he,M))x[ee]=M,x[U]=he,U=ee;else break e}}function n(x){return x.length===0?null:x[0]}function r(x){if(x.length===0)return null;var M=x[0],U=x.pop();if(U!==M){x[0]=U;e:for(var ee=0,he=x.length,Yn=he>>>1;ee<Yn;){var Ct=2*(ee+1)-1,ys=x[Ct],Yt=Ct+1,Qn=x[Yt];if(0>s(ys,U))Yt<he&&0>s(Qn,ys)?(x[ee]=Qn,x[Yt]=U,ee=Yt):(x[ee]=ys,x[Ct]=U,ee=Ct);else if(Yt<he&&0>s(Qn,U))x[ee]=Qn,x[Yt]=U,ee=Yt;else break e}}return M}function s(x,M){var U=x.sortIndex-M.sortIndex;return U!==0?U:x.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var a=[],u=[],f=1,c=null,d=3,m=!1,h=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(x){for(var M=n(u);M!==null;){if(M.callback===null)r(u);else if(M.startTime<=x)r(u),M.sortIndex=M.expirationTime,e(a,M);else break;M=n(u)}}function w(x){if(y=!1,_(x),!h)if(n(a)!==null)h=!0,Q(P);else{var M=n(u);M!==null&&He(w,M.startTime-x)}}function P(x,M){h=!1,y&&(y=!1,g(D),D=-1),m=!0;var U=d;try{for(_(M),c=n(a);c!==null&&(!(c.expirationTime>M)||x&&!q());){var ee=c.callback;if(typeof ee=="function"){c.callback=null,d=c.priorityLevel;var he=ee(c.expirationTime<=M);M=t.unstable_now(),typeof he=="function"?c.callback=he:c===n(a)&&r(a),_(M)}else r(a);c=n(a)}if(c!==null)var Yn=!0;else{var Ct=n(u);Ct!==null&&He(w,Ct.startTime-M),Yn=!1}return Yn}finally{c=null,d=U,m=!1}}var k=!1,b=null,D=-1,$=5,R=-1;function q(){return!(t.unstable_now()-R<$)}function Ge(){if(b!==null){var x=t.unstable_now();R=x;var M=!0;try{M=b(!0,x)}finally{M?Mt():(k=!1,b=null)}}else k=!1}var Mt;if(typeof p=="function")Mt=function(){p(Ge)};else if(typeof MessageChannel<"u"){var Hn=new MessageChannel,Hd=Hn.port2;Hn.port1.onmessage=Ge,Mt=function(){Hd.postMessage(null)}}else Mt=function(){S(Ge,0)};function Q(x){b=x,k||(k=!0,Mt())}function He(x,M){D=S(function(){x(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(x){x.callback=null},t.unstable_continueExecution=function(){h||m||(h=!0,Q(P))},t.unstable_forceFrameRate=function(x){0>x||125<x?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<x?Math.floor(1e3/x):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(x){switch(d){case 1:case 2:case 3:var M=3;break;default:M=d}var U=d;d=M;try{return x()}finally{d=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(x,M){switch(x){case 1:case 2:case 3:case 4:case 5:break;default:x=3}var U=d;d=x;try{return M()}finally{d=U}},t.unstable_scheduleCallback=function(x,M,U){var ee=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?ee+U:ee):U=ee,x){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=U+he,x={id:f++,callback:M,priorityLevel:x,startTime:U,expirationTime:he,sortIndex:-1},U>ee?(x.sortIndex=U,e(u,x),n(a)===null&&x===n(u)&&(y?(g(D),D=-1):y=!0,He(w,U-ee))):(x.sortIndex=he,e(a,x),h||m||(h=!0,Q(P))),x},t.unstable_shouldYield=q,t.unstable_wrapCallback=function(x){var M=d;return function(){var U=d;d=M;try{return x.apply(this,arguments)}finally{d=U}}}})(Rp);Np.exports=Rp;var q_=Np.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X_=$e,lt=q_;function C(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ip=new Set,qs={};function yr(t,e){Yr(t,e),Yr(t+"Capture",e)}function Yr(t,e){for(qs[t]=e,t=0;t<e.length;t++)Ip.add(e[t])}var rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Va=Object.prototype.hasOwnProperty,J_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lf={},af={};function Z_(t){return Va.call(af,t)?!0:Va.call(lf,t)?!1:J_.test(t)?af[t]=!0:(lf[t]=!0,!1)}function ev(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tv(t,e,n,r){if(e===null||typeof e>"u"||ev(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ze(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Ne={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ne[t]=new ze(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ne[e]=new ze(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ne[t]=new ze(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ne[t]=new ze(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ne[t]=new ze(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ne[t]=new ze(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ne[t]=new ze(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ne[t]=new ze(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ne[t]=new ze(t,5,!1,t.toLowerCase(),null,!1,!1)});var uc=/[\-:]([a-z])/g;function cc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(uc,cc);Ne[e]=new ze(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(uc,cc);Ne[e]=new ze(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(uc,cc);Ne[e]=new ze(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ne[t]=new ze(t,1,!1,t.toLowerCase(),null,!1,!1)});Ne.xlinkHref=new ze("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ne[t]=new ze(t,1,!1,t.toLowerCase(),null,!0,!0)});function dc(t,e,n,r){var s=Ne.hasOwnProperty(e)?Ne[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tv(e,n,s,r)&&(n=null),r||s===null?Z_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var dn=X_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ho=Symbol.for("react.element"),br=Symbol.for("react.portal"),Ar=Symbol.for("react.fragment"),fc=Symbol.for("react.strict_mode"),Ba=Symbol.for("react.profiler"),Lp=Symbol.for("react.provider"),$p=Symbol.for("react.context"),hc=Symbol.for("react.forward_ref"),Wa=Symbol.for("react.suspense"),ja=Symbol.for("react.suspense_list"),pc=Symbol.for("react.memo"),hn=Symbol.for("react.lazy"),Up=Symbol.for("react.offscreen"),uf=Symbol.iterator;function vs(t){return t===null||typeof t!="object"?null:(t=uf&&t[uf]||t["@@iterator"],typeof t=="function"?t:null)}var de=Object.assign,na;function Os(t){if(na===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);na=e&&e[1]||""}return`
`+na+t}var ra=!1;function sa(t,e){if(!t||ra)return"";ra=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var a=`
`+s[i].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=i&&0<=l);break}}}finally{ra=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Os(t):""}function nv(t){switch(t.tag){case 5:return Os(t.type);case 16:return Os("Lazy");case 13:return Os("Suspense");case 19:return Os("SuspenseList");case 0:case 2:case 15:return t=sa(t.type,!1),t;case 11:return t=sa(t.type.render,!1),t;case 1:return t=sa(t.type,!0),t;default:return""}}function za(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ar:return"Fragment";case br:return"Portal";case Ba:return"Profiler";case fc:return"StrictMode";case Wa:return"Suspense";case ja:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $p:return(t.displayName||"Context")+".Consumer";case Lp:return(t._context.displayName||"Context")+".Provider";case hc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pc:return e=t.displayName||null,e!==null?e:za(t.type)||"Memo";case hn:e=t._payload,t=t._init;try{return za(t(e))}catch{}}return null}function rv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return za(e);case 8:return e===fc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Mp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sv(t){var e=Mp(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Yo(t){t._valueTracker||(t._valueTracker=sv(t))}function Fp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Mp(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ci(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ha(t,e){var n=e.checked;return de({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function cf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Rn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Gp(t,e){e=e.checked,e!=null&&dc(t,"checked",e,!1)}function Ya(t,e){Gp(t,e);var n=Rn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Qa(t,e.type,n):e.hasOwnProperty("defaultValue")&&Qa(t,e.type,Rn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function df(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Qa(t,e,n){(e!=="number"||Ci(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ns=Array.isArray;function Fr(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Rn(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ka(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(C(91));return de({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ff(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(C(92));if(Ns(n)){if(1<n.length)throw Error(C(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Rn(n)}}function Vp(t,e){var n=Rn(e.value),r=Rn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function hf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Bp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qa(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Bp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qo,Wp=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qo=Qo||document.createElement("div"),Qo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Xs(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $s={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ov=["Webkit","ms","Moz","O"];Object.keys($s).forEach(function(t){ov.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$s[e]=$s[t]})});function jp(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$s.hasOwnProperty(t)&&$s[t]?(""+e).trim():e+"px"}function zp(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=jp(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var iv=de({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xa(t,e){if(e){if(iv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(C(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(C(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(C(61))}if(e.style!=null&&typeof e.style!="object")throw Error(C(62))}}function Ja(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Za=null;function mc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var eu=null,Gr=null,Vr=null;function pf(t){if(t=xo(t)){if(typeof eu!="function")throw Error(C(280));var e=t.stateNode;e&&(e=vl(e),eu(t.stateNode,t.type,e))}}function Hp(t){Gr?Vr?Vr.push(t):Vr=[t]:Gr=t}function Yp(){if(Gr){var t=Gr,e=Vr;if(Vr=Gr=null,pf(t),e)for(t=0;t<e.length;t++)pf(e[t])}}function Qp(t,e){return t(e)}function Kp(){}var oa=!1;function qp(t,e,n){if(oa)return t(e,n);oa=!0;try{return Qp(t,e,n)}finally{oa=!1,(Gr!==null||Vr!==null)&&(Kp(),Yp())}}function Js(t,e){var n=t.stateNode;if(n===null)return null;var r=vl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(C(231,e,typeof n));return n}var tu=!1;if(rn)try{var Es={};Object.defineProperty(Es,"passive",{get:function(){tu=!0}}),window.addEventListener("test",Es,Es),window.removeEventListener("test",Es,Es)}catch{tu=!1}function lv(t,e,n,r,s,o,i,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Us=!1,ki=null,Ti=!1,nu=null,av={onError:function(t){Us=!0,ki=t}};function uv(t,e,n,r,s,o,i,l,a){Us=!1,ki=null,lv.apply(av,arguments)}function cv(t,e,n,r,s,o,i,l,a){if(uv.apply(this,arguments),Us){if(Us){var u=ki;Us=!1,ki=null}else throw Error(C(198));Ti||(Ti=!0,nu=u)}}function _r(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Xp(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function mf(t){if(_r(t)!==t)throw Error(C(188))}function dv(t){var e=t.alternate;if(!e){if(e=_r(t),e===null)throw Error(C(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return mf(s),t;if(o===r)return mf(s),e;o=o.sibling}throw Error(C(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i)throw Error(C(189))}}if(n.alternate!==r)throw Error(C(190))}if(n.tag!==3)throw Error(C(188));return n.stateNode.current===n?t:e}function Jp(t){return t=dv(t),t!==null?Zp(t):null}function Zp(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Zp(t);if(e!==null)return e;t=t.sibling}return null}var em=lt.unstable_scheduleCallback,gf=lt.unstable_cancelCallback,fv=lt.unstable_shouldYield,hv=lt.unstable_requestPaint,me=lt.unstable_now,pv=lt.unstable_getCurrentPriorityLevel,gc=lt.unstable_ImmediatePriority,tm=lt.unstable_UserBlockingPriority,bi=lt.unstable_NormalPriority,mv=lt.unstable_LowPriority,nm=lt.unstable_IdlePriority,ml=null,Bt=null;function gv(t){if(Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(ml,t,void 0,(t.current.flags&128)===128)}catch{}}var Rt=Math.clz32?Math.clz32:vv,yv=Math.log,_v=Math.LN2;function vv(t){return t>>>=0,t===0?32:31-(yv(t)/_v|0)|0}var Ko=64,qo=4194304;function Rs(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ai(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=Rs(l):(o&=i,o!==0&&(r=Rs(o)))}else i=n&~s,i!==0?r=Rs(i):o!==0&&(r=Rs(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Rt(e),s=1<<n,r|=t[n],e&=~s;return r}function Ev(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wv(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-Rt(o),l=1<<i,a=s[i];a===-1?(!(l&n)||l&r)&&(s[i]=Ev(l,e)):a<=e&&(t.expiredLanes|=l),o&=~l}}function ru(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function rm(){var t=Ko;return Ko<<=1,!(Ko&4194240)&&(Ko=64),t}function ia(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ao(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rt(e),t[e]=n}function Sv(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Rt(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function yc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Rt(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var K=0;function sm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var om,_c,im,lm,am,su=!1,Xo=[],wn=null,Sn=null,Pn=null,Zs=new Map,eo=new Map,mn=[],Pv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yf(t,e){switch(t){case"focusin":case"focusout":wn=null;break;case"dragenter":case"dragleave":Sn=null;break;case"mouseover":case"mouseout":Pn=null;break;case"pointerover":case"pointerout":Zs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":eo.delete(e.pointerId)}}function ws(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=xo(e),e!==null&&_c(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Cv(t,e,n,r,s){switch(e){case"focusin":return wn=ws(wn,t,e,n,r,s),!0;case"dragenter":return Sn=ws(Sn,t,e,n,r,s),!0;case"mouseover":return Pn=ws(Pn,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Zs.set(o,ws(Zs.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,eo.set(o,ws(eo.get(o)||null,t,e,n,r,s)),!0}return!1}function um(t){var e=er(t.target);if(e!==null){var n=_r(e);if(n!==null){if(e=n.tag,e===13){if(e=Xp(n),e!==null){t.blockedOn=e,am(t.priority,function(){im(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ou(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Za=r,n.target.dispatchEvent(r),Za=null}else return e=xo(n),e!==null&&_c(e),t.blockedOn=n,!1;e.shift()}return!0}function _f(t,e,n){hi(t)&&n.delete(e)}function kv(){su=!1,wn!==null&&hi(wn)&&(wn=null),Sn!==null&&hi(Sn)&&(Sn=null),Pn!==null&&hi(Pn)&&(Pn=null),Zs.forEach(_f),eo.forEach(_f)}function Ss(t,e){t.blockedOn===e&&(t.blockedOn=null,su||(su=!0,lt.unstable_scheduleCallback(lt.unstable_NormalPriority,kv)))}function to(t){function e(s){return Ss(s,t)}if(0<Xo.length){Ss(Xo[0],t);for(var n=1;n<Xo.length;n++){var r=Xo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wn!==null&&Ss(wn,t),Sn!==null&&Ss(Sn,t),Pn!==null&&Ss(Pn,t),Zs.forEach(e),eo.forEach(e),n=0;n<mn.length;n++)r=mn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<mn.length&&(n=mn[0],n.blockedOn===null);)um(n),n.blockedOn===null&&mn.shift()}var Br=dn.ReactCurrentBatchConfig,Di=!0;function Tv(t,e,n,r){var s=K,o=Br.transition;Br.transition=null;try{K=1,vc(t,e,n,r)}finally{K=s,Br.transition=o}}function bv(t,e,n,r){var s=K,o=Br.transition;Br.transition=null;try{K=4,vc(t,e,n,r)}finally{K=s,Br.transition=o}}function vc(t,e,n,r){if(Di){var s=ou(t,e,n,r);if(s===null)ga(t,e,r,xi,n),yf(t,r);else if(Cv(s,t,e,n,r))r.stopPropagation();else if(yf(t,r),e&4&&-1<Pv.indexOf(t)){for(;s!==null;){var o=xo(s);if(o!==null&&om(o),o=ou(t,e,n,r),o===null&&ga(t,e,r,xi,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else ga(t,e,r,null,n)}}var xi=null;function ou(t,e,n,r){if(xi=null,t=mc(r),t=er(t),t!==null)if(e=_r(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Xp(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return xi=t,null}function cm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pv()){case gc:return 1;case tm:return 4;case bi:case mv:return 16;case nm:return 536870912;default:return 16}default:return 16}}var yn=null,Ec=null,pi=null;function dm(){if(pi)return pi;var t,e=Ec,n=e.length,r,s="value"in yn?yn.value:yn.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return pi=s.slice(t,1<r?1-r:void 0)}function mi(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Jo(){return!0}function vf(){return!1}function dt(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Jo:vf,this.isPropagationStopped=vf,this}return de(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Jo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Jo)},persist:function(){},isPersistent:Jo}),e}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wc=dt(us),Do=de({},us,{view:0,detail:0}),Av=dt(Do),la,aa,Ps,gl=de({},Do,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ps&&(Ps&&t.type==="mousemove"?(la=t.screenX-Ps.screenX,aa=t.screenY-Ps.screenY):aa=la=0,Ps=t),la)},movementY:function(t){return"movementY"in t?t.movementY:aa}}),Ef=dt(gl),Dv=de({},gl,{dataTransfer:0}),xv=dt(Dv),Ov=de({},Do,{relatedTarget:0}),ua=dt(Ov),Nv=de({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),Rv=dt(Nv),Iv=de({},us,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Lv=dt(Iv),$v=de({},us,{data:0}),wf=dt($v),Uv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Fv[t])?!!e[t]:!1}function Sc(){return Gv}var Vv=de({},Do,{key:function(t){if(t.key){var e=Uv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Mv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sc,charCode:function(t){return t.type==="keypress"?mi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Bv=dt(Vv),Wv=de({},gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sf=dt(Wv),jv=de({},Do,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sc}),zv=dt(jv),Hv=de({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yv=dt(Hv),Qv=de({},gl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Kv=dt(Qv),qv=[9,13,27,32],Pc=rn&&"CompositionEvent"in window,Ms=null;rn&&"documentMode"in document&&(Ms=document.documentMode);var Xv=rn&&"TextEvent"in window&&!Ms,fm=rn&&(!Pc||Ms&&8<Ms&&11>=Ms),Pf=" ",Cf=!1;function hm(t,e){switch(t){case"keyup":return qv.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Dr=!1;function Jv(t,e){switch(t){case"compositionend":return pm(e);case"keypress":return e.which!==32?null:(Cf=!0,Pf);case"textInput":return t=e.data,t===Pf&&Cf?null:t;default:return null}}function Zv(t,e){if(Dr)return t==="compositionend"||!Pc&&hm(t,e)?(t=dm(),pi=Ec=yn=null,Dr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return fm&&e.locale!=="ko"?null:e.data;default:return null}}var e0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!e0[t.type]:e==="textarea"}function mm(t,e,n,r){Hp(r),e=Oi(e,"onChange"),0<e.length&&(n=new wc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Fs=null,no=null;function t0(t){Tm(t,0)}function yl(t){var e=Nr(t);if(Fp(e))return t}function n0(t,e){if(t==="change")return e}var gm=!1;if(rn){var ca;if(rn){var da="oninput"in document;if(!da){var Tf=document.createElement("div");Tf.setAttribute("oninput","return;"),da=typeof Tf.oninput=="function"}ca=da}else ca=!1;gm=ca&&(!document.documentMode||9<document.documentMode)}function bf(){Fs&&(Fs.detachEvent("onpropertychange",ym),no=Fs=null)}function ym(t){if(t.propertyName==="value"&&yl(no)){var e=[];mm(e,no,t,mc(t)),qp(t0,e)}}function r0(t,e,n){t==="focusin"?(bf(),Fs=e,no=n,Fs.attachEvent("onpropertychange",ym)):t==="focusout"&&bf()}function s0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return yl(no)}function o0(t,e){if(t==="click")return yl(e)}function i0(t,e){if(t==="input"||t==="change")return yl(e)}function l0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $t=typeof Object.is=="function"?Object.is:l0;function ro(t,e){if($t(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Va.call(e,s)||!$t(t[s],e[s]))return!1}return!0}function Af(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Df(t,e){var n=Af(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Af(n)}}function _m(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_m(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vm(){for(var t=window,e=Ci();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ci(t.document)}return e}function Cc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function a0(t){var e=vm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&_m(n.ownerDocument.documentElement,n)){if(r!==null&&Cc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=Df(n,o);var i=Df(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var u0=rn&&"documentMode"in document&&11>=document.documentMode,xr=null,iu=null,Gs=null,lu=!1;function xf(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lu||xr==null||xr!==Ci(r)||(r=xr,"selectionStart"in r&&Cc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gs&&ro(Gs,r)||(Gs=r,r=Oi(iu,"onSelect"),0<r.length&&(e=new wc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=xr)))}function Zo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Or={animationend:Zo("Animation","AnimationEnd"),animationiteration:Zo("Animation","AnimationIteration"),animationstart:Zo("Animation","AnimationStart"),transitionend:Zo("Transition","TransitionEnd")},fa={},Em={};rn&&(Em=document.createElement("div").style,"AnimationEvent"in window||(delete Or.animationend.animation,delete Or.animationiteration.animation,delete Or.animationstart.animation),"TransitionEvent"in window||delete Or.transitionend.transition);function _l(t){if(fa[t])return fa[t];if(!Or[t])return t;var e=Or[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Em)return fa[t]=e[n];return t}var wm=_l("animationend"),Sm=_l("animationiteration"),Pm=_l("animationstart"),Cm=_l("transitionend"),km=new Map,Of="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bn(t,e){km.set(t,e),yr(e,[t])}for(var ha=0;ha<Of.length;ha++){var pa=Of[ha],c0=pa.toLowerCase(),d0=pa[0].toUpperCase()+pa.slice(1);Bn(c0,"on"+d0)}Bn(wm,"onAnimationEnd");Bn(Sm,"onAnimationIteration");Bn(Pm,"onAnimationStart");Bn("dblclick","onDoubleClick");Bn("focusin","onFocus");Bn("focusout","onBlur");Bn(Cm,"onTransitionEnd");Yr("onMouseEnter",["mouseout","mouseover"]);Yr("onMouseLeave",["mouseout","mouseover"]);Yr("onPointerEnter",["pointerout","pointerover"]);Yr("onPointerLeave",["pointerout","pointerover"]);yr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yr("onBeforeInput",["compositionend","keypress","textInput","paste"]);yr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Is="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Is));function Nf(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,cv(r,e,void 0,t),t.currentTarget=null}function Tm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&s.isPropagationStopped())break e;Nf(s,l,u),o=a}else for(i=0;i<r.length;i++){if(l=r[i],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&s.isPropagationStopped())break e;Nf(s,l,u),o=a}}}if(Ti)throw t=nu,Ti=!1,nu=null,t}function se(t,e){var n=e[fu];n===void 0&&(n=e[fu]=new Set);var r=t+"__bubble";n.has(r)||(bm(e,t,2,!1),n.add(r))}function ma(t,e,n){var r=0;e&&(r|=4),bm(n,t,r,e)}var ei="_reactListening"+Math.random().toString(36).slice(2);function so(t){if(!t[ei]){t[ei]=!0,Ip.forEach(function(n){n!=="selectionchange"&&(f0.has(n)||ma(n,!1,t),ma(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ei]||(e[ei]=!0,ma("selectionchange",!1,e))}}function bm(t,e,n,r){switch(cm(e)){case 1:var s=Tv;break;case 4:s=bv;break;default:s=vc}n=s.bind(null,e,n,t),s=void 0,!tu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ga(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var a=i.tag;if((a===3||a===4)&&(a=i.stateNode.containerInfo,a===s||a.nodeType===8&&a.parentNode===s))return;i=i.return}for(;l!==null;){if(i=er(l),i===null)return;if(a=i.tag,a===5||a===6){r=o=i;continue e}l=l.parentNode}}r=r.return}qp(function(){var u=o,f=mc(n),c=[];e:{var d=km.get(t);if(d!==void 0){var m=wc,h=t;switch(t){case"keypress":if(mi(n)===0)break e;case"keydown":case"keyup":m=Bv;break;case"focusin":h="focus",m=ua;break;case"focusout":h="blur",m=ua;break;case"beforeblur":case"afterblur":m=ua;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ef;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=xv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=zv;break;case wm:case Sm:case Pm:m=Rv;break;case Cm:m=Yv;break;case"scroll":m=Av;break;case"wheel":m=Kv;break;case"copy":case"cut":case"paste":m=Lv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Sf}var y=(e&4)!==0,S=!y&&t==="scroll",g=y?d!==null?d+"Capture":null:d;y=[];for(var p=u,_;p!==null;){_=p;var w=_.stateNode;if(_.tag===5&&w!==null&&(_=w,g!==null&&(w=Js(p,g),w!=null&&y.push(oo(p,w,_)))),S)break;p=p.return}0<y.length&&(d=new m(d,h,null,n,f),c.push({event:d,listeners:y}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&n!==Za&&(h=n.relatedTarget||n.fromElement)&&(er(h)||h[sn]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(h=n.relatedTarget||n.toElement,m=u,h=h?er(h):null,h!==null&&(S=_r(h),h!==S||h.tag!==5&&h.tag!==6)&&(h=null)):(m=null,h=u),m!==h)){if(y=Ef,w="onMouseLeave",g="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(y=Sf,w="onPointerLeave",g="onPointerEnter",p="pointer"),S=m==null?d:Nr(m),_=h==null?d:Nr(h),d=new y(w,p+"leave",m,n,f),d.target=S,d.relatedTarget=_,w=null,er(f)===u&&(y=new y(g,p+"enter",h,n,f),y.target=_,y.relatedTarget=S,w=y),S=w,m&&h)t:{for(y=m,g=h,p=0,_=y;_;_=Cr(_))p++;for(_=0,w=g;w;w=Cr(w))_++;for(;0<p-_;)y=Cr(y),p--;for(;0<_-p;)g=Cr(g),_--;for(;p--;){if(y===g||g!==null&&y===g.alternate)break t;y=Cr(y),g=Cr(g)}y=null}else y=null;m!==null&&Rf(c,d,m,y,!1),h!==null&&S!==null&&Rf(c,S,h,y,!0)}}e:{if(d=u?Nr(u):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var P=n0;else if(kf(d))if(gm)P=i0;else{P=s0;var k=r0}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(P=o0);if(P&&(P=P(t,u))){mm(c,P,n,f);break e}k&&k(t,d,u),t==="focusout"&&(k=d._wrapperState)&&k.controlled&&d.type==="number"&&Qa(d,"number",d.value)}switch(k=u?Nr(u):window,t){case"focusin":(kf(k)||k.contentEditable==="true")&&(xr=k,iu=u,Gs=null);break;case"focusout":Gs=iu=xr=null;break;case"mousedown":lu=!0;break;case"contextmenu":case"mouseup":case"dragend":lu=!1,xf(c,n,f);break;case"selectionchange":if(u0)break;case"keydown":case"keyup":xf(c,n,f)}var b;if(Pc)e:{switch(t){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Dr?hm(t,n)&&(D="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(D="onCompositionStart");D&&(fm&&n.locale!=="ko"&&(Dr||D!=="onCompositionStart"?D==="onCompositionEnd"&&Dr&&(b=dm()):(yn=f,Ec="value"in yn?yn.value:yn.textContent,Dr=!0)),k=Oi(u,D),0<k.length&&(D=new wf(D,t,null,n,f),c.push({event:D,listeners:k}),b?D.data=b:(b=pm(n),b!==null&&(D.data=b)))),(b=Xv?Jv(t,n):Zv(t,n))&&(u=Oi(u,"onBeforeInput"),0<u.length&&(f=new wf("onBeforeInput","beforeinput",null,n,f),c.push({event:f,listeners:u}),f.data=b))}Tm(c,e)})}function oo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Oi(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Js(t,n),o!=null&&r.unshift(oo(t,o,s)),o=Js(t,e),o!=null&&r.push(oo(t,o,s))),t=t.return}return r}function Cr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Rf(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,s?(a=Js(n,o),a!=null&&i.unshift(oo(n,a,l))):s||(a=Js(n,o),a!=null&&i.push(oo(n,a,l)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var h0=/\r\n?/g,p0=/\u0000|\uFFFD/g;function If(t){return(typeof t=="string"?t:""+t).replace(h0,`
`).replace(p0,"")}function ti(t,e,n){if(e=If(e),If(t)!==e&&n)throw Error(C(425))}function Ni(){}var au=null,uu=null;function cu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var du=typeof setTimeout=="function"?setTimeout:void 0,m0=typeof clearTimeout=="function"?clearTimeout:void 0,Lf=typeof Promise=="function"?Promise:void 0,g0=typeof queueMicrotask=="function"?queueMicrotask:typeof Lf<"u"?function(t){return Lf.resolve(null).then(t).catch(y0)}:du;function y0(t){setTimeout(function(){throw t})}function ya(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),to(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);to(e)}function Cn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $f(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var cs=Math.random().toString(36).slice(2),Vt="__reactFiber$"+cs,io="__reactProps$"+cs,sn="__reactContainer$"+cs,fu="__reactEvents$"+cs,_0="__reactListeners$"+cs,v0="__reactHandles$"+cs;function er(t){var e=t[Vt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[sn]||n[Vt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$f(t);t!==null;){if(n=t[Vt])return n;t=$f(t)}return e}t=n,n=t.parentNode}return null}function xo(t){return t=t[Vt]||t[sn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Nr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(C(33))}function vl(t){return t[io]||null}var hu=[],Rr=-1;function Wn(t){return{current:t}}function oe(t){0>Rr||(t.current=hu[Rr],hu[Rr]=null,Rr--)}function ne(t,e){Rr++,hu[Rr]=t.current,t.current=e}var In={},Me=Wn(In),Xe=Wn(!1),ar=In;function Qr(t,e){var n=t.type.contextTypes;if(!n)return In;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Je(t){return t=t.childContextTypes,t!=null}function Ri(){oe(Xe),oe(Me)}function Uf(t,e,n){if(Me.current!==In)throw Error(C(168));ne(Me,e),ne(Xe,n)}function Am(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(C(108,rv(t)||"Unknown",s));return de({},n,r)}function Ii(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||In,ar=Me.current,ne(Me,t),ne(Xe,Xe.current),!0}function Mf(t,e,n){var r=t.stateNode;if(!r)throw Error(C(169));n?(t=Am(t,e,ar),r.__reactInternalMemoizedMergedChildContext=t,oe(Xe),oe(Me),ne(Me,t)):oe(Xe),ne(Xe,n)}var qt=null,El=!1,_a=!1;function Dm(t){qt===null?qt=[t]:qt.push(t)}function E0(t){El=!0,Dm(t)}function jn(){if(!_a&&qt!==null){_a=!0;var t=0,e=K;try{var n=qt;for(K=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}qt=null,El=!1}catch(s){throw qt!==null&&(qt=qt.slice(t+1)),em(gc,jn),s}finally{K=e,_a=!1}}return null}var Ir=[],Lr=0,Li=null,$i=0,pt=[],mt=0,ur=null,Xt=1,Jt="";function qn(t,e){Ir[Lr++]=$i,Ir[Lr++]=Li,Li=t,$i=e}function xm(t,e,n){pt[mt++]=Xt,pt[mt++]=Jt,pt[mt++]=ur,ur=t;var r=Xt;t=Jt;var s=32-Rt(r)-1;r&=~(1<<s),n+=1;var o=32-Rt(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Xt=1<<32-Rt(e)+s|n<<s|r,Jt=o+t}else Xt=1<<o|n<<s|r,Jt=t}function kc(t){t.return!==null&&(qn(t,1),xm(t,1,0))}function Tc(t){for(;t===Li;)Li=Ir[--Lr],Ir[Lr]=null,$i=Ir[--Lr],Ir[Lr]=null;for(;t===ur;)ur=pt[--mt],pt[mt]=null,Jt=pt[--mt],pt[mt]=null,Xt=pt[--mt],pt[mt]=null}var ot=null,st=null,ie=!1,xt=null;function Om(t,e){var n=yt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ff(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ot=t,st=Cn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ot=t,st=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ur!==null?{id:Xt,overflow:Jt}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=yt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ot=t,st=null,!0):!1;default:return!1}}function pu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mu(t){if(ie){var e=st;if(e){var n=e;if(!Ff(t,e)){if(pu(t))throw Error(C(418));e=Cn(n.nextSibling);var r=ot;e&&Ff(t,e)?Om(r,n):(t.flags=t.flags&-4097|2,ie=!1,ot=t)}}else{if(pu(t))throw Error(C(418));t.flags=t.flags&-4097|2,ie=!1,ot=t}}}function Gf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ot=t}function ni(t){if(t!==ot)return!1;if(!ie)return Gf(t),ie=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!cu(t.type,t.memoizedProps)),e&&(e=st)){if(pu(t))throw Nm(),Error(C(418));for(;e;)Om(t,e),e=Cn(e.nextSibling)}if(Gf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(C(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){st=Cn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}st=null}}else st=ot?Cn(t.stateNode.nextSibling):null;return!0}function Nm(){for(var t=st;t;)t=Cn(t.nextSibling)}function Kr(){st=ot=null,ie=!1}function bc(t){xt===null?xt=[t]:xt.push(t)}var w0=dn.ReactCurrentBatchConfig;function Cs(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(C(309));var r=n.stateNode}if(!r)throw Error(C(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(C(284));if(!n._owner)throw Error(C(290,t))}return t}function ri(t,e){throw t=Object.prototype.toString.call(e),Error(C(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Vf(t){var e=t._init;return e(t._payload)}function Rm(t){function e(g,p){if(t){var _=g.deletions;_===null?(g.deletions=[p],g.flags|=16):_.push(p)}}function n(g,p){if(!t)return null;for(;p!==null;)e(g,p),p=p.sibling;return null}function r(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function s(g,p){return g=An(g,p),g.index=0,g.sibling=null,g}function o(g,p,_){return g.index=_,t?(_=g.alternate,_!==null?(_=_.index,_<p?(g.flags|=2,p):_):(g.flags|=2,p)):(g.flags|=1048576,p)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,p,_,w){return p===null||p.tag!==6?(p=ka(_,g.mode,w),p.return=g,p):(p=s(p,_),p.return=g,p)}function a(g,p,_,w){var P=_.type;return P===Ar?f(g,p,_.props.children,w,_.key):p!==null&&(p.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===hn&&Vf(P)===p.type)?(w=s(p,_.props),w.ref=Cs(g,p,_),w.return=g,w):(w=Si(_.type,_.key,_.props,null,g.mode,w),w.ref=Cs(g,p,_),w.return=g,w)}function u(g,p,_,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==_.containerInfo||p.stateNode.implementation!==_.implementation?(p=Ta(_,g.mode,w),p.return=g,p):(p=s(p,_.children||[]),p.return=g,p)}function f(g,p,_,w,P){return p===null||p.tag!==7?(p=or(_,g.mode,w,P),p.return=g,p):(p=s(p,_),p.return=g,p)}function c(g,p,_){if(typeof p=="string"&&p!==""||typeof p=="number")return p=ka(""+p,g.mode,_),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ho:return _=Si(p.type,p.key,p.props,null,g.mode,_),_.ref=Cs(g,null,p),_.return=g,_;case br:return p=Ta(p,g.mode,_),p.return=g,p;case hn:var w=p._init;return c(g,w(p._payload),_)}if(Ns(p)||vs(p))return p=or(p,g.mode,_,null),p.return=g,p;ri(g,p)}return null}function d(g,p,_,w){var P=p!==null?p.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return P!==null?null:l(g,p,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ho:return _.key===P?a(g,p,_,w):null;case br:return _.key===P?u(g,p,_,w):null;case hn:return P=_._init,d(g,p,P(_._payload),w)}if(Ns(_)||vs(_))return P!==null?null:f(g,p,_,w,null);ri(g,_)}return null}function m(g,p,_,w,P){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(_)||null,l(p,g,""+w,P);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ho:return g=g.get(w.key===null?_:w.key)||null,a(p,g,w,P);case br:return g=g.get(w.key===null?_:w.key)||null,u(p,g,w,P);case hn:var k=w._init;return m(g,p,_,k(w._payload),P)}if(Ns(w)||vs(w))return g=g.get(_)||null,f(p,g,w,P,null);ri(p,w)}return null}function h(g,p,_,w){for(var P=null,k=null,b=p,D=p=0,$=null;b!==null&&D<_.length;D++){b.index>D?($=b,b=null):$=b.sibling;var R=d(g,b,_[D],w);if(R===null){b===null&&(b=$);break}t&&b&&R.alternate===null&&e(g,b),p=o(R,p,D),k===null?P=R:k.sibling=R,k=R,b=$}if(D===_.length)return n(g,b),ie&&qn(g,D),P;if(b===null){for(;D<_.length;D++)b=c(g,_[D],w),b!==null&&(p=o(b,p,D),k===null?P=b:k.sibling=b,k=b);return ie&&qn(g,D),P}for(b=r(g,b);D<_.length;D++)$=m(b,g,D,_[D],w),$!==null&&(t&&$.alternate!==null&&b.delete($.key===null?D:$.key),p=o($,p,D),k===null?P=$:k.sibling=$,k=$);return t&&b.forEach(function(q){return e(g,q)}),ie&&qn(g,D),P}function y(g,p,_,w){var P=vs(_);if(typeof P!="function")throw Error(C(150));if(_=P.call(_),_==null)throw Error(C(151));for(var k=P=null,b=p,D=p=0,$=null,R=_.next();b!==null&&!R.done;D++,R=_.next()){b.index>D?($=b,b=null):$=b.sibling;var q=d(g,b,R.value,w);if(q===null){b===null&&(b=$);break}t&&b&&q.alternate===null&&e(g,b),p=o(q,p,D),k===null?P=q:k.sibling=q,k=q,b=$}if(R.done)return n(g,b),ie&&qn(g,D),P;if(b===null){for(;!R.done;D++,R=_.next())R=c(g,R.value,w),R!==null&&(p=o(R,p,D),k===null?P=R:k.sibling=R,k=R);return ie&&qn(g,D),P}for(b=r(g,b);!R.done;D++,R=_.next())R=m(b,g,D,R.value,w),R!==null&&(t&&R.alternate!==null&&b.delete(R.key===null?D:R.key),p=o(R,p,D),k===null?P=R:k.sibling=R,k=R);return t&&b.forEach(function(Ge){return e(g,Ge)}),ie&&qn(g,D),P}function S(g,p,_,w){if(typeof _=="object"&&_!==null&&_.type===Ar&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Ho:e:{for(var P=_.key,k=p;k!==null;){if(k.key===P){if(P=_.type,P===Ar){if(k.tag===7){n(g,k.sibling),p=s(k,_.props.children),p.return=g,g=p;break e}}else if(k.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===hn&&Vf(P)===k.type){n(g,k.sibling),p=s(k,_.props),p.ref=Cs(g,k,_),p.return=g,g=p;break e}n(g,k);break}else e(g,k);k=k.sibling}_.type===Ar?(p=or(_.props.children,g.mode,w,_.key),p.return=g,g=p):(w=Si(_.type,_.key,_.props,null,g.mode,w),w.ref=Cs(g,p,_),w.return=g,g=w)}return i(g);case br:e:{for(k=_.key;p!==null;){if(p.key===k)if(p.tag===4&&p.stateNode.containerInfo===_.containerInfo&&p.stateNode.implementation===_.implementation){n(g,p.sibling),p=s(p,_.children||[]),p.return=g,g=p;break e}else{n(g,p);break}else e(g,p);p=p.sibling}p=Ta(_,g.mode,w),p.return=g,g=p}return i(g);case hn:return k=_._init,S(g,p,k(_._payload),w)}if(Ns(_))return h(g,p,_,w);if(vs(_))return y(g,p,_,w);ri(g,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,p!==null&&p.tag===6?(n(g,p.sibling),p=s(p,_),p.return=g,g=p):(n(g,p),p=ka(_,g.mode,w),p.return=g,g=p),i(g)):n(g,p)}return S}var qr=Rm(!0),Im=Rm(!1),Ui=Wn(null),Mi=null,$r=null,Ac=null;function Dc(){Ac=$r=Mi=null}function xc(t){var e=Ui.current;oe(Ui),t._currentValue=e}function gu(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Wr(t,e){Mi=t,Ac=$r=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ke=!0),t.firstContext=null)}function wt(t){var e=t._currentValue;if(Ac!==t)if(t={context:t,memoizedValue:e,next:null},$r===null){if(Mi===null)throw Error(C(308));$r=t,Mi.dependencies={lanes:0,firstContext:t}}else $r=$r.next=t;return e}var tr=null;function Oc(t){tr===null?tr=[t]:tr.push(t)}function Lm(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Oc(e)):(n.next=s.next,s.next=n),e.interleaved=n,on(t,r)}function on(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var pn=!1;function Nc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $m(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function en(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function kn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,z&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,on(t,n)}return s=r.interleaved,s===null?(e.next=e,Oc(r)):(e.next=s.next,s.next=e),r.interleaved=e,on(t,n)}function gi(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yc(t,n)}}function Bf(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fi(t,e,n,r){var s=t.updateQueue;pn=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var a=l,u=a.next;a.next=null,i===null?o=u:i.next=u,i=a;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==i&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=a))}if(o!==null){var c=s.baseState;i=0,f=u=a=null,l=o;do{var d=l.lane,m=l.eventTime;if((r&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var h=t,y=l;switch(d=e,m=n,y.tag){case 1:if(h=y.payload,typeof h=="function"){c=h.call(m,c,d);break e}c=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=y.payload,d=typeof h=="function"?h.call(m,c,d):h,d==null)break e;c=de({},c,d);break e;case 2:pn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[l]:d.push(l))}else m={eventTime:m,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=m,a=c):f=f.next=m,i|=d;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;d=l,l=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(f===null&&(a=c),s.baseState=a,s.firstBaseUpdate=u,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);dr|=i,t.lanes=i,t.memoizedState=c}}function Wf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(C(191,s));s.call(r)}}}var Oo={},Wt=Wn(Oo),lo=Wn(Oo),ao=Wn(Oo);function nr(t){if(t===Oo)throw Error(C(174));return t}function Rc(t,e){switch(ne(ao,e),ne(lo,t),ne(Wt,Oo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qa(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qa(e,t)}oe(Wt),ne(Wt,e)}function Xr(){oe(Wt),oe(lo),oe(ao)}function Um(t){nr(ao.current);var e=nr(Wt.current),n=qa(e,t.type);e!==n&&(ne(lo,t),ne(Wt,n))}function Ic(t){lo.current===t&&(oe(Wt),oe(lo))}var ae=Wn(0);function Gi(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var va=[];function Lc(){for(var t=0;t<va.length;t++)va[t]._workInProgressVersionPrimary=null;va.length=0}var yi=dn.ReactCurrentDispatcher,Ea=dn.ReactCurrentBatchConfig,cr=0,ce=null,_e=null,Se=null,Vi=!1,Vs=!1,uo=0,S0=0;function Re(){throw Error(C(321))}function $c(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!$t(t[n],e[n]))return!1;return!0}function Uc(t,e,n,r,s,o){if(cr=o,ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yi.current=t===null||t.memoizedState===null?T0:b0,t=n(r,s),Vs){o=0;do{if(Vs=!1,uo=0,25<=o)throw Error(C(301));o+=1,Se=_e=null,e.updateQueue=null,yi.current=A0,t=n(r,s)}while(Vs)}if(yi.current=Bi,e=_e!==null&&_e.next!==null,cr=0,Se=_e=ce=null,Vi=!1,e)throw Error(C(300));return t}function Mc(){var t=uo!==0;return uo=0,t}function Gt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Se===null?ce.memoizedState=Se=t:Se=Se.next=t,Se}function St(){if(_e===null){var t=ce.alternate;t=t!==null?t.memoizedState:null}else t=_e.next;var e=Se===null?ce.memoizedState:Se.next;if(e!==null)Se=e,_e=t;else{if(t===null)throw Error(C(310));_e=t,t={memoizedState:_e.memoizedState,baseState:_e.baseState,baseQueue:_e.baseQueue,queue:_e.queue,next:null},Se===null?ce.memoizedState=Se=t:Se=Se.next=t}return Se}function co(t,e){return typeof e=="function"?e(t):e}function wa(t){var e=St(),n=e.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=t;var r=_e,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,a=null,u=o;do{var f=u.lane;if((cr&f)===f)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var c={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=c,i=r):a=a.next=c,ce.lanes|=f,dr|=f}u=u.next}while(u!==null&&u!==o);a===null?i=r:a.next=l,$t(r,e.memoizedState)||(Ke=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,ce.lanes|=o,dr|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Sa(t){var e=St(),n=e.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);$t(o,e.memoizedState)||(Ke=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Mm(){}function Fm(t,e){var n=ce,r=St(),s=e(),o=!$t(r.memoizedState,s);if(o&&(r.memoizedState=s,Ke=!0),r=r.queue,Fc(Bm.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Se!==null&&Se.memoizedState.tag&1){if(n.flags|=2048,fo(9,Vm.bind(null,n,r,s,e),void 0,null),Te===null)throw Error(C(349));cr&30||Gm(n,e,s)}return s}function Gm(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Vm(t,e,n,r){e.value=n,e.getSnapshot=r,Wm(e)&&jm(t)}function Bm(t,e,n){return n(function(){Wm(e)&&jm(t)})}function Wm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!$t(t,n)}catch{return!0}}function jm(t){var e=on(t,1);e!==null&&It(e,t,1,-1)}function jf(t){var e=Gt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:t},e.queue=t,t=t.dispatch=k0.bind(null,ce,t),[e.memoizedState,t]}function fo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function zm(){return St().memoizedState}function _i(t,e,n,r){var s=Gt();ce.flags|=t,s.memoizedState=fo(1|e,n,void 0,r===void 0?null:r)}function wl(t,e,n,r){var s=St();r=r===void 0?null:r;var o=void 0;if(_e!==null){var i=_e.memoizedState;if(o=i.destroy,r!==null&&$c(r,i.deps)){s.memoizedState=fo(e,n,o,r);return}}ce.flags|=t,s.memoizedState=fo(1|e,n,o,r)}function zf(t,e){return _i(8390656,8,t,e)}function Fc(t,e){return wl(2048,8,t,e)}function Hm(t,e){return wl(4,2,t,e)}function Ym(t,e){return wl(4,4,t,e)}function Qm(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Km(t,e,n){return n=n!=null?n.concat([t]):null,wl(4,4,Qm.bind(null,e,t),n)}function Gc(){}function qm(t,e){var n=St();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$c(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Xm(t,e){var n=St();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$c(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Jm(t,e,n){return cr&21?($t(n,e)||(n=rm(),ce.lanes|=n,dr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ke=!0),t.memoizedState=n)}function P0(t,e){var n=K;K=n!==0&&4>n?n:4,t(!0);var r=Ea.transition;Ea.transition={};try{t(!1),e()}finally{K=n,Ea.transition=r}}function Zm(){return St().memoizedState}function C0(t,e,n){var r=bn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},eg(t))tg(e,n);else if(n=Lm(t,e,n,r),n!==null){var s=We();It(n,t,r,s),ng(n,e,r)}}function k0(t,e,n){var r=bn(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(eg(t))tg(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,$t(l,i)){var a=e.interleaved;a===null?(s.next=s,Oc(e)):(s.next=a.next,a.next=s),e.interleaved=s;return}}catch{}finally{}n=Lm(t,e,s,r),n!==null&&(s=We(),It(n,t,r,s),ng(n,e,r))}}function eg(t){var e=t.alternate;return t===ce||e!==null&&e===ce}function tg(t,e){Vs=Vi=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ng(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yc(t,n)}}var Bi={readContext:wt,useCallback:Re,useContext:Re,useEffect:Re,useImperativeHandle:Re,useInsertionEffect:Re,useLayoutEffect:Re,useMemo:Re,useReducer:Re,useRef:Re,useState:Re,useDebugValue:Re,useDeferredValue:Re,useTransition:Re,useMutableSource:Re,useSyncExternalStore:Re,useId:Re,unstable_isNewReconciler:!1},T0={readContext:wt,useCallback:function(t,e){return Gt().memoizedState=[t,e===void 0?null:e],t},useContext:wt,useEffect:zf,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_i(4194308,4,Qm.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _i(4194308,4,t,e)},useInsertionEffect:function(t,e){return _i(4,2,t,e)},useMemo:function(t,e){var n=Gt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=C0.bind(null,ce,t),[r.memoizedState,t]},useRef:function(t){var e=Gt();return t={current:t},e.memoizedState=t},useState:jf,useDebugValue:Gc,useDeferredValue:function(t){return Gt().memoizedState=t},useTransition:function(){var t=jf(!1),e=t[0];return t=P0.bind(null,t[1]),Gt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ce,s=Gt();if(ie){if(n===void 0)throw Error(C(407));n=n()}else{if(n=e(),Te===null)throw Error(C(349));cr&30||Gm(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,zf(Bm.bind(null,r,o,t),[t]),r.flags|=2048,fo(9,Vm.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Gt(),e=Te.identifierPrefix;if(ie){var n=Jt,r=Xt;n=(r&~(1<<32-Rt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=uo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=S0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},b0={readContext:wt,useCallback:qm,useContext:wt,useEffect:Fc,useImperativeHandle:Km,useInsertionEffect:Hm,useLayoutEffect:Ym,useMemo:Xm,useReducer:wa,useRef:zm,useState:function(){return wa(co)},useDebugValue:Gc,useDeferredValue:function(t){var e=St();return Jm(e,_e.memoizedState,t)},useTransition:function(){var t=wa(co)[0],e=St().memoizedState;return[t,e]},useMutableSource:Mm,useSyncExternalStore:Fm,useId:Zm,unstable_isNewReconciler:!1},A0={readContext:wt,useCallback:qm,useContext:wt,useEffect:Fc,useImperativeHandle:Km,useInsertionEffect:Hm,useLayoutEffect:Ym,useMemo:Xm,useReducer:Sa,useRef:zm,useState:function(){return Sa(co)},useDebugValue:Gc,useDeferredValue:function(t){var e=St();return _e===null?e.memoizedState=t:Jm(e,_e.memoizedState,t)},useTransition:function(){var t=Sa(co)[0],e=St().memoizedState;return[t,e]},useMutableSource:Mm,useSyncExternalStore:Fm,useId:Zm,unstable_isNewReconciler:!1};function At(t,e){if(t&&t.defaultProps){e=de({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function yu(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:de({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Sl={isMounted:function(t){return(t=t._reactInternals)?_r(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=We(),s=bn(t),o=en(r,s);o.payload=e,n!=null&&(o.callback=n),e=kn(t,o,s),e!==null&&(It(e,t,s,r),gi(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=We(),s=bn(t),o=en(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=kn(t,o,s),e!==null&&(It(e,t,s,r),gi(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=We(),r=bn(t),s=en(n,r);s.tag=2,e!=null&&(s.callback=e),e=kn(t,s,r),e!==null&&(It(e,t,r,n),gi(e,t,r))}};function Hf(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!ro(n,r)||!ro(s,o):!0}function rg(t,e,n){var r=!1,s=In,o=e.contextType;return typeof o=="object"&&o!==null?o=wt(o):(s=Je(e)?ar:Me.current,r=e.contextTypes,o=(r=r!=null)?Qr(t,s):In),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Sl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Yf(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Sl.enqueueReplaceState(e,e.state,null)}function _u(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Nc(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=wt(o):(o=Je(e)?ar:Me.current,s.context=Qr(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(yu(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Sl.enqueueReplaceState(s,s.state,null),Fi(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Jr(t,e){try{var n="",r=e;do n+=nv(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Pa(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function vu(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var D0=typeof WeakMap=="function"?WeakMap:Map;function sg(t,e,n){n=en(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ji||(ji=!0,Du=r),vu(t,e)},n}function og(t,e,n){n=en(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){vu(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){vu(t,e),typeof r!="function"&&(Tn===null?Tn=new Set([this]):Tn.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function Qf(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new D0;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=W0.bind(null,t,e,n),e.then(t,t))}function Kf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function qf(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=en(-1,1),e.tag=2,kn(n,e,1))),n.lanes|=1),t)}var x0=dn.ReactCurrentOwner,Ke=!1;function Ve(t,e,n,r){e.child=t===null?Im(e,null,n,r):qr(e,t.child,n,r)}function Xf(t,e,n,r,s){n=n.render;var o=e.ref;return Wr(e,s),r=Uc(t,e,n,r,o,s),n=Mc(),t!==null&&!Ke?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ln(t,e,s)):(ie&&n&&kc(e),e.flags|=1,Ve(t,e,r,s),e.child)}function Jf(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!Qc(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,ig(t,e,o,r,s)):(t=Si(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:ro,n(i,r)&&t.ref===e.ref)return ln(t,e,s)}return e.flags|=1,t=An(o,r),t.ref=e.ref,t.return=e,e.child=t}function ig(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(ro(o,r)&&t.ref===e.ref)if(Ke=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Ke=!0);else return e.lanes=t.lanes,ln(t,e,s)}return Eu(t,e,n,r,s)}function lg(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ne(Mr,nt),nt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ne(Mr,nt),nt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ne(Mr,nt),nt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ne(Mr,nt),nt|=r;return Ve(t,e,s,n),e.child}function ag(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Eu(t,e,n,r,s){var o=Je(n)?ar:Me.current;return o=Qr(e,o),Wr(e,s),n=Uc(t,e,n,r,o,s),r=Mc(),t!==null&&!Ke?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ln(t,e,s)):(ie&&r&&kc(e),e.flags|=1,Ve(t,e,n,s),e.child)}function Zf(t,e,n,r,s){if(Je(n)){var o=!0;Ii(e)}else o=!1;if(Wr(e,s),e.stateNode===null)vi(t,e),rg(e,n,r),_u(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var a=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=wt(u):(u=Je(n)?ar:Me.current,u=Qr(e,u));var f=n.getDerivedStateFromProps,c=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";c||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||a!==u)&&Yf(e,i,r,u),pn=!1;var d=e.memoizedState;i.state=d,Fi(e,r,i,s),a=e.memoizedState,l!==r||d!==a||Xe.current||pn?(typeof f=="function"&&(yu(e,n,f,r),a=e.memoizedState),(l=pn||Hf(e,n,l,r,d,a,u))?(c||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),i.props=r,i.state=a,i.context=u,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,$m(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:At(e.type,l),i.props=u,c=e.pendingProps,d=i.context,a=n.contextType,typeof a=="object"&&a!==null?a=wt(a):(a=Je(n)?ar:Me.current,a=Qr(e,a));var m=n.getDerivedStateFromProps;(f=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==c||d!==a)&&Yf(e,i,r,a),pn=!1,d=e.memoizedState,i.state=d,Fi(e,r,i,s);var h=e.memoizedState;l!==c||d!==h||Xe.current||pn?(typeof m=="function"&&(yu(e,n,m,r),h=e.memoizedState),(u=pn||Hf(e,n,u,r,d,h,a)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,h,a),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,h,a)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=h),i.props=r,i.state=h,i.context=a,r=u):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return wu(t,e,n,r,o,s)}function wu(t,e,n,r,s,o){ag(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&Mf(e,n,!1),ln(t,e,o);r=e.stateNode,x0.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=qr(e,t.child,null,o),e.child=qr(e,null,l,o)):Ve(t,e,l,o),e.memoizedState=r.state,s&&Mf(e,n,!0),e.child}function ug(t){var e=t.stateNode;e.pendingContext?Uf(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Uf(t,e.context,!1),Rc(t,e.containerInfo)}function eh(t,e,n,r,s){return Kr(),bc(s),e.flags|=256,Ve(t,e,n,r),e.child}var Su={dehydrated:null,treeContext:null,retryLane:0};function Pu(t){return{baseLanes:t,cachePool:null,transitions:null}}function cg(t,e,n){var r=e.pendingProps,s=ae.current,o=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ne(ae,s&1),t===null)return mu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=kl(i,r,0,null),t=or(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Pu(n),e.memoizedState=Su,t):Vc(e,i));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return O0(t,e,i,r,l,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,l=s.sibling;var a={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=An(s,a),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=An(l,o):(o=or(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?Pu(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=Su,r}return o=t.child,t=o.sibling,r=An(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Vc(t,e){return e=kl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function si(t,e,n,r){return r!==null&&bc(r),qr(e,t.child,null,n),t=Vc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function O0(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Pa(Error(C(422))),si(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=kl({mode:"visible",children:r.children},s,0,null),o=or(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&qr(e,t.child,null,i),e.child.memoizedState=Pu(i),e.memoizedState=Su,o);if(!(e.mode&1))return si(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(C(419)),r=Pa(o,r,void 0),si(t,e,i,r)}if(l=(i&t.childLanes)!==0,Ke||l){if(r=Te,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,on(t,s),It(r,t,s,-1))}return Yc(),r=Pa(Error(C(421))),si(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=j0.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,st=Cn(s.nextSibling),ot=e,ie=!0,xt=null,t!==null&&(pt[mt++]=Xt,pt[mt++]=Jt,pt[mt++]=ur,Xt=t.id,Jt=t.overflow,ur=e),e=Vc(e,r.children),e.flags|=4096,e)}function th(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),gu(t.return,e,n)}function Ca(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function dg(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(Ve(t,e,r.children,n),r=ae.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&th(t,n,e);else if(t.tag===19)th(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ne(ae,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Gi(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ca(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Gi(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ca(e,!0,n,null,o);break;case"together":Ca(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vi(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ln(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),dr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(C(153));if(e.child!==null){for(t=e.child,n=An(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=An(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function N0(t,e,n){switch(e.tag){case 3:ug(e),Kr();break;case 5:Um(e);break;case 1:Je(e.type)&&Ii(e);break;case 4:Rc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ne(Ui,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ne(ae,ae.current&1),e.flags|=128,null):n&e.child.childLanes?cg(t,e,n):(ne(ae,ae.current&1),t=ln(t,e,n),t!==null?t.sibling:null);ne(ae,ae.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return dg(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ne(ae,ae.current),r)break;return null;case 22:case 23:return e.lanes=0,lg(t,e,n)}return ln(t,e,n)}var fg,Cu,hg,pg;fg=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cu=function(){};hg=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,nr(Wt.current);var o=null;switch(n){case"input":s=Ha(t,s),r=Ha(t,r),o=[];break;case"select":s=de({},s,{value:void 0}),r=de({},r,{value:void 0}),o=[];break;case"textarea":s=Ka(t,s),r=Ka(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ni)}Xa(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qs.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var a=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||a&&a.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in a)a.hasOwnProperty(i)&&l[i]!==a[i]&&(n||(n={}),n[i]=a[i])}else n||(o||(o=[]),o.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qs.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&se("scroll",t),o||l===a||(o=[])):(o=o||[]).push(u,a))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};pg=function(t,e,n,r){n!==r&&(e.flags|=4)};function ks(t,e){if(!ie)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ie(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function R0(t,e,n){var r=e.pendingProps;switch(Tc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ie(e),null;case 1:return Je(e.type)&&Ri(),Ie(e),null;case 3:return r=e.stateNode,Xr(),oe(Xe),oe(Me),Lc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ni(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xt!==null&&(Nu(xt),xt=null))),Cu(t,e),Ie(e),null;case 5:Ic(e);var s=nr(ao.current);if(n=e.type,t!==null&&e.stateNode!=null)hg(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(C(166));return Ie(e),null}if(t=nr(Wt.current),ni(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Vt]=e,r[io]=o,t=(e.mode&1)!==0,n){case"dialog":se("cancel",r),se("close",r);break;case"iframe":case"object":case"embed":se("load",r);break;case"video":case"audio":for(s=0;s<Is.length;s++)se(Is[s],r);break;case"source":se("error",r);break;case"img":case"image":case"link":se("error",r),se("load",r);break;case"details":se("toggle",r);break;case"input":cf(r,o),se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},se("invalid",r);break;case"textarea":ff(r,o),se("invalid",r)}Xa(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&ti(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&ti(r.textContent,l,t),s=["children",""+l]):qs.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&se("scroll",r)}switch(n){case"input":Yo(r),df(r,o,!0);break;case"textarea":Yo(r),hf(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ni)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Bp(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[Vt]=e,t[io]=r,fg(t,e,!1,!1),e.stateNode=t;e:{switch(i=Ja(n,r),n){case"dialog":se("cancel",t),se("close",t),s=r;break;case"iframe":case"object":case"embed":se("load",t),s=r;break;case"video":case"audio":for(s=0;s<Is.length;s++)se(Is[s],t);s=r;break;case"source":se("error",t),s=r;break;case"img":case"image":case"link":se("error",t),se("load",t),s=r;break;case"details":se("toggle",t),s=r;break;case"input":cf(t,r),s=Ha(t,r),se("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=de({},r,{value:void 0}),se("invalid",t);break;case"textarea":ff(t,r),s=Ka(t,r),se("invalid",t);break;default:s=r}Xa(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?zp(t,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Wp(t,a)):o==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Xs(t,a):typeof a=="number"&&Xs(t,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(qs.hasOwnProperty(o)?a!=null&&o==="onScroll"&&se("scroll",t):a!=null&&dc(t,o,a,i))}switch(n){case"input":Yo(t),df(t,r,!1);break;case"textarea":Yo(t),hf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Rn(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Fr(t,!!r.multiple,o,!1):r.defaultValue!=null&&Fr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ni)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ie(e),null;case 6:if(t&&e.stateNode!=null)pg(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(C(166));if(n=nr(ao.current),nr(Wt.current),ni(e)){if(r=e.stateNode,n=e.memoizedProps,r[Vt]=e,(o=r.nodeValue!==n)&&(t=ot,t!==null))switch(t.tag){case 3:ti(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ti(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vt]=e,e.stateNode=r}return Ie(e),null;case 13:if(oe(ae),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ie&&st!==null&&e.mode&1&&!(e.flags&128))Nm(),Kr(),e.flags|=98560,o=!1;else if(o=ni(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(C(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(C(317));o[Vt]=e}else Kr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ie(e),o=!1}else xt!==null&&(Nu(xt),xt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ae.current&1?Ee===0&&(Ee=3):Yc())),e.updateQueue!==null&&(e.flags|=4),Ie(e),null);case 4:return Xr(),Cu(t,e),t===null&&so(e.stateNode.containerInfo),Ie(e),null;case 10:return xc(e.type._context),Ie(e),null;case 17:return Je(e.type)&&Ri(),Ie(e),null;case 19:if(oe(ae),o=e.memoizedState,o===null)return Ie(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)ks(o,!1);else{if(Ee!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Gi(t),i!==null){for(e.flags|=128,ks(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ne(ae,ae.current&1|2),e.child}t=t.sibling}o.tail!==null&&me()>Zr&&(e.flags|=128,r=!0,ks(o,!1),e.lanes=4194304)}else{if(!r)if(t=Gi(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ks(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!ie)return Ie(e),null}else 2*me()-o.renderingStartTime>Zr&&n!==1073741824&&(e.flags|=128,r=!0,ks(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=me(),e.sibling=null,n=ae.current,ne(ae,r?n&1|2:n&1),e):(Ie(e),null);case 22:case 23:return Hc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?nt&1073741824&&(Ie(e),e.subtreeFlags&6&&(e.flags|=8192)):Ie(e),null;case 24:return null;case 25:return null}throw Error(C(156,e.tag))}function I0(t,e){switch(Tc(e),e.tag){case 1:return Je(e.type)&&Ri(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Xr(),oe(Xe),oe(Me),Lc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ic(e),null;case 13:if(oe(ae),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(C(340));Kr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return oe(ae),null;case 4:return Xr(),null;case 10:return xc(e.type._context),null;case 22:case 23:return Hc(),null;case 24:return null;default:return null}}var oi=!1,Le=!1,L0=typeof WeakSet=="function"?WeakSet:Set,O=null;function Ur(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){fe(t,e,r)}else n.current=null}function ku(t,e,n){try{n()}catch(r){fe(t,e,r)}}var nh=!1;function $0(t,e){if(au=Di,t=vm(),Cc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,a=-1,u=0,f=0,c=t,d=null;t:for(;;){for(var m;c!==n||s!==0&&c.nodeType!==3||(l=i+s),c!==o||r!==0&&c.nodeType!==3||(a=i+r),c.nodeType===3&&(i+=c.nodeValue.length),(m=c.firstChild)!==null;)d=c,c=m;for(;;){if(c===t)break t;if(d===n&&++u===s&&(l=i),d===o&&++f===r&&(a=i),(m=c.nextSibling)!==null)break;c=d,d=c.parentNode}c=m}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(uu={focusedElem:t,selectionRange:n},Di=!1,O=e;O!==null;)if(e=O,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,O=t;else for(;O!==null;){e=O;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var y=h.memoizedProps,S=h.memoizedState,g=e.stateNode,p=g.getSnapshotBeforeUpdate(e.elementType===e.type?y:At(e.type,y),S);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(C(163))}}catch(w){fe(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,O=t;break}O=e.return}return h=nh,nh=!1,h}function Bs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&ku(e,n,o)}s=s.next}while(s!==r)}}function Pl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Tu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function mg(t){var e=t.alternate;e!==null&&(t.alternate=null,mg(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vt],delete e[io],delete e[fu],delete e[_0],delete e[v0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gg(t){return t.tag===5||t.tag===3||t.tag===4}function rh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ni));else if(r!==4&&(t=t.child,t!==null))for(bu(t,e,n),t=t.sibling;t!==null;)bu(t,e,n),t=t.sibling}function Au(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Au(t,e,n),t=t.sibling;t!==null;)Au(t,e,n),t=t.sibling}var De=null,Dt=!1;function fn(t,e,n){for(n=n.child;n!==null;)yg(t,e,n),n=n.sibling}function yg(t,e,n){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(ml,n)}catch{}switch(n.tag){case 5:Le||Ur(n,e);case 6:var r=De,s=Dt;De=null,fn(t,e,n),De=r,Dt=s,De!==null&&(Dt?(t=De,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):De.removeChild(n.stateNode));break;case 18:De!==null&&(Dt?(t=De,n=n.stateNode,t.nodeType===8?ya(t.parentNode,n):t.nodeType===1&&ya(t,n),to(t)):ya(De,n.stateNode));break;case 4:r=De,s=Dt,De=n.stateNode.containerInfo,Dt=!0,fn(t,e,n),De=r,Dt=s;break;case 0:case 11:case 14:case 15:if(!Le&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&ku(n,e,i),s=s.next}while(s!==r)}fn(t,e,n);break;case 1:if(!Le&&(Ur(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){fe(n,e,l)}fn(t,e,n);break;case 21:fn(t,e,n);break;case 22:n.mode&1?(Le=(r=Le)||n.memoizedState!==null,fn(t,e,n),Le=r):fn(t,e,n);break;default:fn(t,e,n)}}function sh(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new L0),e.forEach(function(r){var s=z0.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Tt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:De=l.stateNode,Dt=!1;break e;case 3:De=l.stateNode.containerInfo,Dt=!0;break e;case 4:De=l.stateNode.containerInfo,Dt=!0;break e}l=l.return}if(De===null)throw Error(C(160));yg(o,i,s),De=null,Dt=!1;var a=s.alternate;a!==null&&(a.return=null),s.return=null}catch(u){fe(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_g(e,t),e=e.sibling}function _g(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Tt(e,t),Ft(t),r&4){try{Bs(3,t,t.return),Pl(3,t)}catch(y){fe(t,t.return,y)}try{Bs(5,t,t.return)}catch(y){fe(t,t.return,y)}}break;case 1:Tt(e,t),Ft(t),r&512&&n!==null&&Ur(n,n.return);break;case 5:if(Tt(e,t),Ft(t),r&512&&n!==null&&Ur(n,n.return),t.flags&32){var s=t.stateNode;try{Xs(s,"")}catch(y){fe(t,t.return,y)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Gp(s,o),Ja(l,i);var u=Ja(l,o);for(i=0;i<a.length;i+=2){var f=a[i],c=a[i+1];f==="style"?zp(s,c):f==="dangerouslySetInnerHTML"?Wp(s,c):f==="children"?Xs(s,c):dc(s,f,c,u)}switch(l){case"input":Ya(s,o);break;case"textarea":Vp(s,o);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?Fr(s,!!o.multiple,m,!1):d!==!!o.multiple&&(o.defaultValue!=null?Fr(s,!!o.multiple,o.defaultValue,!0):Fr(s,!!o.multiple,o.multiple?[]:"",!1))}s[io]=o}catch(y){fe(t,t.return,y)}}break;case 6:if(Tt(e,t),Ft(t),r&4){if(t.stateNode===null)throw Error(C(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(y){fe(t,t.return,y)}}break;case 3:if(Tt(e,t),Ft(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{to(e.containerInfo)}catch(y){fe(t,t.return,y)}break;case 4:Tt(e,t),Ft(t);break;case 13:Tt(e,t),Ft(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(jc=me())),r&4&&sh(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Le=(u=Le)||f,Tt(e,t),Le=u):Tt(e,t),Ft(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(O=t,f=t.child;f!==null;){for(c=O=f;O!==null;){switch(d=O,m=d.child,d.tag){case 0:case 11:case 14:case 15:Bs(4,d,d.return);break;case 1:Ur(d,d.return);var h=d.stateNode;if(typeof h.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(y){fe(r,n,y)}}break;case 5:Ur(d,d.return);break;case 22:if(d.memoizedState!==null){ih(c);continue}}m!==null?(m.return=d,O=m):ih(c)}f=f.sibling}e:for(f=null,c=t;;){if(c.tag===5){if(f===null){f=c;try{s=c.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=c.stateNode,a=c.memoizedProps.style,i=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=jp("display",i))}catch(y){fe(t,t.return,y)}}}else if(c.tag===6){if(f===null)try{c.stateNode.nodeValue=u?"":c.memoizedProps}catch(y){fe(t,t.return,y)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===t)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:Tt(e,t),Ft(t),r&4&&sh(t);break;case 21:break;default:Tt(e,t),Ft(t)}}function Ft(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(gg(n)){var r=n;break e}n=n.return}throw Error(C(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xs(s,""),r.flags&=-33);var o=rh(t);Au(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=rh(t);bu(t,l,i);break;default:throw Error(C(161))}}catch(a){fe(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function U0(t,e,n){O=t,vg(t)}function vg(t,e,n){for(var r=(t.mode&1)!==0;O!==null;){var s=O,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||oi;if(!i){var l=s.alternate,a=l!==null&&l.memoizedState!==null||Le;l=oi;var u=Le;if(oi=i,(Le=a)&&!u)for(O=s;O!==null;)i=O,a=i.child,i.tag===22&&i.memoizedState!==null?lh(s):a!==null?(a.return=i,O=a):lh(s);for(;o!==null;)O=o,vg(o),o=o.sibling;O=s,oi=l,Le=u}oh(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,O=o):oh(t)}}function oh(t){for(;O!==null;){var e=O;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Le||Pl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Le)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:At(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Wf(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Wf(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var c=f.dehydrated;c!==null&&to(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(C(163))}Le||e.flags&512&&Tu(e)}catch(d){fe(e,e.return,d)}}if(e===t){O=null;break}if(n=e.sibling,n!==null){n.return=e.return,O=n;break}O=e.return}}function ih(t){for(;O!==null;){var e=O;if(e===t){O=null;break}var n=e.sibling;if(n!==null){n.return=e.return,O=n;break}O=e.return}}function lh(t){for(;O!==null;){var e=O;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Pl(4,e)}catch(a){fe(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(a){fe(e,s,a)}}var o=e.return;try{Tu(e)}catch(a){fe(e,o,a)}break;case 5:var i=e.return;try{Tu(e)}catch(a){fe(e,i,a)}}}catch(a){fe(e,e.return,a)}if(e===t){O=null;break}var l=e.sibling;if(l!==null){l.return=e.return,O=l;break}O=e.return}}var M0=Math.ceil,Wi=dn.ReactCurrentDispatcher,Bc=dn.ReactCurrentOwner,Et=dn.ReactCurrentBatchConfig,z=0,Te=null,ge=null,Oe=0,nt=0,Mr=Wn(0),Ee=0,ho=null,dr=0,Cl=0,Wc=0,Ws=null,Ye=null,jc=0,Zr=1/0,Kt=null,ji=!1,Du=null,Tn=null,ii=!1,_n=null,zi=0,js=0,xu=null,Ei=-1,wi=0;function We(){return z&6?me():Ei!==-1?Ei:Ei=me()}function bn(t){return t.mode&1?z&2&&Oe!==0?Oe&-Oe:w0.transition!==null?(wi===0&&(wi=rm()),wi):(t=K,t!==0||(t=window.event,t=t===void 0?16:cm(t.type)),t):1}function It(t,e,n,r){if(50<js)throw js=0,xu=null,Error(C(185));Ao(t,n,r),(!(z&2)||t!==Te)&&(t===Te&&(!(z&2)&&(Cl|=n),Ee===4&&gn(t,Oe)),Ze(t,r),n===1&&z===0&&!(e.mode&1)&&(Zr=me()+500,El&&jn()))}function Ze(t,e){var n=t.callbackNode;wv(t,e);var r=Ai(t,t===Te?Oe:0);if(r===0)n!==null&&gf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&gf(n),e===1)t.tag===0?E0(ah.bind(null,t)):Dm(ah.bind(null,t)),g0(function(){!(z&6)&&jn()}),n=null;else{switch(sm(r)){case 1:n=gc;break;case 4:n=tm;break;case 16:n=bi;break;case 536870912:n=nm;break;default:n=bi}n=bg(n,Eg.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Eg(t,e){if(Ei=-1,wi=0,z&6)throw Error(C(327));var n=t.callbackNode;if(jr()&&t.callbackNode!==n)return null;var r=Ai(t,t===Te?Oe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hi(t,r);else{e=r;var s=z;z|=2;var o=Sg();(Te!==t||Oe!==e)&&(Kt=null,Zr=me()+500,sr(t,e));do try{V0();break}catch(l){wg(t,l)}while(!0);Dc(),Wi.current=o,z=s,ge!==null?e=0:(Te=null,Oe=0,e=Ee)}if(e!==0){if(e===2&&(s=ru(t),s!==0&&(r=s,e=Ou(t,s))),e===1)throw n=ho,sr(t,0),gn(t,r),Ze(t,me()),n;if(e===6)gn(t,r);else{if(s=t.current.alternate,!(r&30)&&!F0(s)&&(e=Hi(t,r),e===2&&(o=ru(t),o!==0&&(r=o,e=Ou(t,o))),e===1))throw n=ho,sr(t,0),gn(t,r),Ze(t,me()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(C(345));case 2:Xn(t,Ye,Kt);break;case 3:if(gn(t,r),(r&130023424)===r&&(e=jc+500-me(),10<e)){if(Ai(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){We(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=du(Xn.bind(null,t,Ye,Kt),e);break}Xn(t,Ye,Kt);break;case 4:if(gn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-Rt(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=me()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*M0(r/1960))-r,10<r){t.timeoutHandle=du(Xn.bind(null,t,Ye,Kt),r);break}Xn(t,Ye,Kt);break;case 5:Xn(t,Ye,Kt);break;default:throw Error(C(329))}}}return Ze(t,me()),t.callbackNode===n?Eg.bind(null,t):null}function Ou(t,e){var n=Ws;return t.current.memoizedState.isDehydrated&&(sr(t,e).flags|=256),t=Hi(t,e),t!==2&&(e=Ye,Ye=n,e!==null&&Nu(e)),t}function Nu(t){Ye===null?Ye=t:Ye.push.apply(Ye,t)}function F0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!$t(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gn(t,e){for(e&=~Wc,e&=~Cl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Rt(e),r=1<<n;t[n]=-1,e&=~r}}function ah(t){if(z&6)throw Error(C(327));jr();var e=Ai(t,0);if(!(e&1))return Ze(t,me()),null;var n=Hi(t,e);if(t.tag!==0&&n===2){var r=ru(t);r!==0&&(e=r,n=Ou(t,r))}if(n===1)throw n=ho,sr(t,0),gn(t,e),Ze(t,me()),n;if(n===6)throw Error(C(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xn(t,Ye,Kt),Ze(t,me()),null}function zc(t,e){var n=z;z|=1;try{return t(e)}finally{z=n,z===0&&(Zr=me()+500,El&&jn())}}function fr(t){_n!==null&&_n.tag===0&&!(z&6)&&jr();var e=z;z|=1;var n=Et.transition,r=K;try{if(Et.transition=null,K=1,t)return t()}finally{K=r,Et.transition=n,z=e,!(z&6)&&jn()}}function Hc(){nt=Mr.current,oe(Mr)}function sr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,m0(n)),ge!==null)for(n=ge.return;n!==null;){var r=n;switch(Tc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ri();break;case 3:Xr(),oe(Xe),oe(Me),Lc();break;case 5:Ic(r);break;case 4:Xr();break;case 13:oe(ae);break;case 19:oe(ae);break;case 10:xc(r.type._context);break;case 22:case 23:Hc()}n=n.return}if(Te=t,ge=t=An(t.current,null),Oe=nt=e,Ee=0,ho=null,Wc=Cl=dr=0,Ye=Ws=null,tr!==null){for(e=0;e<tr.length;e++)if(n=tr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}tr=null}return t}function wg(t,e){do{var n=ge;try{if(Dc(),yi.current=Bi,Vi){for(var r=ce.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Vi=!1}if(cr=0,Se=_e=ce=null,Vs=!1,uo=0,Bc.current=null,n===null||n.return===null){Ee=1,ho=e,ge=null;break}e:{var o=t,i=n.return,l=n,a=e;if(e=Oe,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,f=l,c=f.tag;if(!(f.mode&1)&&(c===0||c===11||c===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Kf(i);if(m!==null){m.flags&=-257,qf(m,i,l,o,e),m.mode&1&&Qf(o,u,e),e=m,a=u;var h=e.updateQueue;if(h===null){var y=new Set;y.add(a),e.updateQueue=y}else h.add(a);break e}else{if(!(e&1)){Qf(o,u,e),Yc();break e}a=Error(C(426))}}else if(ie&&l.mode&1){var S=Kf(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),qf(S,i,l,o,e),bc(Jr(a,l));break e}}o=a=Jr(a,l),Ee!==4&&(Ee=2),Ws===null?Ws=[o]:Ws.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=sg(o,a,e);Bf(o,g);break e;case 1:l=a;var p=o.type,_=o.stateNode;if(!(o.flags&128)&&(typeof p.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Tn===null||!Tn.has(_)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=og(o,l,e);Bf(o,w);break e}}o=o.return}while(o!==null)}Cg(n)}catch(P){e=P,ge===n&&n!==null&&(ge=n=n.return);continue}break}while(!0)}function Sg(){var t=Wi.current;return Wi.current=Bi,t===null?Bi:t}function Yc(){(Ee===0||Ee===3||Ee===2)&&(Ee=4),Te===null||!(dr&268435455)&&!(Cl&268435455)||gn(Te,Oe)}function Hi(t,e){var n=z;z|=2;var r=Sg();(Te!==t||Oe!==e)&&(Kt=null,sr(t,e));do try{G0();break}catch(s){wg(t,s)}while(!0);if(Dc(),z=n,Wi.current=r,ge!==null)throw Error(C(261));return Te=null,Oe=0,Ee}function G0(){for(;ge!==null;)Pg(ge)}function V0(){for(;ge!==null&&!fv();)Pg(ge)}function Pg(t){var e=Tg(t.alternate,t,nt);t.memoizedProps=t.pendingProps,e===null?Cg(t):ge=e,Bc.current=null}function Cg(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=I0(n,e),n!==null){n.flags&=32767,ge=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ee=6,ge=null;return}}else if(n=R0(n,e,nt),n!==null){ge=n;return}if(e=e.sibling,e!==null){ge=e;return}ge=e=t}while(e!==null);Ee===0&&(Ee=5)}function Xn(t,e,n){var r=K,s=Et.transition;try{Et.transition=null,K=1,B0(t,e,n,r)}finally{Et.transition=s,K=r}return null}function B0(t,e,n,r){do jr();while(_n!==null);if(z&6)throw Error(C(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(C(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Sv(t,o),t===Te&&(ge=Te=null,Oe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ii||(ii=!0,bg(bi,function(){return jr(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Et.transition,Et.transition=null;var i=K;K=1;var l=z;z|=4,Bc.current=null,$0(t,n),_g(n,t),a0(uu),Di=!!au,uu=au=null,t.current=n,U0(n),hv(),z=l,K=i,Et.transition=o}else t.current=n;if(ii&&(ii=!1,_n=t,zi=s),o=t.pendingLanes,o===0&&(Tn=null),gv(n.stateNode),Ze(t,me()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ji)throw ji=!1,t=Du,Du=null,t;return zi&1&&t.tag!==0&&jr(),o=t.pendingLanes,o&1?t===xu?js++:(js=0,xu=t):js=0,jn(),null}function jr(){if(_n!==null){var t=sm(zi),e=Et.transition,n=K;try{if(Et.transition=null,K=16>t?16:t,_n===null)var r=!1;else{if(t=_n,_n=null,zi=0,z&6)throw Error(C(331));var s=z;for(z|=4,O=t.current;O!==null;){var o=O,i=o.child;if(O.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(O=u;O!==null;){var f=O;switch(f.tag){case 0:case 11:case 15:Bs(8,f,o)}var c=f.child;if(c!==null)c.return=f,O=c;else for(;O!==null;){f=O;var d=f.sibling,m=f.return;if(mg(f),f===u){O=null;break}if(d!==null){d.return=m,O=d;break}O=m}}}var h=o.alternate;if(h!==null){var y=h.child;if(y!==null){h.child=null;do{var S=y.sibling;y.sibling=null,y=S}while(y!==null)}}O=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,O=i;else e:for(;O!==null;){if(o=O,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Bs(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,O=g;break e}O=o.return}}var p=t.current;for(O=p;O!==null;){i=O;var _=i.child;if(i.subtreeFlags&2064&&_!==null)_.return=i,O=_;else e:for(i=p;O!==null;){if(l=O,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Pl(9,l)}}catch(P){fe(l,l.return,P)}if(l===i){O=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,O=w;break e}O=l.return}}if(z=s,jn(),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(ml,t)}catch{}r=!0}return r}finally{K=n,Et.transition=e}}return!1}function uh(t,e,n){e=Jr(n,e),e=sg(t,e,1),t=kn(t,e,1),e=We(),t!==null&&(Ao(t,1,e),Ze(t,e))}function fe(t,e,n){if(t.tag===3)uh(t,t,n);else for(;e!==null;){if(e.tag===3){uh(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Tn===null||!Tn.has(r))){t=Jr(n,t),t=og(e,t,1),e=kn(e,t,1),t=We(),e!==null&&(Ao(e,1,t),Ze(e,t));break}}e=e.return}}function W0(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=We(),t.pingedLanes|=t.suspendedLanes&n,Te===t&&(Oe&n)===n&&(Ee===4||Ee===3&&(Oe&130023424)===Oe&&500>me()-jc?sr(t,0):Wc|=n),Ze(t,e)}function kg(t,e){e===0&&(t.mode&1?(e=qo,qo<<=1,!(qo&130023424)&&(qo=4194304)):e=1);var n=We();t=on(t,e),t!==null&&(Ao(t,e,n),Ze(t,n))}function j0(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kg(t,n)}function z0(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(C(314))}r!==null&&r.delete(e),kg(t,n)}var Tg;Tg=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xe.current)Ke=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ke=!1,N0(t,e,n);Ke=!!(t.flags&131072)}else Ke=!1,ie&&e.flags&1048576&&xm(e,$i,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;vi(t,e),t=e.pendingProps;var s=Qr(e,Me.current);Wr(e,n),s=Uc(null,e,r,t,s,n);var o=Mc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Je(r)?(o=!0,Ii(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Nc(e),s.updater=Sl,e.stateNode=s,s._reactInternals=e,_u(e,r,t,n),e=wu(null,e,r,!0,o,n)):(e.tag=0,ie&&o&&kc(e),Ve(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(vi(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Y0(r),t=At(r,t),s){case 0:e=Eu(null,e,r,t,n);break e;case 1:e=Zf(null,e,r,t,n);break e;case 11:e=Xf(null,e,r,t,n);break e;case 14:e=Jf(null,e,r,At(r.type,t),n);break e}throw Error(C(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:At(r,s),Eu(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:At(r,s),Zf(t,e,r,s,n);case 3:e:{if(ug(e),t===null)throw Error(C(387));r=e.pendingProps,o=e.memoizedState,s=o.element,$m(t,e),Fi(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=Jr(Error(C(423)),e),e=eh(t,e,r,n,s);break e}else if(r!==s){s=Jr(Error(C(424)),e),e=eh(t,e,r,n,s);break e}else for(st=Cn(e.stateNode.containerInfo.firstChild),ot=e,ie=!0,xt=null,n=Im(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kr(),r===s){e=ln(t,e,n);break e}Ve(t,e,r,n)}e=e.child}return e;case 5:return Um(e),t===null&&mu(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,cu(r,s)?i=null:o!==null&&cu(r,o)&&(e.flags|=32),ag(t,e),Ve(t,e,i,n),e.child;case 6:return t===null&&mu(e),null;case 13:return cg(t,e,n);case 4:return Rc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=qr(e,null,r,n):Ve(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:At(r,s),Xf(t,e,r,s,n);case 7:return Ve(t,e,e.pendingProps,n),e.child;case 8:return Ve(t,e,e.pendingProps.children,n),e.child;case 12:return Ve(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,ne(Ui,r._currentValue),r._currentValue=i,o!==null)if($t(o.value,i)){if(o.children===s.children&&!Xe.current){e=ln(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=en(-1,n&-n),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?a.next=a:(a.next=f.next,f.next=a),u.pending=a}}o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),gu(o.return,n,e),l.lanes|=n;break}a=a.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(C(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),gu(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Ve(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Wr(e,n),s=wt(s),r=r(s),e.flags|=1,Ve(t,e,r,n),e.child;case 14:return r=e.type,s=At(r,e.pendingProps),s=At(r.type,s),Jf(t,e,r,s,n);case 15:return ig(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:At(r,s),vi(t,e),e.tag=1,Je(r)?(t=!0,Ii(e)):t=!1,Wr(e,n),rg(e,r,s),_u(e,r,s,n),wu(null,e,r,!0,t,n);case 19:return dg(t,e,n);case 22:return lg(t,e,n)}throw Error(C(156,e.tag))};function bg(t,e){return em(t,e)}function H0(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yt(t,e,n,r){return new H0(t,e,n,r)}function Qc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Y0(t){if(typeof t=="function")return Qc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hc)return 11;if(t===pc)return 14}return 2}function An(t,e){var n=t.alternate;return n===null?(n=yt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Si(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")Qc(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Ar:return or(n.children,s,o,e);case fc:i=8,s|=8;break;case Ba:return t=yt(12,n,e,s|2),t.elementType=Ba,t.lanes=o,t;case Wa:return t=yt(13,n,e,s),t.elementType=Wa,t.lanes=o,t;case ja:return t=yt(19,n,e,s),t.elementType=ja,t.lanes=o,t;case Up:return kl(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Lp:i=10;break e;case $p:i=9;break e;case hc:i=11;break e;case pc:i=14;break e;case hn:i=16,r=null;break e}throw Error(C(130,t==null?t:typeof t,""))}return e=yt(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function or(t,e,n,r){return t=yt(7,t,r,e),t.lanes=n,t}function kl(t,e,n,r){return t=yt(22,t,r,e),t.elementType=Up,t.lanes=n,t.stateNode={isHidden:!1},t}function ka(t,e,n){return t=yt(6,t,null,e),t.lanes=n,t}function Ta(t,e,n){return e=yt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Q0(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ia(0),this.expirationTimes=ia(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ia(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Kc(t,e,n,r,s,o,i,l,a){return t=new Q0(t,e,n,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=yt(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nc(o),t}function K0(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:br,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Ag(t){if(!t)return In;t=t._reactInternals;e:{if(_r(t)!==t||t.tag!==1)throw Error(C(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Je(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(C(171))}if(t.tag===1){var n=t.type;if(Je(n))return Am(t,n,e)}return e}function Dg(t,e,n,r,s,o,i,l,a){return t=Kc(n,r,!0,t,s,o,i,l,a),t.context=Ag(null),n=t.current,r=We(),s=bn(n),o=en(r,s),o.callback=e??null,kn(n,o,s),t.current.lanes=s,Ao(t,s,r),Ze(t,r),t}function Tl(t,e,n,r){var s=e.current,o=We(),i=bn(s);return n=Ag(n),e.context===null?e.context=n:e.pendingContext=n,e=en(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=kn(s,e,i),t!==null&&(It(t,s,i,o),gi(t,s,i)),i}function Yi(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ch(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qc(t,e){ch(t,e),(t=t.alternate)&&ch(t,e)}function q0(){return null}var xg=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xc(t){this._internalRoot=t}bl.prototype.render=Xc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(C(409));Tl(t,e,null,null)};bl.prototype.unmount=Xc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fr(function(){Tl(null,t,null,null)}),e[sn]=null}};function bl(t){this._internalRoot=t}bl.prototype.unstable_scheduleHydration=function(t){if(t){var e=lm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<mn.length&&e!==0&&e<mn[n].priority;n++);mn.splice(n,0,t),n===0&&um(t)}};function Jc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Al(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function dh(){}function X0(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=Yi(i);o.call(u)}}var i=Dg(e,r,t,0,null,!1,!1,"",dh);return t._reactRootContainer=i,t[sn]=i.current,so(t.nodeType===8?t.parentNode:t),fr(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Yi(a);l.call(u)}}var a=Kc(t,0,!1,null,null,!1,!1,"",dh);return t._reactRootContainer=a,t[sn]=a.current,so(t.nodeType===8?t.parentNode:t),fr(function(){Tl(e,a,n,r)}),a}function Dl(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var a=Yi(i);l.call(a)}}Tl(e,i,t,s)}else i=X0(n,e,t,s,r);return Yi(i)}om=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Rs(e.pendingLanes);n!==0&&(yc(e,n|1),Ze(e,me()),!(z&6)&&(Zr=me()+500,jn()))}break;case 13:fr(function(){var r=on(t,1);if(r!==null){var s=We();It(r,t,1,s)}}),qc(t,1)}};_c=function(t){if(t.tag===13){var e=on(t,134217728);if(e!==null){var n=We();It(e,t,134217728,n)}qc(t,134217728)}};im=function(t){if(t.tag===13){var e=bn(t),n=on(t,e);if(n!==null){var r=We();It(n,t,e,r)}qc(t,e)}};lm=function(){return K};am=function(t,e){var n=K;try{return K=t,e()}finally{K=n}};eu=function(t,e,n){switch(e){case"input":if(Ya(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=vl(r);if(!s)throw Error(C(90));Fp(r),Ya(r,s)}}}break;case"textarea":Vp(t,n);break;case"select":e=n.value,e!=null&&Fr(t,!!n.multiple,e,!1)}};Qp=zc;Kp=fr;var J0={usingClientEntryPoint:!1,Events:[xo,Nr,vl,Hp,Yp,zc]},Ts={findFiberByHostInstance:er,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Z0={bundleType:Ts.bundleType,version:Ts.version,rendererPackageName:Ts.rendererPackageName,rendererConfig:Ts.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Jp(t),t===null?null:t.stateNode},findFiberByHostInstance:Ts.findFiberByHostInstance||q0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var li=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!li.isDisabled&&li.supportsFiber)try{ml=li.inject(Z0),Bt=li}catch{}}ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J0;ct.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jc(e))throw Error(C(200));return K0(t,e,null,n)};ct.createRoot=function(t,e){if(!Jc(t))throw Error(C(299));var n=!1,r="",s=xg;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Kc(t,1,!1,null,null,n,!1,r,s),t[sn]=e.current,so(t.nodeType===8?t.parentNode:t),new Xc(e)};ct.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(C(188)):(t=Object.keys(t).join(","),Error(C(268,t)));return t=Jp(e),t=t===null?null:t.stateNode,t};ct.flushSync=function(t){return fr(t)};ct.hydrate=function(t,e,n){if(!Al(e))throw Error(C(200));return Dl(null,t,e,!0,n)};ct.hydrateRoot=function(t,e,n){if(!Jc(t))throw Error(C(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=xg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=Dg(e,null,t,1,n??null,s,!1,o,i),t[sn]=e.current,so(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new bl(e)};ct.render=function(t,e,n){if(!Al(e))throw Error(C(200));return Dl(null,t,e,!1,n)};ct.unmountComponentAtNode=function(t){if(!Al(t))throw Error(C(40));return t._reactRootContainer?(fr(function(){Dl(null,null,t,!1,function(){t._reactRootContainer=null,t[sn]=null})}),!0):!1};ct.unstable_batchedUpdates=zc;ct.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Al(n))throw Error(C(200));if(t==null||t._reactInternals===void 0)throw Error(C(38));return Dl(t,e,n,!1,r)};ct.version="18.3.1-next-f1338f8080-20240426";function Og(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Og)}catch(t){console.error(t)}}Og(),Op.exports=ct;var eE=Op.exports,fh=eE;Ga.createRoot=fh.createRoot,Ga.hydrateRoot=fh.hydrateRoot;const tE=()=>{};var hh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T=function(t,e){if(!t)throw ds(e)},ds=function(t){return new Error("Firebase Database ("+Ng.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},nE=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],i=t[n++],l=t[n++],a=((s&7)<<18|(o&63)<<12|(i&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(a&1023))}else{const o=t[n++],i=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},Zc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],i=s+1<t.length,l=i?t[s+1]:0,a=s+2<t.length,u=a?t[s+2]:0,f=o>>2,c=(o&3)<<4|l>>4;let d=(l&15)<<2|u>>6,m=u&63;a||(m=64,i||(d=64)),r.push(n[f],n[c],n[d],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Rg(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nE(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const c=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||l==null||u==null||c==null)throw new rE;const d=o<<2|l>>4;if(r.push(d),u!==64){const m=l<<4&240|u>>2;if(r.push(m),c!==64){const h=u<<6&192|c;r.push(h)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class rE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ig=function(t){const e=Rg(t);return Zc.encodeByteArray(e,!0)},Qi=function(t){return Ig(t).replace(/\./g,"")},Ki=function(t){try{return Zc.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(t){return po(void 0,t)}function po(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!oE(n)||(t[n]=po(t[n],e[n]));return t}function oE(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=()=>Lg().__FIREBASE_DEFAULTS__,lE=()=>{if(typeof process>"u"||typeof hh>"u")return;const t=hh.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},aE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ki(t[1]);return e&&JSON.parse(e)},uE=()=>{try{return tE()||iE()||lE()||aE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ed=()=>{var t;return(t=uE())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function td(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cE(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Qi(JSON.stringify(n)),Qi(JSON.stringify(i)),""].join(".")}const zs={};function fE(){const t={prod:[],emulator:[]};for(const e of Object.keys(zs))zs[e]?t.emulator.push(e):t.prod.push(e);return t}function hE(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let ph=!1;function pE(t,e){if(typeof window>"u"||typeof document>"u"||!td(window.location.host)||zs[t]===e||zs[t]||ph)return;zs[t]=e;function n(d){return`__firebase__banner__${d}`}const r="__firebase__banner",o=fE().prod.length>0;function i(){const d=document.getElementById(r);d&&d.remove()}function l(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function a(d,m){d.setAttribute("width","24"),d.setAttribute("id",m),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function u(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{ph=!0,i()},d}function f(d,m){d.setAttribute("id",m),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function c(){const d=hE(r),m=n("text"),h=document.getElementById(m)||document.createElement("span"),y=n("learnmore"),S=document.getElementById(y)||document.createElement("a"),g=n("preprendIcon"),p=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const _=d.element;l(_),f(S,y);const w=u();a(p,g),_.append(p,h,S,w),document.body.appendChild(_)}o?(h.innerText="Preview backend disconnected.",p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,h.innerText="Preview backend running in this workspace."),h.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",c):c()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $g(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mE())}function gE(){return typeof window<"u"||Ug()}function Ug(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _E(){return Ng.NODE_ADMIN===!0}function vE(){try{return typeof indexedDB=="object"}catch{return!1}}function EE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE="FirebaseError";class fs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=wE,Object.setPrototypeOf(this,fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xl.prototype.create)}}class xl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?SE(o,r):"Error",l=`${this.serviceName}: ${i} (${s}).`;return new fs(s,l,r)}}function SE(t,e){return t.replace(PE,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const PE=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t){return JSON.parse(t)}function ve(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg=function(t){let e={},n={},r={},s="";try{const o=t.split(".");e=mo(Ki(o[0])||""),n=mo(Ki(o[1])||""),s=o[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},CE=function(t){const e=Mg(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},kE=function(t){const e=Mg(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hr(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Ru(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qi(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Xi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(mh(o)&&mh(i)){if(!Xi(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function mh(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let c=0;c<16;c++)r[c]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let c=0;c<16;c++)r[c]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let c=16;c<80;c++){const d=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=(d<<1|d>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],i=this.chain_[2],l=this.chain_[3],a=this.chain_[4],u,f;for(let c=0;c<80;c++){c<40?c<20?(u=l^o&(i^l),f=1518500249):(u=o^i^l,f=1859775393):c<60?(u=o&i|l&(o|i),f=2400959708):(u=o^i^l,f=3395469782);const d=(s<<5|s>>>27)+u+a+f+r[c]&4294967295;a=l,l=i,i=(o<<30|o>>>2)&4294967295,o=s,s=d}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+i&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const o=this.buf_;let i=this.inbuf_;for(;s<n;){if(i===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(o[i]=e.charCodeAt(s),++i,++s,i===this.blockSize){this.compress_(o),i=0;break}}else for(;s<n;)if(o[i]=e[s],++i,++s,i===this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[s]>>o&255,++r;return e}}function AE(t,e){const n=new DE(t,e);return n.subscribe.bind(n)}class DE{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");xE(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=ba),s.error===void 0&&(s.error=ba),s.complete===void 0&&(s.complete=ba);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xE(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ba(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L=function(t,e,n,r){let s;if(r<e?s="at least "+e:r>n&&(s=n===0?"none":"no more than "+n),s){const o=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(o)}};function et(t,e){return`${t} failed: ${e} argument `}function Pe(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(et(t,e)+"must be a valid function.")}function gh(t,e,n,r){if(n&&(typeof n!="object"||n===null))throw new Error(et(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const o=s-55296;r++,T(r<t.length,"Surrogate pair missing trail surrogate.");const i=t.charCodeAt(r)-56320;s=65536+(o<<10)+i}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Ol=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(t){return t&&t._delegate?t._delegate:t}class an{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Qe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RE(e))try{this.getOrInitializeService({instanceIdentifier:Jn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=Jn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jn){return this.instances.has(e)}getOptions(e=Jn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);r===l&&i.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:NE(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Jn){return this.component?this.component.multipleInstances?e:Jn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NE(t){return t===Jn?void 0:t}function RE(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Iu(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd=[];var J;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(J||(J={}));const Fg={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},IE=J.INFO,LE={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},$E=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=LE[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nl{constructor(e){this.name=e,this._logLevel=IE,this._logHandler=$E,this._userLogHandler=null,rd.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in J))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Fg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...e),this._logHandler(this,J.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...e),this._logHandler(this,J.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,J.INFO,...e),this._logHandler(this,J.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,J.WARN,...e),this._logHandler(this,J.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...e),this._logHandler(this,J.ERROR,...e)}}function UE(t){rd.forEach(e=>{e.setLogLevel(t)})}function ME(t,e){for(const n of rd){let r=null;e&&e.level&&(r=Fg[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,o,...i)=>{const l=i.map(a=>{if(a==null)return null;if(typeof a=="string")return a;if(typeof a=="number"||typeof a=="boolean")return a.toString();if(a instanceof Error)return a.message;try{return JSON.stringify(a)}catch{return null}}).filter(a=>a).join(" ");o>=(r??s.logLevel)&&t({level:J[o].toLowerCase(),message:l,args:i,type:s.name})}}}const FE=(t,e)=>e.some(n=>t instanceof n);let yh,_h;function GE(){return yh||(yh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function VE(){return _h||(_h=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Gg=new WeakMap,Lu=new WeakMap,Vg=new WeakMap,Aa=new WeakMap,sd=new WeakMap;function BE(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{n(Dn(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&Gg.set(n,t)}).catch(()=>{}),sd.set(e,t),e}function WE(t){if(Lu.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});Lu.set(t,e)}let $u={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Lu.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Vg.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Dn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function jE(t){$u=t($u)}function zE(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Da(this),e,...n);return Vg.set(r,e.sort?e.sort():[e]),Dn(r)}:VE().includes(t)?function(...e){return t.apply(Da(this),e),Dn(Gg.get(this))}:function(...e){return Dn(t.apply(Da(this),e))}}function HE(t){return typeof t=="function"?zE(t):(t instanceof IDBTransaction&&WE(t),FE(t,GE())?new Proxy(t,$u):t)}function Dn(t){if(t instanceof IDBRequest)return BE(t);if(Aa.has(t))return Aa.get(t);const e=HE(t);return e!==t&&(Aa.set(t,e),sd.set(e,t)),e}const Da=t=>sd.get(t);function YE(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(t,e),l=Dn(i);return r&&i.addEventListener("upgradeneeded",a=>{r(Dn(i.result),a.oldVersion,a.newVersion,Dn(i.transaction),a)}),n&&i.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{o&&a.addEventListener("close",()=>o()),s&&a.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const QE=["get","getKey","getAll","getAllKeys","count"],KE=["put","add","delete","clear"],xa=new Map;function vh(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xa.get(e))return xa.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=KE.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||QE.includes(n)))return;const o=async function(i,...l){const a=this.transaction(i,s?"readwrite":"readonly");let u=a.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&a.done]))[0]};return xa.set(e,o),o}jE(t=>({...t,get:(e,n,r)=>vh(e,n)||t.get(e,n,r),has:(e,n)=>!!vh(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(XE(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function XE(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ji="@firebase/app",Uu="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un=new Nl("@firebase/app"),JE="@firebase/app-compat",ZE="@firebase/analytics-compat",ew="@firebase/analytics",tw="@firebase/app-check-compat",nw="@firebase/app-check",rw="@firebase/auth",sw="@firebase/auth-compat",ow="@firebase/database",iw="@firebase/data-connect",lw="@firebase/database-compat",aw="@firebase/functions",uw="@firebase/functions-compat",cw="@firebase/installations",dw="@firebase/installations-compat",fw="@firebase/messaging",hw="@firebase/messaging-compat",pw="@firebase/performance",mw="@firebase/performance-compat",gw="@firebase/remote-config",yw="@firebase/remote-config-compat",_w="@firebase/storage",vw="@firebase/storage-compat",Ew="@firebase/firestore",ww="@firebase/ai",Sw="@firebase/firestore-compat",Pw="firebase",Cw="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln="[DEFAULT]",kw={[Ji]:"fire-core",[JE]:"fire-core-compat",[ew]:"fire-analytics",[ZE]:"fire-analytics-compat",[nw]:"fire-app-check",[tw]:"fire-app-check-compat",[rw]:"fire-auth",[sw]:"fire-auth-compat",[ow]:"fire-rtdb",[iw]:"fire-data-connect",[lw]:"fire-rtdb-compat",[aw]:"fire-fn",[uw]:"fire-fn-compat",[cw]:"fire-iid",[dw]:"fire-iid-compat",[fw]:"fire-fcm",[hw]:"fire-fcm-compat",[pw]:"fire-perf",[mw]:"fire-perf-compat",[gw]:"fire-rc",[yw]:"fire-rc-compat",[_w]:"fire-gcs",[vw]:"fire-gcs-compat",[Ew]:"fire-fst",[Sw]:"fire-fst-compat",[ww]:"fire-vertex","fire-js":"fire-js",[Pw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n=new Map,es=new Map,ts=new Map;function go(t,e){try{t.container.addComponent(e)}catch(n){un.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Bg(t,e){t.container.addOrOverwriteComponent(e)}function ns(t){const e=t.name;if(ts.has(e))return un.debug(`There were multiple attempts to register component ${e}.`),!1;ts.set(e,t);for(const n of $n.values())go(n,t);for(const n of es.values())go(n,t);return!0}function Wg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Tw(t,e,n=Ln){Wg(t,e).clearInstance(n)}function od(t){return t.options!==void 0}function jg(t){return od(t)?!1:"authIdToken"in t||"appCheckToken"in t||"releaseOnDeref"in t||"automaticDataCollectionEnabled"in t}function zg(t){return t==null?!1:t.settings!==void 0}function bw(){ts.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},it=new xl("app","Firebase",Aw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hg=class{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new an("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw it.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eh(t,e){const n=Ki(t.split(".")[1]);if(n===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(n).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(n).exp*1e3,o=new Date().getTime();s-o<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class Dw extends Hg{constructor(e,n,r,s){const o=n.automaticDataCollectionEnabled!==void 0?n.automaticDataCollectionEnabled:!0,i={name:r,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,i,s);else{const l=e;super(l.options,i,s)}this._serverConfig={automaticDataCollectionEnabled:o,...n},this._serverConfig.authIdToken&&Eh(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Eh(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,tn(Ji,Uu,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){ad(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw it.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const id=Cw;function ld(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Ln,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw it.create("bad-app-name",{appName:String(s)});if(n||(n=ed()),!n)throw it.create("no-options");const o=$n.get(s);if(o){if(Xi(n,o.options)&&Xi(r,o.config))return o;throw it.create("duplicate-app",{appName:s})}const i=new nd(s);for(const a of ts.values())i.addComponent(a);const l=new Hg(n,r,i);return $n.set(s,l),l}function xw(t,e={}){if(gE()&&!Ug())throw it.create("invalid-server-app-environment");let n,r=e||{};if(t&&(od(t)?n=t.options:jg(t)?r=t:n=t),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),n||(n=ed()),!n)throw it.create("no-options");const s={...r,...n};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const o=f=>[...f].reduce((c,d)=>Math.imul(31,c)+d.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw it.create("finalization-registry-not-supported",{});const i=""+o(JSON.stringify(s)),l=es.get(i);if(l)return l.incRefCount(r.releaseOnDeref),l;const a=new nd(i);for(const f of ts.values())a.addComponent(f);const u=new Dw(n,r,i,a);return es.set(i,u),u}function Ow(t=Ln){const e=$n.get(t);if(!e&&t===Ln&&ed())return ld();if(!e)throw it.create("no-app",{appName:t});return e}function Nw(){return Array.from($n.values())}async function ad(t){let e=!1;const n=t.name;$n.has(n)?(e=!0,$n.delete(n)):es.has(n)&&t.decRefCount()<=0&&(es.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function tn(t,e,n){let r=kw[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const i=[`Unable to register library "${r}" with version "${e}":`];s&&i.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&i.push("and"),o&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),un.warn(i.join(" "));return}ns(new an(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function Yg(t,e){if(t!==null&&typeof t!="function")throw it.create("invalid-log-argument");ME(t,e)}function Qg(t){UE(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="firebase-heartbeat-database",Iw=1,yo="firebase-heartbeat-store";let Oa=null;function Kg(){return Oa||(Oa=YE(Rw,Iw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(yo)}catch(n){console.warn(n)}}}}).catch(t=>{throw it.create("idb-open",{originalErrorMessage:t.message})})),Oa}async function Lw(t){try{const n=(await Kg()).transaction(yo),r=await n.objectStore(yo).get(qg(t));return await n.done,r}catch(e){if(e instanceof fs)un.warn(e.message);else{const n=it.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});un.warn(n.message)}}}async function wh(t,e){try{const r=(await Kg()).transaction(yo,"readwrite");await r.objectStore(yo).put(e,qg(t)),await r.done}catch(n){if(n instanceof fs)un.warn(n.message);else{const r=it.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});un.warn(r.message)}}}function qg(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w=1024,Uw=30;class Mw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Gw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Sh();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(i=>i.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>Uw){const i=Vw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){un.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Sh(),{heartbeatsToSend:r,unsentEntries:s}=Fw(this._heartbeatsCache.heartbeats),o=Qi(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return un.warn(n),""}}}function Sh(){return new Date().toISOString().substring(0,10)}function Fw(t,e=$w){const n=[];let r=t.slice();for(const s of t){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),Ph(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ph(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Gw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vE()?EE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Lw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return wh(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return wh(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Ph(t){return Qi(JSON.stringify({version:2,heartbeats:t})).length}function Vw(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bw(t){ns(new an("platform-logger",e=>new qE(e),"PRIVATE")),ns(new an("heartbeat",e=>new Mw(e),"PRIVATE")),tn(Ji,Uu,t),tn(Ji,Uu,"esm2020"),tn("fire-js","")}Bw("");const Ww=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:fs,SDK_VERSION:id,_DEFAULT_ENTRY_NAME:Ln,_addComponent:go,_addOrOverwriteComponent:Bg,_apps:$n,_clearComponents:bw,_components:ts,_getProvider:Wg,_isFirebaseApp:od,_isFirebaseServerApp:zg,_isFirebaseServerAppSettings:jg,_registerComponent:ns,_removeServiceInstance:Tw,_serverApps:es,deleteApp:ad,getApp:Ow,getApps:Nw,initializeApp:ld,initializeServerApp:xw,onLog:Yg,registerVersion:tn,setLogLevel:Qg},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,n){this._delegate=e,this.firebase=n,go(e,new an("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),ad(this._delegate)))}_getService(e,n=Ln){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())==null?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=Ln){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){go(this._delegate,e)}_addOrOverwriteComponent(e){Bg(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Ch=new xl("app-compat","Firebase",zw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t){const e={},n={__esModule:!0,initializeApp:o,app:s,registerVersion:tn,setLogLevel:Qg,onLog:Yg,apps:null,SDK_VERSION:id,INTERNAL:{registerComponent:l,removeApp:r,useAsService:a,modularAPIs:Ww}};n.default=n,Object.defineProperty(n,"apps",{get:i});function r(u){delete e[u]}function s(u){if(u=u||Ln,!at(e,u))throw Ch.create("no-app",{appName:u});return e[u]}s.App=t;function o(u,f={}){const c=ld(u,f);if(at(e,c.name))return e[c.name];const d=new t(c,n);return e[c.name]=d,d}function i(){return Object.keys(e).map(u=>e[u])}function l(u){const f=u.name,c=f.replace("-compat","");if(ns(u)&&u.type==="PUBLIC"){const d=(m=s())=>{if(typeof m[c]!="function")throw Ch.create("invalid-app-argument",{appName:f});return m[c]()};u.serviceProps!==void 0&&po(d,u.serviceProps),n[c]=d,t.prototype[c]=function(...m){return this._getService.bind(this,f).apply(this,u.multipleInstances?m:[])}}return u.type==="PUBLIC"?n[c]:null}function a(u,f){return f==="serverAuth"?null:f}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(){const t=Hw(jw);t.INTERNAL={...t.INTERNAL,createFirebaseNamespace:Xg,extendNamespace:e,createSubscribe:AE,ErrorFactory:xl,deepExtend:po};function e(n){po(t,n)}return t}const Yw=Xg();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh=new Nl("@firebase/app-compat"),Qw="@firebase/app-compat",Kw="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qw(t){tn(Qw,Kw,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const t=Lg();if(t.firebase!==void 0){kh.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=t.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&kh.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const ud=Yw;qw();var Xw="firebase",Jw="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ud.registerVersion(Xw,Jw,"app-compat");var Th={};const bh="@firebase/database",Ah="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jg="";function Zg(t){Jg=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ve(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:mo(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return at(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Zw(e)}}catch{}return new eS},rr=ey("localStorage"),Mu=ey("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new Nl("@firebase/database"),ty=function(){let t=1;return function(){return t++}}(),ny=function(t){const e=OE(t),n=new bE;n.update(e);const r=n.digest();return Zc.encodeByteArray(r)},No=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=No.apply(null,r):typeof r=="object"?e+=ve(r):e+=r,e+=" "}return e};let ir=null,Dh=!0;const ry=function(t,e){T(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(zr.logLevel=J.VERBOSE,ir=zr.log.bind(zr),e&&Mu.set("logging_enabled",!0)):typeof t=="function"?ir=t:(ir=null,Mu.remove("logging_enabled"))},ke=function(...t){if(Dh===!0&&(Dh=!1,ir===null&&Mu.get("logging_enabled")===!0&&ry(!0)),ir){const e=No.apply(null,t);ir(e)}},Ro=function(t){return function(...e){ke(t,...e)}},Fu=function(...t){const e="FIREBASE INTERNAL ERROR: "+No(...t);zr.error(e)},zt=function(...t){const e=`FIREBASE FATAL ERROR: ${No(...t)}`;throw zr.error(e),new Error(e)},Ue=function(...t){const e="FIREBASE WARNING: "+No(...t);zr.warn(e)},tS=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ue("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Rl=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},nS=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Un="[MIN_NAME]",cn="[MAX_NAME]",vr=function(t,e){if(t===e)return 0;if(t===Un||e===cn)return-1;if(e===Un||t===cn)return 1;{const n=xh(t),r=xh(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},rS=function(t,e){return t===e?0:t<e?-1:1},bs=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ve(e))},cd=function(t){if(typeof t!="object"||t===null)return ve(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=ve(e[r]),n+=":",n+=cd(t[e[r]]);return n+="}",n},sy=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function be(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const oy=function(t){T(!Rl(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,o,i,l,a;t===0?(o=0,i=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),o=l+r,i=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(o=0,i=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(a=n;a;a-=1)u.push(i%2?1:0),i=Math.floor(i/2);for(a=e;a;a-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(s?1:0),u.reverse();const f=u.join("");let c="";for(a=0;a<64;a+=8){let d=parseInt(f.substr(a,8),2).toString(16);d.length===1&&(d="0"+d),c=c+d}return c.toLowerCase()},sS=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},oS=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function iS(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const lS=new RegExp("^-?(0*)\\d{1,10}$"),aS=-2147483648,uS=2147483647,xh=function(t){if(lS.test(t)){const e=Number(t);if(e>=aS&&e<=uS)return e}return null},hs=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ue("Exception was thrown by user callback.",n),e},Math.floor(0))}},cS=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Hs=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,zg(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ue(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ke("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ue(e)}}class Hr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Hr.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd="5",iy="v",ly="s",ay="r",uy="f",cy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,dy="ls",fy="p",Gu="ac",hy="websocket",py="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,n,r,s,o=!1,i="",l=!1,a=!1,u=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=i,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=rr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&rr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function hS(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function gy(t,e,n){T(typeof e=="string","typeof type must == string"),T(typeof n=="object","typeof params must == object");let r;if(e===hy)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===py)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);hS(t)&&(n.ns=t.namespace);const s=[];return be(n,(o,i)=>{s.push(o+"="+i)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(){this.counters_={}}incrementCounter(e,n=1){at(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return sE(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na={},Ra={};function fd(t){const e=t.toString();return Na[e]||(Na[e]=new pS),Na[e]}function mS(t,e){const n=t.toString();return Ra[n]||(Ra[n]=e()),Ra[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&hs(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh="start",yS="close",_S="pLPCommand",vS="pRTLPCB",yy="id",_y="pw",vy="ser",ES="cb",wS="seg",SS="ts",PS="d",CS="dframe",Ey=1870,wy=30,kS=Ey-wy,TS=25e3,bS=3e4;class vn{constructor(e,n,r,s,o,i,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.transportSessionId=i,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ro(e),this.stats_=fd(n),this.urlFn=a=>(this.appCheckToken&&(a[Gu]=this.appCheckToken),gy(n,py,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new gS(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(bS)),nS(()=>{if(this.isClosed_)return;this.scriptTagHolder=new hd((...o)=>{const[i,l,a,u,f]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,i===Oh)this.id=l,this.password=a;else if(i===yS)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+i)},(...o)=>{const[i,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(i,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[Oh]="t",r[vy]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[ES]=this.scriptTagHolder.uniqueCallbackIdentifier),r[iy]=dd,this.transportSessionId&&(r[ly]=this.transportSessionId),this.lastSessionId&&(r[dy]=this.lastSessionId),this.applicationId&&(r[fy]=this.applicationId),this.appCheckToken&&(r[Gu]=this.appCheckToken),typeof location<"u"&&location.hostname&&cy.test(location.hostname)&&(r[ay]=uy);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){vn.forceAllow_=!0}static forceDisallow(){vn.forceDisallow_=!0}static isAvailable(){return vn.forceAllow_?!0:!vn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!sS()&&!oS()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ve(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Ig(n),s=sy(r,kS);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[CS]="t",r[yy]=e,r[_y]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ve(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class hd{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ty(),window[_S+this.uniqueCallbackIdentifier]=e,window[vS+this.uniqueCallbackIdentifier]=n,this.myIFrame=hd.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(l){ke("frame writing exception"),l.stack&&ke(l.stack),ke(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ke("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[yy]=this.myID,e[_y]=this.myPW,e[vy]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+wy+r.length<=Ey;){const i=this.pendingSegs.shift();r=r+"&"+wS+s+"="+i.seg+"&"+SS+s+"="+i.ts+"&"+PS+s+"="+i.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(TS)),o=()=>{clearTimeout(s),r()};this.addTag(e,o)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{ke("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=16384,DS=45e3;let Zi=null;typeof MozWebSocket<"u"?Zi=MozWebSocket:typeof WebSocket<"u"&&(Zi=WebSocket);class gt{constructor(e,n,r,s,o,i,l){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ro(this.connId),this.stats_=fd(n),this.connURL=gt.connectionURL_(n,i,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,o){const i={};return i[iy]=dd,typeof location<"u"&&location.hostname&&cy.test(location.hostname)&&(i[ay]=uy),n&&(i[ly]=n),r&&(i[dy]=r),s&&(i[Gu]=s),o&&(i[fy]=o),gy(e,hy,i)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,rr.set("previous_websocket_failure",!0);try{let r;_E(),this.mySock=new Zi(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){gt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Zi!==null&&!gt.forceDisallow_}static previouslyFailed(){return rr.isInMemoryStorage||rr.get("previous_websocket_failure")===!0}markConnectionHealthy(){rr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=mo(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(T(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=ve(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=sy(n,AS);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(DS))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}gt.responsesRequiredToBeHealthy=2;gt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{static get ALL_TRANSPORTS(){return[vn,gt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=gt&&gt.isAvailable();let r=n&&!gt.previouslyFailed();if(e.webSocketOnly&&(n||Ue("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[gt];else{const s=this.transports_=[];for(const o of rs.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);rs.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}rs.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS=6e4,OS=5e3,NS=10*1024,RS=100*1024,Ia="t",Nh="d",IS="s",Rh="r",LS="e",Ih="o",Lh="a",$h="n",Uh="p",$S="h";class US{constructor(e,n,r,s,o,i,l,a,u,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=i,this.onReady_=l,this.onDisconnect_=a,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ro("c:"+this.id+":"),this.transportManager_=new rs(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Hs(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>RS?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>NS?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ia in e){const n=e[Ia];n===Lh?this.upgradeIfSecondaryHealthy_():n===Rh?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Ih&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=bs("t",e),r=bs("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Uh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Lh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:$h,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=bs("t",e),r=bs("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=bs(Ia,e);if(Nh in e){const r=e[Nh];if(n===$S){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===$h){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===IS?this.onConnectionShutdown_(r):n===Rh?this.onReset_(r):n===LS?Fu("Server Error: "+r):n===Ih?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Fu("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),dd!==r&&Ue("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Hs(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(xS))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Hs(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(OS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Uh,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(rr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e){this.allowedEvents_=e,this.listeners_={},T(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===n&&(!r||r===s[o].context)){s.splice(o,1);return}}validateEventType_(e){T(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el extends Py{static getInstance(){return new el}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!$g()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return T(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=32,Fh=768;class Y{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function H(){return new Y("")}function G(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Mn(t){return t.pieces_.length-t.pieceNum_}function Z(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Y(t.pieces_,e)}function pd(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function MS(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function _o(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Cy(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Y(e,0)}function le(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Y)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Y(n,0)}function V(t){return t.pieceNum_>=t.pieces_.length}function Be(t,e){const n=G(t),r=G(e);if(n===null)return e;if(n===r)return Be(Z(t),Z(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function FS(t,e){const n=_o(t,0),r=_o(e,0);for(let s=0;s<n.length&&s<r.length;s++){const o=vr(n[s],r[s]);if(o!==0)return o}return n.length===r.length?0:n.length<r.length?-1:1}function md(t,e){if(Mn(t)!==Mn(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function _t(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Mn(t)>Mn(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class GS{constructor(e,n){this.errorPrefix_=n,this.parts_=_o(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Ol(this.parts_[r]);ky(this)}}function VS(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Ol(e),ky(t)}function BS(t){const e=t.parts_.pop();t.byteLength_-=Ol(e),t.parts_.length>0&&(t.byteLength_-=1)}function ky(t){if(t.byteLength_>Fh)throw new Error(t.errorPrefix_+"has a key path longer than "+Fh+" bytes ("+t.byteLength_+").");if(t.parts_.length>Mh)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Mh+") or object contains a cycle "+Zn(t))}function Zn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd extends Py{static getInstance(){return new gd}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return T(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As=1e3,WS=60*5*1e3,Gh=30*1e3,jS=1.3,zS=3e4,HS="server_kill",Vh=3;class nn extends Sy{constructor(e,n,r,s,o,i,l,a){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=i,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=nn.nextPersistentConnectionId_++,this.log_=Ro("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=As,this.maxReconnectDelay_=WS,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");gd.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&el.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,o={r:s,a:e,b:n};this.log_(ve(o)),T(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Qe,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:i=>{const l=i.d;i.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),n.promise}listen(e,n,r,s){this.initConnection_();const o=e._queryIdentifier,i=e._path.toString();this.log_("Listen called for "+i+" "+o),this.listens.has(i)||this.listens.set(i,new Map),T(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),T(!this.listens.get(i).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(i).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const o={p:r},i="q";e.tag&&(o.q=n._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(i,o,l=>{const a=l.d,u=l.s;nn.warnOnListenWarnings_(a,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(u,a))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&at(e,"w")){const r=hr(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',o=n._path.toString();Ue(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||kE(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Gh)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=CE(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const o=s.s,i=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),T(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const o={p:e},i="n";s&&(o.q=r,o.t=s),this.sendRequest(i,o)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const o={p:n,d:r};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,i=>{s&&setTimeout(()=>{s(i.s,i.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,o){this.initConnection_();const i={p:n,d:r};o!==void 0&&(i.h=o),this.outstandingPuts_.push({action:e,request:i,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,o=>{this.log_(n+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ve(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Fu("Unrecognized action received from server: "+ve(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){T(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=As,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=As,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>zS&&(this.reconnectDelay_=As),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*jS)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+nn.nextConnectionId_++,o=this.lastSessionId;let i=!1,l=null;const a=function(){l?l.close():(i=!0,r())},u=function(c){T(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(c)};this.realtime_={close:a,sendRequest:u};const f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[c,d]=await Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);i?ke("getToken() completed but was canceled"):(ke("getToken() completed. Creating connection."),this.authToken_=c&&c.accessToken,this.appCheckToken_=d&&d.token,l=new US(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,m=>{Ue(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(HS)},o))}catch(c){this.log_("Failed to get token: "+c),i||(this.repoInfo_.nodeAdmin&&Ue(c),a())}}}interrupt(e){ke("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ke("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ru(this.interruptReasons_)&&(this.reconnectDelay_=As,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(o=>cd(o)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Y(e).toString();let s;if(this.listens.has(r)){const o=this.listens.get(r);s=o.get(n),o.delete(n),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){ke("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Vh&&(this.reconnectDelay_=Gh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){ke("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Vh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Jg.replace(/\./g,"-")]=1,$g()?e["framework.cordova"]=1:yE()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=el.getInstance().currentlyOnline();return Ru(this.interruptReasons_)&&e}}nn.nextPersistentConnectionId_=0;nn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new B(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new B(Un,e),s=new B(Un,n);return this.compare(r,s)!==0}minPost(){return B.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ai;class Ty extends Il{static get __EMPTY_NODE(){return ai}static set __EMPTY_NODE(e){ai=e}compare(e,n){return vr(e.name,n.name)}isDefinedOn(e){throw ds("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return B.MIN}maxPost(){return new B(cn,ai)}makePost(e,n){return T(typeof e=="string","KeyIndex indexValue must always be a string."),new B(e,ai)}toString(){return".key"}}const jt=new Ty;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n,r,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let i=1;for(;!e.isEmpty();)if(e=e,i=n?r(e.key,n):1,s&&(i*=-1),i<0)this.isReverse_?e=e.left:e=e.right;else if(i===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ce{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??Ce.RED,this.left=s??qe.EMPTY_NODE,this.right=o??qe.EMPTY_NODE}copy(e,n,r,s,o){return new Ce(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return qe.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return qe.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ce.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ce.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ce.RED=!0;Ce.BLACK=!1;class YS{copy(e,n,r,s,o){return this}insert(e,n,r){return new Ce(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class qe{constructor(e,n=qe.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new qe(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ce.BLACK,null,null))}remove(e){return new qe(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ce.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ui(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ui(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ui(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ui(this.root_,null,this.comparator_,!0,e)}}qe.EMPTY_NODE=new YS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(t,e){return vr(t.name,e.name)}function yd(t,e){return vr(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vu;function KS(t){Vu=t}const by=function(t){return typeof t=="number"?"number:"+oy(t):"string:"+t},Ay=function(t){if(t.isLeafNode()){const e=t.val();T(typeof e=="string"||typeof e=="number"||typeof e=="object"&&at(e,".sv"),"Priority must be a string or number.")}else T(t===Vu||t.isEmpty(),"priority of unexpected type.");T(t===Vu||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bh;class we{static set __childrenNodeConstructor(e){Bh=e}static get __childrenNodeConstructor(){return Bh}constructor(e,n=we.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,T(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Ay(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new we(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:we.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return V(e)?this:G(e)===".priority"?this.priorityNode_:we.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:we.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=G(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(T(r!==".priority"||Mn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,we.__childrenNodeConstructor.EMPTY_NODE.updateChild(Z(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+by(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=oy(this.value_):e+=this.value_,this.lazyHash_=ny(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===we.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof we.__childrenNodeConstructor?-1:(T(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=we.VALUE_TYPE_ORDER.indexOf(n),o=we.VALUE_TYPE_ORDER.indexOf(r);return T(s>=0,"Unknown leaf type: "+n),T(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}we.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dy,xy;function qS(t){Dy=t}function XS(t){xy=t}class JS extends Il{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),o=r.compareTo(s);return o===0?vr(e.name,n.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return B.MIN}maxPost(){return new B(cn,new we("[PRIORITY-POST]",xy))}makePost(e,n){const r=Dy(e);return new B(n,new we("[PRIORITY-POST]",r))}toString(){return".priority"}}const re=new JS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS=Math.log(2);class eP{constructor(e){const n=o=>parseInt(Math.log(o)/ZS,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const tl=function(t,e,n,r){t.sort(e);const s=function(a,u){const f=u-a;let c,d;if(f===0)return null;if(f===1)return c=t[a],d=n?n(c):c,new Ce(d,c.node,Ce.BLACK,null,null);{const m=parseInt(f/2,10)+a,h=s(a,m),y=s(m+1,u);return c=t[m],d=n?n(c):c,new Ce(d,c.node,Ce.BLACK,h,y)}},o=function(a){let u=null,f=null,c=t.length;const d=function(h,y){const S=c-h,g=c;c-=h;const p=s(S+1,g),_=t[S],w=n?n(_):_;m(new Ce(w,_.node,y,null,p))},m=function(h){u?(u.left=h,u=h):(f=h,u=h)};for(let h=0;h<a.count;++h){const y=a.nextBitIsOne(),S=Math.pow(2,a.count-(h+1));y?d(S,Ce.BLACK):(d(S,Ce.BLACK),d(S,Ce.RED))}return f},i=new eP(t.length),l=o(i);return new qe(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let La;const kr={};class Zt{static get Default(){return T(kr&&re,"ChildrenNode.ts has not been loaded"),La=La||new Zt({".priority":kr},{".priority":re}),La}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=hr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof qe?n:null}hasIndex(e){return at(this.indexSet_,e.toString())}addIndex(e,n){T(e!==jt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const o=n.getIterator(B.Wrap);let i=o.getNext();for(;i;)s=s||e.isDefinedOn(i.node),r.push(i),i=o.getNext();let l;s?l=tl(r,e.getCompare()):l=kr;const a=e.toString(),u={...this.indexSet_};u[a]=e;const f={...this.indexes_};return f[a]=l,new Zt(f,u)}addToIndexes(e,n){const r=qi(this.indexes_,(s,o)=>{const i=hr(this.indexSet_,o);if(T(i,"Missing index implementation for "+o),s===kr)if(i.isDefinedOn(e.node)){const l=[],a=n.getIterator(B.Wrap);let u=a.getNext();for(;u;)u.name!==e.name&&l.push(u),u=a.getNext();return l.push(e),tl(l,i.getCompare())}else return kr;else{const l=n.get(e.name);let a=s;return l&&(a=a.remove(new B(e.name,l))),a.insert(e,e.node)}});return new Zt(r,this.indexSet_)}removeFromIndexes(e,n){const r=qi(this.indexes_,s=>{if(s===kr)return s;{const o=n.get(e.name);return o?s.remove(new B(e.name,o)):s}});return new Zt(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ds;class I{static get EMPTY_NODE(){return Ds||(Ds=new I(new qe(yd),null,Zt.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Ay(this.priorityNode_),this.children_.isEmpty()&&T(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ds}updatePriority(e){return this.children_.isEmpty()?this:new I(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Ds:n}}getChild(e){const n=G(e);return n===null?this:this.getImmediateChild(n).getChild(Z(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(T(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new B(e,n);let s,o;n.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));const i=s.isEmpty()?Ds:this.priorityNode_;return new I(s,i,o)}}updateChild(e,n){const r=G(e);if(r===null)return n;{T(G(e)!==".priority"||Mn(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Z(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,o=!0;if(this.forEachChild(re,(i,l)=>{n[i]=l.val(e),r++,o&&I.INTEGER_REGEXP_.test(i)?s=Math.max(s,Number(i)):o=!1}),!e&&o&&s<2*r){const i=[];for(const l in n)i[l]=n[l];return i}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+by(this.getPriority().val())+":"),this.forEachChild(re,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":ny(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const o=s.getPredecessorKey(new B(e,n));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new B(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new B(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,B.Wrap);let o=s.peek();for(;o!=null&&n.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,B.Wrap);let o=s.peek();for(;o!=null&&n.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Io?-1:0}withIndex(e){if(e===jt||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new I(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===jt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(re),s=n.getIterator(re);let o=r.getNext(),i=s.getNext();for(;o&&i;){if(o.name!==i.name||!o.node.equals(i.node))return!1;o=r.getNext(),i=s.getNext()}return o===null&&i===null}else return!1;else return!1}}resolveIndex_(e){return e===jt?null:this.indexMap_.get(e.toString())}}I.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class tP extends I{constructor(){super(new qe(yd),I.EMPTY_NODE,Zt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return I.EMPTY_NODE}isEmpty(){return!1}}const Io=new tP;Object.defineProperties(B,{MIN:{value:new B(Un,I.EMPTY_NODE)},MAX:{value:new B(cn,Io)}});Ty.__EMPTY_NODE=I.EMPTY_NODE;we.__childrenNodeConstructor=I;KS(Io);XS(Io);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP=!0;function ue(t,e=null){if(t===null)return I.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),T(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new we(n,ue(e))}if(!(t instanceof Array)&&nP){const n=[];let r=!1;if(be(t,(i,l)=>{if(i.substring(0,1)!=="."){const a=ue(l);a.isEmpty()||(r=r||!a.getPriority().isEmpty(),n.push(new B(i,a)))}}),n.length===0)return I.EMPTY_NODE;const o=tl(n,QS,i=>i.name,yd);if(r){const i=tl(n,re.getCompare());return new I(o,ue(e),new Zt({".priority":i},{".priority":re}))}else return new I(o,ue(e),Zt.Default)}else{let n=I.EMPTY_NODE;return be(t,(r,s)=>{if(at(t,r)&&r.substring(0,1)!=="."){const o=ue(s);(o.isLeafNode()||!o.isEmpty())&&(n=n.updateImmediateChild(r,o))}}),n.updatePriority(ue(e))}}qS(ue);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d extends Il{constructor(e){super(),this.indexPath_=e,T(!V(e)&&G(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),o=r.compareTo(s);return o===0?vr(e.name,n.name):o}makePost(e,n){const r=ue(e),s=I.EMPTY_NODE.updateChild(this.indexPath_,r);return new B(n,s)}maxPost(){const e=I.EMPTY_NODE.updateChild(this.indexPath_,Io);return new B(cn,e)}toString(){return _o(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP extends Il{compare(e,n){const r=e.node.compareTo(n.node);return r===0?vr(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return B.MIN}maxPost(){return B.MAX}makePost(e,n){const r=ue(e);return new B(n,r)}toString(){return".value"}}const vd=new rP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t){return{type:"value",snapshotNode:t}}function ss(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function vo(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Eo(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function sP(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e){this.index_=e}updateChild(e,n,r,s,o,i){T(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(r.getChild(s))&&l.isEmpty()===r.isEmpty()||(i!=null&&(r.isEmpty()?e.hasChild(n)?i.trackChildChange(vo(n,l)):T(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?i.trackChildChange(ss(n,r)):i.trackChildChange(Eo(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(re,(s,o)=>{n.hasChild(s)||r.trackChildChange(vo(s,o))}),n.isLeafNode()||n.forEachChild(re,(s,o)=>{if(e.hasChild(s)){const i=e.getImmediateChild(s);i.equals(o)||r.trackChildChange(Eo(s,o,i))}else r.trackChildChange(ss(s,o))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?I.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this.indexedFilter_=new Ed(e.getIndex()),this.index_=e.getIndex(),this.startPost_=wo.getStartPost_(e),this.endPost_=wo.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,o,i){return this.matches(new B(n,r))||(r=I.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,o,i)}updateFullNode(e,n,r){n.isLeafNode()&&(n=I.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(I.EMPTY_NODE);const o=this;return n.forEachChild(re,(i,l)=>{o.matches(new B(i,l))||(s=s.updateImmediateChild(i,I.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new wo(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,o,i){return this.rangedFilter_.matches(new B(n,r))||(r=I.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,o,i):this.fullLimitUpdateChild_(e,n,r,o,i)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=I.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=I.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let i=0;for(;o.hasNext()&&i<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),i++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(I.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let i=0;for(;o.hasNext();){const l=o.getNext();i<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?i++:s=s.updateImmediateChild(l.name,I.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,o){let i;if(this.reverse_){const c=this.index_.getCompare();i=(d,m)=>c(m,d)}else i=this.index_.getCompare();const l=e;T(l.numChildren()===this.limit_,"");const a=new B(n,r),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),f=this.rangedFilter_.matches(a);if(l.hasChild(n)){const c=l.getImmediateChild(n);let d=s.getChildAfterChild(this.index_,u,this.reverse_);for(;d!=null&&(d.name===n||l.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);const m=d==null?1:i(d,a);if(f&&!r.isEmpty()&&m>=0)return o!=null&&o.trackChildChange(Eo(n,r,c)),l.updateImmediateChild(n,r);{o!=null&&o.trackChildChange(vo(n,c));const y=l.updateImmediateChild(n,I.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(o!=null&&o.trackChildChange(ss(d.name,d.node)),y.updateImmediateChild(d.name,d.node)):y}}else return r.isEmpty()?e:f&&i(u,a)>=0?(o!=null&&(o.trackChildChange(vo(u.name,u.node)),o.trackChildChange(ss(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(u.name,I.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=re}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return T(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return T(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Un}hasEnd(){return this.endSet_}getIndexEndValue(){return T(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return T(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:cn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return T(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===re}copy(){const e=new Ll;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function iP(t){return t.loadsAllData()?new Ed(t.getIndex()):t.hasLimit()?new oP(t):new wo(t)}function lP(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function aP(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Bu(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function uP(t,e,n){let r;return t.index_===jt||n?r=Bu(t,e,n):r=Bu(t,e,cn),r.startAfterSet_=!0,r}function Wu(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function cP(t,e,n){let r;return t.index_===jt||n?r=Wu(t,e,n):r=Wu(t,e,Un),r.endBeforeSet_=!0,r}function $l(t,e){const n=t.copy();return n.index_=e,n}function Wh(t){const e={};if(t.isDefault())return e;let n;if(t.index_===re?n="$priority":t.index_===vd?n="$value":t.index_===jt?n="$key":(T(t.index_ instanceof _d,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ve(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=ve(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+ve(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=ve(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+ve(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function jh(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==re&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl extends Sy{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(T(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Ro("p:rest:"),this.listens_={}}listen(e,n,r,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const i=nl.getListenId_(e,r),l={};this.listens_[i]=l;const a=Wh(e._queryParams);this.restRequest_(o+".json",a,(u,f)=>{let c=f;if(u===404&&(c=null,u=null),u===null&&this.onDataUpdate_(o,c,!1,r),hr(this.listens_,i)===l){let d;u?u===401?d="permission_denied":d="rest_error:"+u:d="ok",s(d,null)}})}unlisten(e,n){const r=nl.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Wh(e._queryParams),r=e._path.toString(),s=new Qe;return this.restRequest_(r+".json",n,(o,i)=>{let l=i;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(r,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(n.auth=s.accessToken),o&&o.token&&(n.ac=o.token);const i=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+TE(n);this.log_("Sending REST request for "+i);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+i+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=mo(l.responseText)}catch{Ue("Failed to parse JSON response for "+i+": "+l.responseText)}r(null,a)}else l.status!==401&&l.status!==404&&Ue("Got unsuccessful REST response for "+i+" Status: "+l.status),r(l.status);r=null}},l.open("GET",i,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(){this.rootNode_=I.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rl(){return{value:null,children:new Map}}function ps(t,e,n){if(V(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=G(e);t.children.has(r)||t.children.set(r,rl());const s=t.children.get(r);e=Z(e),ps(s,e,n)}}function ju(t,e){if(V(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(re,(r,s)=>{ps(t,new Y(r),s)}),ju(t,e)}}else if(t.children.size>0){const n=G(e);return e=Z(e),t.children.has(n)&&ju(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function zu(t,e,n){t.value!==null?n(e,t.value):fP(t,(r,s)=>{const o=new Y(e.toString()+"/"+r);zu(s,o,n)})}function fP(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&be(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=10*1e3,pP=30*1e3,mP=5*60*1e3;class gP{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new hP(e);const r=zh+(pP-zh)*Math.random();Hs(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;be(e,(s,o)=>{o>0&&at(this.statsToReport_,s)&&(n[s]=o,r=!0)}),r&&this.server_.reportStats(n),Hs(this.reportStats_.bind(this),Math.floor(Math.random()*2*mP))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Nt||(Nt={}));function wd(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Sd(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Pd(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Nt.ACK_USER_WRITE,this.source=wd()}operationForChild(e){if(V(this.path)){if(this.affectedTree.value!=null)return T(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Y(e));return new sl(H(),n,this.revert)}}else return T(G(this.path)===e,"operationForChild called for unrelated child."),new sl(Z(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,n){this.source=e,this.path=n,this.type=Nt.LISTEN_COMPLETE}operationForChild(e){return V(this.path)?new So(this.source,H()):new So(this.source,Z(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Nt.OVERWRITE}operationForChild(e){return V(this.path)?new pr(this.source,H(),this.snap.getImmediateChild(e)):new pr(this.source,Z(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Nt.MERGE}operationForChild(e){if(V(this.path)){const n=this.children.subtree(new Y(e));return n.isEmpty()?null:n.value?new pr(this.source,H(),n.value):new os(this.source,H(),n)}else return T(G(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new os(this.source,Z(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(V(e))return this.isFullyInitialized()&&!this.filtered_;const n=G(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function _P(t,e,n,r){const s=[],o=[];return e.forEach(i=>{i.type==="child_changed"&&t.index_.indexedValueChanged(i.oldSnap,i.snapshotNode)&&o.push(sP(i.childName,i.snapshotNode))}),xs(t,s,"child_removed",e,r,n),xs(t,s,"child_added",e,r,n),xs(t,s,"child_moved",o,r,n),xs(t,s,"child_changed",e,r,n),xs(t,s,"value",e,r,n),s}function xs(t,e,n,r,s,o){const i=r.filter(l=>l.type===n);i.sort((l,a)=>EP(t,l,a)),i.forEach(l=>{const a=vP(t,l,o);s.forEach(u=>{u.respondsTo(l.type)&&e.push(u.createEvent(a,t.query_))})})}function vP(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function EP(t,e,n){if(e.childName==null||n.childName==null)throw ds("Should only compare child_ events.");const r=new B(e.childName,e.snapshotNode),s=new B(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(t,e){return{eventCache:t,serverCache:e}}function Ys(t,e,n,r){return Ul(new Fn(e,n,r),t.serverCache)}function Ny(t,e,n,r){return Ul(t.eventCache,new Fn(e,n,r))}function ol(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function mr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $a;const wP=()=>($a||($a=new qe(rS)),$a);class te{static fromObject(e){let n=new te(null);return be(e,(r,s)=>{n=n.set(new Y(r),s)}),n}constructor(e,n=wP()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:H(),value:this.value};if(V(e))return null;{const r=G(e),s=this.children.get(r);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Z(e),n);return o!=null?{path:le(new Y(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(V(e))return this;{const n=G(e),r=this.children.get(n);return r!==null?r.subtree(Z(e)):new te(null)}}set(e,n){if(V(e))return new te(n,this.children);{const r=G(e),o=(this.children.get(r)||new te(null)).set(Z(e),n),i=this.children.insert(r,o);return new te(this.value,i)}}remove(e){if(V(e))return this.children.isEmpty()?new te(null):new te(null,this.children);{const n=G(e),r=this.children.get(n);if(r){const s=r.remove(Z(e));let o;return s.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,s),this.value===null&&o.isEmpty()?new te(null):new te(this.value,o)}else return this}}get(e){if(V(e))return this.value;{const n=G(e),r=this.children.get(n);return r?r.get(Z(e)):null}}setTree(e,n){if(V(e))return n;{const r=G(e),o=(this.children.get(r)||new te(null)).setTree(Z(e),n);let i;return o.isEmpty()?i=this.children.remove(r):i=this.children.insert(r,o),new te(this.value,i)}}fold(e){return this.fold_(H(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,o)=>{r[s]=o.fold_(le(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,H(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(V(e))return null;{const o=G(e),i=this.children.get(o);return i?i.findOnPath_(Z(e),le(n,o),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,H(),n)}foreachOnPath_(e,n,r){if(V(e))return this;{this.value&&r(n,this.value);const s=G(e),o=this.children.get(s);return o?o.foreachOnPath_(Z(e),le(n,s),r):new te(null)}}foreach(e){this.foreach_(H(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(le(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.writeTree_=e}static empty(){return new Lt(new te(null))}}function Qs(t,e,n){if(V(e))return new Lt(new te(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let o=r.value;const i=Be(s,e);return o=o.updateChild(i,n),new Lt(t.writeTree_.set(s,o))}else{const s=new te(n),o=t.writeTree_.setTree(e,s);return new Lt(o)}}}function Hu(t,e,n){let r=t;return be(n,(s,o)=>{r=Qs(r,le(e,s),o)}),r}function Hh(t,e){if(V(e))return Lt.empty();{const n=t.writeTree_.setTree(e,new te(null));return new Lt(n)}}function Yu(t,e){return Er(t,e)!=null}function Er(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Be(n.path,e)):null}function Yh(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(re,(r,s)=>{e.push(new B(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new B(r,s.value))}),e}function xn(t,e){if(V(e))return t;{const n=Er(t,e);return n!=null?new Lt(new te(n)):new Lt(t.writeTree_.subtree(e))}}function Qu(t){return t.writeTree_.isEmpty()}function is(t,e){return Ry(H(),t.writeTree_,e)}function Ry(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(T(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):n=Ry(le(t,s),o,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(le(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(t,e){return Uy(e,t)}function SP(t,e,n,r,s){T(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Qs(t.visibleWrites,e,n)),t.lastWriteId=r}function PP(t,e,n,r){T(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Hu(t.visibleWrites,e,n),t.lastWriteId=r}function CP(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function kP(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);T(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,o=!1,i=t.allWrites.length-1;for(;s&&i>=0;){const l=t.allWrites[i];l.visible&&(i>=n&&TP(l,r.path)?s=!1:_t(r.path,l.path)&&(o=!0)),i--}if(s){if(o)return bP(t),!0;if(r.snap)t.visibleWrites=Hh(t.visibleWrites,r.path);else{const l=r.children;be(l,a=>{t.visibleWrites=Hh(t.visibleWrites,le(r.path,a))})}return!0}else return!1}function TP(t,e){if(t.snap)return _t(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&_t(le(t.path,n),e))return!0;return!1}function bP(t){t.visibleWrites=Iy(t.allWrites,AP,H()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function AP(t){return t.visible}function Iy(t,e,n){let r=Lt.empty();for(let s=0;s<t.length;++s){const o=t[s];if(e(o)){const i=o.path;let l;if(o.snap)_t(n,i)?(l=Be(n,i),r=Qs(r,l,o.snap)):_t(i,n)&&(l=Be(i,n),r=Qs(r,H(),o.snap.getChild(l)));else if(o.children){if(_t(n,i))l=Be(n,i),r=Hu(r,l,o.children);else if(_t(i,n))if(l=Be(i,n),V(l))r=Hu(r,H(),o.children);else{const a=hr(o.children,G(l));if(a){const u=a.getChild(Z(l));r=Qs(r,H(),u)}}}else throw ds("WriteRecord should have .snap or .children")}}return r}function Ly(t,e,n,r,s){if(!r&&!s){const o=Er(t.visibleWrites,e);if(o!=null)return o;{const i=xn(t.visibleWrites,e);if(Qu(i))return n;if(n==null&&!Yu(i,H()))return null;{const l=n||I.EMPTY_NODE;return is(i,l)}}}else{const o=xn(t.visibleWrites,e);if(!s&&Qu(o))return n;if(!s&&n==null&&!Yu(o,H()))return null;{const i=function(u){return(u.visible||s)&&(!r||!~r.indexOf(u.writeId))&&(_t(u.path,e)||_t(e,u.path))},l=Iy(t.allWrites,i,e),a=n||I.EMPTY_NODE;return is(l,a)}}}function DP(t,e,n){let r=I.EMPTY_NODE;const s=Er(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(re,(o,i)=>{r=r.updateImmediateChild(o,i)}),r;if(n){const o=xn(t.visibleWrites,e);return n.forEachChild(re,(i,l)=>{const a=is(xn(o,new Y(i)),l);r=r.updateImmediateChild(i,a)}),Yh(o).forEach(i=>{r=r.updateImmediateChild(i.name,i.node)}),r}else{const o=xn(t.visibleWrites,e);return Yh(o).forEach(i=>{r=r.updateImmediateChild(i.name,i.node)}),r}}function xP(t,e,n,r,s){T(r||s,"Either existingEventSnap or existingServerSnap must exist");const o=le(e,n);if(Yu(t.visibleWrites,o))return null;{const i=xn(t.visibleWrites,o);return Qu(i)?s.getChild(n):is(i,s.getChild(n))}}function OP(t,e,n,r){const s=le(e,n),o=Er(t.visibleWrites,s);if(o!=null)return o;if(r.isCompleteForChild(n)){const i=xn(t.visibleWrites,s);return is(i,r.getNode().getImmediateChild(n))}else return null}function NP(t,e){return Er(t.visibleWrites,e)}function RP(t,e,n,r,s,o,i){let l;const a=xn(t.visibleWrites,e),u=Er(a,H());if(u!=null)l=u;else if(n!=null)l=is(a,n);else return[];if(l=l.withIndex(i),!l.isEmpty()&&!l.isLeafNode()){const f=[],c=i.getCompare(),d=o?l.getReverseIteratorFrom(r,i):l.getIteratorFrom(r,i);let m=d.getNext();for(;m&&f.length<s;)c(m,r)!==0&&f.push(m),m=d.getNext();return f}else return[]}function IP(){return{visibleWrites:Lt.empty(),allWrites:[],lastWriteId:-1}}function il(t,e,n,r){return Ly(t.writeTree,t.treePath,e,n,r)}function Cd(t,e){return DP(t.writeTree,t.treePath,e)}function Qh(t,e,n,r){return xP(t.writeTree,t.treePath,e,n,r)}function ll(t,e){return NP(t.writeTree,le(t.treePath,e))}function LP(t,e,n,r,s,o){return RP(t.writeTree,t.treePath,e,n,r,s,o)}function kd(t,e,n){return OP(t.writeTree,t.treePath,e,n)}function $y(t,e){return Uy(le(t.treePath,e),t.writeTree)}function Uy(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;T(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),T(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const o=s.type;if(n==="child_added"&&o==="child_removed")this.changeMap.set(r,Eo(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&o==="child_changed")this.changeMap.set(r,vo(r,s.oldSnap));else if(n==="child_changed"&&o==="child_added")this.changeMap.set(r,ss(r,e.snapshotNode));else if(n==="child_changed"&&o==="child_changed")this.changeMap.set(r,Eo(r,e.snapshotNode,s.oldSnap));else throw ds("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const My=new UP;class Td{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Fn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return kd(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:mr(this.viewCache_),o=LP(this.writes_,s,n,1,r,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MP(t){return{filter:t}}function FP(t,e){T(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),T(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function GP(t,e,n,r,s){const o=new $P;let i,l;if(n.type===Nt.OVERWRITE){const u=n;u.source.fromUser?i=Ku(t,e,u.path,u.snap,r,s,o):(T(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered()&&!V(u.path),i=al(t,e,u.path,u.snap,r,s,l,o))}else if(n.type===Nt.MERGE){const u=n;u.source.fromUser?i=BP(t,e,u.path,u.children,r,s,o):(T(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered(),i=qu(t,e,u.path,u.children,r,s,l,o))}else if(n.type===Nt.ACK_USER_WRITE){const u=n;u.revert?i=zP(t,e,u.path,r,s,o):i=WP(t,e,u.path,u.affectedTree,r,s,o)}else if(n.type===Nt.LISTEN_COMPLETE)i=jP(t,e,n.path,r,o);else throw ds("Unknown operation type: "+n.type);const a=o.getChanges();return VP(e,i,a),{viewCache:i,changes:a}}function VP(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=ol(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Oy(ol(e)))}}function Fy(t,e,n,r,s,o){const i=e.eventCache;if(ll(r,n)!=null)return e;{let l,a;if(V(n))if(T(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=mr(e),f=u instanceof I?u:I.EMPTY_NODE,c=Cd(r,f);l=t.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const u=il(r,mr(e));l=t.filter.updateFullNode(e.eventCache.getNode(),u,o)}else{const u=G(n);if(u===".priority"){T(Mn(n)===1,"Can't have a priority with additional path components");const f=i.getNode();a=e.serverCache.getNode();const c=Qh(r,n,f,a);c!=null?l=t.filter.updatePriority(f,c):l=i.getNode()}else{const f=Z(n);let c;if(i.isCompleteForChild(u)){a=e.serverCache.getNode();const d=Qh(r,n,i.getNode(),a);d!=null?c=i.getNode().getImmediateChild(u).updateChild(f,d):c=i.getNode().getImmediateChild(u)}else c=kd(r,u,e.serverCache);c!=null?l=t.filter.updateChild(i.getNode(),u,c,f,s,o):l=i.getNode()}}return Ys(e,l,i.isFullyInitialized()||V(n),t.filter.filtersNodes())}}function al(t,e,n,r,s,o,i,l){const a=e.serverCache;let u;const f=i?t.filter:t.filter.getIndexedFilter();if(V(n))u=f.updateFullNode(a.getNode(),r,null);else if(f.filtersNodes()&&!a.isFiltered()){const m=a.getNode().updateChild(n,r);u=f.updateFullNode(a.getNode(),m,null)}else{const m=G(n);if(!a.isCompleteForPath(n)&&Mn(n)>1)return e;const h=Z(n),S=a.getNode().getImmediateChild(m).updateChild(h,r);m===".priority"?u=f.updatePriority(a.getNode(),S):u=f.updateChild(a.getNode(),m,S,h,My,null)}const c=Ny(e,u,a.isFullyInitialized()||V(n),f.filtersNodes()),d=new Td(s,c,o);return Fy(t,c,n,s,d,l)}function Ku(t,e,n,r,s,o,i){const l=e.eventCache;let a,u;const f=new Td(s,e,o);if(V(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,i),a=Ys(e,u,!0,t.filter.filtersNodes());else{const c=G(n);if(c===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),a=Ys(e,u,l.isFullyInitialized(),l.isFiltered());else{const d=Z(n),m=l.getNode().getImmediateChild(c);let h;if(V(d))h=r;else{const y=f.getCompleteChild(c);y!=null?pd(d)===".priority"&&y.getChild(Cy(d)).isEmpty()?h=y:h=y.updateChild(d,r):h=I.EMPTY_NODE}if(m.equals(h))a=e;else{const y=t.filter.updateChild(l.getNode(),c,h,d,f,i);a=Ys(e,y,l.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function Kh(t,e){return t.eventCache.isCompleteForChild(e)}function BP(t,e,n,r,s,o,i){let l=e;return r.foreach((a,u)=>{const f=le(n,a);Kh(e,G(f))&&(l=Ku(t,l,f,u,s,o,i))}),r.foreach((a,u)=>{const f=le(n,a);Kh(e,G(f))||(l=Ku(t,l,f,u,s,o,i))}),l}function qh(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function qu(t,e,n,r,s,o,i,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,u;V(n)?u=r:u=new te(null).setTree(n,r);const f=e.serverCache.getNode();return u.children.inorderTraversal((c,d)=>{if(f.hasChild(c)){const m=e.serverCache.getNode().getImmediateChild(c),h=qh(t,m,d);a=al(t,a,new Y(c),h,s,o,i,l)}}),u.children.inorderTraversal((c,d)=>{const m=!e.serverCache.isCompleteForChild(c)&&d.value===null;if(!f.hasChild(c)&&!m){const h=e.serverCache.getNode().getImmediateChild(c),y=qh(t,h,d);a=al(t,a,new Y(c),y,s,o,i,l)}}),a}function WP(t,e,n,r,s,o,i){if(ll(s,n)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(r.value!=null){if(V(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return al(t,e,n,a.getNode().getChild(n),s,o,l,i);if(V(n)){let u=new te(null);return a.getNode().forEachChild(jt,(f,c)=>{u=u.set(new Y(f),c)}),qu(t,e,n,u,s,o,l,i)}else return e}else{let u=new te(null);return r.foreach((f,c)=>{const d=le(n,f);a.isCompleteForPath(d)&&(u=u.set(f,a.getNode().getChild(d)))}),qu(t,e,n,u,s,o,l,i)}}function jP(t,e,n,r,s){const o=e.serverCache,i=Ny(e,o.getNode(),o.isFullyInitialized()||V(n),o.isFiltered());return Fy(t,i,n,r,My,s)}function zP(t,e,n,r,s,o){let i;if(ll(r,n)!=null)return e;{const l=new Td(r,e,s),a=e.eventCache.getNode();let u;if(V(n)||G(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=il(r,mr(e));else{const c=e.serverCache.getNode();T(c instanceof I,"serverChildren would be complete if leaf node"),f=Cd(r,c)}f=f,u=t.filter.updateFullNode(a,f,o)}else{const f=G(n);let c=kd(r,f,e.serverCache);c==null&&e.serverCache.isCompleteForChild(f)&&(c=a.getImmediateChild(f)),c!=null?u=t.filter.updateChild(a,f,c,Z(n),l,o):e.eventCache.getNode().hasChild(f)?u=t.filter.updateChild(a,f,I.EMPTY_NODE,Z(n),l,o):u=a,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(i=il(r,mr(e)),i.isLeafNode()&&(u=t.filter.updateFullNode(u,i,o)))}return i=e.serverCache.isFullyInitialized()||ll(r,H())!=null,Ys(e,u,i,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Ed(r.getIndex()),o=iP(r);this.processor_=MP(o);const i=n.serverCache,l=n.eventCache,a=s.updateFullNode(I.EMPTY_NODE,i.getNode(),null),u=o.updateFullNode(I.EMPTY_NODE,l.getNode(),null),f=new Fn(a,i.isFullyInitialized(),s.filtersNodes()),c=new Fn(u,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ul(c,f),this.eventGenerator_=new yP(this.query_)}get query(){return this.query_}}function YP(t){return t.viewCache_.serverCache.getNode()}function QP(t){return ol(t.viewCache_)}function KP(t,e){const n=mr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!V(e)&&!n.getImmediateChild(G(e)).isEmpty())?n.getChild(e):null}function Xh(t){return t.eventRegistrations_.length===0}function qP(t,e){t.eventRegistrations_.push(e)}function Jh(t,e,n){const r=[];if(n){T(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(o=>{const i=o.createCancelEvent(n,s);i&&r.push(i)})}if(e){let s=[];for(let o=0;o<t.eventRegistrations_.length;++o){const i=t.eventRegistrations_[o];if(!i.matches(e))s.push(i);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(o+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function Zh(t,e,n,r){e.type===Nt.MERGE&&e.source.queryId!==null&&(T(mr(t.viewCache_),"We should always have a full cache before handling merges"),T(ol(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,o=GP(t.processor_,s,e,n,r);return FP(t.processor_,o.viewCache),T(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,Gy(t,o.changes,o.viewCache.eventCache.getNode(),null)}function XP(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(re,(o,i)=>{r.push(ss(o,i))}),n.isFullyInitialized()&&r.push(Oy(n.getNode())),Gy(t,r,n.getNode(),e)}function Gy(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return _P(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ul;class Vy{constructor(){this.views=new Map}}function JP(t){T(!ul,"__referenceConstructor has already been defined"),ul=t}function ZP(){return T(ul,"Reference.ts has not been loaded"),ul}function e1(t){return t.views.size===0}function bd(t,e,n,r){const s=e.source.queryId;if(s!==null){const o=t.views.get(s);return T(o!=null,"SyncTree gave us an op for an invalid query."),Zh(o,e,n,r)}else{let o=[];for(const i of t.views.values())o=o.concat(Zh(i,e,n,r));return o}}function By(t,e,n,r,s){const o=e._queryIdentifier,i=t.views.get(o);if(!i){let l=il(n,s?r:null),a=!1;l?a=!0:r instanceof I?(l=Cd(n,r),a=!1):(l=I.EMPTY_NODE,a=!1);const u=Ul(new Fn(l,a,!1),new Fn(r,s,!1));return new HP(e,u)}return i}function t1(t,e,n,r,s,o){const i=By(t,e,r,s,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,i),qP(i,n),XP(i,n)}function n1(t,e,n,r){const s=e._queryIdentifier,o=[];let i=[];const l=Gn(t);if(s==="default")for(const[a,u]of t.views.entries())i=i.concat(Jh(u,n,r)),Xh(u)&&(t.views.delete(a),u.query._queryParams.loadsAllData()||o.push(u.query));else{const a=t.views.get(s);a&&(i=i.concat(Jh(a,n,r)),Xh(a)&&(t.views.delete(s),a.query._queryParams.loadsAllData()||o.push(a.query)))}return l&&!Gn(t)&&o.push(new(ZP())(e._repo,e._path)),{removed:o,events:i}}function Wy(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function On(t,e){let n=null;for(const r of t.views.values())n=n||KP(r,e);return n}function jy(t,e){if(e._queryParams.loadsAllData())return Fl(t);{const r=e._queryIdentifier;return t.views.get(r)}}function zy(t,e){return jy(t,e)!=null}function Gn(t){return Fl(t)!=null}function Fl(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cl;function r1(t){T(!cl,"__referenceConstructor has already been defined"),cl=t}function s1(){return T(cl,"Reference.ts has not been loaded"),cl}let o1=1;class ep{constructor(e){this.listenProvider_=e,this.syncPointTree_=new te(null),this.pendingWriteTree_=IP(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ad(t,e,n,r,s){return SP(t.pendingWriteTree_,e,n,r,s),s?ms(t,new pr(wd(),e,n)):[]}function i1(t,e,n,r){PP(t.pendingWriteTree_,e,n,r);const s=te.fromObject(n);return ms(t,new os(wd(),e,s))}function En(t,e,n=!1){const r=CP(t.pendingWriteTree_,e);if(kP(t.pendingWriteTree_,e)){let o=new te(null);return r.snap!=null?o=o.set(H(),!0):be(r.children,i=>{o=o.set(new Y(i),!0)}),ms(t,new sl(r.path,o,n))}else return[]}function Lo(t,e,n){return ms(t,new pr(Sd(),e,n))}function l1(t,e,n){const r=te.fromObject(n);return ms(t,new os(Sd(),e,r))}function a1(t,e){return ms(t,new So(Sd(),e))}function u1(t,e,n){const r=Dd(t,n);if(r){const s=xd(r),o=s.path,i=s.queryId,l=Be(o,e),a=new So(Pd(i),l);return Od(t,o,a)}else return[]}function dl(t,e,n,r,s=!1){const o=e._path,i=t.syncPointTree_.get(o);let l=[];if(i&&(e._queryIdentifier==="default"||zy(i,e))){const a=n1(i,e,n,r);e1(i)&&(t.syncPointTree_=t.syncPointTree_.remove(o));const u=a.removed;if(l=a.events,!s){const f=u.findIndex(d=>d._queryParams.loadsAllData())!==-1,c=t.syncPointTree_.findOnPath(o,(d,m)=>Gn(m));if(f&&!c){const d=t.syncPointTree_.subtree(o);if(!d.isEmpty()){const m=f1(d);for(let h=0;h<m.length;++h){const y=m[h],S=y.query,g=Ky(t,y);t.listenProvider_.startListening(Ks(S),Po(t,S),g.hashFn,g.onComplete)}}}!c&&u.length>0&&!r&&(f?t.listenProvider_.stopListening(Ks(e),null):u.forEach(d=>{const m=t.queryToTagMap.get(Vl(d));t.listenProvider_.stopListening(Ks(d),m)}))}h1(t,u)}return l}function Hy(t,e,n,r){const s=Dd(t,r);if(s!=null){const o=xd(s),i=o.path,l=o.queryId,a=Be(i,e),u=new pr(Pd(l),a,n);return Od(t,i,u)}else return[]}function c1(t,e,n,r){const s=Dd(t,r);if(s){const o=xd(s),i=o.path,l=o.queryId,a=Be(i,e),u=te.fromObject(n),f=new os(Pd(l),a,u);return Od(t,i,f)}else return[]}function Xu(t,e,n,r=!1){const s=e._path;let o=null,i=!1;t.syncPointTree_.foreachOnPath(s,(d,m)=>{const h=Be(d,s);o=o||On(m,h),i=i||Gn(m)});let l=t.syncPointTree_.get(s);l?(i=i||Gn(l),o=o||On(l,H())):(l=new Vy,t.syncPointTree_=t.syncPointTree_.set(s,l));let a;o!=null?a=!0:(a=!1,o=I.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((m,h)=>{const y=On(h,H());y&&(o=o.updateImmediateChild(m,y))}));const u=zy(l,e);if(!u&&!e._queryParams.loadsAllData()){const d=Vl(e);T(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const m=p1();t.queryToTagMap.set(d,m),t.tagToQueryMap.set(m,d)}const f=Ml(t.pendingWriteTree_,s);let c=t1(l,e,n,f,o,a);if(!u&&!i&&!r){const d=jy(l,e);c=c.concat(m1(t,e,d))}return c}function Gl(t,e,n){const s=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(e,(i,l)=>{const a=Be(i,e),u=On(l,a);if(u)return u});return Ly(s,e,o,n,!0)}function d1(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,f)=>{const c=Be(u,n);r=r||On(f,c)});let s=t.syncPointTree_.get(n);s?r=r||On(s,H()):(s=new Vy,t.syncPointTree_=t.syncPointTree_.set(n,s));const o=r!=null,i=o?new Fn(r,!0,!1):null,l=Ml(t.pendingWriteTree_,e._path),a=By(s,e,l,o?i.getNode():I.EMPTY_NODE,o);return QP(a)}function ms(t,e){return Yy(e,t.syncPointTree_,null,Ml(t.pendingWriteTree_,H()))}function Yy(t,e,n,r){if(V(t.path))return Qy(t,e,n,r);{const s=e.get(H());n==null&&s!=null&&(n=On(s,H()));let o=[];const i=G(t.path),l=t.operationForChild(i),a=e.children.get(i);if(a&&l){const u=n?n.getImmediateChild(i):null,f=$y(r,i);o=o.concat(Yy(l,a,u,f))}return s&&(o=o.concat(bd(s,t,r,n))),o}}function Qy(t,e,n,r){const s=e.get(H());n==null&&s!=null&&(n=On(s,H()));let o=[];return e.children.inorderTraversal((i,l)=>{const a=n?n.getImmediateChild(i):null,u=$y(r,i),f=t.operationForChild(i);f&&(o=o.concat(Qy(f,l,a,u)))}),s&&(o=o.concat(bd(s,t,r,n))),o}function Ky(t,e){const n=e.query,r=Po(t,n);return{hashFn:()=>(YP(e)||I.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?u1(t,n._path,r):a1(t,n._path);{const o=iS(s,n);return dl(t,n,null,o)}}}}function Po(t,e){const n=Vl(e);return t.queryToTagMap.get(n)}function Vl(t){return t._path.toString()+"$"+t._queryIdentifier}function Dd(t,e){return t.tagToQueryMap.get(e)}function xd(t){const e=t.indexOf("$");return T(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Y(t.substr(0,e))}}function Od(t,e,n){const r=t.syncPointTree_.get(e);T(r,"Missing sync point for query tag that we're tracking");const s=Ml(t.pendingWriteTree_,e);return bd(r,n,s,null)}function f1(t){return t.fold((e,n,r)=>{if(n&&Gn(n))return[Fl(n)];{let s=[];return n&&(s=Wy(n)),be(r,(o,i)=>{s=s.concat(i)}),s}})}function Ks(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(s1())(t._repo,t._path):t}function h1(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=Vl(r),o=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(o)}}}function p1(){return o1++}function m1(t,e,n){const r=e._path,s=Po(t,e),o=Ky(t,n),i=t.listenProvider_.startListening(Ks(e),s,o.hashFn,o.onComplete),l=t.syncPointTree_.subtree(r);if(s)T(!Gn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((u,f,c)=>{if(!V(u)&&f&&Gn(f))return[Fl(f).query];{let d=[];return f&&(d=d.concat(Wy(f).map(m=>m.query))),be(c,(m,h)=>{d=d.concat(h)}),d}});for(let u=0;u<a.length;++u){const f=a[u];t.listenProvider_.stopListening(Ks(f),Po(t,f))}}return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Nd(n)}node(){return this.node_}}class Rd{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=le(this.path_,e);return new Rd(this.syncTree_,n)}node(){return Gl(this.syncTree_,this.path_)}}const g1=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},tp=function(t,e,n){if(!t||typeof t!="object")return t;if(T(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return y1(t[".sv"],e,n);if(typeof t[".sv"]=="object")return _1(t[".sv"],e);T(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},y1=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:T(!1,"Unexpected server value: "+t)}},_1=function(t,e,n){t.hasOwnProperty("increment")||T(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&T(!1,"Unexpected increment value: "+r);const s=e.node();if(T(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const i=s.getValue();return typeof i!="number"?r:i+r},qy=function(t,e,n,r){return Ld(e,new Rd(n,t),r)},Id=function(t,e,n){return Ld(t,new Nd(e),n)};function Ld(t,e,n){const r=t.getPriority().val(),s=tp(r,e.getImmediateChild(".priority"),n);let o;if(t.isLeafNode()){const i=t,l=tp(i.getValue(),e,n);return l!==i.getValue()||s!==i.getPriority().val()?new we(l,ue(s)):t}else{const i=t;return o=i,s!==i.getPriority().val()&&(o=o.updatePriority(new we(s))),i.forEachChild(re,(l,a)=>{const u=Ld(a,e.getImmediateChild(l),n);u!==a&&(o=o.updateImmediateChild(l,u))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Bl(t,e){let n=e instanceof Y?e:new Y(e),r=t,s=G(n);for(;s!==null;){const o=hr(r.node.children,s)||{children:{},childCount:0};r=new $d(s,r,o),n=Z(n),s=G(n)}return r}function wr(t){return t.node.value}function Ud(t,e){t.node.value=e,Ju(t)}function Xy(t){return t.node.childCount>0}function v1(t){return wr(t)===void 0&&!Xy(t)}function Wl(t,e){be(t.node.children,(n,r)=>{e(new $d(n,t,r))})}function Jy(t,e,n,r){n&&e(t),Wl(t,s=>{Jy(s,e,!0)})}function E1(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function $o(t){return new Y(t.parent===null?t.name:$o(t.parent)+"/"+t.name)}function Ju(t){t.parent!==null&&w1(t.parent,t.name,t)}function w1(t,e,n){const r=v1(n),s=at(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,Ju(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,Ju(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1=/[\[\].#$\/\u0000-\u001F\u007F]/,P1=/[\[\].#$\u0000-\u001F\u007F]/,Ua=10*1024*1024,jl=function(t){return typeof t=="string"&&t.length!==0&&!S1.test(t)},Zy=function(t){return typeof t=="string"&&t.length!==0&&!P1.test(t)},C1=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Zy(t)},Co=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Rl(t)||t&&typeof t=="object"&&at(t,".sv")},Ht=function(t,e,n,r){r&&e===void 0||Uo(et(t,"value"),e,n)},Uo=function(t,e,n){const r=n instanceof Y?new GS(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Zn(r));if(typeof e=="function")throw new Error(t+"contains a function "+Zn(r)+" with contents = "+e.toString());if(Rl(e))throw new Error(t+"contains "+e.toString()+" "+Zn(r));if(typeof e=="string"&&e.length>Ua/3&&Ol(e)>Ua)throw new Error(t+"contains a string greater than "+Ua+" utf8 bytes "+Zn(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(be(e,(i,l)=>{if(i===".value")s=!0;else if(i!==".priority"&&i!==".sv"&&(o=!0,!jl(i)))throw new Error(t+" contains an invalid key ("+i+") "+Zn(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);VS(r,i),Uo(t,l,r),BS(r)}),s&&o)throw new Error(t+' contains ".value" child '+Zn(r)+" in addition to actual children.")}},k1=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const o=_o(r);for(let i=0;i<o.length;i++)if(!(o[i]===".priority"&&i===o.length-1)){if(!jl(o[i]))throw new Error(t+"contains an invalid key ("+o[i]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(FS);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&_t(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},e_=function(t,e,n,r){const s=et(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];be(e,(i,l)=>{const a=new Y(i);if(Uo(s,l,le(n,a)),pd(a)===".priority"&&!Co(l))throw new Error(s+"contains an invalid value for '"+a.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(a)}),k1(s,o)},Md=function(t,e,n){if(Rl(e))throw new Error(et(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Co(e))throw new Error(et(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Mo=function(t,e,n,r){if(n!==void 0&&!jl(n))throw new Error(et(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},ko=function(t,e,n,r){if(!Zy(n))throw new Error(et(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},T1=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ko(t,e,n)},vt=function(t,e){if(G(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},t_=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!jl(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!C1(n))throw new Error(et(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function zl(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],o=s.getPath();n!==null&&!md(o,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:o}),n.events.push(s)}n&&t.eventLists_.push(n)}function n_(t,e,n){zl(t,n),r_(t,r=>md(r,e))}function ut(t,e,n){zl(t,n),r_(t,r=>_t(r,e)||_t(e,r))}function r_(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const o=s.path;e(o)?(A1(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function A1(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();ir&&ke("event: "+n.toString()),hs(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_="repo_interrupt",D1=25;class x1{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new b1,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=rl(),this.transactionQueueTree_=new $d,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function O1(t,e,n){if(t.stats_=fd(t.repoInfo_),t.forceRestClient_||cS())t.server_=new nl(t.repoInfo_,(r,s,o,i)=>{np(t,r,s,o,i)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>rp(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ve(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new nn(t.repoInfo_,e,(r,s,o,i)=>{np(t,r,s,o,i)},r=>{rp(t,r)},r=>{N1(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=mS(t.repoInfo_,()=>new gP(t.stats_,t.server_)),t.infoData_=new dP,t.infoSyncTree_=new ep({startListening:(r,s,o,i)=>{let l=[];const a=t.infoData_.getNode(r._path);return a.isEmpty()||(l=Lo(t.infoSyncTree_,r._path,a),setTimeout(()=>{i("ok")},0)),l},stopListening:()=>{}}),Fd(t,"connected",!1),t.serverSyncTree_=new ep({startListening:(r,s,o,i)=>(t.server_.listen(r,o,s,(l,a)=>{const u=i(l,a);ut(t.eventQueue_,r._path,u)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function o_(t){const n=t.infoData_.getNode(new Y(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Fo(t){return g1({timestamp:o_(t)})}function np(t,e,n,r,s){t.dataUpdateCount++;const o=new Y(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let i=[];if(s)if(r){const a=qi(n,u=>ue(u));i=c1(t.serverSyncTree_,o,a,s)}else{const a=ue(n);i=Hy(t.serverSyncTree_,o,a,s)}else if(r){const a=qi(n,u=>ue(u));i=l1(t.serverSyncTree_,o,a)}else{const a=ue(n);i=Lo(t.serverSyncTree_,o,a)}let l=o;i.length>0&&(l=ls(t,o)),ut(t.eventQueue_,l,i)}function rp(t,e){Fd(t,"connected",e),e===!1&&L1(t)}function N1(t,e){be(e,(n,r)=>{Fd(t,n,r)})}function Fd(t,e,n){const r=new Y("/.info/"+e),s=ue(n);t.infoData_.updateSnapshot(r,s);const o=Lo(t.infoSyncTree_,r,s);ut(t.eventQueue_,r,o)}function Hl(t){return t.nextWriteId_++}function R1(t,e,n){const r=d1(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const o=ue(s).withIndex(e._queryParams.getIndex());Xu(t.serverSyncTree_,e,n,!0);let i;if(e._queryParams.loadsAllData())i=Lo(t.serverSyncTree_,e._path,o);else{const l=Po(t.serverSyncTree_,e);i=Hy(t.serverSyncTree_,e._path,o,l)}return ut(t.eventQueue_,e._path,i),dl(t.serverSyncTree_,e,n,null,!0),o},s=>(gs(t,"get for query "+ve(e)+" failed: "+s),Promise.reject(new Error(s))))}function Gd(t,e,n,r,s){gs(t,"set",{path:e.toString(),value:n,priority:r});const o=Fo(t),i=ue(n,r),l=Gl(t.serverSyncTree_,e),a=Id(i,l,o),u=Hl(t),f=Ad(t.serverSyncTree_,e,a,u,!0);zl(t.eventQueue_,f),t.server_.put(e.toString(),i.val(!0),(d,m)=>{const h=d==="ok";h||Ue("set at "+e+" failed: "+d);const y=En(t.serverSyncTree_,u,!h);ut(t.eventQueue_,e,y),Vn(t,s,d,m)});const c=Bd(t,e);ls(t,c),ut(t.eventQueue_,c,[])}function I1(t,e,n,r){gs(t,"update",{path:e.toString(),value:n});let s=!0;const o=Fo(t),i={};if(be(n,(l,a)=>{s=!1,i[l]=qy(le(e,l),ue(a),t.serverSyncTree_,o)}),s)ke("update() called with empty data.  Don't do anything."),Vn(t,r,"ok",void 0);else{const l=Hl(t),a=i1(t.serverSyncTree_,e,i,l);zl(t.eventQueue_,a),t.server_.merge(e.toString(),n,(u,f)=>{const c=u==="ok";c||Ue("update at "+e+" failed: "+u);const d=En(t.serverSyncTree_,l,!c),m=d.length>0?ls(t,e):e;ut(t.eventQueue_,m,d),Vn(t,r,u,f)}),be(n,u=>{const f=Bd(t,le(e,u));ls(t,f)}),ut(t.eventQueue_,e,[])}}function L1(t){gs(t,"onDisconnectEvents");const e=Fo(t),n=rl();zu(t.onDisconnect_,H(),(s,o)=>{const i=qy(s,o,t.serverSyncTree_,e);ps(n,s,i)});let r=[];zu(n,H(),(s,o)=>{r=r.concat(Lo(t.serverSyncTree_,s,o));const i=Bd(t,s);ls(t,i)}),t.onDisconnect_=rl(),ut(t.eventQueue_,H(),r)}function $1(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&ju(t.onDisconnect_,e),Vn(t,n,r,s)})}function sp(t,e,n,r){const s=ue(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,i)=>{o==="ok"&&ps(t.onDisconnect_,e,s),Vn(t,r,o,i)})}function U1(t,e,n,r,s){const o=ue(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(i,l)=>{i==="ok"&&ps(t.onDisconnect_,e,o),Vn(t,s,i,l)})}function M1(t,e,n,r){if(Ru(n)){ke("onDisconnect().update() called with empty data.  Don't do anything."),Vn(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,o)=>{s==="ok"&&be(n,(i,l)=>{const a=ue(l);ps(t.onDisconnect_,le(e,i),a)}),Vn(t,r,s,o)})}function F1(t,e,n){let r;G(e._path)===".info"?r=Xu(t.infoSyncTree_,e,n):r=Xu(t.serverSyncTree_,e,n),n_(t.eventQueue_,e._path,r)}function Zu(t,e,n){let r;G(e._path)===".info"?r=dl(t.infoSyncTree_,e,n):r=dl(t.serverSyncTree_,e,n),n_(t.eventQueue_,e._path,r)}function i_(t){t.persistentConnection_&&t.persistentConnection_.interrupt(s_)}function G1(t){t.persistentConnection_&&t.persistentConnection_.resume(s_)}function gs(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ke(n,...e)}function Vn(t,e,n,r){e&&hs(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let o=s;r&&(o+=": "+r);const i=new Error(o);i.code=s,e(i)}})}function V1(t,e,n,r,s,o){gs(t,"transaction on "+e);const i={path:e,update:n,onComplete:r,status:null,order:ty(),applyLocally:o,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Vd(t,e,void 0);i.currentInputSnapshot=l;const a=i.update(l.val());if(a===void 0)i.unwatcher(),i.currentOutputSnapshotRaw=null,i.currentOutputSnapshotResolved=null,i.onComplete&&i.onComplete(null,!1,i.currentInputSnapshot);else{Uo("transaction failed: Data returned ",a,i.path),i.status=0;const u=Bl(t.transactionQueueTree_,e),f=wr(u)||[];f.push(i),Ud(u,f);let c;typeof a=="object"&&a!==null&&at(a,".priority")?(c=hr(a,".priority"),T(Co(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=(Gl(t.serverSyncTree_,e)||I.EMPTY_NODE).getPriority().val();const d=Fo(t),m=ue(a,c),h=Id(m,l,d);i.currentOutputSnapshotRaw=m,i.currentOutputSnapshotResolved=h,i.currentWriteId=Hl(t);const y=Ad(t.serverSyncTree_,e,h,i.currentWriteId,i.applyLocally);ut(t.eventQueue_,e,y),Yl(t,t.transactionQueueTree_)}}function Vd(t,e,n){return Gl(t.serverSyncTree_,e,n)||I.EMPTY_NODE}function Yl(t,e=t.transactionQueueTree_){if(e||Ql(t,e),wr(e)){const n=a_(t,e);T(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&B1(t,$o(e),n)}else Xy(e)&&Wl(e,n=>{Yl(t,n)})}function B1(t,e,n){const r=n.map(u=>u.currentWriteId),s=Vd(t,e,r);let o=s;const i=s.hash();for(let u=0;u<n.length;u++){const f=n[u];T(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const c=Be(e,f.path);o=o.updateChild(c,f.currentOutputSnapshotRaw)}const l=o.val(!0),a=e;t.server_.put(a.toString(),l,u=>{gs(t,"transaction put response",{path:a.toString(),status:u});let f=[];if(u==="ok"){const c=[];for(let d=0;d<n.length;d++)n[d].status=2,f=f.concat(En(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&c.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Ql(t,Bl(t.transactionQueueTree_,e)),Yl(t,t.transactionQueueTree_),ut(t.eventQueue_,e,f);for(let d=0;d<c.length;d++)hs(c[d])}else{if(u==="datastale")for(let c=0;c<n.length;c++)n[c].status===3?n[c].status=4:n[c].status=0;else{Ue("transaction at "+a.toString()+" failed: "+u);for(let c=0;c<n.length;c++)n[c].status=4,n[c].abortReason=u}ls(t,e)}},i)}function ls(t,e){const n=l_(t,e),r=$o(n),s=a_(t,n);return W1(t,s,r),r}function W1(t,e,n){if(e.length===0)return;const r=[];let s=[];const i=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],u=Be(n,a.path);let f=!1,c;if(T(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)f=!0,c=a.abortReason,s=s.concat(En(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=D1)f=!0,c="maxretry",s=s.concat(En(t.serverSyncTree_,a.currentWriteId,!0));else{const d=Vd(t,a.path,i);a.currentInputSnapshot=d;const m=e[l].update(d.val());if(m!==void 0){Uo("transaction failed: Data returned ",m,a.path);let h=ue(m);typeof m=="object"&&m!=null&&at(m,".priority")||(h=h.updatePriority(d.getPriority()));const S=a.currentWriteId,g=Fo(t),p=Id(h,d,g);a.currentOutputSnapshotRaw=h,a.currentOutputSnapshotResolved=p,a.currentWriteId=Hl(t),i.splice(i.indexOf(S),1),s=s.concat(Ad(t.serverSyncTree_,a.path,p,a.currentWriteId,a.applyLocally)),s=s.concat(En(t.serverSyncTree_,S,!0))}else f=!0,c="nodata",s=s.concat(En(t.serverSyncTree_,a.currentWriteId,!0))}ut(t.eventQueue_,n,s),s=[],f&&(e[l].status=2,function(d){setTimeout(d,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(c==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(c),!1,null))))}Ql(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)hs(r[l]);Yl(t,t.transactionQueueTree_)}function l_(t,e){let n,r=t.transactionQueueTree_;for(n=G(e);n!==null&&wr(r)===void 0;)r=Bl(r,n),e=Z(e),n=G(e);return r}function a_(t,e){const n=[];return u_(t,e,n),n.sort((r,s)=>r.order-s.order),n}function u_(t,e,n){const r=wr(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Wl(e,s=>{u_(t,s,n)})}function Ql(t,e){const n=wr(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,Ud(e,n.length>0?n:void 0)}Wl(e,r=>{Ql(t,r)})}function Bd(t,e){const n=$o(l_(t,e)),r=Bl(t.transactionQueueTree_,e);return E1(r,s=>{Ma(t,s)}),Ma(t,r),Jy(r,s=>{Ma(t,s)}),n}function Ma(t,e){const n=wr(e);if(n){const r=[];let s=[],o=-1;for(let i=0;i<n.length;i++)n[i].status===3||(n[i].status===1?(T(o===i-1,"All SENT items should be at beginning of queue."),o=i,n[i].status=3,n[i].abortReason="set"):(T(n[i].status===0,"Unexpected transaction status in abort"),n[i].unwatcher(),s=s.concat(En(t.serverSyncTree_,n[i].currentWriteId,!0)),n[i].onComplete&&r.push(n[i].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Ud(e,void 0):n.length=o+1,ut(t.eventQueue_,$o(e),s);for(let i=0;i<r.length;i++)hs(r[i])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function z1(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ue(`Invalid query segment '${n}' in query '${t}'`)}return e}const ec=function(t,e){const n=H1(t),r=n.namespace;n.domain==="firebase.com"&&zt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&zt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||tS();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new my(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Y(n.pathString)}},H1=function(t){let e="",n="",r="",s="",o="",i=!0,l="https",a=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(l=t.substring(0,u-1),t=t.substring(u+2));let f=t.indexOf("/");f===-1&&(f=t.length);let c=t.indexOf("?");c===-1&&(c=t.length),e=t.substring(0,Math.min(f,c)),f<c&&(s=j1(t.substring(f,c)));const d=z1(t.substring(Math.min(t.length,c)));u=e.indexOf(":"),u>=0?(i=l==="https"||l==="wss",a=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const h=e.indexOf(".");r=e.substring(0,h).toLowerCase(),n=e.substring(h+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:a,domain:n,subdomain:r,secure:i,scheme:l,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Y1=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=op.charAt(n%64),n=Math.floor(n/64);T(n===0,"Cannot push at time == 0");let i=o.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)i+=op.charAt(e[s]);return T(i.length===20,"nextPushId: Length should be 20."),i}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ve(this.snapshot.exportVal())}}class d_{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return T(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q1=class{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Qe;return $1(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){vt("OnDisconnect.remove",this._path);const e=new Qe;return sp(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){vt("OnDisconnect.set",this._path),Ht("OnDisconnect.set",e,this._path,!1);const n=new Qe;return sp(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){vt("OnDisconnect.setWithPriority",this._path),Ht("OnDisconnect.setWithPriority",e,this._path,!1),Md("OnDisconnect.setWithPriority",n);const r=new Qe;return U1(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){vt("OnDisconnect.update",this._path),e_("OnDisconnect.update",e,this._path);const n=new Qe;return M1(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return V(this._path)?null:pd(this._path)}get ref(){return new Pt(this._repo,this._path)}get _queryIdentifier(){const e=jh(this._queryParams),n=cd(e);return n==="{}"?"default":n}get _queryObject(){return jh(this._queryParams)}isEqual(e){if(e=ft(e),!(e instanceof tt))return!1;const n=this._repo===e._repo,r=md(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+MS(this._path)}}function Kl(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function zn(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===jt){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Un)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==cn)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===re){if(e!=null&&!Co(e)||n!=null&&!Co(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(T(t.getIndex()instanceof _d||t.getIndex()===vd,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ql(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Pt extends tt{constructor(e,n){super(e,n,new Ll,!1)}get parent(){const e=Cy(this._path);return e===null?null:new Pt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let Xl=class tc{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Y(e),r=gr(this.ref,e);return new tc(this._node.getChild(n),r,re)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new tc(s,gr(this.ref,r),re)))}hasChild(e){const n=new Y(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function f_(t,e){return t=ft(t),t._checkNotDeleted("ref"),e!==void 0?gr(t._root,e):t._root}function ip(t,e){t=ft(t),t._checkNotDeleted("refFromURL");const n=ec(e,t._repo.repoInfo_.nodeAdmin);t_("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&zt("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),f_(t,n.path.toString())}function gr(t,e){return t=ft(t),G(t._path)===null?T1("child","path",e):ko("child","path",e),new Pt(t._repo,le(t._path,e))}function K1(t,e){t=ft(t),vt("push",t._path),Ht("push",e,t._path,!0);const n=o_(t._repo),r=Y1(n),s=gr(t,r),o=gr(t,r);let i;return e!=null?i=jd(o,e).then(()=>o):i=Promise.resolve(o),s.then=i.then.bind(i),s.catch=i.then.bind(i,void 0),s}function q1(t){return vt("remove",t._path),jd(t,null)}function jd(t,e){t=ft(t),vt("set",t._path),Ht("set",e,t._path,!1);const n=new Qe;return Gd(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function X1(t,e){t=ft(t),vt("setPriority",t._path),Md("setPriority",e);const n=new Qe;return Gd(t._repo,le(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function J1(t,e,n){if(vt("setWithPriority",t._path),Ht("setWithPriority",e,t._path,!1),Md("setWithPriority",n),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new Qe;return Gd(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function Z1(t,e){e_("update",e,t._path);const n=new Qe;return I1(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function eC(t){t=ft(t);const e=new Wd(()=>{}),n=new Go(e);return R1(t._repo,t,n).then(r=>new Xl(r,new Pt(t._repo,t._path),t._queryParams.getIndex()))}class Go{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new c_("value",this,new Xl(e.snapshotNode,new Pt(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new d_(this,e,n):null}matches(e){return e instanceof Go?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Jl{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new d_(this,e,n):null}createEvent(e,n){T(e.childName!=null,"Child events should have a childName.");const r=gr(new Pt(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new c_(e.type,this,new Xl(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Jl?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Vo(t,e,n,r,s){let o;if(typeof r=="object"&&(o=void 0,s=r),typeof r=="function"&&(o=r),s&&s.onlyOnce){const a=n,u=(f,c)=>{Zu(t._repo,t,l),a(f,c)};u.userCallback=n.userCallback,u.context=n.context,n=u}const i=new Wd(n,o||void 0),l=e==="value"?new Go(i):new Jl(e,i);return F1(t._repo,t,l),()=>Zu(t._repo,t,l)}function nc(t,e,n,r){return Vo(t,"value",e,n,r)}function lp(t,e,n,r){return Vo(t,"child_added",e,n,r)}function ap(t,e,n,r){return Vo(t,"child_changed",e,n,r)}function up(t,e,n,r){return Vo(t,"child_moved",e,n,r)}function cp(t,e,n,r){return Vo(t,"child_removed",e,n,r)}function dp(t,e,n){let r=null;const s=n?new Wd(n):null;e==="value"?r=new Go(s):e&&(r=new Jl(e,s)),Zu(t._repo,t,r)}class Ut{}class h_ extends Ut{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Ht("endAt",this._value,e._path,!0);const n=Wu(e._queryParams,this._value,this._key);if(ql(n),zn(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new tt(e._repo,e._path,n,e._orderByCalled)}}function tC(t,e){return Mo("endAt","key",e),new h_(t,e)}class nC extends Ut{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Ht("endBefore",this._value,e._path,!1);const n=cP(e._queryParams,this._value,this._key);if(ql(n),zn(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new tt(e._repo,e._path,n,e._orderByCalled)}}function rC(t,e){return Mo("endBefore","key",e),new nC(t,e)}class p_ extends Ut{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Ht("startAt",this._value,e._path,!0);const n=Bu(e._queryParams,this._value,this._key);if(ql(n),zn(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new tt(e._repo,e._path,n,e._orderByCalled)}}function sC(t=null,e){return Mo("startAt","key",e),new p_(t,e)}class oC extends Ut{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Ht("startAfter",this._value,e._path,!1);const n=uP(e._queryParams,this._value,this._key);if(ql(n),zn(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new tt(e._repo,e._path,n,e._orderByCalled)}}function iC(t,e){return Mo("startAfter","key",e),new oC(t,e)}class lC extends Ut{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new tt(e._repo,e._path,lP(e._queryParams,this._limit),e._orderByCalled)}}function aC(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new lC(t)}class uC extends Ut{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new tt(e._repo,e._path,aP(e._queryParams,this._limit),e._orderByCalled)}}function cC(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new uC(t)}class dC extends Ut{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Kl(e,"orderByChild");const n=new Y(this._path);if(V(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new _d(n),s=$l(e._queryParams,r);return zn(s),new tt(e._repo,e._path,s,!0)}}function fC(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ko("orderByChild","path",t),new dC(t)}class hC extends Ut{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Kl(e,"orderByKey");const n=$l(e._queryParams,jt);return zn(n),new tt(e._repo,e._path,n,!0)}}function pC(){return new hC}class mC extends Ut{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Kl(e,"orderByPriority");const n=$l(e._queryParams,re);return zn(n),new tt(e._repo,e._path,n,!0)}}function gC(){return new mC}class yC extends Ut{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Kl(e,"orderByValue");const n=$l(e._queryParams,vd);return zn(n),new tt(e._repo,e._path,n,!0)}}function _C(){return new yC}class vC extends Ut{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Ht("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new h_(this._value,this._key)._apply(new p_(this._value,this._key)._apply(e))}}function EC(t,e){return Mo("equalTo","key",e),new vC(t,e)}function bt(t,...e){let n=ft(t);for(const r of e)n=r._apply(n);return n}JP(Pt);r1(Pt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC="FIREBASE_DATABASE_EMULATOR_HOST",rc={};let SC=!1;function PC(t,e,n,r){const s=e.lastIndexOf(":"),o=e.substring(0,s),i=td(o);t.repoInfo_=new my(e,i,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function m_(t,e,n,r,s){let o=r||t.options.databaseURL;o===void 0&&(t.options.projectId||zt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ke("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let i=ec(o,s),l=i.repoInfo,a,u;typeof process<"u"&&Th&&(u=Th[wC]),u?(a=!0,o=`http://${u}?ns=${l.namespace}`,i=ec(o,s),l=i.repoInfo):a=!i.repoInfo.secure;const f=s&&a?new Hr(Hr.OWNER):new fS(t.name,t.options,e);t_("Invalid Firebase Database URL",i),V(i.path)||zt("Database URL must point to the root of a Firebase Database (not including a child path).");const c=kC(l,t,f,new dS(t,n));return new TC(c,t)}function CC(t,e){const n=rc[e];(!n||n[t.key]!==t)&&zt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),i_(t),delete n[t.key]}function kC(t,e,n,r){let s=rc[e.name];s||(s={},rc[e.name]=s);let o=s[t.toURLString()];return o&&zt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new x1(t,SC,n,r),s[t.toURLString()]=o,o}let TC=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(O1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Pt(this._repo,H())),this._rootInternal}_delete(){return this._rootInternal!==null&&(CC(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&zt("Cannot call "+e+" on a deleted database.")}};function g_(){rs.IS_TRANSPORT_INITIALIZED&&Ue("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function bC(){g_(),vn.forceDisallow()}function AC(){g_(),gt.forceDisallow(),vn.forceAllow()}function DC(t,e,n,r={}){t=ft(t),t._checkNotDeleted("useEmulator");const s=`${e}:${n}`,o=t._repoInternal;if(t._instanceStarted){if(s===t._repoInternal.repoInfo_.host&&Xi(r,o.repoInfo_.emulatorOptions))return;zt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let i;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&zt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new Hr(Hr.OWNER);else if(r.mockUserToken){const l=typeof r.mockUserToken=="string"?r.mockUserToken:dE(r.mockUserToken,t.app.options.projectId);i=new Hr(l)}td(e)&&(cE(e),pE("Database",!0)),PC(o,s,r,i)}function xC(t){t=ft(t),t._checkNotDeleted("goOffline"),i_(t._repo)}function OC(t){t=ft(t),t._checkNotDeleted("goOnline"),G1(t._repo)}function NC(t,e){ry(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(t){Zg(id),ns(new an("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return m_(r,s,o,n)},"PUBLIC").setMultipleInstances(!0)),tn(bh,Ah,t),tn(bh,Ah,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC={".sv":"timestamp"};function LC(){return IC}function $C(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UC=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function MC(t,e,n){if(t=ft(t),vt("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(n==null?void 0:n.applyLocally)??!0,s=new Qe,o=(l,a,u)=>{let f=null;l?s.reject(l):(f=new Xl(u,new Pt(t._repo,t._path),re),s.resolve(new UC(a,f)))},i=nc(t,()=>{});return V1(t._repo,t._path,e,o,i,r),s.promise}nn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};nn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};RC();const FC="@firebase/database-compat",GC="2.1.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC=new Nl("@firebase/database-compat"),y_=function(t){const e="FIREBASE WARNING: "+t;VC.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=function(t,e,n,r){if(n!==void 0&&typeof n!="boolean")throw new Error(et(t,e)+"must be a boolean.")},WC=function(t,e,n){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(et(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this._delegate=e}cancel(e){L("OnDisconnect.cancel",0,1,arguments.length),Pe("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){L("OnDisconnect.remove",0,1,arguments.length),Pe("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){L("OnDisconnect.set",1,2,arguments.length),Pe("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){L("OnDisconnect.setWithPriority",2,3,arguments.length),Pe("OnDisconnect.setWithPriority","onComplete",r,!0);const s=this._delegate.setWithPriority(e,n);return r&&s.then(()=>r(null),o=>r(o)),s}update(e,n){if(L("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,y_("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Pe("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),s=>n(s)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return L("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,n){this._database=e,this._delegate=n}val(){return L("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return L("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return L("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return L("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return L("DataSnapshot.child",0,1,arguments.length),e=String(e),ko("DataSnapshot.child","path",e),new Nn(this._database,this._delegate.child(e))}hasChild(e){return L("DataSnapshot.hasChild",1,1,arguments.length),ko("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return L("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return L("DataSnapshot.forEach",1,1,arguments.length),Pe("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Nn(this._database,n)))}hasChildren(){return L("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return L("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return L("DataSnapshot.ref",0,0,arguments.length),new rt(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Ae{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,s){var a;L("Query.on",2,4,arguments.length),Pe("Query.on","callback",n,!1);const o=Ae.getCancelAndContextArgs_("Query.on",r,s),i=(u,f)=>{n.call(o.context,new Nn(this.database,u),f)};i.userCallback=n,i.context=o.context;const l=(a=o.cancel)==null?void 0:a.bind(o.context);switch(e){case"value":return nc(this._delegate,i,l),n;case"child_added":return lp(this._delegate,i,l),n;case"child_removed":return cp(this._delegate,i,l),n;case"child_changed":return ap(this._delegate,i,l),n;case"child_moved":return up(this._delegate,i,l),n;default:throw new Error(et("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(L("Query.off",0,3,arguments.length),WC("Query.off",e),Pe("Query.off","callback",n,!0),gh("Query.off","context",r),n){const s=()=>{};s.userCallback=n,s.context=r,dp(this._delegate,e,s)}else dp(this._delegate,e)}get(){return eC(this._delegate).then(e=>new Nn(this.database,e))}once(e,n,r,s){L("Query.once",1,4,arguments.length),Pe("Query.once","callback",n,!0);const o=Ae.getCancelAndContextArgs_("Query.once",r,s),i=new Qe,l=(u,f)=>{const c=new Nn(this.database,u);n&&n.call(o.context,c,f),i.resolve(c)};l.userCallback=n,l.context=o.context;const a=u=>{o.cancel&&o.cancel.call(o.context,u),i.reject(u)};switch(e){case"value":nc(this._delegate,l,a,{onlyOnce:!0});break;case"child_added":lp(this._delegate,l,a,{onlyOnce:!0});break;case"child_removed":cp(this._delegate,l,a,{onlyOnce:!0});break;case"child_changed":ap(this._delegate,l,a,{onlyOnce:!0});break;case"child_moved":up(this._delegate,l,a,{onlyOnce:!0});break;default:throw new Error(et("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return i.promise}limitToFirst(e){return L("Query.limitToFirst",1,1,arguments.length),new Ae(this.database,bt(this._delegate,aC(e)))}limitToLast(e){return L("Query.limitToLast",1,1,arguments.length),new Ae(this.database,bt(this._delegate,cC(e)))}orderByChild(e){return L("Query.orderByChild",1,1,arguments.length),new Ae(this.database,bt(this._delegate,fC(e)))}orderByKey(){return L("Query.orderByKey",0,0,arguments.length),new Ae(this.database,bt(this._delegate,pC()))}orderByPriority(){return L("Query.orderByPriority",0,0,arguments.length),new Ae(this.database,bt(this._delegate,gC()))}orderByValue(){return L("Query.orderByValue",0,0,arguments.length),new Ae(this.database,bt(this._delegate,_C()))}startAt(e=null,n){return L("Query.startAt",0,2,arguments.length),new Ae(this.database,bt(this._delegate,sC(e,n)))}startAfter(e=null,n){return L("Query.startAfter",0,2,arguments.length),new Ae(this.database,bt(this._delegate,iC(e,n)))}endAt(e=null,n){return L("Query.endAt",0,2,arguments.length),new Ae(this.database,bt(this._delegate,tC(e,n)))}endBefore(e=null,n){return L("Query.endBefore",0,2,arguments.length),new Ae(this.database,bt(this._delegate,rC(e,n)))}equalTo(e,n){return L("Query.equalTo",1,2,arguments.length),new Ae(this.database,bt(this._delegate,EC(e,n)))}toString(){return L("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return L("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(L("Query.isEqual",1,1,arguments.length),!(e instanceof Ae)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const s={cancel:void 0,context:void 0};if(n&&r)s.cancel=n,Pe(e,"cancel",s.cancel,!0),s.context=r,gh(e,"context",s.context);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(et(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new rt(this.database,new Pt(this._delegate._repo,this._delegate._path))}}class rt extends Ae{constructor(e,n){super(e,new tt(n._repo,n._path,new Ll,!1)),this.database=e,this._delegate=n}getKey(){return L("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return L("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new rt(this.database,gr(this._delegate,e))}getParent(){L("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new rt(this.database,e):null}getRoot(){return L("Reference.root",0,0,arguments.length),new rt(this.database,this._delegate.root)}set(e,n){L("Reference.set",1,2,arguments.length),Pe("Reference.set","onComplete",n,!0);const r=jd(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}update(e,n){if(L("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,y_("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}vt("Reference.update",this._delegate._path),Pe("Reference.update","onComplete",n,!0);const r=Z1(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){L("Reference.setWithPriority",2,3,arguments.length),Pe("Reference.setWithPriority","onComplete",r,!0);const s=J1(this._delegate,e,n);return r&&s.then(()=>r(null),o=>r(o)),s}remove(e){L("Reference.remove",0,1,arguments.length),Pe("Reference.remove","onComplete",e,!0);const n=q1(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){L("Reference.transaction",1,3,arguments.length),Pe("Reference.transaction","transactionUpdate",e,!1),Pe("Reference.transaction","onComplete",n,!0),BC("Reference.transaction","applyLocally",r);const s=MC(this._delegate,e,{applyLocally:r}).then(o=>new zC(o.committed,new Nn(this.database,o.snapshot)));return n&&s.then(o=>n(null,o.committed,o.snapshot),o=>n(o,!1,null)),s}setPriority(e,n){L("Reference.setPriority",1,2,arguments.length),Pe("Reference.setPriority","onComplete",n,!0);const r=X1(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}push(e,n){L("Reference.push",0,2,arguments.length),Pe("Reference.push","onComplete",n,!0);const r=K1(this._delegate,e),s=r.then(i=>new rt(this.database,i));n&&s.then(()=>n(null),i=>n(i));const o=new rt(this.database,r);return o.then=s.then.bind(s),o.catch=s.catch.bind(s,void 0),o}onDisconnect(){return vt("Reference.onDisconnect",this._delegate._path),new jC(new Q1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:bC,forceLongPolling:AC}}useEmulator(e,n,r={}){DC(this._delegate,e,n,r)}ref(e){if(L("database.ref",0,1,arguments.length),e instanceof rt){const n=ip(this._delegate,e.toString());return new rt(this,n)}else{const n=f_(this._delegate,e);return new rt(this,n)}}refFromURL(e){L("database.refFromURL",1,1,arguments.length);const r=ip(this._delegate,e);return new rt(this,r)}goOffline(){return L("database.goOffline",0,0,arguments.length),xC(this._delegate)}goOnline(){return L("database.goOnline",0,0,arguments.length),OC(this._delegate)}}To.ServerValue={TIMESTAMP:LC(),increment:t=>$C(t)};function HC({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:s,namespace:o,nodeAdmin:i=!1}){Zg(n);const l=new nd("database-standalone"),a=new Iu("auth-internal",l);a.setComponent(new an("auth-internal",()=>r,"PRIVATE"));let u;return s&&(u=new Iu("app-check-internal",l),u.setComponent(new an("app-check-internal",()=>s,"PRIVATE"))),{instance:new To(m_(t,a,u,e,i),t),namespace:o}}var YC=Object.freeze({__proto__:null,initStandalone:HC});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=To.ServerValue;function KC(t){t.INTERNAL.registerComponent(new an("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new To(s,r)},"PUBLIC").setServiceProps({Reference:rt,Query:Ae,Database:To,DataSnapshot:Nn,enableLogging:NC,INTERNAL:YC,ServerValue:QC}).setMultipleInstances(!0)),t.registerVersion(FC,GC)}KC(ud);window.firebase=ud;const qC=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],fp=5,XC=1e3;function zd(t=4){return[...qC].sort(()=>Math.random()-.5).slice(0,t)}const hp={red:{title:"Patron Manipulation",icon:"",actions:[{id:"gain3red",title:"Gain 3 ",description:"",round:1},{id:"gain2red",title:"Gain 2 ",description:"",round:1},{id:"redHybrid1",title:"+1  + Swap Patrons",description:"(Both execute their new action)",round:1},{id:"redRepeatAction",title:"Repeat an Action",description:"(That one of your patrons is on)",round:1},{id:"redVPFocus",title:"Gain 1, +1 VP Per Red Patron",description:"(for each red action where you have a patron)",round:2},{id:"redHybrid2",title:"+1  + Swap Patrons",description:"(Only you execute your new action)",round:2},{id:"redRepeatAll",title:"Repeat all actions where you have a patron",description:"(In any order you choose)",round:3}]},yellow:{title:"Resource Manipulation",icon:"",actions:[{id:"gain3yellow",title:"Gain 3 resources",description:"(any colors)",round:1},{id:"gain2yellow",title:"Gain 2 resources",description:"(any colors)",round:1},{id:"steal2Gems",title:"+1 + Trade all resources for new ones",description:"(keep same total count)",round:1},{id:"yellowHybrid1",title:"+2",description:"",round:1},{id:"steal3Gems",title:"Gain 4 resources",description:"(any colors)",round:2},{id:"yellowHybrid2",title:"+1 + Copy previous player's last gain",description:"",round:2},{id:"yellowSwapResources",title:"Gain 3 of each color in the game",description:"",round:3}]},blue:{title:"Shop Control",icon:"",actions:[{id:"gain3blue",title:"Gain 3 ",description:"",round:1},{id:"gain2blue",title:"Gain 2 ",description:"",round:1},{id:"blueR1ShopBenefit",title:"Gain an R1 Shop Benefit",description:"(Even if closed)",round:1},{id:"blueReduceCosts",title:"+1  + Reduce All Shop Costs",description:"(By 1  this round)",round:1},{id:"blueIncreaseCosts",title:"Increase All Shop Costs",description:"(By 2  for other players)",round:2},{id:"blueToggleShops",title:"+1  + Toggle All Shop Status",description:"(Including victory shops)",round:2},{id:"blueAnyShopBenefit",title:"Gain Any Shop Benefit",description:"(Even if closed)",round:3}]},purple:{title:"Timing/Order",icon:"",actions:[{id:"gain4purpleSkip",title:"Gain 4 , Skip Next Turn",description:"",round:1},{id:"gain3purple",title:"Gain 3 ",description:"",round:1},{id:"gain2purpleTakeBack",title:"Gain 2 , Take Back Patron",description:"(From different quad)",round:1},{id:"playTwoWorkers",title:"Place 2 More Patrons",description:"(This turn)",round:1},{id:"gain5purpleSkip",title:"Gain 5 , Skip Turn",description:"",round:2},{id:"playThreeWorkers",title:"Place 3 More Patrons",description:"(This turn)",round:2},{id:"gain4purpleWaitAll",title:"Gain 4 , Take Another Turn",description:"(After this one)",round:3}]},gold:{title:"Victory Points",icon:"",actions:[{id:"gain2gold",title:"Gain 2 Gold",description:"",round:1},{id:"convert2AnyTo2Gold",title:"Trade: 2 resources  2 Gold",description:"(any colors)",round:1},{id:"gain1gold",title:"Gain 1 Gold",description:"",round:1},{id:"convert1AnyTo1Gold",title:"Trade: 1 resource  1 Gold",description:"(any color)",round:1},{id:"gain3goldSkip",title:"Gain 3 Gold, skip your next turn",description:"",round:2},{id:"convert3AnyTo3Gold",title:"Trade: 3 resources  3 Gold",description:"(any colors)",round:2},{id:"goldVPPerGold",title:"Gain 1 VP for each Gold you have",description:"",round:3}]},white:{title:"White - VP Trading",icon:"",actions:[{id:"gain3vp",title:"Gain 3 VP",description:"",round:1},{id:"gain2vp",title:"Gain 2 VP",description:"",round:1},{id:"spend1AnyFor2VP",title:"Trade: 1 resource  2 VP",description:"(any color)",round:1},{id:"spend2AnyFor3VP",title:"Trade: 2 resources  3 VP",description:"(any colors)",round:1},{id:"lose1VPGain2Any",title:"Lose 1 VP, gain 2 resources",description:"(any colors)",round:2},{id:"lose2VPGain4Any",title:"Lose 2 VP, gain 4 resources",description:"(any colors)",round:2},{id:"gain5VPAnd5Any",title:"Gain 5 VP and 5 resources",description:"(any colors)",round:3}]},black:{title:"Destruction/Penalty",icon:"",actions:[{id:"gain3black",title:"Gain 3 ",description:"",round:1},{id:"gain2black",title:"Gain 2 ",description:"",round:1},{id:"blackSteal1VP",title:"+1 , steal 1 VP from a player",description:"",round:1},{id:"blackSteal2Any",title:"Steal 2 resources from a player",description:"(any colors)",round:1},{id:"blackStealWorker",title:"+1 , steal 4 resources from a player",description:"(any colors)",round:2},{id:"blackAllLose2VP",title:"All other players lose 2 VP",description:"",round:2},{id:"blackAllLose4VP",title:"+2 , all other players lose 4 VP",description:"",round:3}]},silver:{title:"Information/Planning",icon:"",actions:[{id:"silver4Others1",title:"+4 Silver for you, +1 for all others",description:"",round:1},{id:"silver3Others1",title:"+3 Silver for you, +1 for all others",description:"",round:1},{id:"silver2Plus1Others",title:"+2 Silver + 1 resource for you",description:"(others get 1 of same color)",round:1},{id:"silver2VPBoth",title:"+2 VP for you, pick a player for +2 VP",description:"",round:1},{id:"silverTakeBack2",title:"+2 Silver, take back 2 patrons",description:"(others take back 1)",round:2},{id:"silver3Plus2Others1",title:"+3 Silver + 2 resources for you",description:"(others get 1 of that color)",round:2},{id:"silver8VPOthers3S",title:"+8 VP for you, +3 Silver for all others",description:"",round:3}]}};function fl(t,e="advanced"){let n;e==="basic"?n=["red","yellow","blue","black"]:n=Object.keys(hp);const r=[...n];for(let i=r.length-1;i>0;i--){const l=Math.floor(Math.random()*(i+1));[r[i],r[l]]=[r[l],r[i]]}const s=r.slice(0,t),o={};return s.forEach(i=>{o[i]=hp[i]}),o}const Ls=zd(4),hl={currentPlayer:1,turnDirection:1,gameMode:null,players:[{id:1,name:"Player 1",emoji:Ls[0],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0,lastGain:{}},{id:2,name:"Player 2",emoji:Ls[1],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0,lastGain:{}},{id:3,name:"Player 3",emoji:Ls[2],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0,lastGain:{}},{id:4,name:"Player 4",emoji:Ls[3],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0,lastGain:{}}],occupiedSpaces:{},round:1,turnOrder:[1,2,3,4],workerPlacedThisTurn:!1,workersToPlace:1,shopUsedAfterWorkers:!1,vpShopUsed:!1,modal:null,actionLog:[],gameLayers:null,automaticVPs:{},closedShops:{},skippedTurns:{},playersOutOfWorkers:[],waitingForOthers:{},roundActions:[],roundAdvancing:!1,roomCode:null,myPlayerId:null,myPlayerName:"",connectedPlayers:{},isHost:!1,gameStarted:!1,connectionStatus:"disconnected",gameOver:!1,syncingFromFirebase:!1,stateVersion:0,notifications:[],pendingPlacements:{}};function JC(t,e){console.log("Reducer called with action:",e.type,e);const n=(()=>{var r,s,o,i,l;switch(e.type){case"PLACE_WORKER":const a=e.playerId||t.currentPlayer,u=a===t.currentPlayer,f=u?Math.max(0,t.workersToPlace-1):t.workersToPlace,c=t.players.find(E=>E.id===a),d=Math.max(0,c.workersLeft-1),m=(c.effects||[]).some(E=>E.includes("Can place")&&E.includes("more workers this turn")),h=f===0&&m;return{...t,occupiedSpaces:{...t.occupiedSpaces,[e.actionId]:a},players:t.players.map(E=>{if(E.id===a){const A={...E,workersLeft:d};return h&&u&&(A.effects=(A.effects||[]).filter(F=>!F.includes("Can place")&&!F.includes("more workers this turn"))),A}return E}),workerPlacedThisTurn:u?!0:t.workerPlacedThisTurn,workersToPlace:f,roundActions:[...t.roundActions,{playerId:a,actionId:e.actionId}],lastUpdatedBy:t.myPlayerId};case"UPDATE_RESOURCES":console.log("UPDATE_RESOURCES reducer called with:",{playerId:e.playerId,resources:e.resources,currentPlayers:t.players.map(E=>({id:E.id,resources:E.resources}))});const y={};Object.keys(e.resources).forEach(E=>{e.resources[E]>0&&(y[E]=e.resources[E])});const S={...t,players:t.players.map(E=>{if(E.id===e.playerId){const A={red:E.resources.red+(e.resources.red||0),yellow:E.resources.yellow+(e.resources.yellow||0),blue:E.resources.blue+(e.resources.blue||0),purple:E.resources.purple+(e.resources.purple||0),gold:E.resources.gold+(e.resources.gold||0),white:E.resources.white+(e.resources.white||0),black:E.resources.black+(e.resources.black||0),silver:E.resources.silver+(e.resources.silver||0)};return console.log("UPDATE_RESOURCES - Updating player",E.id,"from",E.resources,"to",A),console.log("UPDATE_RESOURCES - All players will track gainedResources:",y),{...E,resources:A,lastGain:Object.keys(y).length>0?y:E.lastGain}}else if(Object.keys(y).length>0)return{...E,lastGain:y};return E})};return console.log("UPDATE_RESOURCES - Updated state players:",S.players.map(E=>({id:E.id,resources:E.resources}))),console.log("UPDATE_RESOURCES - Returning updated state"),S;case"SET_RESOURCES":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,resources:e.resources}:E)};case"ADD_VICTORY_POINTS":return{...t,players:t.players.map(E=>{var A;return E.id===e.playerId?{...E,victoryPoints:E.victoryPoints+e.points,vpSources:{...E.vpSources,victoryShop:(((A=E.vpSources)==null?void 0:A.victoryShop)||0)+e.points}}:E})};case"UPDATE_VP":return{...t,players:t.players.map(E=>{var A;return E.id===e.playerId?{...E,victoryPoints:E.victoryPoints+e.vp,vpSources:{...E.vpSources,[e.source||"other"]:(((A=E.vpSources)==null?void 0:A[e.source||"other"])||0)+e.vp}}:E})};case"ADD_EFFECT":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,effects:[...E.effects||[],e.effect]}:E)};case"UPDATE_PLAYER_EFFECTS":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,effects:e.effects}:E)};case"SET_WORKERS_TO_PLACE":return{...t,workersToPlace:e.count,workerPlacedThisTurn:!1};case"ADD_WORKERS_TO_PLACE":return{...t,workersToPlace:t.workersToPlace+e.count};case"END_TURN":const g=t.players.find(E=>E.id===t.currentPlayer);let p=[...t.playersOutOfWorkers];g.workersLeft===0&&!p.includes(t.currentPlayer)&&p.push(t.currentPlayer);const _=[];if((r=t.automaticVPs)!=null&&r.purple){const E=t.players.filter(A=>A.workersLeft>0);p.length===1&&p[0]===t.currentPlayer&&_.push({playerId:t.currentPlayer,vp:4,reason:"first to run out of workers"}),g.workersLeft===0&&E.length===0&&_.push({playerId:t.currentPlayer,vp:4,reason:"last to run out of workers"})}const w=t.turnOrder.indexOf(t.currentPlayer);let P=!1;t.turnDirection===1?w===t.turnOrder.length-1&&(P=!0,t.turnOrder[w]):w===0&&(P=!0,t.turnOrder[w]);const k=g.effects.some(E=>E.includes("Will take an extra turn after this one")),b=(g.extraTurns||0)>0,D=k||b,$=t.skippedTurns[t.currentPlayer]>0;if(D&&!P){const E={...t.skippedTurns};let A="";$?(E[t.currentPlayer]--,A=`Player ${t.currentPlayer}: Extra turn consumed by skip (${E[t.currentPlayer]} skips remaining)`):A=`Player ${t.currentPlayer}: Taking extra turn!`;const F=t.players.map(N=>{var X,Pr;const j=_.find(ht=>ht.playerId===N.id);return N.id===t.currentPlayer?{...N,effects:(N.effects||[]).filter(ht=>ht.includes("Can place")&&ht.includes("more workers this turn")&&t.workersToPlace>0?!0:!ht.includes("Will take an extra turn after this one")&&!ht.includes("more workers this turn")&&!ht.includes("Can place")),extraTurns:Math.max(0,(N.extraTurns||0)-1),victoryPoints:N.victoryPoints+(j?j.vp:0),vpSources:j?{...N.vpSources,purpleWorkers:(((X=N.vpSources)==null?void 0:X.purpleWorkers)||0)+j.vp}:N.vpSources}:{...N,victoryPoints:N.victoryPoints+(j?j.vp:0),vpSources:j?{...N.vpSources,purpleWorkers:(((Pr=N.vpSources)==null?void 0:Pr.purpleWorkers)||0)+j.vp}:N.vpSources}});if(!$){const j=(F.find(X=>X.id===t.currentPlayer).effects||[]).some(X=>X.includes("Can place")&&X.includes("more workers this turn"));return{...t,players:F,workerPlacedThisTurn:!1,workersToPlace:j?t.workersToPlace:1,shopUsedAfterWorkers:!1,vpShopUsed:!1,playersOutOfWorkers:p,skippedTurns:E,lastUpdatedBy:t.myPlayerId,actionLog:[...t.actionLog.slice(-9),A,..._.map(X=>`Player ${X.playerId}: +${X.vp} VP (${X.reason})`)].filter(Boolean)}}}else if(D&&P){console.log(`Player ${t.currentPlayer}: Snake draft reversal - extra turn preserved`);const E=`Player ${t.currentPlayer}: At end of snake draft - gets another turn naturally (extra turn preserved)`;t.actionLog.push(E)}const R=D&&$&&!P?{...t.skippedTurns,[t.currentPlayer]:t.skippedTurns[t.currentPlayer]-1}:t.skippedTurns,q=D&&!P?t.players.map(E=>{var F,N;const A=_.find(j=>j.playerId===E.id);return E.id===t.currentPlayer?{...E,effects:(E.effects||[]).filter(j=>j.includes("Can place")&&j.includes("more workers this turn")&&t.workersToPlace>0?!0:!j.includes("Will take an extra turn after this one")&&!j.includes("more workers this turn")&&!j.includes("Can place")),extraTurns:Math.max(0,(E.extraTurns||0)-1),victoryPoints:E.victoryPoints+(A?A.vp:0),vpSources:A?{...E.vpSources,purpleWorkers:(((F=E.vpSources)==null?void 0:F.purpleWorkers)||0)+A.vp}:E.vpSources}:{...E,victoryPoints:E.victoryPoints+(A?A.vp:0),vpSources:A?{...E.vpSources,purpleWorkers:(((N=E.vpSources)==null?void 0:N.purpleWorkers)||0)+A.vp}:E.vpSources}}):t.players.map(E=>{var F;const A=_.find(N=>N.playerId===E.id);return A?{...E,victoryPoints:E.victoryPoints+A.vp,vpSources:{...E.vpSources,purpleWorkers:(((F=E.vpSources)==null?void 0:F.purpleWorkers)||0)+A.vp}}:E}),Ge=[];D&&$&&Ge.push(`Player ${t.currentPlayer}: Extra turn consumed by skip (${R[t.currentPlayer]} skips remaining)`);let Mt=[],Hn={...t.waitingForOthers};t.players.filter(E=>!t.waitingForOthers[E.id]&&E.workersLeft>0).length===0&&Object.keys(t.waitingForOthers).forEach(E=>{if(t.waitingForOthers[E]){const A=t.players.find(F=>F.id===parseInt(E));A&&A.workersLeft>0&&(Mt.push({playerId:parseInt(E),workers:A.workersLeft}),delete Hn[E])}});let Q,He=t.turnDirection,x=0;const M=t.players.length*2,U={...R},ee=[];console.log("END_TURN: Skip turns state",{effectiveSkippedTurns:R,tempSkippedTurns:U,currentPlayer:t.currentPlayer,turnOrder:t.turnOrder,turnDirection:t.turnDirection}),t.turnDirection===1?w===t.turnOrder.length-1?(He=-1,Q=t.turnOrder[w]):Q=t.turnOrder[w+1]:w===0?(He=1,Q=t.turnOrder[w]):Q=t.turnOrder[w-1];do{if(x++,x>M)break;if(U[Q]>0){console.log(`Player ${Q} should skip turn. Skips remaining: ${U[Q]}`),ee.push(Q),U[Q]--;const F=t.turnOrder.indexOf(Q);He===1?F===t.turnOrder.length-1?(He=-1,Q=t.turnOrder[F]):Q=t.turnOrder[F+1]:F===0?(He=1,Q=t.turnOrder[F]):Q=t.turnOrder[F-1];continue}const E=Hn[Q],A=t.players.find(F=>F.id===Q).workersLeft>0;if(E||!A){const F=t.turnOrder.indexOf(Q);He===1?F===t.turnOrder.length-1?(He=-1,Q=t.turnOrder[F-1]):Q=t.turnOrder[F+1]:F===0?(He=1,Q=t.turnOrder[F+1]):Q=t.turnOrder[F-1];continue}break}while(x<M);const he={...U};ee.length>0&&console.log("Skip turn debug:",{skippedPlayers:ee,currentPlayer:t.currentPlayer,nextPlayer:Q,turnDirection:t.turnDirection,nextDirection:He,skippedTurns:he});const Yn=Mt.find(E=>E.playerId===Q),Ct=q.find(E=>E.id===Q),ys=((Ct==null?void 0:Ct.effects)||[]).some(E=>E.includes("Can place")&&E.includes("more workers this turn")),Yt=Yn?Yn.workers:ys?t.workersToPlace:1,Qn=q.reduce((E,A)=>Hn[A.id]?E:E+A.workersLeft,0);if(Qn===0&&t.round===3&&!q.some(A=>(A.extraTurns||0)>0||(A.effects||[]).some(F=>F.includes("Will take an extra turn after this one")))){const A=[],F=q.map(N=>{var Pr,ht;let j=0;const X={...N.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const kt=Object.entries(N.resources).filter(([Yk,b_])=>b_>0).length;kt>0&&(j+=kt,X.yellowDiversity=(((Pr=N.vpSources)==null?void 0:Pr.yellowDiversity)||0)+kt,A.push(`Player ${N.id}: +${kt} VP for ${kt} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const kt=N.resources.gold||0;kt>0&&(j+=kt,X.goldAutomatic=(((ht=N.vpSources)==null?void 0:ht.goldAutomatic)||0)+kt,A.push(`Player ${N.id}: +${kt} VP for ${kt} gold resources`))}return j>0?{...N,victoryPoints:N.victoryPoints+j,vpSources:X}:N});return{...t,players:F,gameOver:!0,actionLog:[...t.actionLog.slice(-9),...A,"Game Over! All players are out of workers."]}}return Qn===0&&t.round<3&&!t.pendingRoundAdvance?{...t,pendingRoundAdvance:!0,lastUpdatedBy:t.myPlayerId,actionLog:[...t.actionLog.slice(-9),...Ge,..._.map(E=>`Player ${E.playerId}: +${E.vp} VP (${E.reason})`),...Mt.map(E=>`Player ${E.playerId}: Can now play all ${E.workers} workers!`),"Round complete! All players are out of patrons."].filter(Boolean)}:{...t,currentPlayer:Q,turnDirection:He,workerPlacedThisTurn:!1,workersToPlace:Yt,shopUsedAfterWorkers:!1,vpShopUsed:!1,skippedTurns:he,waitingForOthers:Hn,playersOutOfWorkers:p,players:q,lastUpdatedBy:t.myPlayerId,actionLog:[...t.actionLog.slice(-9),...Ge,..._.map(E=>`Player ${E.playerId}: +${E.vp} VP (${E.reason})`),...Mt.map(E=>`Player ${E.playerId}: Can now play all ${E.workers} workers!`),...ee.map(E=>`Player ${E}: Turn skipped (${U[E]} skips remaining)`)].filter(Boolean)};case"ADVANCE_ROUND":if(t.round>=3)return console.log("ADVANCE_ROUND: Already at round 3, ignoring"),t;console.log("ADVANCE_ROUND reducer called, current state:",{round:t.round,occupiedSpaces:t.occupiedSpaces,players:t.players.map(E=>({id:E.id,workersLeft:E.workersLeft}))});const _s=[],Bo=t.players.map(E=>{var N,j;let A=0;const F={...E.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const X=Object.entries(E.resources).filter(([Pr,ht])=>ht>0).length;X>0&&(A+=X,F.yellowDiversity=(((N=E.vpSources)==null?void 0:N.yellowDiversity)||0)+X,_s.push(`Player ${E.id}: +${X} VP for ${X} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const X=E.resources.gold||0;X>0&&(A+=X,F.goldAutomatic=(((j=E.vpSources)==null?void 0:j.goldAutomatic)||0)+X,_s.push(`Player ${E.id}: +${X} VP for ${X} gold resources`))}return A>0?{...E,victoryPoints:E.victoryPoints+A,vpSources:F}:E});let Zl=Bo;if(t.gameLayers&&t.gameLayers.silver){let E=Math.max(...Bo.map(N=>N.victoryPoints));const F=Bo.filter(N=>N.victoryPoints===E).map(N=>N.id);Zl=Bo.map(N=>{var j;return F.includes(N.id)?(_s.push(`Player ${N.id}: +3 Silver (most VP)`),{...N,resources:{...N.resources,silver:(N.resources.silver||0)+3}}):(_s.push(`Player ${N.id}: +2 VP (Silver automatic)`),{...N,victoryPoints:N.victoryPoints+2,vpSources:{...N.vpSources,silverAutomatic:(((j=N.vpSources)==null?void 0:j.silverAutomatic)||0)+2}})})}const Wo=t.round+1,Yd={...t.closedShops};(t.gameLayers?Object.keys(t.gameLayers):[]).forEach(E=>{const A=`${E}${Wo}`;console.log(`Opening shop ${A} for round ${Wo}`),delete Yd[A]});const Qd=[...Zl].sort((E,A)=>E.victoryPoints-A.victoryPoints).map(E=>E.id),Kd=Wo>3;Kd&&console.log("ADVANCE_ROUND: Game is over! Setting gameOver to true");const Sr={...t,round:Wo,gameOver:Kd,closedShops:Yd,players:Zl.map(E=>{const A=3+(t.round+1),N=(E.effects||[]).some(j=>j.includes("Will get 2 extra workers next round"))?2:0;return{...E,workersLeft:A+N,effects:(E.effects||[]).filter(j=>!j.includes("Will get 2 extra workers next round")&&!j.includes("more workers this turn")),shopCostModifier:0}}),occupiedSpaces:{},turnOrder:Qd,currentPlayer:Qd[0],turnDirection:1,workerPlacedThisTurn:!1,workersToPlace:1,shopUsedAfterWorkers:!1,vpShopUsed:!1,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],roundAdvancing:!1,pendingRoundAdvance:!1,lastUpdatedBy:t.myPlayerId,actionLog:[...t.actionLog.slice(-9),..._s,`Round ${t.round+1} started! Extra workers applied.`]};return console.log("ADVANCE_ROUND - New state:",{round:Sr.round,occupiedSpaces:Sr.occupiedSpaces,players:Sr.players.map(E=>({id:E.id,workersLeft:E.workersLeft})),turnOrder:Sr.turnOrder,currentPlayer:Sr.currentPlayer}),Sr;case"ADD_LOG":return{...t,actionLog:[...t.actionLog.slice(-9),e.message]};case"ADD_NOTIFICATION":return!t.roomCode||!e.notification?t:{...t,notifications:[...t.notifications,{id:Date.now(),...e.notification,timestamp:Date.now()}].slice(-5)};case"CLEAR_NOTIFICATION":return{...t,notifications:t.notifications.filter(E=>E.id!==e.id)};case"RESET_GAME":const P_=zd(4);return{...hl,players:hl.players.map((E,A)=>({...E,emoji:e.preserveEmojis&&t.players[A]?t.players[A].emoji:P_[A]}))};case"SHOW_MODAL":const C_=((s=e.modal)==null?void 0:s.targetPlayerId)&&e.modal.targetPlayerId!==t.myPlayerId&&t.myPlayerId===t.currentPlayer;return{...t,modal:e.modal,waitingForPlayer:C_?e.modal.targetPlayerId:null};case"HIDE_MODAL":return{...t,modal:null,waitingForPlayer:null};case"UNDO_LAST_WORKER":const qd={...t.occupiedSpaces};return delete qd[e.actionId],{...t,occupiedSpaces:qd,players:t.players.map(E=>E.id===e.playerId?{...E,workersLeft:E.workersLeft+1}:E),workerPlacedThisTurn:!1,workersToPlace:t.workersToPlace+1};case"UPDATE_OCCUPIED_SPACES":return{...t,occupiedSpaces:e.occupiedSpaces,lastUpdatedBy:t.myPlayerId};case"SET_TURN_ORDER":return{...t,turnOrder:e.turnOrder};case"CLOSE_SHOP":return console.log("CLOSE_SHOP action:",e.shopId),{...t,closedShops:{...t.closedShops,[e.shopId]:!0},lastUpdatedBy:t.myPlayerId};case"OPEN_SHOP":console.log("OPEN_SHOP action:",e.shopId);const Xd={...t.closedShops};return delete Xd[e.shopId],{...t,closedShops:Xd,lastUpdatedBy:t.myPlayerId};case"FLIP_ALL_SHOPS":const jo={},k_=t.gameLayers?Object.keys(t.gameLayers):["red","yellow","blue","purple"],T_=[1,2,3];return k_.forEach(E=>{T_.forEach(F=>{const N=`${E}${F}`;jo[N]=!t.closedShops[N]});const A=`${E}vp`;jo[A]=!t.closedShops[A]}),t.roomCode&&e.playerId&&e.playerId!==t.myPlayerId?{...t,closedShops:jo,notifications:[...t.notifications,{id:Date.now(),type:"shop_toggle",icon:"",title:"All Shops Toggled!",message:`${e.playerName||`Player ${e.playerId}`} flipped all shop statuses`,timestamp:Date.now()}].slice(-5),lastUpdatedBy:t.myPlayerId}:{...t,closedShops:jo,lastUpdatedBy:t.myPlayerId};case"ADD_SHOP_COST_MODIFIER":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,shopCostModifier:(E.shopCostModifier||0)+e.modifier}:E)};case"USE_SHOP":return{...t,shopUsedAfterWorkers:!0,lastUpdatedBy:t.myPlayerId};case"USE_VP_SHOP":return{...t,vpShopUsed:!0,lastUpdatedBy:t.myPlayerId};case"SET_ROOM_INFO":return{...t,roomCode:e.roomCode,isHost:e.isHost};case"SET_MY_PLAYER_INFO":return{...t,myPlayerId:e.playerId,myPlayerName:e.playerName};case"UPDATE_CONNECTED_PLAYERS":return{...t,connectedPlayers:e.connectedPlayers};case"START_GAME":const ea={};(t.gameLayers?Object.keys(t.gameLayers):["red","yellow","blue","black"]).forEach(E=>{ea[`${E}2`]=!0,ea[`${E}3`]=!0});let Jd=t.players;t.gameLayers&&t.gameLayers.white&&(Jd=t.players.map(E=>({...E,victoryPoints:E.victoryPoints+5,vpSources:{...E.vpSources,whiteStarting:5}})));const Kn=[...t.turnOrder];for(let E=Kn.length-1;E>0;E--){const A=Math.floor(Math.random()*(E+1));[Kn[E],Kn[A]]=[Kn[A],Kn[E]]}return{...t,gameStarted:!0,closedShops:ea,players:Jd,turnOrder:Kn,currentPlayer:Kn[0]};case"SET_GAME_LAYERS":const Zd={};return e.layers.blue&&(Zd.blue=!0),{...t,gameLayers:e.layers,automaticVPs:Zd};case"SET_GAME_MODE":return{...t,gameMode:e.mode};case"UPDATE_CONNECTION_STATUS":return{...t,connectionStatus:e.status};case"SET_SKIPPED_TURNS":return{...t,skippedTurns:e.skippedTurns};case"SET_WAITING_FOR_OTHERS":return{...t,waitingForOthers:e.waitingForOthers};case"REMOVE_WORKER":const ef={...t.occupiedSpaces};return delete ef[e.actionId],{...t,occupiedSpaces:ef,players:t.players.map(E=>E.id===e.playerId?{...E,workersLeft:E.workersLeft+1}:E)};case"CLEAR_SYNC_FLAG":return{...t,justSyncedFromFirebase:!1};case"SYNC_GAME_STATE":if(console.log("SYNC_GAME_STATE reducer called with:",{round:e.gameState.round,currentPlayer:e.gameState.currentPlayer,myPlayerId:t.myPlayerId,gameStarted:e.gameState.gameStarted,gameLayers:e.gameState.gameLayers?Object.keys(e.gameState.gameLayers):null,occupiedSpaces:e.gameState.occupiedSpaces,closedShops:e.gameState.closedShops,players:(o=e.gameState.players)==null?void 0:o.map(E=>({id:E.id,resources:E.resources,workersLeft:E.workersLeft}))}),e.gameState.players&&(console.log("SYNC_GAME_STATE - Player 1 resources from Firebase:",(i=e.gameState.players.find(E=>E.id===1))==null?void 0:i.resources),console.log("SYNC_GAME_STATE - All players from Firebase:",e.gameState.players)),console.log("SYNC_GAME_STATE - Echo detection:",{lastUpdatedBy:e.gameState.lastUpdatedBy,myPlayerId:t.myPlayerId,isOurUpdate:e.gameState.lastUpdatedBy===t.myPlayerId}),e.gameState.lastUpdatedBy&&t.myPlayerId&&e.gameState.lastUpdatedBy===t.myPlayerId)return console.log("SYNC_GAME_STATE - Ignoring our own update echo"),t;const Qt={...t,...e.gameState,syncingFromFirebase:!0,occupiedSpaces:e.gameState.occupiedSpaces||{},players:e.gameState.players?e.gameState.players.map(E=>({...E,effects:E.effects||[],emoji:E.emoji||Ls[E.id-1]||"",resources:E.resources||{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},vpSources:E.vpSources||{},shopCostModifier:E.shopCostModifier!==void 0?E.shopCostModifier:0})):t.players,roomCode:t.roomCode,myPlayerId:t.myPlayerId,myPlayerName:t.myPlayerName,connectedPlayers:t.connectedPlayers,isHost:t.isHost,gameStarted:e.gameState.gameStarted!==void 0?e.gameState.gameStarted:t.gameStarted,connectionStatus:t.connectionStatus,gameLayers:e.gameState.gameLayers||t.gameLayers,closedShops:e.gameState.closedShops||t.closedShops,automaticVPs:e.gameState.automaticVPs||t.automaticVPs,pendingPlacements:e.gameState.pendingPlacements||{},lastSyncTimestamp:e.gameState.timestamp||Date.now(),justSyncedFromFirebase:!0};return console.log(" SYNC_GAME_STATE - After merge, new state:",{myPlayerId:Qt.myPlayerId,currentPlayer:Qt.currentPlayer,turnMatch:Qt.myPlayerId===Qt.currentPlayer,round:Qt.round,gameOver:Qt.gameOver,occupiedSpaces:Qt.occupiedSpaces,players:(l=Qt.players)==null?void 0:l.map(E=>({id:E.id,name:E.name,emoji:E.emoji,resources:E.resources,workersLeft:E.workersLeft}))}),Qt;case"SET_PENDING_PLACEMENT":return{...t,pendingPlacements:{...t.pendingPlacements,[e.actionId]:e.playerId}};case"CLEAR_PENDING_PLACEMENT":const tf={...t.pendingPlacements};return delete tf[e.actionId],{...t,pendingPlacements:tf};default:return t}})();return n!==t&&console.log("Reducer returning new state for action:",e.type),n}const ZC={apiKey:"AIzaSyB0c0iUOG3llUzLd9FhQ6Qc1qCB0DoajVw",authDomain:"cornycolonies.firebaseapp.com",databaseURL:"https://cornycolonies-default-rtdb.firebaseio.com",projectId:"cornycolonies",storageBucket:"cornycolonies.firebasestorage.app",messagingSenderId:"566795956627",appId:"1:566795956627:web:585b66a3277696f3b0b866"};let xe=null;try{typeof firebase<"u"&&(firebase.initializeApp(ZC),xe=firebase.database())}catch{console.log("Firebase not available, using local mode")}const __=$e.createContext();function ek({children:t}){const[e,n]=$e.useReducer(JC,hl);return(window.location.search.includes("test=true")||window.location.search.includes("debug=true"))&&(window.lastKnownState=e,window.lastKnownDispatch=n),v.createElement(__.Provider,{value:{state:e,dispatch:n}},t)}function Fe(){const t=$e.useContext(__);if(!t)throw new Error("useGame must be used within a GameProvider");return t}function tk(){return Math.random().toString(36).substring(2,8).toUpperCase()}function nk(t,e){const n=tk(),r=1;if(xe){t({type:"UPDATE_CONNECTION_STATUS",status:"connecting"});const s=Date.now(),o=24*60*60*1e3;xe.ref("rooms").once("value").then(a=>{const u=a.val()||{},f=[];return Object.keys(u).forEach(c=>{const d=u[c];d.createdAt&&s-d.createdAt>o&&(console.log(`Deleting old room: ${c} (${Math.floor((s-d.createdAt)/1e3/60/60)} hours old)`),f.push(xe.ref(`rooms/${c}`).remove()))}),Promise.all(f)}).then(()=>{console.log("Old rooms cleaned up, creating new room")}).catch(a=>{console.warn("Failed to clean up old rooms:",a)});const i=xe.ref(`rooms/${n}`),l=setTimeout(()=>{console.error("Room creation timeout"),alert("Failed to create room - connection timeout. Please try local mode or set up Firebase."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})},5e3);i.set({createdAt:Date.now(),host:r,gameState:{...hl,gameStarted:!1},players:{[r]:{id:r,name:e,connected:!0,joinedAt:Date.now()}}}).then(()=>{clearTimeout(l),t({type:"SET_ROOM_INFO",roomCode:n,isHost:!0}),t({type:"SET_MY_PLAYER_INFO",playerId:r,playerName:e}),t({type:"UPDATE_CONNECTION_STATUS",status:"connected"}),E_(n,t,r)}).catch(a=>{clearTimeout(l),console.error("Error creating room:",a),alert("Failed to create room. Firebase is not properly configured. Please use local mode for now."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})})}else alert("Multiplayer requires Firebase setup. Please use local mode for now."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})}function rk(t,e,n){if(xe){t({type:"UPDATE_CONNECTION_STATUS",status:"connecting"});const r=setTimeout(()=>{console.error("Room join timeout"),alert("Failed to join room - connection timeout. Please try local mode or check the room code."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})},5e3),s=xe.ref(`rooms/${e}`);s.once("value").then(o=>{if(clearTimeout(r),o.exists()){const i=o.val(),l=i.players||{};let a=null;for(let u=1;u<=4;u++)if(!l[u]||!l[u].connected){a=u;break}a?s.child(`players/${a}`).set({id:a,name:n,connected:!0,joinedAt:Date.now()}).then(()=>{t({type:"SET_ROOM_INFO",roomCode:e,isHost:!1}),t({type:"SET_MY_PLAYER_INFO",playerId:a,playerName:n}),t({type:"UPDATE_CONNECTION_STATUS",status:"connected"}),i.gameState&&t({type:"SYNC_GAME_STATE",gameState:i.gameState}),E_(e,t,a)}):(alert("Room is full (4 players max)"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"}))}else alert("Room not found"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})}).catch(o=>{console.error("Error joining room:",o),alert("Failed to join room"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})})}else alert("Firebase not available. Using local mode.")}let Pi=null,Tr=0;function v_(t,e,n){if(Tr>=fp){console.error("Max reconnection attempts reached"),e({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"}),alert("Connection lost. Please refresh the page to rejoin.");return}Tr++;const r=XC*Math.pow(2,Tr-1);console.log(`Attempting to reconnect (attempt ${Tr}/${fp}) in ${r}ms...`),Pi=setTimeout(()=>{xe.ref(`rooms/${t}/players/${n}/connected`).set(!0).then(()=>{console.log("Reconnection successful"),Tr=0,e({type:"UPDATE_CONNECTION_STATUS",status:"connected"})}).catch(s=>{console.error("Reconnection failed:",s),v_(t,e,n)})},r)}function E_(t,e,n){if(!xe)return;const r=xe.ref(`rooms/${t}`);r.child("players").on("value",i=>{const l=i.val()||{};e({type:"UPDATE_CONNECTED_PLAYERS",connectedPlayers:l});const a=Object.values(l).filter(f=>f.connected);!a.find(f=>f.id===1)&&a.length>0&&a.reduce((c,d)=>d.id<c.id?d:c).id===n&&(e({type:"SET_ROOM_INFO",roomCode:t,isHost:!0}),console.log(`Player ${n} is now the host`))});let s=0;r.child("gameState").on("value",i=>{var a;const l=i.val();if(l){if(l.timestamp&&l.timestamp<=s){console.log("Skipping older gameState update:",l.timestamp,"<=",s);return}console.log("Firebase gameState update received:",{round:l.round,currentPlayer:l.currentPlayer,gameOver:l.gameOver,lastUpdatedBy:l.lastUpdatedBy,timestamp:l.timestamp,occupiedSpaces:l.occupiedSpaces,players:(a=l.players)==null?void 0:a.map(u=>({id:u.id,resources:u.resources,workersLeft:u.workersLeft}))}),s=l.timestamp||Date.now(),e({type:"SYNC_GAME_STATE",gameState:l})}}),r.child(`players/${n}/connected`).onDisconnect().set(!1),xe.ref(".info/connected").on("value",i=>{i.val()===!0?(console.log("Firebase connection established"),Pi&&(clearTimeout(Pi),Pi=null),Tr=0,e({type:"UPDATE_CONNECTION_STATUS",status:"connected"})):(console.log("Firebase connection lost"),e({type:"UPDATE_CONNECTION_STATUS",status:"reconnecting"}),v_(t,e,n))})}let ci=!1;function sk(t,e){var n,r;if(xe&&t&&!ci){ci=!0,console.log("syncGameState - Syncing to Firebase:",{roomCode:t,round:e.round,currentPlayer:e.currentPlayer,gameOver:e.gameOver,lastUpdatedBy:e.lastUpdatedBy,occupiedSpaces:e.occupiedSpaces,players:(n=e.players)==null?void 0:n.map(i=>({id:i.id,resources:i.resources,workersLeft:i.workersLeft}))});const s=(r=e.players)==null?void 0:r.find(i=>i.id===1);s&&console.log("syncGameState - Player 1 resources being sent:",s.resources);const o={...e,lastUpdatedBy:e.lastUpdatedBy||null,timestamp:e.timestamp||Date.now(),gameLayers:e.gameLayers||null};xe.ref(`rooms/${t}/gameState`).set(o).then(()=>{ci=!1}).catch(i=>{console.error("Failed to sync game state:",i),console.error("Problematic game state:",e),ci=!1})}}function pp(t,e,n=null,r="basic"){xe&&e&&xe.ref(`rooms/${e}/players`).once("value",s=>{const o=s.val()||{},i=Object.keys(o).length,l=zd(i),a=[];Object.values(o).forEach((h,y)=>{a.push({id:h.id,name:h.name,emoji:l[y],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0,lastGain:{}})});let u={};n&&n.blue&&(u.blue=!0);let f=a;n&&n.white&&(f=a.map(h=>({...h,victoryPoints:h.victoryPoints+5,vpSources:{...h.vpSources,whiteStart:5}})));const c={};(n?Object.keys(n):["red","yellow","blue","black"]).forEach(h=>{c[`${h}2`]=!0,c[`${h}3`]=!0});const m={currentPlayer:1,turnDirection:1,players:f,occupiedSpaces:{},round:1,turnOrder:a.map(h=>h.id),workerPlacedThisTurn:!1,workersToPlace:1,actionLog:[],gameStarted:!0,gameLayers:n,gameMode:r,automaticVPs:u,closedShops:c,shopUsedAfterWorkers:!1,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],gameOver:!1,timestamp:Date.now(),lastUpdatedBy:0};console.log(" Starting multiplayer game with state:",{currentPlayer:m.currentPlayer,players:m.players.map(h=>({id:h.id,name:h.name,emoji:h.emoji})),playerCount:m.players.length,gameLayers:n?Object.keys(n):"null",gameMode:r,automaticVPs:u,lastUpdatedBy:m.lastUpdatedBy}),xe.ref(`rooms/${e}/gameState`).set(m).then(()=>{console.log("Game state successfully written to Firebase"),xe.ref(`rooms/${e}/lastUpdate`).set(Date.now())}).catch(h=>{console.error("Failed to write game state to Firebase:",h)})})}function ok(){const{state:t,dispatch:e}=Fe(),[n,r]=$e.useState(""),[s,o]=$e.useState(""),[i,l]=$e.useState("menu"),[a,u]=$e.useState(null),f=()=>{if(!n.trim()){alert("Please enter your name");return}nk(e,n.trim())},c=()=>{if(!n.trim()){alert("Please enter your name");return}if(!s.trim()){alert("Please enter room code");return}rk(e,s.trim().toUpperCase(),n.trim())},d=()=>{l("gameMode")},m=h=>{const y=fl(4,h);e({type:"SET_GAME_MODE",mode:h}),e({type:"SET_GAME_LAYERS",layers:y}),e({type:"START_GAME"})};return v.createElement("div",{className:"min-h-screen flex items-center justify-center p-4"},v.createElement("div",{className:"glass rounded-xl shadow-2xl p-8 max-w-md w-full"},[v.createElement("div",{key:"header",className:"text-center mb-8"},[v.createElement("h1",{key:"title",className:"text-3xl font-bold text-gray-800 mb-2"},"Patrons"),v.createElement("p",{key:"subtitle",className:"text-gray-600"},"Choose your game mode")]),i==="menu"&&v.createElement("div",{key:"menu",className:"space-y-4"},[v.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:h=>r(h.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),v.createElement("button",{key:"create",onClick:()=>l("create"),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Create Online Game"),v.createElement("button",{key:"join",onClick:()=>l("join"),className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Join Online Game"),v.createElement("button",{key:"local",onClick:d,className:"w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Play Local (Same Device)")]),i==="create"&&v.createElement("div",{key:"create",className:"space-y-4"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Create Room"),v.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:h=>r(h.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),v.createElement("button",{key:"create",onClick:f,disabled:t.connectionStatus==="connecting",className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 disabled:transform-none"},t.connectionStatus==="connecting"?"Creating...":"Create Room"),v.createElement("button",{key:"back",onClick:()=>l("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")]),i==="join"&&v.createElement("div",{key:"join",className:"space-y-4"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Join Room"),v.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:h=>r(h.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),v.createElement("input",{key:"code",type:"text",placeholder:"Enter room code",value:s,onChange:h=>o(h.target.value.toUpperCase()),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"}),v.createElement("button",{key:"join",onClick:c,disabled:t.connectionStatus==="connecting",className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 disabled:transform-none"},t.connectionStatus==="connecting"?"Joining...":"Join Room"),v.createElement("button",{key:"back",onClick:()=>l("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")]),i==="gameMode"&&v.createElement("div",{key:"gameMode",className:"space-y-4"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Select Game Mode"),v.createElement("div",{key:"description",className:"text-sm text-gray-600 text-center mb-6 space-y-2"},[v.createElement("p",{key:"basic"},"Basic: Play with the classic 4 colors (Red, Yellow, Blue, Black)"),v.createElement("p",{key:"advanced"},"Advanced: Play with 4 randomly selected colors from all 8 available")]),v.createElement("button",{key:"basic",onClick:()=>m("basic"),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Basic Mode"),v.createElement("button",{key:"advanced",onClick:()=>m("advanced"),className:"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Advanced Mode"),v.createElement("button",{key:"back",onClick:()=>l("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")])]))}function mp(){const{state:t,dispatch:e}=Fe(),n=Object.keys(t.connectedPlayers).length,[r,s]=$e.useState(!1),[o,i]=$e.useState("basic"),l=()=>{n>=2?s(!0):alert("Need at least 2 players to start")},a=()=>{confirm("Are you sure you want to leave the room?")&&window.location.reload()};return t.gameStarted?null:v.createElement("div",{className:"glass rounded-lg p-4 mb-6"},[v.createElement("div",{key:"header",className:"flex justify-between items-center mb-4"},[v.createElement("div",{key:"info"},[v.createElement("h3",{key:"title",className:"text-lg font-bold text-gray-800"},`Room: ${t.roomCode}`),v.createElement("p",{key:"count",className:"text-sm text-gray-600"},`${n}/4 players connected`)]),v.createElement("button",{key:"leave",onClick:a,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm"},"Leave")]),v.createElement("div",{key:"players",className:"grid grid-cols-2 gap-2 mb-4"},Object.values(t.connectedPlayers).map(u=>v.createElement("div",{key:u.id,className:`p-2 rounded border-2 ${u.connected?"border-green-400 bg-green-50":"border-gray-300 bg-gray-50"} ${u.id===t.myPlayerId?"ring-2 ring-blue-400":""}`},[v.createElement("div",{key:"name",className:"font-semibold"},`Player ${u.id}: ${u.name}`),v.createElement("div",{key:"status",className:`text-xs ${u.connected?"text-green-600":"text-gray-500"}`},u.connected?" Connected":u.id===t.myPlayerId&&t.connectionStatus==="reconnecting"?" Reconnecting...":" Disconnected"),u.id===t.myPlayerId&&v.createElement("div",{key:"you",className:"text-xs text-blue-600 font-bold"},"(You)")]))),t.isHost&&!t.gameStarted&&!r&&v.createElement("button",{key:"start",onClick:l,disabled:n<2,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-all duration-200"},n>=2?"Start Game":"Need 2+ Players to Start"),r&&v.createElement("div",{key:"gameMode",className:"space-y-3 mt-4"},[v.createElement("h4",{key:"title",className:"text-md font-bold text-center"},"Select Game Mode"),v.createElement("div",{key:"buttons",className:"flex gap-2"},[v.createElement("button",{key:"basic",onClick:()=>{console.log("Starting game with",n,"players in basic mode");const u=fl(n,"basic");console.log("Selected layers:",Object.keys(u)),e({type:"SET_GAME_MODE",mode:"basic"}),e({type:"SET_GAME_LAYERS",layers:u}),pp(e,t.roomCode,u,"basic"),console.log("Game started successfully")},className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-3 rounded-lg text-sm"},"Basic"),v.createElement("button",{key:"advanced",onClick:()=>{console.log("Starting game with",n,"players in advanced mode");const u=fl(n,"advanced");console.log("Selected layers:",Object.keys(u)),e({type:"SET_GAME_MODE",mode:"advanced"}),e({type:"SET_GAME_LAYERS",layers:u}),pp(e,t.roomCode,u,"advanced"),console.log("Game started successfully")},className:"flex-1 bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-3 rounded-lg text-sm"},"Advanced"),v.createElement("button",{key:"cancel",onClick:()=>s(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 rounded-lg text-sm"},"Cancel")])])])}function ik({notifications:t,myPlayerId:e}){const n=t.filter(r=>!r.forPlayer||r.forPlayer===e);return n.length===0?null:v.createElement("div",{className:"fixed top-4 right-4 z-50 space-y-2"},n.slice(-3).map(r=>v.createElement("div",{key:r.id,className:"bg-gray-800 text-white p-4 rounded-lg shadow-lg transform transition-all duration-300 hover:scale-105",style:{minWidth:"300px"}},[v.createElement("div",{key:"header",className:"flex items-center gap-2 mb-1"},[v.createElement("span",{key:"icon",className:"text-2xl"},r.icon||""),v.createElement("span",{key:"title",className:"font-bold"},r.title)]),v.createElement("div",{key:"message",className:"text-sm opacity-90"},r.message),v.createElement("div",{key:"time",className:"text-xs opacity-60 mt-1"},`${Math.floor((Date.now()-r.timestamp)/1e3)}s ago`)])))}function lk({actionId:t,title:e,description:n,round:r,available:s=!0,compact:o=!1}){const{state:i,dispatch:l}=Fe(),a=i.occupiedSpaces[t],u=a?i.players.find(y=>y.id===a):null,f=i.pendingPlacements&&i.pendingPlacements[t],c=async()=>{if(a||!s)return;if(console.log(" Turn Validation:",{roomCode:i.roomCode,myPlayerId:i.myPlayerId,currentPlayer:i.currentPlayer,match:i.myPlayerId===i.currentPlayer,canPlay:!i.roomCode||i.myPlayerId===i.currentPlayer}),i.roomCode&&i.myPlayerId!==i.currentPlayer){console.error(" Turn validation failed!",{myPlayerId:i.myPlayerId,myPlayerType:typeof i.myPlayerId,currentPlayer:i.currentPlayer,currentPlayerType:typeof i.currentPlayer,playersInState:i.players.map(g=>({id:g.id,name:g.name,emoji:g.emoji})),roomCode:i.roomCode,isHost:i.isHost}),alert("It's not your turn!");return}if(i.roomCode&&i.pendingPlacements&&i.pendingPlacements[t]){alert("Another player is placing a patron here!");return}const y=i.players.find(g=>g.id===i.currentPlayer);if(i.workersToPlace<=0){alert("You have already placed all your patrons this turn. End your turn or buy from shops.");return}if(y.workersLeft<=0&&i.workersToPlace<=1){alert("You have no patrons left to place!");return}if((t==="redHybrid1"||t==="redHybrid2")&&Object.entries(i.occupiedSpaces).filter(([p,_])=>_===i.currentPlayer&&p!==t).length===0){const p=[];if(Object.entries(i.gameLayers||{}).forEach(([_,w])=>{w.actions.forEach(P=>{P.round<=i.round&&!i.occupiedSpaces[P.id]&&p.push(P.id)})}),p.length>1&&!confirm("WARNING: You have no other patrons on the board to swap! This action will only give you the resource bonus. Continue anyway?"))return}if(t==="gain2purpleTakeBack"&&Object.entries(i.occupiedSpaces).filter(([p,_])=>_!==i.currentPlayer?!1:!(i.gameLayers.purple&&i.gameLayers.purple.actions.some(P=>P.id===p))).length===0){const p=[];if(Object.entries(i.gameLayers||{}).forEach(([_,w])=>{w.actions.forEach(P=>{P.round<=i.round&&!i.occupiedSpaces[P.id]&&p.push(P.id)})}),p.length>1&&!confirm("WARNING: You have no patrons on non-purple quads to take back! This action will only give you the purple resources. Continue anyway?"))return}if(t==="playTwoWorkers"&&y.workersLeft<2&&!confirm(`WARNING: You only have ${y.workersLeft} patron(s) left. You won't be able to place 2 patrons. Continue anyway?`)||t==="playThreeWorkers"&&y.workersLeft<3&&!confirm(`WARNING: You only have ${y.workersLeft} patron(s) left. You won't be able to place 3 patrons. Continue anyway?`))return;if(t==="gain4purpleWaitAll"){const g=(y.effects||[]).some(_=>_.includes("Will take an extra turn after this one")),p=(y.extraTurns||0)>0;if((g||p)&&!confirm("WARNING: You already have an extra turn queued! This action will have no additional effect. Continue anyway?"))return}if(t==="spend2AnyFor3VP"){const g=Object.values(y.resources).reduce((p,_)=>p+_,0);if(g<2&&!confirm("WARNING: You need at least 2 resources to use this action. You only have "+g+". Continue anyway?"))return}if(t==="spend1AnyFor2VP"&&Object.values(y.resources).reduce((p,_)=>p+_,0)<1&&!confirm("WARNING: You need at least 1 resource to use this action. You have none. Continue anyway?"))return;const S={actionId:t,playerId:i.currentPlayer};i.roomCode&&l({type:"SET_PENDING_PLACEMENT",actionId:t,playerId:i.myPlayerId});try{l({type:"PLACE_WORKER",actionId:t});const g={...i,occupiedSpaces:{...i.occupiedSpaces,[t]:i.currentPlayer},players:i.players.map(w=>w.id===i.currentPlayer?{...w,workersLeft:w.workersLeft-1}:w),workerPlacedThisTurn:!0,workersToPlace:Math.max(0,i.workersToPlace-1)},p=g.players.find(w=>w.id===i.currentPlayer);await Ot(t,p,l,g,i.gameLayers,0,S);const _=`Action completed: ${t} for Player ${y.id}`;l({type:"ADD_LOG",message:_}),console.log(_)}finally{i.roomCode&&l({type:"CLEAR_PENDING_PLACEMENT",actionId:t})}},d=()=>r===1?"bg-gray-100 border-gray-300":r===2?"bg-green-100 border-green-500":r===3?"bg-yellow-100 border-yellow-500":"bg-gray-100 border-gray-300",m=()=>s?a?"bg-red-50 border-red-500 cursor-not-allowed":f?"bg-yellow-50 border-yellow-500 cursor-wait animate-pulse":"hover:bg-blue-50 hover:border-blue-500 hover:shadow-md cursor-pointer transition-all duration-150 border-blue-300":"opacity-60 cursor-not-allowed bg-gray-200 border-gray-400",h=()=>{const y="absolute top-0.5 left-0.5 px-1.5 py-0.5 rounded-full text-xs font-bold text-white shadow";switch(r){case 1:return`${y} bg-gray-500`;case 2:return`${y} bg-green-500`;case 3:return`${y} bg-yellow-600`;default:return`${y} bg-gray-500`}};return v.createElement("div",{className:`relative border-2 rounded-lg flex flex-col p-1.5 min-h-[60px] transition-all duration-150 shadow-sm ${d()} ${m()}`,onClick:c},[v.createElement("div",{key:"round-indicator",className:h()},`R${r}`),u&&v.createElement("div",{key:"worker",className:"absolute top-0.5 right-0.5 text-xl drop-shadow-lg"},u.emoji||u.id),v.createElement("div",{key:"title",className:`font-bold text-xs mb-0.5 px-5 text-center ${s?"text-gray-900":"text-gray-500"}`},e),v.createElement("div",{key:"desc",className:`text-xs text-center px-1 ${s?"text-gray-600":"text-gray-400"} leading-tight`},n)])}function gp(t,e){const n=e==null?void 0:e.red;return n?n.actions.some(r=>r.id===t):!1}async function Ot(t,e,n,r,s,o=0,i=null){var a,u;if(o>5){n({type:"ADD_LOG",message:" Max recursion depth reached - stopping to prevent infinite loop"});return}o>0&&n({type:"ADD_LOG",message:` Action chain depth: ${o}`});const l={gain3red:{red:3},gain2red:{red:2},gain3blue:{blue:3},gain2blue:{blue:2},gain3purple:{purple:3},gain2purple:{purple:2},gain2gold:{gold:2},gain1gold:{gold:1},gain3white:{white:3},gain2white:{white:2},gain3black:{black:3},gain2black:{black:2},gain3silver:{silver:3},gain2silver:{silver:2}};if(l[t]){let f={...l[t]};if((e.effects||[]).some(d=>d.includes("Next gain will be doubled"))){Object.keys(f).forEach(m=>{f[m]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(m=>!m.includes("Next gain will be doubled"))});const d=`Player ${e.id}: ${t}  +${Object.entries(f).map(([m,h])=>`${h} ${m}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:d})}else{const d=`Player ${e.id}: ${t}  +${Object.entries(f).map(([m,h])=>`${h} ${m}`).join(", ")}`;n({type:"ADD_LOG",message:d})}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f}),t.includes("red")&&o===0&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`}));return}if(t==="gain3yellow"){const f=(i==null?void 0:i.playerId)||e.id,c=r.players.find(p=>p.id===f),d=i&&i.placedBy&&i.placedBy!==f,h=await pe(n,d?"Your patron was placed! Select 3 Resources ( Colors):":"Select 3 Resources ( Colors)",3,null,i,d?f:null);if(console.log("gain3yellow - selectedGems:",h),!h){n({type:"UPDATE_RESOURCES",playerId:f,resources:{red:1,yellow:1,blue:1}});const _=`Player ${f}: gain3yellow  +1 red, +1 yellow, +1 blue (default)`;n({type:"ADD_LOG",message:_});return}const y=h;console.log("gain3yellow - resources object before processing:",y),console.log("gain3yellow - actualPlayerId:",f),console.log("gain3yellow - actualPlayer:",c);const S={};if(Object.entries(y).forEach(([p,_])=>{_>0&&(S[p]=_)}),console.log("gain3yellow - filteredResources (zeros removed):",S),(c.effects||[]).some(p=>p.includes("Next gain will be doubled"))){Object.keys(S).forEach(_=>{S[_]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:f,effects:(c.effects||[]).filter(_=>!_.includes("Next gain will be doubled"))});const p=`Player ${f}: ${t}  +${Object.entries(S).map(([_,w])=>`${w} ${_}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:p})}else{const p=`Player ${f}: ${t}  +${Object.entries(S).map(([_,w])=>`${w} ${_}`).join(", ")}`;n({type:"ADD_LOG",message:p})}console.log("gain3yellow - About to dispatch UPDATE_RESOURCES with:",{type:"UPDATE_RESOURCES",playerId:f,resources:S});try{n({type:"UPDATE_RESOURCES",playerId:f,resources:S}),console.log("gain3yellow - UPDATE_RESOURCES dispatched successfully")}catch(p){console.error("gain3yellow - Error dispatching UPDATE_RESOURCES:",p)}return}if(t==="gain2yellow"){console.log("gain2yellow - Starting for player",e.id,"workerInfo:",i);const f=(i==null?void 0:i.playerId)||e.id,c=r.players.find(g=>g.id===f);console.log("gain2yellow - actualPlayerId:",f,"actualPlayer:",c);const d=i&&i.placedBy&&i.placedBy!==f,h=await pe(n,d?"Your patron was placed! Select 2 Resources ( Colors):":"Select 2 Resources ( Colors)",2,null,i,d?f:null);if(console.log("gain2yellow - selectedGems:",h),!h){const g={red:1,yellow:1};console.log("gain2yellow - Using default resources:",g),n({type:"UPDATE_RESOURCES",playerId:f,resources:g});const p=`Player ${f}: gain2yellow  +1 red, +1 yellow (default)`;n({type:"ADD_LOG",message:p});return}const y=h;if(console.log("gain2yellow - resources object:",y),(c.effects||[]).some(g=>g.includes("Next gain will be doubled"))){Object.keys(y).forEach(p=>{y[p]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:f,effects:(c.effects||[]).filter(p=>!p.includes("Next gain will be doubled"))});const g=`Player ${f}: ${t}  +${Object.entries(y).map(([p,_])=>`${_} ${p}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:g})}else{const g=`Player ${f}: ${t}  +${Object.entries(y).map(([p,_])=>`${_} ${p}`).join(", ")}`;n({type:"ADD_LOG",message:g})}console.log("gain2yellow - About to dispatch UPDATE_RESOURCES with:",{playerId:f,resources:y}),n({type:"UPDATE_RESOURCES",playerId:f,resources:y});return}if(t==="playTwoWorkers"){const f=e.workersLeft,c=Math.min(2,f);if(c===0){const m=`Player ${e.id}: playTwoWorkers  No patrons left to place`;n({type:"ADD_LOG",message:m});return}n({type:"ADD_WORKERS_TO_PLACE",count:c}),n({type:"ADD_EFFECT",playerId:e.id,effect:`Can place ${c} more patron${c>1?"s":""} this turn`});const d=`Player ${e.id}: playTwoWorkers  Can now place ${c} MORE patron${c>1?"s":""} this turn`;n({type:"ADD_LOG",message:d}),console.log(d);return}if(t==="gain4purpleSkip"){const f=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let c=4;f&&(c*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:c}});const d={...r.skippedTurns};d[e.id]=(d[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:d});const m=`Player ${e.id}: gain4purpleSkip  +${c} purple${f?" (DOUBLED!)":""}, will skip next turn (total skips: ${d[e.id]})`;n({type:"ADD_LOG",message:m});return}if(t==="gain2purpleTakeBack"){const f=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let c=2;f&&(c*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:c}});const d=Object.entries(r.occupiedSpaces||{}).filter(([h,y])=>y!==e.id?!1:!(s.purple&&s.purple.actions.some(g=>g.id===h)));if(d.length>0){const h={};d.forEach(([S,g])=>{const p=Object.keys(s).find(_=>s[_].actions.some(w=>w.id===S));p&&(h[p]||(h[p]=[]),h[p].push(S))});const y=[];if(Object.entries(h).forEach(([S,g])=>{g.forEach(p=>{const _=s[S].actions.find(w=>w.id===p);_&&y.push({label:`${S} - ${_.title}`,value:p})})}),y.length>0){const S=await ye(n,"Choose a patron to take back",y);S&&(n({type:"REMOVE_WORKER",actionId:S,playerId:e.id}),n({type:"ADD_LOG",message:`Player ${e.id}: Took back patron from ${S}`}))}}const m=`Player ${e.id}: gain2purpleTakeBack  +${c} purple${f?" (DOUBLED!)":""} + take back patron`;n({type:"ADD_LOG",message:m});return}if(t==="gain5purpleSkip"){const f=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let c=5;f&&(c*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:c}});const d={...r.skippedTurns};d[e.id]=(d[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:d});const m=`Player ${e.id}: gain5purpleSkip  +${c} purple${f?" (DOUBLED!)":""}, will skip next turn (total skips: ${d[e.id]})`;n({type:"ADD_LOG",message:m});return}if(t==="playThreeWorkers"){const f=e.workersLeft,c=Math.min(3,f);if(c===0){const m=`Player ${e.id}: playThreeWorkers  No patrons left to place`;n({type:"ADD_LOG",message:m});return}n({type:"ADD_WORKERS_TO_PLACE",count:c}),n({type:"ADD_EFFECT",playerId:e.id,effect:`Can place ${c} more patron${c>1?"s":""} this turn`});const d=`Player ${e.id}: playThreeWorkers  Can now place ${c} MORE patron${c>1?"s":""} this turn`;n({type:"ADD_LOG",message:d});return}if(t==="gain4purpleWaitAll"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:4}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Will take an extra turn after this one"}),n({type:"UPDATE_PLAYER",playerId:e.id,updates:{extraTurns:(e.extraTurns||0)+1}});const f=`Player ${e.id}: gain4purpleWaitAll  +4 purple + extra turn after this one`;n({type:"ADD_LOG",message:f});return}if(t==="extraWorkers"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Will get 2 extra patrons next round"}),console.log(`Player ${e.id} will get 2 extra workers next round`);return}if(t==="purpleShopHybrid"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}});const c=await ye(n,"Choose  Round 1 shop benefit",[{label:" R1: Repeat patron action",value:"red1"},{label:" R1: Double next gain",value:"yellow1"},{label:" R1: Close  shop this round",value:"blue1"},{label:" R1: Take an extra turn after this one",value:"purple1"}]);if(c){switch(c){case"red1":await w_(e,n,r,s);break;case"yellow1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Next gain will be doubled"});break;case"blue1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Can close  shop this round"});break;case"purple1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Will take an extra turn after this one"}),n({type:"UPDATE_PLAYER",playerId:e.id,updates:{extraTurns:(e.extraTurns||0)+1}});break}const d={red1:"Repeat patron action",yellow1:"Double next gain",blue1:"Close shop ability",purple1:"Extra turn"},m=`Player ${e.id}: purpleShopHybrid  +1 purple + ${d[c]}`;n({type:"ADD_LOG",message:m})}return}if(t==="purpleHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}});const c=await ye(n,"Choose new turn order for next round",[{label:"1  2  3  4",value:[1,2,3,4]},{label:"4  3  2  1",value:[4,3,2,1]},{label:"2  1  4  3",value:[2,1,4,3]},{label:"3  4  1  2",value:[3,4,1,2]}]);if(c){n({type:"SET_TURN_ORDER",turnOrder:c});const d=`Player ${e.id}: purpleHybrid2  +1 purple + set turn order to ${c.join("  ")}`;n({type:"ADD_LOG",message:d})}return}if(t==="redRepeatAction"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const f=`DEBUG: Occupied spaces: ${JSON.stringify(r.occupiedSpaces)}`;n({type:"ADD_LOG",message:f});const c=["redRepeatAction"],d=Object.entries(r.occupiedSpaces).filter(([S,g])=>g===e.id&&!c.includes(S)).map(([S])=>S),m=`DEBUG: Player spaces to repeat: ${d.join(", ")}`;if(n({type:"ADD_LOG",message:m}),d.length===0){const S=`Player ${e.id}: redRepeatAction  +1 red (no valid patrons to repeat - swap/repeat actions excluded)`;n({type:"ADD_LOG",message:S});return}const h=d.map(S=>{let g=S;for(const p of Object.values(s)){const _=p.actions.find(w=>w.id===S);if(_){g=_.title;break}}return{label:`Repeat: ${g}`,value:S}}),y=await ye(n,"Choose an action to repeat",h);if(y){let S=y;for(const p of Object.values(s)){const _=p.actions.find(w=>w.id===y);if(_){S=_.title;break}}const g=`Player ${e.id}: redRepeatAction  +1 red + repeating ${S}`;n({type:"ADD_LOG",message:g}),await Ot(y,e,n,r,s,o+1,i),gp(y,s)&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for repeating red action`}))}return}if(t==="redHybrid1"||t==="redHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const f=Object.entries(r.occupiedSpaces);if(f.length<2){const w=`Player ${e.id}: ${t}  +1 red (not enough patrons to swap)`;n({type:"ADD_LOG",message:w});return}const c=f.filter(([w,P])=>P===e.id&&w!==t&&w!=="redHybrid1"&&w!=="redHybrid2"),d=f.filter(([w,P])=>P!==e.id&&w!==t&&w!=="redHybrid1"&&w!=="redHybrid2");if(c.length===0||d.length===0){const w=`Player ${e.id}: ${t}  +1 red (need valid patrons from both players - swap actions excluded)`;n({type:"ADD_LOG",message:w});return}const m=c.map(([w,P])=>{let k=w;for(const[b,D]of Object.entries(s)){const $=D.actions.find(R=>R.id===w);if($){k=`${b} - ${$.title}`;break}}return{label:`Your patron on: ${k}`,value:{spaceId:w,playerId:P}}}),h=await ye(n,"Choose your patron to swap",m,!1,i);if(!h)return;const y=d.map(([w,P])=>{let k=w;for(const[$,R]of Object.entries(s)){const q=R.actions.find(Ge=>Ge.id===w);if(q){k=`${$} - ${q.title}`;break}}const b=r.players.find($=>$.id===P);return{label:`${b?`${b.name} ${b.emoji||""}`:`Player ${P}`}'s patron on: ${k}`,value:{spaceId:w,playerId:P}}}),S=await ye(n,"Choose another player's worker to swap with",y,!1,i);if(!S)return;const g={...r.occupiedSpaces};g[h.spaceId]=S.playerId,g[S.spaceId]=h.playerId,n({type:"UPDATE_OCCUPIED_SPACES",occupiedSpaces:g}),S.playerId,n({type:"ADD_LOG",message:"Workers swapped between actions"});const p=["playTwoWorkers","playThreeWorkers"];t==="redHybrid1"?(p.includes(h.spaceId)||await Ot(h.spaceId,r.players.find(w=>w.id===S.playerId),n,r,s,o+1),p.includes(S.spaceId)||await Ot(S.spaceId,r.players.find(w=>w.id===h.playerId),n,r,s,o+1)):p.includes(S.spaceId)?n({type:"ADD_LOG",message:`Player ${e.id}: Cannot execute ${S.spaceId} from swap (would interfere with swap)`}):await Ot(S.spaceId,e,n,r,s,o+1);const _=`Player ${e.id}: ${t}  +1 red + swapped patrons`;n({type:"ADD_LOG",message:_});return}if(t==="redVPFocus"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}});const f=(a=r.gameLayers)==null?void 0:a.red,c=f?f.actions.map(y=>y.id):[],d=Object.entries(r.occupiedSpaces).filter(([y,S])=>S===e.id&&c.includes(y)).length,m=1+d;n({type:"UPDATE_VP",playerId:e.id,vp:m,source:"redAction"});const h=`Player ${e.id}: redVPFocus  +1, +${m} VP (${d} red patrons)`;n({type:"ADD_LOG",message:h});return}if(t==="redRepeatAll"){n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const f=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","playTwoWorkers","playThreeWorkers","gain4purpleWaitAll","gain2purpleTakeBack","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"];console.log("redRepeatAll - All occupied spaces:",r.occupiedSpaces),console.log("redRepeatAll - Current player:",e.id);const c=Object.entries(r.occupiedSpaces).filter(([m,h])=>{const y=h===e.id,S=f.includes(m),g=m===t;return console.log(`Checking ${m}: player=${h}, isPlayerSpace=${y}, isExcluded=${S}, isCurrentAction=${g}`),y&&!S&&!g}).map(([m])=>m);if(c.length===0){const m=`Player ${e.id}: redRepeatAll  No other patrons to repeat`;n({type:"ADD_LOG",message:m});return}n({type:"ADD_LOG",message:`Player ${e.id}: redRepeatAll  Will repeat ${c.length} actions`});const d=[...c];for(;d.length>0;){const m=d.map(S=>{let g=S;for(const[p,_]of Object.entries(s)){const w=_.actions.find(P=>P.id===S);if(w){g=`${p} - ${w.title}`;break}}return{label:g,value:S}}),h=await ye(n,`Choose next action to repeat (${d.length} remaining)`,m,!1,i);if(!h){n({type:"ADD_LOG",message:`Player ${e.id}: Stopped repeating actions`});break}await Ot(h,e,n,r,s,o+1),gp(h,s)&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for repeating red action`}));const y=d.indexOf(h);y>-1&&d.splice(y,1)}return}if(t==="steal2Gems"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{yellow:1}});const f=Object.values(r.players.find(h=>h.id===e.id).resources).reduce((h,y)=>h+y,0);if(f===0){const h=`Player ${e.id}: Trade All  for   No resources to trade`;n({type:"ADD_LOG",message:h});return}const c=await pe(n,`Trade all ${f} resources for new ones`,f,null,i);if(!c){const h=`Player ${e.id}: Trade All  for   Cancelled`;n({type:"ADD_LOG",message:h});return}const d={};Object.keys(e.resources).forEach(h=>{e.resources[h]>0&&(d[h]=-e.resources[h])}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});const m=`Player ${e.id}: +1 + Trade All  for   Traded ${f} resources`;n({type:"ADD_LOG",message:m});return}if(t==="steal3Gems"){const f=await pe(n,"Select 4 Resources ( Colors)",4,null,i);if(!f){const m={red:1,yellow:1,blue:1,purple:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:m}),n({type:"ADD_LOG",message:`Player ${e.id}: Gain 4  +1 red, +1 yellow, +1 blue, +1 purple (default)`});return}const c=f;if((e.effects||[]).some(m=>m.includes("Next gain will be doubled"))){Object.keys(c).forEach(h=>{c[h]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))});const m=Object.entries(c).map(([h,y])=>`${y} ${h}`).join(", ");n({type:"ADD_LOG",message:`Player ${e.id}: Gain 4  +${m} (DOUBLED!)`})}else{const m=Object.entries(c).map(([h,y])=>`${y} ${h}`).join(", ");n({type:"ADD_LOG",message:`Player ${e.id}: Gain 4  +${m}`})}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});return}if(t==="yellowHybrid1"){let f=2;(e.effects||[]).some(d=>d.includes("Next gain will be doubled"))?(f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))}),n({type:"ADD_LOG",message:`Player ${e.id}: +2  +${f} yellow (DOUBLED!)`})):n({type:"ADD_LOG",message:`Player ${e.id}: +2  +${f} yellow`}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{yellow:f}});return}if(t==="yellowHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{yellow:1}});const c=(r.players.findIndex(g=>g.id===e.id)-1+r.players.length)%r.players.length,d=r.players[c],m=d.lastGain||{};if(Object.values(m).reduce((g,p)=>g+p,0)===0){alert(` Warning: Player ${d.id} has no recorded resource gain to copy. Defaulting to +1 yellow.`),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{yellow:1}});const g=`Player ${e.id}: +1 + Copy Previous  +1 (no gain to copy, default)`;n({type:"ADD_LOG",message:g});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:m});const y=Object.entries(m).filter(([,g])=>g>0).map(([g,p])=>`${p} ${g}`).join(", "),S=`Player ${e.id}: +1 + Copy Previous  +1 yellow, copied ${y} from Player ${d.id}`;n({type:"ADD_LOG",message:S});return}if(t==="yellowSwapResources"){const f=Object.keys(r.gameLayers||{});if(f.length===0){const m=`Player ${e.id}: Gain 3 per color  No active colors in game`;n({type:"ADD_LOG",message:m});return}const c={};if(f.forEach(m=>{c[m]=3}),(e.effects||[]).some(m=>m.includes("Next gain will be doubled"))){f.forEach(y=>{c[y]=6}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(y=>!y.includes("Next gain will be doubled"))});const m=f.length*6,h=f.map(y=>`6 ${y}`).join(", ");n({type:"ADD_LOG",message:`Player ${e.id}: Gain 3 per color  +${h} (${m} total, DOUBLED!)`})}else{const m=f.length*3,h=f.map(y=>`3 ${y}`).join(", ");n({type:"ADD_LOG",message:`Player ${e.id}: Gain 3 per color  +${h} (${m} total)`})}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});return}if(t==="blueR1ShopBenefit"){console.log("Executing blueR1ShopBenefit for player",e.id);const f=[],c=r.gameLayers?Object.keys(r.gameLayers):["red","yellow","blue","purple"];console.log("Available game layers:",c);const d={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""},m={red:"Red/Yellow",yellow:"Red/Yellow",blue:"Blue/Purple",purple:"Blue/Purple",gold:"Gold/White",white:"Gold/White",black:"Black/Silver",silver:"Black/Silver"};c.forEach(g=>{const p={red:{1:"Repeat one of your patron's actions"},yellow:{1:"Double your next gain action"},blue:{1:"Toggle any shop (open/closed)"},purple:{1:"Take an extra turn after this one"},gold:{1:"1 Gold + 1  = 2 Gold"},white:{1:"Lose 1 VP, Gain 1 "},black:{1:"Steal 1 VP from another player"},silver:{1:"Gain 2 VP"}},_=m[g];f.push({label:`${g} R1: ${p[g][1]}`,shortLabel:`${d[g]} ${p[g][1]}`,value:{color:g,round:1},group:_})});const h=()=>{const g=["redRepeatAction"];return Object.entries(r.occupiedSpaces).filter(([_,w])=>w===e.id&&!g.includes(_)).length>0},y=f.filter(g=>g.value.color==="red"&&g.value.round===1?h():!0);if(y.length===0){n({type:"ADD_LOG",message:`Player ${e.id}: No valid R1 shop benefits available`});return}const S=await ye(n,"Choose any R1 shop benefit (ignores closed status)",y,!0,i);S?(console.log("Player chose shop:",S.color,"R",S.round),await sc(S.color,S.round,e,n,r,o+1),n({type:"ADD_LOG",message:`Player ${e.id}: Executed ${S.color} R1 shop benefit`}),r.automaticVPs&&r.automaticVPs.blue&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (blue automatic VP for shop use)`}))):(console.log("Player cancelled R1 shop selection"),n({type:"ADD_LOG",message:`Player ${e.id}: Cancelled R1 shop benefit selection`}));return}if(t==="blueAnyShopBenefit"){console.log("Executing blueAnyShopBenefit for player",e.id);const f=[],c=r.gameLayers?Object.keys(r.gameLayers):["red","yellow","blue","purple"];console.log("Available game layers:",c);const d={red:{1:"Repeat one of your patron's actions",2:"Place the next player's patron for them",3:"Pick a player. Repeat all actions where they have a patron"},yellow:{1:"Double your next gain action",2:"Gain 5 ",3:"Gain 7 "},blue:{1:"Close any shop this round",2:"Toggle the status of all shops",3:"Gain any shop benefit"},purple:{1:"Take an extra turn",2:"Place 2 more patrons this turn",3:"Place all your remaining patrons now"},gold:{1:"1 gold + 1 any  2 gold",2:"2 gold + 2 any  4 gold",3:"3 gold + 3 any  2x gold"},white:{1:"Pay 1 VP  Gain 1 any gem",2:"Pay 3 VP  Skip next player",3:"Move one patron to any action"},black:{1:"Steal 1 VP from a player",2:"Steal 3 VP from a player",3:"Steal 5 VP from a player"},silver:{1:"Gain 2 VP",2:"Gain 4 VP, pick player for 4 VP",3:"Gain 7 silver, others get 2"}};c.forEach(h=>{const y=h.charAt(0).toUpperCase()+h.slice(1);f.push({label:`${h} R1: ${d[h][1]}`,shortLabel:`R1: ${d[h][1]}`,value:{color:h,round:1},group:y}),f.push({label:`${h} R2: ${d[h][2]}`,shortLabel:`R2: ${d[h][2]}`,value:{color:h,round:2},group:y}),h==="blue"&&t==="blueAnyShopBenefit"||f.push({label:`${h} R3: ${d[h][3]}`,shortLabel:`R3: ${d[h][3]}`,value:{color:h,round:3},group:y});const S={red:{cost:"5 red",vp:5},yellow:{cost:"5 ",vp:3},blue:{cost:"5 blue",vp:5},purple:{cost:"6 purple",vp:5},white:{cost:"4 white",vp:4},black:{cost:"6 black",vp:"Steal 2 from each"},silver:{cost:"6 silver",vp:8},gold:null};if(S[h]){const g=S[h];f.push({label:`Victory: ${typeof g.vp=="number"?g.vp+" VP":g.vp}`,shortLabel:`Victory: ${typeof g.vp=="number"?g.vp+" VP":g.vp}`,value:{color:h,round:"vp"},group:y})}});const m=await ye(n,"Choose any shop benefit (ignores closed status)",f,!0,i);if(m){if(m.round==="vp")if(m.color==="black")state.players.filter(y=>y.id!==e.id).forEach(y=>{const S=Math.min(2,y.victoryPoints);S>0&&(n({type:"UPDATE_VP",playerId:y.id,vp:-S,source:"blackSteal"}),n({type:"UPDATE_VP",playerId:e.id,vp:S,source:"blackSteal"}))}),n({type:"ADD_LOG",message:`Player ${e.id}: Black Victory shop  Stole 2 VP from each other player`});else{const y={red:5,yellow:3,blue:5,purple:5,white:4,silver:8}[m.color]||3;n({type:"UPDATE_VP",playerId:e.id,vp:y,source:"victoryShop"}),n({type:"ADD_LOG",message:`Player ${e.id}: ${m.color} Victory shop  +${y} VP`})}else console.log("Blue R3: About to execute shop benefit for",m.color,"R"+m.round),await sc(m.color,m.round,e,n,r,o+1),n({type:"ADD_LOG",message:`Player ${e.id}: Executed ${m.color} R${m.round} shop benefit`});(u=r.automaticVPs)!=null&&u.blue&&n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (used a shop benefit)`})}return}if(t==="blueReduceCosts"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:1}}),n({type:"ADD_SHOP_COST_MODIFIER",playerId:e.id,modifier:-1});const f=`Player ${e.id}: blueReduceCosts  +1 blue + your shop costs reduced by 1 `;n({type:"ADD_LOG",message:f});return}if(t==="blueIncreaseCosts"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:2}}),r.players.forEach(c=>{c.id!==e.id&&n({type:"ADD_SHOP_COST_MODIFIER",playerId:c.id,modifier:2})});const f=`Player ${e.id}: blueIncreaseCosts  +2 blue, all other players' shop costs increased by 2 `;n({type:"ADD_LOG",message:f});return}if(t==="blueToggleShops"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:2}}),n({type:"FLIP_ALL_SHOPS"});const f=`Player ${e.id}: blueToggleShops  +2 blue + all shops toggled`;n({type:"ADD_LOG",message:f});return}if(t==="convert2AnyTo2Gold"){const f=r.players.find(y=>y.id===e.id);if(Object.entries(f.resources).filter(([y,S])=>y!=="gold"&&S>0).reduce((y,[S,g])=>y+g,0)<2){const y=`Player ${e.id}: convert2AnyTo2Gold  Need at least 2 gems`;n({type:"ADD_LOG",message:y});return}const d=await pe(n,"Choose 2 gems to convert to Gold",2,f,i);if(!d){const y=`Player ${e.id}: convert2AnyTo2Gold  Cancelled`;n({type:"ADD_LOG",message:y});return}const m={gold:2};Object.entries(d).forEach(([y,S])=>{m[y]=-S}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:m});const h=`Player ${e.id}: convert2AnyTo2Gold  Converted 2 gems to 2 gold`;n({type:"ADD_LOG",message:h});return}if(t==="convert1AnyTo1Gold"){const f=r.players.find(y=>y.id===e.id);if(Object.entries(f.resources).filter(([y,S])=>y!=="gold"&&S>0).reduce((y,[S,g])=>y+g,0)<1){const y=`Player ${e.id}: convert1AnyTo1Gold  Need at least 1 gem`;n({type:"ADD_LOG",message:y});return}const d=await pe(n,"Choose 1 gem to convert to Gold",1,f,i);if(!d){const y=`Player ${e.id}: convert1AnyTo1Gold  Cancelled`;n({type:"ADD_LOG",message:y});return}const m={gold:1};Object.entries(d).forEach(([y,S])=>{m[y]=-S}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:m});const h=`Player ${e.id}: convert1AnyTo1Gold  Converted 1 gem to 1 gold`;n({type:"ADD_LOG",message:h});return}if(t==="gain3goldSkip"){const f=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let c=3;f&&(c*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{gold:c}});const d={...r.skippedTurns};d[e.id]=(d[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:d});const m=`Player ${e.id}: gain3goldSkip  +${c} gold${f?" (DOUBLED!)":""}, will skip next turn (total skips: ${d[e.id]})`;n({type:"ADD_LOG",message:m});return}if(t==="convert3AnyTo3Gold"){const f=r.players.find(y=>y.id===e.id);if(Object.entries(f.resources).filter(([y,S])=>y!=="gold"&&S>0).reduce((y,[S,g])=>y+g,0)<3){const y=`Player ${e.id}: convert3AnyTo3Gold  Need at least 3 gems`;n({type:"ADD_LOG",message:y});return}const d=await pe(n,"Choose 3 gems to convert to Gold",3,f,i);if(!d){const y=`Player ${e.id}: convert3AnyTo3Gold  Cancelled`;n({type:"ADD_LOG",message:y});return}const m={gold:3};Object.entries(d).forEach(([y,S])=>{m[y]=-S}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:m});const h=`Player ${e.id}: convert3AnyTo3Gold  Converted 3 gems to 3 gold`;n({type:"ADD_LOG",message:h});return}if(t==="goldVPPerGold"){const c=r.players.find(d=>d.id===e.id).resources.gold||0;if(c>0){n({type:"UPDATE_VP",playerId:e.id,vp:c,source:"goldVPPerGold"});const d=`Player ${e.id}: goldVPPerGold  +${c} VP (1 per gold)`;n({type:"ADD_LOG",message:d})}else{const d=`Player ${e.id}: goldVPPerGold  No gold, no VP gained`;n({type:"ADD_LOG",message:d})}return}if(t==="gain3vp"){let f=3;if((e.effects||[]).some(d=>d.includes("Next gain will be doubled"))){f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(m=>!m.includes("Next gain will be doubled"))});const d=`Player ${e.id}: gain3vp  +${f} VP (DOUBLED!)`;n({type:"ADD_LOG",message:d})}else{const d=`Player ${e.id}: gain3vp  +${f} VP`;n({type:"ADD_LOG",message:d})}n({type:"UPDATE_VP",playerId:e.id,vp:f,source:"whiteAction"});return}if(t==="gain2vp"){let f=2;if((e.effects||[]).some(d=>d.includes("Next gain will be doubled"))){f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(m=>!m.includes("Next gain will be doubled"))});const d=`Player ${e.id}: gain2vp  +${f} VP (DOUBLED!)`;n({type:"ADD_LOG",message:d})}else{const d=`Player ${e.id}: gain2vp  +${f} VP`;n({type:"ADD_LOG",message:d})}n({type:"UPDATE_VP",playerId:e.id,vp:f,source:"whiteAction"});return}if(t==="spend1AnyFor2VP"){const f=r.players.find(y=>y.id===e.id);if(Object.values(f.resources).reduce((y,S)=>y+S,0)<1){const y=`Player ${e.id}: spend1AnyFor2VP  Need at least 1 gem`;n({type:"ADD_LOG",message:y});return}const d=await pe(n,"Choose 1 gem to spend for 2 VP",1,f,i);if(!d){const y=`Player ${e.id}: spend1AnyFor2VP  Cancelled`;n({type:"ADD_LOG",message:y});return}const m={};Object.entries(d).forEach(([y,S])=>{m[y]=-S}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:m}),n({type:"UPDATE_VP",playerId:e.id,vp:2,source:"whiteAction"});const h=`Player ${e.id}: spend1AnyFor2VP  Spent 1 gem for 2 VP`;n({type:"ADD_LOG",message:h});return}if(t==="spend2AnyFor3VP"){const f=r.players.find(y=>y.id===e.id);if(Object.values(f.resources).reduce((y,S)=>y+S,0)<2){const y=`Player ${e.id}: spend2AnyFor3VP  Need at least 2 gems`;n({type:"ADD_LOG",message:y});return}const d=await pe(n,"Choose 2 gems to spend for 3 VP",2,f,i);if(!d){const y=`Player ${e.id}: spend2AnyFor3VP  Cancelled`;n({type:"ADD_LOG",message:y});return}const m={};Object.entries(d).forEach(([y,S])=>{m[y]=-S}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:m}),n({type:"UPDATE_VP",playerId:e.id,vp:3,source:"whiteAction"});const h=`Player ${e.id}: spend2AnyFor3VP  Spent 2 gems for 3 VP`;n({type:"ADD_LOG",message:h});return}if(t==="lose1VPGain2Any"){if(e.victoryPoints<1){const h=`Player ${e.id}: lose1VPGain2Any  Need at least 1 VP`;n({type:"ADD_LOG",message:h});return}n({type:"UPDATE_VP",playerId:e.id,vp:-1,source:"whiteAction"});let f=2;const c=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));c&&(f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))}));const d=await pe(n,`Choose ${f} gems to gain`,f,null,i);if(!d){const h={},y=r.gameLayers?Object.keys(r.gameLayers):["red","blue"];for(let g=0;g<f&&g<y.length;g++)h[y[g]]=(h[y[g]]||0)+1;n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h});const S=`Player ${e.id}: lose1VPGain2Any  -1 VP, +${f} gems (default)${c?" (DOUBLED!)":""}`;n({type:"ADD_LOG",message:S});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const m=`Player ${e.id}: lose1VPGain2Any  -1 VP, gained ${f} gems${c?" (DOUBLED!)":""}`;n({type:"ADD_LOG",message:m});return}if(t==="lose2VPGain4Any"){if(e.victoryPoints<2){const d=`Player ${e.id}: lose2VPGain4Any  Need at least 2 VP`;n({type:"ADD_LOG",message:d});return}n({type:"UPDATE_VP",playerId:e.id,vp:-2,source:"whiteAction"});const f=await pe(n,"Choose 4 gems to gain",4,null,i);if(!f){const d={red:1,yellow:1,blue:1,purple:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const m=`Player ${e.id}: lose2VPGain4Any  -2 VP, +1 of each color (default)`;n({type:"ADD_LOG",message:m});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});const c=`Player ${e.id}: lose2VPGain4Any  -2 VP, gained 4 gems`;n({type:"ADD_LOG",message:c});return}if(t==="gain5VPAnd5Any"){n({type:"UPDATE_VP",playerId:e.id,vp:5,source:"whiteAction"});const f=await pe(n,"Choose 5 gems to gain",5);if(!f){const d={red:1,yellow:1,blue:1,purple:1,gold:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const m=`Player ${e.id}: gain5VPAnd5Any  +5 VP, +1 of each color (default)`;n({type:"ADD_LOG",message:m});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});const c=`Player ${e.id}: gain5VPAnd5Any  +5 VP and 5 gems`;n({type:"ADD_LOG",message:c});return}if(t==="blackSteal1VP"){if(n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:1}}),r.players.filter(m=>m.id!==e.id).length===0){const m=`Player ${e.id}: blackSteal1VP  +1 black (no other players)`;n({type:"ADD_LOG",message:m});return}const c=await lr(n,"Choose a player to steal 1 VP from",r.players,e.id,i);if(!c){const m=`Player ${e.id}: blackSteal1VP  +1 black (cancelled)`;n({type:"ADD_LOG",message:m});return}n({type:"UPDATE_VP",playerId:c.id,vp:-1,source:"blackSteal"}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackSteal"});const d=`Player ${e.id}: blackSteal1VP  +1 black, stole 1 VP from Player ${c.id}`;n({type:"ADD_LOG",message:d}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackSteal2Any"){if(r.players.filter(g=>g.id===e.id?!1:Object.values(g.resources).reduce((_,w)=>_+w,0)>0).length===0){const g=`Player ${e.id}: blackSteal2Any  No players with gems to steal from`;n({type:"ADD_LOG",message:g});return}const c=await lr(n,"Choose a player to steal 2 gems from",r.players,e.id,i);if(!c){const g=`Player ${e.id}: blackSteal2Any  Cancelled`;n({type:"ADD_LOG",message:g});return}const d=Object.values(c.resources).reduce((g,p)=>g+p,0),m=Math.min(2,d);if(m===0){const g=`Player ${e.id}: blackSteal2Any  Player ${c.id} has no gems`;n({type:"ADD_LOG",message:g});return}const h=await yp(n,`Choose ${m} gems to steal from Player ${c.id}`,c,m,i);if(!h){const g=`Player ${e.id}: blackSteal2Any  Cancelled`;n({type:"ADD_LOG",message:g});return}const y={};Object.entries(h).forEach(([g,p])=>{y[g]=-p}),n({type:"UPDATE_RESOURCES",playerId:c.id,resources:y}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h});const S=`Player ${e.id}: blackSteal2Any  Stole ${Object.entries(h).map(([g,p])=>`${p} ${g}`).join(", ")} from Player ${c.id}`;n({type:"ADD_LOG",message:S}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackStealWorker"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:1}});const f=4,c=r.players.filter(w=>w.id!==e.id);if(c.length===0){const w=`Player ${e.id}: blackStealWorker  +1 black (no other players to steal from)`;n({type:"ADD_LOG",message:w});return}const d=c.filter(w=>Object.values(w.resources).some(P=>P>0)).map(w=>({label:`Player ${w.id} (${Object.entries(w.resources).filter(([,P])=>P>0).map(([P,k])=>`${k} ${P}`).join(", ")})`,value:w.id}));if(d.length===0){const w=`Player ${e.id}: blackStealWorker  +1 black (no players have resources to steal)`;n({type:"ADD_LOG",message:w});return}const m=await ye(n,"Choose player to steal 4 resources from",d,!1,i);if(!m){const w=`Player ${e.id}: blackStealWorker  +1 black (cancelled)`;n({type:"ADD_LOG",message:w});return}const h=c.find(w=>w.id===m),y=Object.values(h.resources).reduce((w,P)=>w+P,0),S=Math.min(f,y),g=await yp(n,`Steal up to ${S} resources from Player ${m}`,h,S,i);if(!g){const w=`Player ${e.id}: blackStealWorker  +1 black (cancelled)`;n({type:"ADD_LOG",message:w});return}const p=[];Object.entries(g).forEach(([w,P])=>{P>0&&(n({type:"UPDATE_RESOURCES",playerId:m,resources:{[w]:-P}}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[w]:P}}),p.push(`${P} ${w}`))});const _=`Player ${e.id}: blackStealWorker  +1 black, stole ${p.join(", ")} from Player ${m}`;n({type:"ADD_LOG",message:_}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackAllLose2VP"){r.players.filter(d=>d.id!==e.id).forEach(d=>{n({type:"UPDATE_VP",playerId:d.id,vp:-2,source:"blackPenalty"})});const c=`Player ${e.id}: blackAllLose2VP  All other players lose 2 VP`;n({type:"ADD_LOG",message:c});return}if(t==="blackAllLose4VP"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:2}}),r.players.filter(d=>d.id!==e.id).forEach(d=>{n({type:"UPDATE_VP",playerId:d.id,vp:-4,source:"blackPenalty"})});const c=`Player ${e.id}: blackAllLose4VP  +2 black, all other players lose 4 VP`;n({type:"ADD_LOG",message:c});return}if(t==="silver4Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:4}}),r.players.filter(d=>d.id!==e.id).forEach(d=>{n({type:"UPDATE_RESOURCES",playerId:d.id,resources:{silver:1}})});const c=`Player ${e.id}: silver4Others1  +4 silver, all other players +1 silver`;n({type:"ADD_LOG",message:c});return}if(t==="silver3Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:3}}),r.players.filter(d=>d.id!==e.id).forEach(d=>{n({type:"UPDATE_RESOURCES",playerId:d.id,resources:{silver:1}})});const c=`Player ${e.id}: silver3Others1  +3 silver, all other players +1 silver`;n({type:"ADD_LOG",message:c});return}if(t==="silver2Plus1Others"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:2}});const f=await pe(n,"Choose 1 gem (others will get the same)",1,null,i,e.id);if(!f){const h={red:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h}),r.players.filter(g=>g.id!==e.id).forEach(g=>{n({type:"UPDATE_RESOURCES",playerId:g.id,resources:{red:1}})});const S=`Player ${e.id}: silver2Plus1Others  +2 silver +1 red, others +1 red`;n({type:"ADD_LOG",message:S});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});const c=Object.keys(f)[0];r.players.filter(h=>h.id!==e.id).forEach(h=>{n({type:"UPDATE_RESOURCES",playerId:h.id,resources:{[c]:1}})});const m=`Player ${e.id}: silver2Plus1Others  +2 silver +1 ${c}, others +1 ${c}`;n({type:"ADD_LOG",message:m});return}if(t==="silver2VPBoth"){n({type:"UPDATE_VP",playerId:e.id,vp:2,source:"silverAction"});const f=r.players.filter(m=>m.id!==e.id),c=await lr(n,"Choose a player to also gain 2 VP",r.players,e.id,i);if(!c){const m=f[0];if(m){n({type:"UPDATE_VP",playerId:m.id,vp:2,source:"silverAction"});const h=`Player ${e.id}: silver2VPBoth  +2 VP, Player ${m.id} +2 VP`;n({type:"ADD_LOG",message:h})}else{const h=`Player ${e.id}: silver2VPBoth  +2 VP (no other players)`;n({type:"ADD_LOG",message:h})}return}n({type:"UPDATE_VP",playerId:c.id,vp:2,source:"silverAction"});const d=`Player ${e.id}: silver2VPBoth  +2 VP, Player ${c.id} +2 VP`;n({type:"ADD_LOG",message:d});return}if(t==="silverTakeBack2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:2}});const f=Object.entries(r.occupiedSpaces||{}).filter(([h,y])=>y===e.id);let c=0;for(let h=0;h<Math.min(2,f.length);h++){const[y]=f[h];n({type:"REMOVE_WORKER",actionId:y,playerId:e.id}),c++}r.players.filter(h=>h.id!==e.id).forEach(h=>{const y=Object.entries(r.occupiedSpaces||{}).filter(([S,g])=>g===h.id);if(y.length>0){const[S]=y[0];n({type:"REMOVE_WORKER",actionId:S,playerId:h.id})}});const m=`Player ${e.id}: silverTakeBack2  +2 silver, took back ${c} patrons, others took back 1`;n({type:"ADD_LOG",message:m});return}if(t==="silver3Plus2Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:3}});const f=await pe(n,"Choose 1 color to get 2 gems of (others will get 1 of that color)",1,null,i,e.id);if(!f){const h={red:2};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h}),r.players.filter(g=>g.id!==e.id).forEach(g=>{n({type:"UPDATE_RESOURCES",playerId:g.id,resources:{red:1}})});const S=`Player ${e.id}: silver3Plus2Others1  +3 silver +2 red, others +1 red`;n({type:"ADD_LOG",message:S});return}const c=Object.keys(f)[0];n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[c]:2}}),r.players.filter(h=>h.id!==e.id).forEach(h=>{n({type:"UPDATE_RESOURCES",playerId:h.id,resources:{[c]:1}})});const m=`Player ${e.id}: silver3Plus2Others1  +3 silver +2 ${c}, others +1 ${c}`;n({type:"ADD_LOG",message:m});return}if(t==="silver8VPOthers3S"){let f=8;const c=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));c&&(f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_VP",playerId:e.id,vp:f,source:"silverAction"}),r.players.filter(h=>h.id!==e.id).forEach(h=>{n({type:"UPDATE_RESOURCES",playerId:h.id,resources:{silver:3}})});const m=`Player ${e.id}: silver8VPOthers3S  +${f} VP${c?" (DOUBLED!)":""}, each other player +3 silver`;n({type:"ADD_LOG",message:m});return}console.log(`Player ${e.id} executed action: ${t}`)}function ak({isOpen:t,onClose:e,children:n}){return v.useEffect(()=>{if(t)return requestAnimationFrame(()=>{const r=window.innerWidth-document.documentElement.clientWidth;document.body.style.paddingRight=`${r}px`,document.documentElement.style.paddingRight=`${r}px`,document.body.classList.add("modal-open"),document.querySelectorAll('[style*="position: fixed"]').forEach(o=>{o.dataset.originalPadding=o.style.paddingRight||"",o.style.paddingRight=`${r}px`})}),()=>{document.body.classList.remove("modal-open"),document.body.style.paddingRight="",document.documentElement.style.paddingRight="",document.querySelectorAll('[style*="position: fixed"]').forEach(s=>{s.style.paddingRight=s.dataset.originalPadding||"",delete s.dataset.originalPadding})}},[t]),t?v.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-hidden",onClick:e},v.createElement("div",{className:"glass rounded-xl p-6 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto",onClick:r=>r.stopPropagation()},n)):null}function uk({title:t,options:e,onSelect:n,onCancel:r,columnMode:s=!1}){const{dispatch:o}=Fe(),i=a=>{o({type:"HIDE_MODAL"}),n(a)},l=()=>{o({type:"HIDE_MODAL"}),r&&r()};if(s&&e.some(a=>a.group)){const a=e.reduce((f,c)=>{const d=c.group||"Other";return f[d]||(f[d]=[]),f[d].push(c),f},{}),u={"Red/Yellow":"from-red-400 to-yellow-400","Blue/Purple":"from-blue-400 to-purple-400","Gold/White":"from-yellow-500 to-gray-100","Black/Silver":"from-gray-800 to-gray-400","Red Quad":"from-red-400 to-red-500","Yellow Quad":"from-yellow-400 to-yellow-500","Blue Quad":"from-blue-400 to-blue-500","Purple Quad":"from-purple-400 to-purple-500","Gold Quad":"from-yellow-500 to-yellow-600","White Quad":"from-gray-100 to-gray-200","Black Quad":"from-gray-800 to-gray-900","Silver Quad":"from-gray-400 to-gray-500"};return v.createElement("div",{className:"text-center"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-4"},t),v.createElement("div",{key:"columns",className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 max-h-96 overflow-y-auto"},Object.entries(a).map(([f,c])=>v.createElement("div",{key:f,className:"space-y-2"},[v.createElement("h4",{key:"header",className:`text-sm font-bold text-gray-700 mb-2 p-1 rounded bg-gradient-to-r ${u[f]||"from-gray-200 to-gray-300"}`},f),...c.map((d,m)=>v.createElement("button",{key:`${f}-${m}`,onClick:()=>i(d.value||d),className:"w-full text-xs bg-gradient-to-r from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 text-gray-800 font-semibold py-1 px-2 rounded-md shadow-sm hover:shadow-md transform hover:scale-105 transition-all duration-200 text-left",title:d.label||d},d.label||d.shortLabel||d))]))),v.createElement("button",{key:"cancel",onClick:l,className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel")])}return v.createElement("div",{className:"text-center"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-4"},t),v.createElement("div",{key:"options",className:"space-y-2 mb-6"},e.map((a,u)=>v.createElement("button",{key:u,onClick:()=>i(a.value||a),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},a.label||a))),v.createElement("button",{key:"cancel",onClick:l,className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel")])}function ck({title:t,message:e,onConfirm:n,onCancel:r}){const{dispatch:s}=Fe(),o=()=>{s({type:"HIDE_MODAL"}),n()},i=()=>{s({type:"HIDE_MODAL"}),r&&r()};return v.createElement("div",{className:"text-center"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),v.createElement("p",{key:"message",className:"text-gray-600 mb-6"},e),v.createElement("div",{key:"buttons",className:"flex gap-3"},[v.createElement("button",{key:"cancel",onClick:i,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),v.createElement("button",{key:"confirm",onClick:o,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Confirm")])])}function dk({round:t,players:e}){const{state:n,dispatch:r}=Fe(),s=()=>{r({type:"HIDE_MODAL"}),r({type:"ADVANCE_ROUND"})},o=l=>Object.entries(l.resources).filter(([a,u])=>u>0).map(([a,u])=>`${u}${{red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""}[a]}`).join(" "),i=[...e].sort((l,a)=>a.victoryPoints-l.victoryPoints);return v.createElement("div",{className:"text-center max-w-2xl"},[v.createElement("h2",{key:"title",className:"text-3xl font-bold text-gray-800 mb-6"},`Starting Round ${t}`),v.createElement("h3",{key:"subtitle",className:"text-xl font-semibold text-gray-700 mb-4"},"Current Standings"),v.createElement("div",{key:"players",className:"space-y-3 mb-6"},i.map((l,a)=>v.createElement("div",{key:l.id,className:`p-4 rounded-lg ${a===0?"bg-yellow-100 border-2 border-yellow-400":"bg-gray-100"}`},[v.createElement("div",{key:"header",className:"flex items-center justify-between mb-2"},[v.createElement("div",{key:"name",className:"flex items-center gap-2"},[v.createElement("span",{key:"emoji",className:"text-2xl"},l.emoji||""),v.createElement("span",{key:"text",className:"font-semibold text-lg"},l.name||`Player ${l.id}`),a===0&&v.createElement("span",{key:"crown",className:"text-xl"},"")]),v.createElement("div",{key:"vp-section",className:"text-right"},[v.createElement("div",{key:"total",className:"text-xl font-bold text-green-600 mb-2"},`${l.victoryPoints} VP`),v.createElement("div",{key:"breakdown",className:"text-sm text-gray-700 space-y-1"},S_(l.vpSources))])]),v.createElement("div",{key:"resources",className:"text-sm text-gray-600"},o(l)||"No resources")]))),v.createElement("button",{key:"close",onClick:s,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200"},"Continue to Round "+t)])}function fk({title:t,maxGems:e,onSelect:n,onCancel:r,availableResources:s}){const{state:o,dispatch:i}=Fe(),[l,a]=v.useState({}),[u,f]=v.useState(0),c=o.gameLayers?Object.keys(o.gameLayers):["red","yellow","blue","purple"];v.useEffect(()=>{const p={};c.forEach(_=>{p[_]=0}),a(p)},[]);const d={red:{emoji:"",gradient:"from-red-500 to-red-600"},yellow:{emoji:"",gradient:"from-yellow-400 to-yellow-500"},blue:{emoji:"",gradient:"from-blue-500 to-blue-600"},purple:{emoji:"",gradient:"from-purple-500 to-purple-600"},gold:{emoji:"",gradient:"from-yellow-600 to-yellow-700"},white:{emoji:"",gradient:"from-gray-200 to-gray-300"},black:{emoji:"",gradient:"from-gray-700 to-gray-900"},silver:{emoji:"",gradient:"from-gray-400 to-gray-500"}},m=c.map(p=>({color:p,emoji:d[p].emoji,gradient:d[p].gradient})),h=p=>{const _=l[p]||0,w=s?s[p]||0:1/0;if(u<e&&_<w){const P={...l,[p]:l[p]+1},k=u+1;a(P),f(k),k===e&&setTimeout(()=>{i({type:"HIDE_MODAL"}),n(P)},300)}},y=p=>{l[p]>0&&(a({...l,[p]:l[p]-1}),f(u-1))},S=()=>{i({type:"HIDE_MODAL"}),n(l)},g=()=>{i({type:"HIDE_MODAL"}),r&&r()};return v.createElement("div",{className:"text-center"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),v.createElement("p",{key:"progress",className:"text-gray-600 mb-4"},`Selected: ${u}/${e}`),v.createElement("div",{key:"gem-grid",className:"grid grid-cols-4 gap-4 mb-4"},m.map(({color:p,emoji:_,gradient:w})=>{const P=l[p]||0,k=s?s[p]||0:1/0,b=u<e&&P<k;return v.createElement("div",{key:p,className:"text-center"},[v.createElement("button",{key:`${p}-button`,onClick:()=>h(p),disabled:!b,className:`w-16 h-16 rounded-lg bg-gradient-to-r ${w} ${b?"hover:scale-110":"opacity-50 cursor-not-allowed"} transition-all duration-200 flex items-center justify-center text-2xl shadow-lg relative`},[v.createElement("span",{key:"emoji"},_),s&&k>0&&v.createElement("span",{key:"count",className:"absolute -bottom-2 right-0 bg-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md"},k-P)]),v.createElement("div",{key:`${p}-count`,className:"mt-2 font-semibold text-gray-700"},l[p]>0?`${l[p]}`:"")])})),u>0&&v.createElement("div",{key:"selected-display",className:"mb-4 p-3 bg-gray-100 rounded-lg"},[v.createElement("p",{key:"selected-label",className:"text-sm text-gray-600 mb-2"},"Selected gems:"),v.createElement("div",{key:"selected-gems",className:"flex justify-center gap-2 flex-wrap"},Object.entries(l).flatMap(([p,_])=>Array(_).fill(null).map((w,P)=>{const k=m.find(b=>b.color===p);return v.createElement("button",{key:`${p}-${P}`,onClick:()=>y(p),className:"text-xl hover:scale-125 transition-transform cursor-pointer",title:"Click to remove"},k.emoji)})))]),v.createElement("div",{key:"buttons",className:"flex gap-3"},[v.createElement("button",{key:"cancel",onClick:g,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),v.createElement("button",{key:"confirm",onClick:S,disabled:u===0,className:`flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 ${u===0?"opacity-50 cursor-not-allowed":""}`},"Confirm")])])}function hk({title:t,targetPlayer:e,maxGems:n,onSelect:r,onCancel:s}){const{state:o,dispatch:i}=Fe(),[l,a]=v.useState({}),[u,f]=v.useState(0),c=o.gameLayers?Object.keys(o.gameLayers):["red","yellow","blue","purple"];v.useEffect(()=>{const p={};c.forEach(_=>{p[_]=0}),a(p)},[]);const d={red:{emoji:"",gradient:"from-red-500 to-red-600"},yellow:{emoji:"",gradient:"from-yellow-400 to-yellow-500"},blue:{emoji:"",gradient:"from-blue-500 to-blue-600"},purple:{emoji:"",gradient:"from-purple-500 to-purple-600"},gold:{emoji:"",gradient:"from-yellow-600 to-yellow-700"},white:{emoji:"",gradient:"from-gray-200 to-gray-300"},black:{emoji:"",gradient:"from-gray-700 to-gray-900"},silver:{emoji:"",gradient:"from-gray-400 to-gray-500"}},m=c.map(p=>({color:p,emoji:d[p].emoji,gradient:d[p].gradient})),h=p=>{const _=e.resources[p]||0,w=l[p];if(u<n&&w<_){const P={...l,[p]:l[p]+1},k=u+1;a(P),f(k),k===n&&setTimeout(()=>{i({type:"HIDE_MODAL"}),r(P)},300)}},y=p=>{l[p]>0&&(a({...l,[p]:l[p]-1}),f(u-1))},S=()=>{i({type:"HIDE_MODAL"}),r(l)},g=()=>{i({type:"HIDE_MODAL"}),s&&s()};return v.createElement("div",{className:"text-center"},[v.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),v.createElement("p",{key:"target",className:"text-gray-600 mb-2"},`Stealing from Player ${e.id}`),v.createElement("p",{key:"progress",className:"text-gray-600 mb-4"},`Selected: ${u}/${n}`),v.createElement("div",{key:"available-label",className:"text-sm text-gray-600 mb-2"},"Available gems:"),v.createElement("div",{key:"gem-grid",className:"grid grid-cols-4 gap-4 mb-4"},m.map(({color:p,emoji:_,gradient:w})=>{const P=e.resources[p]||0,k=l[p],b=P-k,D=u<n&&b>0;return v.createElement("div",{key:p,className:"text-center"},[v.createElement("button",{key:`${p}-button`,onClick:()=>h(p),disabled:!D,className:`w-16 h-16 rounded-lg bg-gradient-to-r ${w} ${D?"hover:scale-110":"opacity-50 cursor-not-allowed"} transition-all duration-200 flex items-center justify-center text-2xl shadow-lg relative`},[v.createElement("span",{key:"emoji"},_),P>0&&v.createElement("span",{key:"count",className:"absolute -top-2 -right-2 bg-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md"},P)]),v.createElement("div",{key:`${p}-info`,className:"mt-2 text-sm text-gray-700"},k>0?`Taking ${k}`:b>0?`${b} left`:"None")])})),u>0&&v.createElement("div",{key:"selected-display",className:"mb-4 p-3 bg-gray-100 rounded-lg"},[v.createElement("p",{key:"selected-label",className:"text-sm text-gray-600 mb-2"},"Gems to steal:"),v.createElement("div",{key:"selected-gems",className:"flex justify-center gap-2 flex-wrap"},Object.entries(l).flatMap(([p,_])=>Array(_).fill(null).map((w,P)=>{const k=m.find(b=>b.color===p);return v.createElement("button",{key:`${p}-${P}`,onClick:()=>y(p),className:"text-xl hover:scale-125 transition-transform cursor-pointer",title:"Click to remove"},k.emoji)})))]),v.createElement("div",{key:"buttons",className:"flex gap-3"},[v.createElement("button",{key:"cancel",onClick:g,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),v.createElement("button",{key:"confirm",onClick:S,disabled:u===0,className:`flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 ${u===0?"opacity-50 cursor-not-allowed":""}`},"Confirm")])])}function ye(t,e,n,r=!1,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"choice",title:e,options:n,columnMode:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}function pk(t,e,n,r=null){return new Promise(s=>{t({type:"SHOW_MODAL",modal:{type:"confirm",title:e,message:n,onConfirm:()=>s(!0),onCancel:()=>{r&&t({type:"UNDO_LAST_WORKER",...r}),s(!1)}}})})}function pe(t,e,n,r,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"gemSelection",title:e,maxGems:n,availableResources:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}function yp(t,e,n,r,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"stealGems",title:e,targetPlayer:n,maxGems:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}async function lr(t,e,n,r,s=null){const o=n.filter(a=>a.id!==r);if(o.length===0)return null;const i=o.map(a=>{const u=Object.entries(a.resources).filter(([,f])=>f>0).map(([f,c])=>`${c} ${f}`).join(", ")||"no resources";return{label:`${a.name||`Player ${a.id}`} ${a.emoji||""} (${u}, ${a.victoryPoints||0} VP)`,value:a.id}}),l=await ye(t,e,i,!1,s);return l?n.find(a=>a.id===l):null}function mk({onEndTurn:t}){const{state:e,dispatch:n}=Fe(),r=e.players.find(a=>a.id===e.currentPlayer),s=()=>{const a=e.workersToPlace===0,u=!e.shopUsedAfterWorkers;return a?u?" Skip Shops & End Turn":" End Turn":"End Turn"},o=r&&r.workersLeft===0,i=!e.workerPlacedThisTurn&&!o,l=e.workersToPlace===0&&e.workerPlacedThisTurn;return v.createElement("button",{onClick:t,disabled:i,className:`font-bold py-1.5 px-3 rounded-lg shadow-lg transition-all duration-200 whitespace-nowrap text-sm ${i?"bg-gray-400 text-gray-200 cursor-not-allowed":l?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white hover:shadow-xl":"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white hover:shadow-xl"}`},s())}async function w_(t,e,n,r,s=0){const o=["redRepeatAction"],i=Object.entries(n.occupiedSpaces).filter(([l,a])=>a===t.id&&!o.includes(l)).map(([l])=>l);if(i.length===0){const l=`Player ${t.id}: Red shop  No valid workers to repeat (swap/repeat actions excluded)`;return e({type:"ADD_LOG",message:l}),!1}if(i.length>=1){const l=i.map(u=>{let f=u;for(const c of Object.values(r)){const d=c.actions.find(m=>m.id===u);if(d){f=d.title;break}}return{label:`Repeat: ${f}`,value:u}}),a=await ye(e,"Choose an action to repeat",l);if(a){let u=a;for(const m of Object.values(r)){const h=m.actions.find(y=>y.id===a);if(h){u=h.title;break}}const f=`Player ${t.id}: Red shop  Repeating ${u}`;e({type:"ADD_LOG",message:f});const c=n.players.find(m=>m.id===t.id),d={...n,players:n.players.map(m=>m.id===t.id?c:m)};return await Ot(a,c,e,d,r,s+1),!0}}return!1}async function gk(t,e,n){console.log("executeYellow3Shop - Starting for player",t.id);const r=await pe(e,"Choose 10 gems of any color",10);if(!r){const a=`Player ${t.id}: Yellow R3 shop  Cancelled`;return e({type:"ADD_LOG",message:a}),!1}console.log("executeYellow3Shop - Player",t.id,"selected gems:",r);const s=(t.effects||[]).some(a=>a.includes("Next gain will be doubled"));let o={...r};s&&(Object.keys(o).forEach(a=>{o[a]*=2}),e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(a=>!a.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=Object.values(o).reduce((a,u)=>a+u,0),l=`Player ${t.id}: Yellow R3 shop  Gained ${i} gems${s?" (DOUBLED!)":""}`;return e({type:"ADD_LOG",message:l}),!0}async function yk(t,e,n){console.log("executeYellow2Shop - Trigger Yellow auto VP for player",t.id);const r=Object.keys(n.gameLayers||{});if(r.length===0){const l=`Player ${t.id}: Yellow R2 shop  No active colors (no VP gained)`;e({type:"ADD_LOG",message:l});return}const s=r.map(l=>t.resources[l]||0),o=Math.min(...s);if(o===0){const l=`Player ${t.id}: Yellow R2 shop  +0 VP (no complete sets of ${r.length} colors)`;e({type:"ADD_LOG",message:l});return}e({type:"UPDATE_VP",playerId:t.id,vp:o,source:"yellowAutoVP"});const i=`Player ${t.id}: Yellow R2 shop  +${o} VP (${o} complete sets of ${r.length} colors)`;return e({type:"ADD_LOG",message:i}),!0}async function _k(t,e,n){const r=[],s=n.gameLayers?Object.keys(n.gameLayers):["red","yellow","blue","purple"],o={red:{1:"1+2",2:"2+2",3:"4+4"},yellow:{1:"1+1",2:"2+2",3:"3+3"},blue:{1:"1+1",2:"2+2",3:"3+3"},purple:{1:"1+2",2:"2+2",3:"3+3"},gold:{1:"1+1",2:"2+2",3:"3+3"},white:{1:"1VP",2:"2VP",3:"3VP"},black:{1:"1+1",2:"2+2",3:"3+3"},silver:{1:"1+1",2:"2+2",3:"3+3"}},i={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""},l={red:"Red Quad",yellow:"Yellow Quad",blue:"Blue Quad",purple:"Purple Quad",gold:"Gold Quad",white:"White Quad",black:"Black Quad",silver:"Silver Quad"};s.forEach(u=>{const f=l[u]||u,c=n.closedShops[`${u}1`];n.round>=1,r.push({label:`${i[u]} R1 ${c?" Closed":" Open"}`,shortLabel:`${c?"":""} R1: ${o[u][1]}`,value:`${u}1`,group:f});const d=n.closedShops[`${u}2`],m=n.round>=2;r.push({label:`${i[u]} R2 ${d?" Closed":" Open"}${m?"":" (Round 2+)"}`,shortLabel:`${d?"":""} R2: ${o[u][2]}`,value:`${u}2`,group:f});const h=n.closedShops[`${u}3`],y=n.round>=3;r.push({label:`${i[u]} R3 ${h?" Closed":" Open"}${y?"":" (Round 3)"}`,shortLabel:`${h?"":""} R3: ${o[u][3]}`,value:`${u}3`,group:f});const S=n.closedShops[`${u}vp`];r.push({label:`${i[u]} VP ${S?" Closed":" Open"}`,shortLabel:`${S?"":""} VP`,value:`${u}vp`,group:f})});const a=await ye(e,"Choose a shop to toggle (Closed/Open)",r,!0);a&&(n.closedShops[a]?(e({type:"OPEN_SHOP",shopId:a}),e({type:"ADD_LOG",message:`Player ${t.id}: Opened ${a} shop`})):(e({type:"CLOSE_SHOP",shopId:a}),e({type:"ADD_LOG",message:`Player ${t.id}: Closed ${a} shop`})))}async function vk(t,e,n,r=0){await Ot("blueAnyShopBenefit",t,e,n,n.gameLayers,r)}async function Ek(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((c,d)=>c+d,0);if(r<1||s<2){const c=`Player ${t.id}: Gold R1 shop  Need 1 gold + 1  resource`;e({type:"ADD_LOG",message:c});return}const o=Object.entries(t.resources).filter(([c,d])=>c!=="gold"&&d>0).reduce((c,[,d])=>c+d,0);let i;if(o===0&&r>=2)i={gold:1};else if(i=await pe(e,"Choose 1  resource to pay",1,t),!i){const c=`Player ${t.id}: Gold R1 shop  Cancelled`;e({type:"ADD_LOG",message:c});return}const l={gold:-1};Object.entries(i).forEach(([c,d])=>{l[c]=l[c]?l[c]-d:-d}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:l});const a=(t.effects||[]).some(c=>c.includes("Next gain will be doubled"));let u=2;a&&(u*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:u}});const f=`Player ${t.id}: Gold R1 shop  Paid 1 gold + 1 resource, gained ${u} gold${a?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:f})}async function wk(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((f,c)=>f+c,0);if(r<2||s<4){const f=`Player ${t.id}: Gold R2 shop  Need 2 gold + 2  resources`;e({type:"ADD_LOG",message:f});return}const o=await pe(e,"Choose 2  resources to pay",2,t);if(!o){const f=`Player ${t.id}: Gold R2 shop  Cancelled`;e({type:"ADD_LOG",message:f});return}const i={gold:-2};Object.entries(o).forEach(([f,c])=>{i[f]=i[f]?i[f]-c:-c}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:i});const l=(t.effects||[]).some(f=>f.includes("Next gain will be doubled"));let a=4;l&&(a*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(f=>!f.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:a}});const u=`Player ${t.id}: Gold R2 shop  Paid 2 gold + 2 resources, gained ${a} gold${l?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:u})}async function Sk(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((c,d)=>c+d,0);if(r<3||s<6){const c=`Player ${t.id}: Gold R3 shop  Need 3 gold + 3  resources`;e({type:"ADD_LOG",message:c});return}const o=await pe(e,"Choose 3  resources to pay",3,t);if(!o){const c=`Player ${t.id}: Gold R3 shop  Cancelled`;e({type:"ADD_LOG",message:c});return}const i={gold:-3};Object.entries(o).forEach(([c,d])=>{i[c]=i[c]?i[c]-d:-d}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:i});const l=(t.effects||[]).some(c=>c.includes("Next gain will be doubled"));let a=r*2;l&&(a*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:a}});const u=r-3+a,f=`Player ${t.id}: Gold R3 shop  Paid 3 gold + 3 resources, gold went from ${r} to ${u}${l?" (DOUBLE DOUBLED!)":""}`;e({type:"ADD_LOG",message:f})}async function Pk(t,e,n){if(t.victoryPoints<1){const l=`Player ${t.id}: White R1 shop  Need at least 1 VP`;e({type:"ADD_LOG",message:l});return}e({type:"UPDATE_VP",playerId:t.id,vp:-1,source:"whiteShop"});let r=1;const s=(t.effects||[]).some(l=>l.includes("Next gain will be doubled"));s&&(r*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(l=>!l.includes("Next gain will be doubled"))}));const o=await pe(e,`Choose ${r} gem${r>1?"s":""} to gain`,r);if(!o){const l={red:r};e({type:"UPDATE_RESOURCES",playerId:t.id,resources:l});const a=`Player ${t.id}: White R1 shop  -1 VP, +${r} red (default)${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:a});return}e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=`Player ${t.id}: White R1 shop  -1 VP, gained ${r} gem${r>1?"s":""}${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:i})}async function Ck(t,e,n){if(t.victoryPoints<3){const a=`Player ${t.id}: White R2 shop  Need at least 3 VP`;e({type:"ADD_LOG",message:a});return}e({type:"UPDATE_VP",playerId:t.id,vp:-3,source:"whiteShop"});const s=(n.turnOrder.indexOf(n.currentPlayer)+n.turnDirection+n.turnOrder.length)%n.turnOrder.length,o=n.turnOrder[s],i={...n.skippedTurns};i[o]=(i[o]||0)+1,e({type:"SET_SKIPPED_TURNS",skippedTurns:i});const l=`Player ${t.id}: White R2 shop  -2 VP, Player ${o} will skip next turn`;e({type:"ADD_LOG",message:l})}async function kk(t,e,n){if(t.victoryPoints<3){const c=`Player ${t.id}: White R3 shop  Need at least 3 VP`;e({type:"ADD_LOG",message:c});return}const r=Object.entries(n.occupiedSpaces).filter(([c,d])=>d===t.id).map(([c])=>c);if(r.length===0){const c=`Player ${t.id}: White R3 shop  No workers to move`;e({type:"ADD_LOG",message:c});return}const s=r.map(c=>{let d=c;for(const[m,h]of Object.entries(n.gameLayers||{})){const y=h.actions.find(S=>S.id===c);if(y){d=`${m} - ${y.title}`;break}}return{label:d,value:c}}),o=await ye(e,"Choose a worker to move",s);if(!o)return;const i=[];if(Object.entries(n.gameLayers||{}).forEach(([c,d])=>{d.actions.forEach(m=>{m.round<=n.round&&!n.occupiedSpaces[m.id]&&i.push({label:`${c} - ${m.title}`,value:m.id,color:c})})}),i.length===0){const c=`Player ${t.id}: White R3 shop  No unclaimed actions available`;e({type:"ADD_LOG",message:c});return}const l=await ye(e,"Choose an unclaimed action to move to",i);if(!l)return;e({type:"UPDATE_VP",playerId:t.id,vp:-3,source:"whiteShop"});const a={...n.occupiedSpaces};delete a[o],a[l]=t.id,e({type:"UPDATE_OCCUPIED_SPACES",occupiedSpaces:a});const u={...n,occupiedSpaces:a};await Ot(l,t,e,u,n.gameLayers,0);const f=`Player ${t.id}: White R3 shop  -3 VP, moved worker to ${l}`;e({type:"ADD_LOG",message:f})}async function Tk(t,e,n){if(n.players.filter(o=>o.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  No other players`});return}const s=await lr(e,"Choose a player to steal 1 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  Cancelled`});return}e({type:"UPDATE_VP",playerId:s.id,vp:-1,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  Stole 1 VP from Player ${s.id}`}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function bk(t,e,n){if(n.players.filter(i=>i.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  No other players`});return}const s=await lr(e,"Choose a player to steal 3 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  Cancelled`});return}const o=Math.min(3,s.victoryPoints);e({type:"UPDATE_VP",playerId:s.id,vp:-o,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:o,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  Stole ${o} VP from Player ${s.id}`}),n.roomCode&&e({type:"ADD_NOTIFICATION",notification:{type:"steal",icon:"",title:"VP Stolen!",message:`${t.name||`Player ${t.id}`} stole ${o} VP from you`,forPlayer:s.id}}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function Ak(t,e,n){if(n.players.filter(i=>i.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  No other players`});return}const s=await lr(e,"Choose a player to steal 5 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  Cancelled`});return}const o=Math.min(5,s.victoryPoints);e({type:"UPDATE_VP",playerId:s.id,vp:-o,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:o,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  Stole ${o} VP from Player ${s.id}`}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function Dk(t,e,n){e({type:"UPDATE_VP",playerId:t.id,vp:4,source:"silverShop"});const r=n.players.filter(o=>o.id!==t.id);if(r.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP (no other players)`});return}if(r.length===1){const o=r[0];e({type:"UPDATE_VP",playerId:o.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${o.id} +4 VP`});return}const s=await lr(e,"Choose a player to give 4 VP",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP (gift cancelled)`});return}if(n.roomCode&&s.id!==t.id){const o=`${t.name||`Player ${t.id}`} ${t.emoji||""}`;await ye(e,`${o} wants to give you 4 VP! `,[{label:"Graciously Accept (+4 VP)",value:!0},{label:"Politely Decline",value:!1}],!1,null,s.id)?(e({type:"UPDATE_VP",playerId:s.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${s.id} accepted +4 VP gift! `})):e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${s.id} declined the gift`})}else e({type:"UPDATE_VP",playerId:s.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, gave Player ${s.id} +4 VP`})}async function xk(t,e,n){const r=(t.effects||[]).some(i=>i.includes("Next gain will be doubled"));let s=7;r&&(s*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(i=>!i.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{silver:s}}),n.players.filter(i=>i.id!==t.id).forEach(i=>{e({type:"UPDATE_RESOURCES",playerId:i.id,resources:{silver:2}})}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R3 shop  +${s} silver${r?" (DOUBLED!)":""}, all other players +2 silver`})}async function sc(t,e,n,r,s,o=0){const i=`${t}${e}`;switch(i){case"red1":if(!await w_(n,r,s,s.gameLayers,o))return!1;break;case"red2":await Ok(n,r,s);break;case"red3":await Nk(n,r,s,o);break;case"yellow1":r({type:"ADD_EFFECT",playerId:n.id,effect:"Next gain will be doubled"}),r({type:"ADD_LOG",message:`Player ${n.id}: Yellow R1 shop  Next gain will be doubled`});break;case"yellow2":if(!await yk(n,r,s))return!1;break;case"yellow3":if(!await gk(n,r))return!1;break;case"blue1":await _k(n,r,s),r({type:"ADD_LOG",message:`Player ${n.id}: Blue R1 shop  Toggle any shop (open/closed)`});break;case"blue2":r({type:"FLIP_ALL_SHOPS",playerId:n.id,playerName:n.name}),r({type:"ADD_LOG",message:`Player ${n.id}: Blue R2 shop  All shops toggled!`});break;case"blue3":await vk(n,r,s);break;case"purple1":r({type:"ADD_EFFECT",playerId:n.id,effect:"Will take an extra turn after this one"}),r({type:"UPDATE_PLAYER",playerId:n.id,updates:{extraTurns:(n.extraTurns||0)+1}}),r({type:"ADD_LOG",message:`Player ${n.id}: Purple R1 shop  Will take an extra turn after this one`});break;case"purple2":const f=n.workersLeft,c=Math.min(2,f);if(c===0){r({type:"ADD_LOG",message:`Player ${n.id}: Purple R2 shop  No patrons left to place`});break}r({type:"ADD_WORKERS_TO_PLACE",count:c}),r({type:"ADD_EFFECT",playerId:n.id,effect:`Can place ${c} more patron${c>1?"s":""} this turn`}),r({type:"ADD_LOG",message:`Player ${n.id}: Can place ${c} more patron${c>1?"s":""}${c<2?" (limited by available patrons)":""} this turn!`});break;case"purple3":const d=n.workersLeft;d>0&&(r({type:"ADD_WORKERS_TO_PLACE",count:d}),r({type:"ADD_EFFECT",playerId:n.id,effect:`Can place ${d} more patrons this turn`}),r({type:"ADD_LOG",message:`Player ${n.id}: Can place all ${d} remaining patrons!`}));break;case"gold1":await Ek(n,r);break;case"gold2":await wk(n,r);break;case"gold3":await Sk(n,r);break;case"white1":await Pk(n,r);break;case"white2":await Ck(n,r,s);break;case"white3":await kk(n,r,s);break;case"black1":await Tk(n,r,s);break;case"black2":await bk(n,r,s);break;case"black3":await Ak(n,r,s);break;case"silver1":r({type:"UPDATE_VP",playerId:n.id,vp:2,source:"silverShop"}),r({type:"ADD_LOG",message:`Player ${n.id}: Silver R1 shop benefit  +2 VP`});break;case"silver2":await Dk(n,r,s);break;case"silver3":await xk(n,r,s);break;default:r({type:"ADD_LOG",message:`Player ${n.id}: Shop benefit ${i} not implemented yet`})}return!0}async function Ok(t,e,n){var c;let s=n.turnOrder.indexOf(t.id),o=null,i=null,l=0,a=n.turnDirection;for(;!o&&l<n.players.length;){s=s+a,a===1&&s>=n.turnOrder.length?(a=-1,s=n.turnOrder.length-1):a===-1&&s<0&&(a=1,s=0),i=n.turnOrder[s];const d=n.players.find(m=>m.id===i);if(d&&d.workersLeft>0&&!(((c=n.skippedTurns)==null?void 0:c[i])>0)){o=d;break}l++}if(!o){e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  No players with workers remaining in turn order`});return}const u=[];if(Object.entries(n.gameLayers||{}).forEach(([d,m])=>{m.actions.forEach(h=>{h.round<=n.round&&!n.occupiedSpaces[h.id]&&u.push({label:`${d} - ${h.title}`,value:h.id,color:d})})}),u.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  No available actions`});return}const f=await ye(e,`Choose where to place Player ${i}'s worker (they have ${o.workersLeft} workers left)`,u);if(f){e({type:"PLACE_WORKER",actionId:f,playerId:i}),e({type:"UPDATE_PLAYER",playerId:i,updates:{workersLeft:o.workersLeft-1}});const d={actionId:f,playerId:i,placedBy:t.id};await Ot(f,o,e,n,n.gameLayers,0,d);let m=f;for(const[h,y]of Object.entries(n.gameLayers||{})){const S=y.actions.find(g=>g.id===f);if(S){m=`${h} - ${S.title}`;break}}e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  Placed Player ${i}'s patron on ${m}`}),n.roomCode&&e({type:"ADD_NOTIFICATION",notification:{type:"worker_placed",icon:"",title:"Worker Placed For You!",message:`${t.name||`Player ${t.id}`} placed your worker on ${m}`,forPlayer:i}})}}async function Nk(t,e,n,r=0){var m;const s=[],o={};Object.entries(n.occupiedSpaces).forEach(([h,y])=>{o[y]||(o[y]=[],s.push(y)),o[y].push(h)});const i=s.filter(h=>h!==t.id);if(i.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  No other players have workers!`});return}const l=i.map(h=>{const y=o[h].length;return{label:`Player ${h} (${y} worker${y>1?"s":""})`,value:h}}),a=await ye(e,"Choose which player's actions to repeat",l);if(!a){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Cancelled`});return}const u=o[a],f=["redRepeatAction"],c=u.filter(h=>!f.includes(h)).map(h=>{let y=h,S="";return Object.entries(n.gameLayers||{}).forEach(([g,p])=>{const _=p.actions.find(w=>w.id===h);_&&(y=_.title,S=g)}),{label:`${S} - ${y}`,value:h}});if(c.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  No valid actions to repeat from Player ${a}`});return}e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Will repeat ${c.length} actions from Player ${a}`});const d=[...c];for(;d.length>0;){const h=await ye(e,`Choose next action to repeat (${d.length} remaining)`,d,!1);if(!h){e({type:"ADD_LOG",message:`Player ${t.id}: Stopped repeating actions`});break}console.log(`Red R3 shop - Player ${t.id} repeating ${h} from Player ${a}`),await Ot(h,t,e,n,n.gameLayers,r+1);const y=(m=n.gameLayers)==null?void 0:m.red;y&&y.actions.some(p=>p.id===h)&&(e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"redAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP for repeating red action`}));const g=d.findIndex(p=>p.value===h);g>-1&&d.splice(g,1)}e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Completed copying Player ${a}'s actions!`})}function Rk(t=[]){return t.map(e=>e.includes("Next gain will be doubled")?{type:"double_gain",label:"2 Next Gain",trigger:"Next Turn",icon:"",color:"bg-yellow-100 text-yellow-800"}:e.includes("Skip next turn")||e.includes("skip turn")?{type:"skip_turn",label:"Skip Next Turn",trigger:"Next Turn",icon:"",color:"bg-purple-100 text-purple-800"}:e.includes("extra turn")||e.includes("Take another turn")?{type:"extra_turn",label:"Extra Turn",trigger:"After This Turn",icon:"",color:"bg-green-100 text-green-800"}:e.includes("play")&&e.includes("more workers")?{type:"extra_workers",label:"Extra Workers",trigger:"This Turn",icon:"",color:"bg-blue-100 text-blue-800"}:{type:"other",label:e.substring(0,20),trigger:"Pending",icon:"",color:"bg-gray-100 text-gray-800"}).filter(Boolean)}function Ik({effects:t}){const e=Rk(t);return e.length===0?null:v.createElement("div",{key:"active-effects",className:"space-y-1"},[v.createElement("div",{key:"header",className:"text-xs font-semibold text-gray-700 mb-1"}," Active Effects"),...e.map((n,r)=>v.createElement("div",{key:r,className:`text-xs px-2 py-1 rounded ${n.color} flex justify-between items-center`},[v.createElement("span",{key:"label",className:"font-semibold"},`${n.icon} ${n.label}`),v.createElement("span",{key:"trigger",className:"text-xs opacity-75"},n.trigger)]))])}function _p({player:t,isCurrentPlayer:e,onEndTurn:n,turnPosition:r}){const{state:s,dispatch:o}=Fe(),i=s.gameLayers?Object.keys(s.gameLayers):["red","yellow","blue","purple"],l={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""};return v.createElement("div",{className:`flex flex-col gap-2 px-4 py-3 rounded-lg glass shadow ${e?"ring-2 ring-blue-400":""}`},[v.createElement("div",{key:"row1",className:"flex items-center gap-3"},[v.createElement("div",{key:"name",className:"font-bold text-base whitespace-nowrap"},[v.createElement("span",{key:"emoji",className:"text-xl mr-1"},t.emoji||""),t.name,e&&v.createElement("span",{key:"indicator",className:"ml-1"},"")]),v.createElement("div",{key:"vp",className:"text-lg font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded whitespace-nowrap"},`${t.victoryPoints}VP`)]),t.effects&&t.effects.length>0&&v.createElement(Ik,{key:"effects",effects:t.effects}),e&&(()=>{let a="",u="";return s.workersToPlace>0?(a=`Place Patrons: ${s.workersToPlace} remaining`,u="bg-blue-100 text-blue-800"):!s.shopUsedAfterWorkers?(a="Shop Phase: R1/R2/R3  VP  End Turn",u="bg-purple-100 text-purple-800"):(a="Shop Phase: VP  End Turn",u="bg-green-100 text-green-800"),v.createElement("div",{key:"phase",className:`text-sm font-semibold px-3 py-1.5 rounded-lg ${u} text-center`},a)})(),v.createElement("div",{key:"row2",className:"flex items-center gap-3"},[v.createElement("div",{key:"resources",className:"flex gap-1"},i.map(a=>v.createElement("div",{key:a,className:"text-sm font-medium"},`${l[a]}${t.resources[a]||0}`))),v.createElement("div",{key:"workers",className:"text-base whitespace-nowrap font-medium"},t.workersLeft>0?`${t.emoji||""}  ${t.workersLeft}`:""),e&&s.workersToPlace===0&&(!s.roomCode||s.myPlayerId===s.currentPlayer)&&v.createElement(mk,{key:"end-turn",onEndTurn:n})])])}function Lk({color:t,title:e,icon:n,actions:r,round:s}){const{state:o}=Fe();o.players.find(u=>u.id===o.currentPlayer);const i=()=>{const u="glass rounded-lg shadow-md p-3 border-t-8 hover:shadow-lg transition-all duration-200 h-full flex flex-col";switch(t){case"red":return`${u} border-t-red-500 bg-red-50 bg-opacity-30`;case"yellow":return`${u} border-t-yellow-500 bg-yellow-50 bg-opacity-30`;case"blue":return`${u} border-t-blue-500 bg-blue-50 bg-opacity-30`;case"purple":return`${u} border-t-purple-500 bg-purple-50 bg-opacity-30`;case"gold":return`${u} border-t-yellow-600 bg-yellow-50 bg-opacity-30`;case"white":return`${u} border-t-gray-300 bg-gray-50 bg-opacity-30`;case"black":return`${u} border-t-gray-800 bg-gray-100 bg-opacity-30`;case"silver":return`${u} border-t-gray-400 bg-gray-50 bg-opacity-30`;default:return`${u} border-t-gray-500`}},l=()=>{switch(t){case"red":return"text-red-500";case"yellow":return"text-yellow-500";case"blue":return"text-blue-500";case"purple":return"text-purple-500";case"gold":return"text-yellow-600";case"white":return"text-gray-600";case"black":return"text-gray-800";case"silver":return"text-gray-400";default:return"text-gray-500"}},a=r;return v.createElement("div",{className:i()},[v.createElement("div",{key:"header",className:"flex justify-between items-center mb-2"},[v.createElement("h2",{key:"title",className:`text-lg font-bold ${l()}`},`${n} ${t.charAt(0).toUpperCase()+t.slice(1)}`),v.createElement("div",{key:"auto-vp",className:"text-sm font-bold text-gray-900 flex items-center gap-1"},[v.createElement("span",{key:"trophy"},""),v.createElement("span",{key:"text"},$k(t))]),v.createElement("span",{key:"round",className:"text-gray-700 text-xs bg-white px-2 py-0.5 rounded shadow-sm font-semibold"},`R${s}`)]),v.createElement("div",{key:"shops",className:"mb-1.5 bg-white bg-opacity-20 rounded-lg p-1.5"},[v.createElement("div",{key:"shop-header",className:"text-xs font-semibold text-gray-800 mb-1 px-0.5"}," Shops"),v.createElement("div",{key:"shop-grid",className:"grid grid-cols-4 gap-1"},[v.createElement(Fa,{key:"shop-r1",color:t,round:1,label:"R1",currentRound:s}),v.createElement(Fa,{key:"shop-r2",color:t,round:2,label:"R2",currentRound:s}),v.createElement(Fa,{key:"shop-r3",color:t,round:3,label:"R3",currentRound:s}),v.createElement(Mk,{key:"shop-vp",color:t})])]),v.createElement("div",{key:"actions-section",className:"flex-1"},[v.createElement("h3",{key:"actions-title",className:"text-xs font-semibold mb-1 text-gray-800 px-0.5"}," Actions"),v.createElement("div",{key:"actions",className:"grid grid-cols-3 gap-1"},a.map(u=>v.createElement(lk,{key:u.id,actionId:u.id,title:u.title,description:u.description,round:u.round,available:u.round<=s,compact:!0})))])])}function $k(t){switch(t){case"red":return" +1 VP each time you use or repeat a RED action";case"yellow":return" +1 VP per complete set of all colors at end of each round";case"blue":return" Get 1 VP when you activate a shop effect";case"purple":return" First & last to run out of workers each round get 4 VP";case"white":return" All players start game with 5 VP when white is in play";case"gold":return" +1 VP per gold gem at end of each round";case"black":return" +1 VP whenever you steal from another player";case"silver":return" End of Round: Most VP get 3 Silver, others get 2 VP";default:return""}}function S_(t){return!t||Object.keys(t).length===0?v.createElement("div",{},"No VP yet"):v.createElement("div",{},Object.entries(t).map(([e,n])=>v.createElement("div",{key:e},`${Uk(e)}: ${n} VP`)))}function Uk(t){switch(t){case"redAction":return" Red Actions";case"yellowDiversity":return" Resource Diversity";case"blueShopUsage":return" Shop Usage";case"purpleWorkers":return" Worker Timing";case"victoryShop":return" Victory Shops";case"shopPurchase":return" Shop Purchases";case"whiteStarting":return" Starting VP";case"whiteAction":return" White Actions";case"whiteShop":return" White Shops";case"goldAutomatic":return" Gold Resources";case"goldVPPerGold":return" Gold Action";case"blackAutomatic":return" Stealing Bonus";case"blackSteal":return" Stolen VP";case"blackShop":return" Black Shop";case"blackVictoryShop":return" Victory Shop";case"blackPenalty":return" Black Penalty";case"silverAutomatic":return" Silver Automatic";case"silverAction":return" Silver Actions";case"silverShop":return" Silver Shops";default:return" Other"}}function Fa({color:t,round:e,label:n,currentRound:r}){const{state:s,dispatch:o}=Fe(),l={red:{1:{cost:{red:1,any:2},effect:"Repeat one of your patron's actions"},2:{cost:{red:2,any:2},effect:"Place the next player's patron for them"},3:{cost:{red:4,any:4},effect:"Pick a player. Repeat all actions where they have a patron"}},yellow:{1:{cost:{yellow:1,any:1},effect:"Double your next resource gain"},2:{cost:{yellow:2,any:2},effect:"Trigger Yellow auto VP now"},3:{cost:{yellow:3,any:3},effect:"Gain 10 resources (any colors)"}},blue:{1:{cost:{blue:1,any:1},effect:"Open or close any one shop"},2:{cost:{blue:2,any:2},effect:"Flip all shops (open  closed)"},3:{cost:{blue:3,any:3},effect:"Use any shop benefit for free"}},purple:{1:{cost:{purple:1,any:2},effect:"Take an extra turn after this one"},2:{cost:{purple:2,any:2},effect:"Place 2 more patrons this turn"},3:{cost:{purple:3,any:3},effect:"Place all your remaining patrons now"}},gold:{1:{cost:{gold:1,any:1},effect:"Trade: 1 Gold + 1 Any  2 Gold"},2:{cost:{gold:2,any:2},effect:"Trade: 2 Gold + 2 Any  4 Gold"},3:{cost:{gold:3,any:3},effect:"Trade: 3 Gold + 3 Any  Double your Gold"}},white:{1:{cost:{vp:1},effect:"Lose 1 VP, gain 1 resource (any color)"},2:{cost:{vp:2},effect:"Lose 3 VP, next player skips their turn"},3:{cost:{vp:3},effect:"Lose 5 VP, move one patron to any action"}},black:{1:{cost:{black:1,any:1},effect:"Steal 1 VP from any player"},2:{cost:{black:2,any:2},effect:"Steal 3 VP from any player"},3:{cost:{black:3,any:3},effect:"Steal 5 VP from any player"}},silver:{1:{cost:{silver:1,any:1},effect:"Gain 2 VP"},2:{cost:{silver:2,any:2},effect:"You and another player each gain 4 VP"},3:{cost:{silver:3,any:3},effect:"Gain 7 Silver, all others gain 2 Silver"}}}[t][e],a=`${t}${e}`,u=s.closedShops[a],f=!u,c=l.cost.vp||0,d=l.cost[t]||0,m=s.players.find(_=>_.id===s.currentPlayer),h=Math.max(0,(l.cost.any||0)+((m==null?void 0:m.shopCostModifier)||0)),y=async()=>{var D;if(u){alert("This shop is closed!");return}if(s.roomCode&&s.myPlayerId!==s.currentPlayer){alert("It's not your turn!");return}if(s.workersToPlace>0){alert("You must finish placing all your patrons before using a shop!");return}if(s.shopUsedAfterWorkers){alert("You have already used a shop this turn!");return}const _=s.players.find($=>$.id===s.currentPlayer);if(c>0){if(_.victoryPoints<c){alert(`Need ${c} VP. You have ${_.victoryPoints}.`);return}}else if(_.resources[t]<d){alert(`Need ${d} ${t} gems.`);return}const w=Object.values(_.resources).reduce(($,R)=>$+R,0);if((c>0?w:w-d)<h){alert(`Need ${h} additional gems.`);return}if(t==="red"&&e===1){const $=["redRepeatAction"];if(Object.entries(s.occupiedSpaces).filter(([q,Ge])=>Ge===_.id&&!$.includes(q)).length===0){alert("You have no valid patrons to repeat! The repeat action cannot repeat itself.");return}}const k={};if(d>0&&(k[t]=-d),h>0){const $={..._.resources};d>0&&t in $&&($[t]=Math.max(0,$[t]-d));const R=await pe(o,`Choose ${h} ${h===1?"gem":"gems"} to spend`,h,$);if(R)Object.entries(R).forEach(([q,Ge])=>{k[q]=(k[q]||0)-Ge});else return}if(c>0&&o({type:"UPDATE_VP",playerId:_.id,vp:-c,source:"shopCost"}),o({type:"UPDATE_RESOURCES",playerId:_.id,resources:k}),!await sc(t,e,_,o,s,0)){c>0&&o({type:"UPDATE_VP",playerId:_.id,vp:c,source:"shopRefund"});const $={};Object.entries(k).forEach(([R,q])=>{$[R]=-q}),o({type:"UPDATE_RESOURCES",playerId:_.id,resources:$}),o({type:"ADD_LOG",message:`Player ${_.id}: Shop purchase cancelled - costs refunded`});return}o({type:"USE_SHOP"}),(D=s.automaticVPs)!=null&&D.blue&&(o({type:"UPDATE_VP",playerId:_.id,vp:1,source:"blueShopUsage"}),o({type:"ADD_LOG",message:`Player ${_.id}: +1 VP (activated a shop effect)`}))},S=()=>{switch(t){case"red":return"";case"yellow":return"";case"blue":return"";case"purple":return"";case"gold":return"";case"white":return"";case"black":return"";case"silver":return"";default:return""}},g=()=>{if(!f)return"bg-gray-100";switch(t){case"red":return"bg-gradient-to-br from-red-50 to-red-100";case"yellow":return"bg-gradient-to-br from-yellow-50 to-yellow-100";case"blue":return"bg-gradient-to-br from-blue-50 to-blue-100";case"purple":return"bg-gradient-to-br from-purple-50 to-purple-100";case"gold":return"bg-gradient-to-br from-yellow-100 to-amber-100";case"white":return"bg-gradient-to-br from-gray-50 to-gray-100";case"black":return"bg-gradient-to-br from-gray-700 to-gray-800";case"silver":return"bg-gradient-to-br from-gray-200 to-gray-300";default:return"bg-white"}},p=()=>{if(!f)return"border-gray-300";switch(t){case"red":return"border-red-300";case"yellow":return"border-yellow-300";case"blue":return"border-blue-300";case"purple":return"border-purple-300";case"gold":return"border-amber-400";case"white":return"border-gray-400";case"black":return"border-gray-600";case"silver":return"border-gray-400";default:return"border-gray-300"}};return v.createElement("div",{className:`relative rounded-lg ${g()} ${p()} border-2 transition-all flex flex-col shadow hover:shadow-md overflow-hidden ${f?"":"opacity-60"}`},[v.createElement("div",{key:"header",className:"bg-white bg-opacity-80 px-2 py-1 flex items-center justify-between border-b "+p()},[v.createElement("span",{key:"round-label",className:"text-xs font-bold text-gray-900"},`R${e}`),v.createElement("div",{key:"cost",className:"text-sm font-bold flex items-center gap-0.5"},c>0?[v.createElement("span",{key:"vp",className:"text-purple-700"},`${c}VP`),h>0&&v.createElement("span",{key:"any",className:"text-gray-600"},`+${h}`)]:[d>0&&v.createElement("span",{key:"color"},`${d}${S()}`),d>0&&h>0&&v.createElement("span",{key:"plus",className:"text-gray-600"},"+"),h>0&&v.createElement("span",{key:"any",className:"text-gray-600"},`${h}`)])]),v.createElement("div",{key:"effect",className:`p-1.5 text-xs font-medium ${t==="black"?"text-white":"text-gray-900"} leading-tight text-center min-h-[45px] flex items-center justify-center`},l.effect),v.createElement("button",{key:"btn",onClick:y,className:`py-1 text-xs font-bold transition-all ${f?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-400 cursor-not-allowed text-gray-600"}`,disabled:!f},f?"BUY":"")])}function Mk({color:t}){const{state:e,dispatch:n}=Fe(),r={red:{cost:4,vp:5},yellow:{cost:4,vp:3},blue:{cost:4,vp:5},purple:{cost:4,vp:5},white:{cost:4,vp:4},black:{cost:6,vp:0,special:"steal2FromEach"},silver:{cost:6,vp:8}};if(t==="gold")return null;const s=r[t],o=`${t}vp`,i=e.closedShops[o],l=e.players.find(m=>m.id===e.currentPlayer),a=t==="black"||t==="white"?s.cost:Math.max(0,s.cost+((l==null?void 0:l.shopCostModifier)||0)),u=async()=>{var S;if(i){alert("This shop is closed!");return}if(e.roomCode&&e.myPlayerId!==e.currentPlayer){alert("It's not your turn!");return}if(e.workersToPlace>0){alert("You must finish placing all your patrons before using a VP shop!");return}if(e.vpShopUsed){alert("You can only use one VP shop per turn!");return}const m=e.players.find(g=>g.id===e.currentPlayer),h=t==="black"||t==="white"?s.cost:Math.max(0,s.cost+(m.shopCostModifier||0));if(t==="yellow"){if(Object.values(m.resources).reduce((p,_)=>p+_,0)<h){alert(`Need ${h} gems total.`);return}}else if(m.resources[t]<h){alert(`Need ${h} ${t} gems.`);return}const y={};if(t==="yellow"){const g=await pe(n,`Choose ${h} gems to pay`,h,m);if(!g)return;Object.entries(g).forEach(([p,_])=>{y[p]=y[p]?y[p]-_:-_})}else y[t]=-h;if(n({type:"UPDATE_RESOURCES",playerId:m.id,resources:y}),t==="black"&&s.special==="steal2FromEach"){const g=e.players.filter(_=>_.id!==m.id);let p=0;g.forEach(_=>{const w=Math.min(2,_.victoryPoints);w>0&&(n({type:"UPDATE_VP",playerId:_.id,vp:-w,source:"blackVictoryShop"}),p+=w)}),p>0?(n({type:"UPDATE_VP",playerId:m.id,vp:p,source:"blackVictoryShop"}),n({type:"ADD_LOG",message:`Player ${m.id}: Black Victory Shop  Stole ${p} VP (2 from each player)`}),n({type:"UPDATE_VP",playerId:m.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${m.id}: +1 VP (Black automatic: stealing bonus)`})):n({type:"ADD_LOG",message:`Player ${m.id}: Black Victory Shop  No VP to steal`})}else n({type:"UPDATE_VP",playerId:m.id,vp:s.vp,source:"victoryShop"});n({type:"USE_VP_SHOP"}),(S=e.automaticVPs)!=null&&S.blue&&(n({type:"UPDATE_VP",playerId:m.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${m.id}: +1 VP (activated a shop effect)`}))},f=()=>{switch(t){case"red":return"";case"yellow":return"";case"blue":return"";case"purple":return"";case"gold":return"";case"white":return"";case"black":return"";case"silver":return"";default:return""}},c=()=>i?"bg-gray-100":"bg-gradient-to-br from-emerald-50 to-emerald-100",d=()=>t==="black"&&s.special==="steal2FromEach"?"Steal 2 VP from each player":`Gain ${s.vp} Victory Points`;return v.createElement("div",{className:`p-2 rounded-lg ${c()} border-2 border-emerald-400 transition-all flex flex-col shadow-sm hover:shadow-md ${i?"opacity-50":""}`},[v.createElement("div",{key:"header",className:"flex items-center justify-between mb-1"},[v.createElement("div",{key:"vp-label",className:"text-xs font-bold text-emerald-700"}," VP"),v.createElement("div",{key:"cost",className:"text-xs font-bold"},t==="yellow"?`${a}`:`${a}${f()}`)]),v.createElement("div",{key:"effect",className:"text-xs text-gray-700 font-medium leading-tight mb-2 min-h-[2rem]"},d()),v.createElement("button",{key:"btn",onClick:u,className:`text-xs py-1 px-2 rounded font-semibold transition-all ${i?"bg-gray-300 cursor-not-allowed text-gray-500":"bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm hover:shadow"}`,disabled:i},"Buy")])}function Fk(){var l;const{state:t,dispatch:e}=Fe(),n=v.useRef(null),r=v.useRef(t);r.current=t,$e.useEffect(()=>{if(t.justSyncedFromFirebase){const a=setTimeout(()=>{e({type:"CLEAR_SYNC_FLAG"})},100);return()=>clearTimeout(a)}},[t.justSyncedFromFirebase]),$e.useEffect(()=>{t.pendingRoundAdvance&&!t.modal&&e({type:"SHOW_MODAL",modal:{type:"roundTransition",round:t.round+1,players:t.players}})},[t.pendingRoundAdvance,t.modal]),$e.useEffect(()=>{var a;!t.pendingRoundAdvance&&((a=t.modal)==null?void 0:a.type)==="roundTransition"&&e({type:"HIDE_MODAL"})},[t.pendingRoundAdvance,(l=t.modal)==null?void 0:l.type]),$e.useEffect(()=>(t.roomCode&&t.gameStarted&&!t.justSyncedFromFirebase&&(n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{const a=r.current,u={currentPlayer:a.currentPlayer,turnDirection:a.turnDirection,players:a.players,occupiedSpaces:a.occupiedSpaces,round:a.round,turnOrder:a.turnOrder,workerPlacedThisTurn:a.workerPlacedThisTurn,workersToPlace:a.workersToPlace,actionLog:a.actionLog,gameStarted:a.gameStarted,gameLayers:a.gameLayers,closedShops:a.closedShops,shopUsedAfterWorkers:a.shopUsedAfterWorkers,vpShopUsed:a.vpShopUsed,playersOutOfWorkers:a.playersOutOfWorkers,skippedTurns:a.skippedTurns,waitingForOthers:a.waitingForOthers,roundActions:a.roundActions,gameOver:a.gameOver,automaticVPs:a.automaticVPs,pendingPlacements:a.pendingPlacements||{},pendingRoundAdvance:a.pendingRoundAdvance||!1,lastUpdatedBy:a.myPlayerId,timestamp:Date.now()};console.log("Syncing game state to Firebase:",{myPlayerId:a.myPlayerId,currentPlayer:u.currentPlayer,gameLayers:u.gameLayers?Object.keys(u.gameLayers):null,gameStarted:u.gameStarted}),sk(a.roomCode,u)},200)),()=>{n.current&&clearTimeout(n.current)}),[t.currentPlayer,t.players,t.occupiedSpaces,t.round,t.actionLog,t.workersToPlace,t.gameLayers,t.closedShops,t.shopUsedAfterWorkers,t.vpShopUsed,t.playersOutOfWorkers,t.skippedTurns,t.waitingForOthers,t.roundActions,t.gameOver,t.automaticVPs,t.pendingPlacements]);const s=async()=>{if(t.roomCode&&t.myPlayerId!==t.currentPlayer){alert("It's not your turn!");return}if(t.players.find(a=>a.id===t.currentPlayer),t.workersToPlace>0){const a=t.workersToPlace;if(!await pk(e,"End Turn Early?",`You can still place ${a} more worker${a>1?"s":""} this turn. Are you sure you want to end your turn?`))return}e({type:"END_TURN"})},o=()=>{if(t.round<3){if(t.gameLayers&&t.gameLayers.yellow){const a=Object.keys(t.gameLayers);e({type:"ADD_LOG",message:`=== End of Round ${t.round}: Yellow Auto VP ===`}),t.players.forEach(u=>{const f=a.map(d=>u.resources[d]||0),c=Math.min(...f);c>0?(e({type:"UPDATE_VP",playerId:u.id,vp:c,source:"yellowAutoVP"}),e({type:"ADD_LOG",message:`Player ${u.id}: Yellow auto VP  +${c} VP (${c} complete sets of ${a.length} colors)`})):e({type:"ADD_LOG",message:`Player ${u.id}: Yellow auto VP  +0 VP (no complete sets)`})})}e({type:"SHOW_MODAL",modal:{type:"roundTransition",round:t.round+1,players:t.players}})}else alert("Game is already at Round 3 (final round)")},i=()=>{e({type:"RESET_GAME",preserveEmojis:!0})};if(!t.gameLayers){if(console.log("No game layers found. State:",{roomCode:t.roomCode,gameStarted:t.gameStarted,gameLayers:t.gameLayers,myPlayerId:t.myPlayerId,currentPlayer:t.currentPlayer}),!t.roomCode){console.log("Local play - selecting 4 layers");const a=fl(4);e({type:"SET_GAME_LAYERS",layers:a})}return v.createElement("div",{className:"min-h-screen flex items-center justify-center"},v.createElement("div",{className:"text-center glass rounded-xl p-8"},[v.createElement("h2",{key:"title",className:"text-2xl font-bold mb-4"},"Setting up game layers..."),v.createElement("div",{key:"spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),v.createElement("div",{key:"debug",className:"text-sm text-gray-600 mt-4"},[v.createElement("div",{key:"line1"},`Room: ${t.roomCode||"None"}, Started: ${t.gameStarted}`),v.createElement("div",{key:"line2"},`You are Player ${t.myPlayerId}, Current Turn: Player ${t.currentPlayer}`)])]))}return console.log("GameBoard rendering with layers:",Object.keys(t.gameLayers)),t.players.reduce((a,u)=>a+u.workersLeft,0),Object.values(t.gameLayers).reduce((a,u)=>a+u.actions.filter(f=>f.round<=t.round).length,0),v.createElement("div",{className:"min-h-screen p-4 overflow-x-hidden w-full max-w-full"},[v.createElement(ik,{key:"notifications",notifications:t.notifications,myPlayerId:t.myPlayerId}),v.createElement("div",{key:"container",className:"w-full px-6"},[v.createElement("div",{key:"top-bar",className:"flex items-stretch gap-3 mb-4"},[v.createElement("div",{key:"round",className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-3 rounded-lg shadow flex items-center gap-2"},[v.createElement("span",{key:"icon",className:"text-lg"},""),v.createElement("span",{key:"text",className:"text-base font-bold"},`Round ${t.round}`)]),t.currentPlayer&&(()=>{var f;const a=(f=t.players.find(c=>c.id===t.currentPlayer))==null?void 0:f.name;let u="";return t.workersToPlace>0?u=`  Place Patrons: ${t.workersToPlace}`:!t.shopUsedAfterWorkers?u="  Shop: R1/R2/R3  VP  End":u="  Shop: VP  End Turn",v.createElement("div",{key:"current-turn",className:"bg-gray-700 text-white px-4 py-3 rounded-lg shadow flex items-center gap-2"},[v.createElement("span",{key:"icon",className:"text-base"},""),v.createElement("span",{key:"text",className:"text-base font-bold"},`${a}'s Turn${u}`)])})(),t.roomCode&&v.createElement("div",{key:"room-badge",className:"bg-gray-700 text-white px-4 py-3 rounded-lg shadow flex items-center gap-2"},[v.createElement("span",{key:"icon",className:"text-base"},""),v.createElement("span",{key:"text",className:"text-base font-bold"},`Room: ${t.roomCode}`)]),...t.turnOrder.map((a,u)=>{const f=t.players.find(c=>c.id===a);return v.createElement(_p,{key:f.id,player:f,isCurrentPlayer:f.id===t.currentPlayer,onEndTurn:s,turnPosition:u+1})})]),v.createElement("div",{key:"game-area",className:"w-full"},[v.createElement("div",{key:"players-placeholder",className:"hidden"},t.turnOrder.map((a,u)=>{const f=t.players.find(c=>c.id===a);return v.createElement(_p,{key:f.id,player:f,isCurrentPlayer:f.id===t.currentPlayer,onEndTurn:s,turnPosition:u+1})})),v.createElement("div",{key:"layers",className:"grid grid-cols-2 gap-6 mb-6"},Object.entries(t.gameLayers).map(([a,u])=>v.createElement(Lk,{key:a,color:a,title:u.title,icon:u.icon,actions:u.actions,round:t.round}))),v.createElement("div",{key:"controls",className:"text-center glass rounded-lg p-4 shadow-lg"},[v.createElement("button",{key:"advance",onClick:o,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-2 px-4 rounded-lg mr-3 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},`Advance to Round ${Math.min(t.round+1,3)}`),v.createElement("button",{key:"reset",onClick:i,className:"bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},"Reset Game"),v.createElement("div",{key:"instructions",className:"text-gray-600 mt-3 text-sm"},"Place worker  Buy from shops  End turn (button under current player)"),t.actionLog.length>0&&v.createElement("div",{key:"action-log",className:"mt-4 p-3 bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg max-h-40 overflow-y-auto border border-gray-200 shadow-sm"},[v.createElement("div",{key:"log-title",className:"font-bold text-gray-800 mb-2 text-sm flex items-center gap-2"},[v.createElement("span",{key:"icon"},""),v.createElement("span",{key:"text"},"Recent Activity")]),...t.actionLog.map((a,u)=>{const f=Wk(a,t.players);return v.createElement("div",{key:u,className:"text-sm text-gray-700 mb-1.5 pl-2 border-l-2 border-gray-300 leading-relaxed"},f)})])])]),t.waitingForPlayer&&t.myPlayerId===t.currentPlayer&&v.createElement("div",{key:"waiting-indicator",className:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-yellow-100 border-2 border-yellow-400 rounded-lg p-4 shadow-lg z-50"},[v.createElement("div",{className:"flex items-center space-x-3"},[v.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"}),v.createElement("div",{className:"text-yellow-800 font-semibold"},`Waiting for Player ${t.waitingForPlayer} to make a choice...`)])]),t.modal&&t.roomCode&&t.modal.targetPlayerId&&t.modal.targetPlayerId!==t.myPlayerId&&v.createElement("div",{key:"modal-waiting-indicator",className:"fixed bottom-4 right-4 bg-blue-100 border-2 border-blue-400 rounded-lg p-3 shadow-lg z-40"},[v.createElement("div",{className:"flex items-center space-x-2"},[v.createElement("div",{className:"animate-pulse rounded-full h-3 w-3 bg-blue-600"}),v.createElement("div",{className:"text-blue-800 text-sm font-medium"},`Player ${t.modal.targetPlayerId} is making a decision...`)])]),t.modal&&(!t.roomCode||t.modal.type==="roundTransition"||t.myPlayerId===t.currentPlayer||t.modal.targetPlayerId===t.myPlayerId)&&v.createElement(ak,{key:"modal",isOpen:!0,onClose:()=>e({type:"HIDE_MODAL"})},t.modal.type==="choice"?v.createElement(uk,t.modal):t.modal.type==="gemSelection"?v.createElement(fk,t.modal):t.modal.type==="stealGems"?v.createElement(hk,t.modal):t.modal.type==="roundTransition"?v.createElement(dk,t.modal):v.createElement(ck,t.modal))])])}function Gk(){const{state:t,dispatch:e}=Fe(),n=[...t.players].sort((o,i)=>i.victoryPoints-o.victoryPoints),r=n[0],s=()=>{t.roomCode?e({type:"RESET_GAME"}):window.location.reload()};return v.createElement("div",{className:"min-h-screen bg-gradient-to-br from-yellow-100 via-purple-100 to-blue-100 flex items-center justify-center p-4"},v.createElement("div",{className:"glass rounded-xl p-8 max-w-2xl w-full text-center"},[v.createElement("h1",{key:"title",className:"text-4xl font-bold mb-2 bg-gradient-to-r from-yellow-600 to-purple-600 bg-clip-text text-transparent"},"Game Over!"),v.createElement("div",{key:"winner",className:"text-6xl mb-4"},""),v.createElement("h2",{key:"winner-name",className:"text-3xl font-bold mb-6"},`${r.name} ${r.emoji||""} Wins!`),v.createElement("div",{key:"winner-score",className:"text-2xl mb-8 text-gray-700"},`Final Score: ${r.victoryPoints} VP`),v.createElement("div",{key:"standings",className:"mb-8"},[v.createElement("h3",{key:"standings-title",className:"text-xl font-semibold mb-4"},"Final Standings"),v.createElement("div",{key:"players-list",className:"space-y-3"},n.map((o,i)=>v.createElement("div",{key:o.id,className:`glass rounded-lg p-4 ${i===0?"ring-2 ring-yellow-400":""}`},[v.createElement("div",{key:"header",className:"flex items-center justify-between mb-2"},[v.createElement("div",{key:"left",className:"flex items-center gap-3"},[v.createElement("div",{key:"rank",className:"text-2xl font-bold"},i===0?"":i===1?"":i===2?"":`${i+1}.`),v.createElement("div",{key:"name",className:"text-lg font-semibold"},`${o.name} ${o.emoji||""}`)]),v.createElement("div",{key:"score",className:"text-xl font-bold text-green-600"},`${o.victoryPoints} VP`)]),v.createElement("div",{key:"breakdown",className:"text-sm text-gray-700 pl-12"},S_(o.vpSources))])))]),v.createElement("button",{key:"play-again",onClick:s,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-8 py-3 rounded-lg font-semibold text-lg transform hover:scale-105 transition-all"},t.roomCode?"Back to Lobby":"Play Again")]))}function Vk(){return v.createElement(ek,{},v.createElement(Bk,{}))}function Bk(){const{state:t}=Fe();try{return t.gameStarted?t.gameOver?v.createElement(Gk,{}):v.createElement("div",{className:"min-h-screen"},[t.roomCode&&v.createElement(mp,{key:"players"}),v.createElement(Fk,{key:"game"})]):t.roomCode?v.createElement("div",{className:"min-h-screen p-4 overflow-x-hidden w-full max-w-full"},[v.createElement(mp,{key:"players"}),v.createElement("div",{key:"waiting",className:"text-center mt-8"},[v.createElement("div",{key:"spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),v.createElement("h2",{key:"text",className:"text-xl text-gray-600"},t.isHost?"Waiting for you to start the game...":"Waiting for host to start the game...")])]):v.createElement(ok,{})}catch(e){return console.error("Render error:",e),console.error("Error stack:",e.stack),console.error("Game state at error:",t),v.createElement("div",{className:"min-h-screen flex items-center justify-center p-4"},v.createElement("div",{className:"glass rounded-xl p-8 text-center"},[v.createElement("h1",{key:"title",className:"text-2xl font-bold text-red-600 mb-4"},"Game Error"),v.createElement("p",{key:"message",className:"text-gray-600 mb-4"},"Something went wrong. Check browser console for details."),v.createElement("div",{key:"error-details",className:"text-sm text-gray-500 mb-4 p-2 bg-gray-100 rounded"},`Error: ${e.message}`),v.createElement("button",{key:"reload",onClick:()=>window.location.reload(),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded"},"Reload Game")]))}}function Wk(t,e){if(!t)return t;let n=t;return e.forEach(r=>{const s=r.name||`Player ${r.id}`;n=n.replace(new RegExp(`Player ${r.id}`,"g"),s)}),n=n.replace(/,?\s*0\s+\w+/g,""),n=n.replace(/\s+,/g,","),n}const vp=new URLSearchParams(window.location.search);(vp.get("test")==="true"||vp.get("debug")==="true")&&(window.debugGetState=()=>{const t=document.getElementById("root")._reactRootContainer;if(!t)return null;let e=null;const n=r=>{r&&(r.memoizedState&&r.memoizedState.element&&r.memoizedState.element.type&&r.memoizedState.element.type.name==="App"&&r.memoizedState.memoizedState&&(e=r.memoizedState.memoizedState[0]),r.child&&n(r.child),r.sibling&&n(r.sibling))};return t._internalRoot&&n(t._internalRoot.current),e||window.lastKnownState||null},window.debugDispatch=t=>window.lastKnownDispatch?(window.lastKnownDispatch(t),!0):!1,window.debugLog=t=>{console.log("[DEBUG]",t)},console.log("Debug mode enabled. Available functions: debugGetState(), debugDispatch(action), debugLog(message)"));Ga.createRoot(document.getElementById("root")).render(of.jsx(v.StrictMode,{children:of.jsx(Vk,{})}));
