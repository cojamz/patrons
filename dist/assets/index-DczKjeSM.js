(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function D_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ep={exports:{}},_l={},Sp={exports:{}},j={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oo=Symbol.for("react.element"),x_=Symbol.for("react.portal"),O_=Symbol.for("react.fragment"),R_=Symbol.for("react.strict_mode"),N_=Symbol.for("react.profiler"),I_=Symbol.for("react.provider"),L_=Symbol.for("react.context"),$_=Symbol.for("react.forward_ref"),M_=Symbol.for("react.suspense"),U_=Symbol.for("react.memo"),F_=Symbol.for("react.lazy"),lf=Symbol.iterator;function V_(t){return t===null||typeof t!="object"?null:(t=lf&&t[lf]||t["@@iterator"],typeof t=="function"?t:null)}var Pp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kp=Object.assign,Cp={};function fs(t,e,n){this.props=t,this.context=e,this.refs=Cp,this.updater=n||Pp}fs.prototype.isReactComponent={};fs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Tp(){}Tp.prototype=fs.prototype;function dc(t,e,n){this.props=t,this.context=e,this.refs=Cp,this.updater=n||Pp}var fc=dc.prototype=new Tp;fc.constructor=dc;kp(fc,fs.prototype);fc.isPureReactComponent=!0;var af=Array.isArray,bp=Object.prototype.hasOwnProperty,hc={current:null},Ap={key:!0,ref:!0,__self:!0,__source:!0};function Dp(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)bp.call(e,r)&&!Ap.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Oo,type:t,key:o,ref:i,props:s,_owner:hc.current}}function G_(t,e){return{$$typeof:Oo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function pc(t){return typeof t=="object"&&t!==null&&t.$$typeof===Oo}function W_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var uf=/\/+/g;function ia(t,e){return typeof t=="object"&&t!==null&&t.key!=null?W_(""+t.key):e.toString(36)}function mi(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Oo:case x_:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+ia(i,0):r,af(s)?(n="",t!=null&&(n=t.replace(uf,"$&/")+"/"),mi(s,e,n,"",function(u){return u})):s!=null&&(pc(s)&&(s=G_(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(uf,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",af(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+ia(o,a);i+=mi(o,e,n,l,s)}else if(l=V_(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+ia(o,a++),i+=mi(o,e,n,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Ko(t,e,n){if(t==null)return t;var r=[],s=0;return mi(t,r,"","",function(o){return e.call(n,o,s++)}),r}function B_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var He={current:null},gi={transition:null},j_={ReactCurrentDispatcher:He,ReactCurrentBatchConfig:gi,ReactCurrentOwner:hc};function xp(){throw Error("act(...) is not supported in production builds of React.")}j.Children={map:Ko,forEach:function(t,e,n){Ko(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ko(t,function(){e++}),e},toArray:function(t){return Ko(t,function(e){return e})||[]},only:function(t){if(!pc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};j.Component=fs;j.Fragment=O_;j.Profiler=N_;j.PureComponent=dc;j.StrictMode=R_;j.Suspense=M_;j.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j_;j.act=xp;j.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=kp({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=hc.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)bp.call(e,l)&&!Ap.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Oo,type:t.type,key:s,ref:o,props:r,_owner:i}};j.createContext=function(t){return t={$$typeof:L_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:I_,_context:t},t.Consumer=t};j.createElement=Dp;j.createFactory=function(t){var e=Dp.bind(null,t);return e.type=t,e};j.createRef=function(){return{current:null}};j.forwardRef=function(t){return{$$typeof:$_,render:t}};j.isValidElement=pc;j.lazy=function(t){return{$$typeof:F_,_payload:{_status:-1,_result:t},_init:B_}};j.memo=function(t,e){return{$$typeof:U_,type:t,compare:e===void 0?null:e}};j.startTransition=function(t){var e=gi.transition;gi.transition={};try{t()}finally{gi.transition=e}};j.unstable_act=xp;j.useCallback=function(t,e){return He.current.useCallback(t,e)};j.useContext=function(t){return He.current.useContext(t)};j.useDebugValue=function(){};j.useDeferredValue=function(t){return He.current.useDeferredValue(t)};j.useEffect=function(t,e){return He.current.useEffect(t,e)};j.useId=function(){return He.current.useId()};j.useImperativeHandle=function(t,e,n){return He.current.useImperativeHandle(t,e,n)};j.useInsertionEffect=function(t,e){return He.current.useInsertionEffect(t,e)};j.useLayoutEffect=function(t,e){return He.current.useLayoutEffect(t,e)};j.useMemo=function(t,e){return He.current.useMemo(t,e)};j.useReducer=function(t,e,n){return He.current.useReducer(t,e,n)};j.useRef=function(t){return He.current.useRef(t)};j.useState=function(t){return He.current.useState(t)};j.useSyncExternalStore=function(t,e,n){return He.current.useSyncExternalStore(t,e,n)};j.useTransition=function(){return He.current.useTransition()};j.version="18.3.1";Sp.exports=j;var Je=Sp.exports;const y=D_(Je);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z_=Je,H_=Symbol.for("react.element"),Y_=Symbol.for("react.fragment"),Q_=Object.prototype.hasOwnProperty,K_=z_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,q_={key:!0,ref:!0,__self:!0,__source:!0};function Op(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)Q_.call(e,r)&&!q_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:H_,type:t,key:o,ref:i,props:s,_owner:K_.current}}_l.Fragment=Y_;_l.jsx=Op;_l.jsxs=Op;Ep.exports=_l;var cf=Ep.exports,Ha={},Rp={exports:{}},pt={},Np={exports:{}},Ip={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,$){var F=O.length;O.push($);e:for(;0<F;){var ie=F-1>>>1,pe=O[ie];if(0<s(pe,$))O[ie]=$,O[F]=pe,F=ie;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var $=O[0],F=O.pop();if(F!==$){O[0]=F;e:for(var ie=0,pe=O.length,yn=pe>>>1;ie<yn;){var Xt=2*(ie+1)-1,Es=O[Xt],Vt=Xt+1,Gt=O[Vt];if(0>s(Es,F))Vt<pe&&0>s(Gt,Es)?(O[ie]=Gt,O[Vt]=F,ie=Vt):(O[ie]=Es,O[Xt]=F,ie=Xt);else if(Vt<pe&&0>s(Gt,F))O[ie]=Gt,O[Vt]=F,ie=Vt;else break e}}return $}function s(O,$){var F=O.sortIndex-$.sortIndex;return F!==0?F:O.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],u=[],f=1,d=null,c=3,p=!1,m=!1,g=!1,E=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(O){for(var $=n(u);$!==null;){if($.callback===null)r(u);else if($.startTime<=O)r(u),$.sortIndex=$.expirationTime,e(l,$);else break;$=n(u)}}function S(O){if(g=!1,v(O),!m)if(n(l)!==null)m=!0,Ke(P);else{var $=n(u);$!==null&&Zn(S,$.startTime-O)}}function P(O,$){m=!1,g&&(g=!1,_(A),A=-1),p=!0;var F=c;try{for(v($),d=n(l);d!==null&&(!(d.expirationTime>$)||O&&!H());){var ie=d.callback;if(typeof ie=="function"){d.callback=null,c=d.priorityLevel;var pe=ie(d.expirationTime<=$);$=t.unstable_now(),typeof pe=="function"?d.callback=pe:d===n(l)&&r(l),v($)}else r(l);d=n(l)}if(d!==null)var yn=!0;else{var Xt=n(u);Xt!==null&&Zn(S,Xt.startTime-$),yn=!1}return yn}finally{d=null,c=F,p=!1}}var k=!1,T=null,A=-1,z=5,x=-1;function H(){return!(t.unstable_now()-x<z)}function xe(){if(T!==null){var O=t.unstable_now();x=O;var $=!0;try{$=T(!0,O)}finally{$?Qe():(k=!1,T=null)}}else k=!1}var Qe;if(typeof h=="function")Qe=function(){h(xe)};else if(typeof MessageChannel<"u"){var ra=new MessageChannel,J=ra.port2;ra.port1.onmessage=xe,Qe=function(){J.postMessage(null)}}else Qe=function(){E(xe,0)};function Ke(O){T=O,k||(k=!0,Qe())}function Zn(O,$){A=E(function(){O(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,Ke(P))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return c},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(c){case 1:case 2:case 3:var $=3;break;default:$=c}var F=c;c=$;try{return O()}finally{c=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,$){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var F=c;c=O;try{return $()}finally{c=F}},t.unstable_scheduleCallback=function(O,$,F){var ie=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?ie+F:ie):F=ie,O){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=F+pe,O={id:f++,callback:$,priorityLevel:O,startTime:F,expirationTime:pe,sortIndex:-1},F>ie?(O.sortIndex=F,e(u,O),n(l)===null&&O===n(u)&&(g?(_(A),A=-1):g=!0,Zn(S,F-ie))):(O.sortIndex=pe,e(l,O),m||p||(m=!0,Ke(P))),O},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(O){var $=c;return function(){var F=c;c=$;try{return O.apply(this,arguments)}finally{c=F}}}})(Ip);Np.exports=Ip;var X_=Np.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J_=Je,dt=X_;function C(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Lp=new Set,eo={};function Sr(t,e){Xr(t,e),Xr(t+"Capture",e)}function Xr(t,e){for(eo[t]=e,t=0;t<e.length;t++)Lp.add(e[t])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ya=Object.prototype.hasOwnProperty,Z_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,df={},ff={};function ev(t){return Ya.call(ff,t)?!0:Ya.call(df,t)?!1:Z_.test(t)?ff[t]=!0:(df[t]=!0,!1)}function tv(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nv(t,e,n,r){if(e===null||typeof e>"u"||tv(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ye(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Le={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Le[t]=new Ye(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Le[e]=new Ye(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Le[t]=new Ye(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Le[t]=new Ye(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Le[t]=new Ye(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Le[t]=new Ye(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Le[t]=new Ye(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Le[t]=new Ye(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Le[t]=new Ye(t,5,!1,t.toLowerCase(),null,!1,!1)});var mc=/[\-:]([a-z])/g;function gc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(mc,gc);Le[e]=new Ye(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(mc,gc);Le[e]=new Ye(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(mc,gc);Le[e]=new Ye(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Le[t]=new Ye(t,1,!1,t.toLowerCase(),null,!1,!1)});Le.xlinkHref=new Ye("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Le[t]=new Ye(t,1,!1,t.toLowerCase(),null,!0,!0)});function yc(t,e,n,r){var s=Le.hasOwnProperty(e)?Le[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nv(e,n,s,r)&&(n=null),r||s===null?ev(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gn=J_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qo=Symbol.for("react.element"),Or=Symbol.for("react.portal"),Rr=Symbol.for("react.fragment"),_c=Symbol.for("react.strict_mode"),Qa=Symbol.for("react.profiler"),$p=Symbol.for("react.provider"),Mp=Symbol.for("react.context"),vc=Symbol.for("react.forward_ref"),Ka=Symbol.for("react.suspense"),qa=Symbol.for("react.suspense_list"),wc=Symbol.for("react.memo"),wn=Symbol.for("react.lazy"),Up=Symbol.for("react.offscreen"),hf=Symbol.iterator;function Ps(t){return t===null||typeof t!="object"?null:(t=hf&&t[hf]||t["@@iterator"],typeof t=="function"?t:null)}var fe=Object.assign,la;function Ls(t){if(la===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);la=e&&e[1]||""}return`
`+la+t}var aa=!1;function ua(t,e){if(!t||aa)return"";aa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{aa=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ls(t):""}function rv(t){switch(t.tag){case 5:return Ls(t.type);case 16:return Ls("Lazy");case 13:return Ls("Suspense");case 19:return Ls("SuspenseList");case 0:case 2:case 15:return t=ua(t.type,!1),t;case 11:return t=ua(t.type.render,!1),t;case 1:return t=ua(t.type,!0),t;default:return""}}function Xa(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Rr:return"Fragment";case Or:return"Portal";case Qa:return"Profiler";case _c:return"StrictMode";case Ka:return"Suspense";case qa:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Mp:return(t.displayName||"Context")+".Consumer";case $p:return(t._context.displayName||"Context")+".Provider";case vc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case wc:return e=t.displayName||null,e!==null?e:Xa(t.type)||"Memo";case wn:e=t._payload,t=t._init;try{return Xa(t(e))}catch{}}return null}function sv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xa(e);case 8:return e===_c?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Fp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ov(t){var e=Fp(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Xo(t){t._valueTracker||(t._valueTracker=ov(t))}function Vp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Fp(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ai(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ja(t,e){var n=e.checked;return fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function pf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Gp(t,e){e=e.checked,e!=null&&yc(t,"checked",e,!1)}function Za(t,e){Gp(t,e);var n=Vn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?eu(t,e.type,n):e.hasOwnProperty("defaultValue")&&eu(t,e.type,Vn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function mf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function eu(t,e,n){(e!=="number"||Ai(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $s=Array.isArray;function Br(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vn(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function tu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(C(91));return fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function gf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(C(92));if($s(n)){if(1<n.length)throw Error(C(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vn(n)}}function Wp(t,e){var n=Vn(e.value),r=Vn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function yf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Bp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Bp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Jo,jp=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Jo=Jo||document.createElement("div"),Jo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Jo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function to(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iv=["Webkit","ms","Moz","O"];Object.keys(Vs).forEach(function(t){iv.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vs[e]=Vs[t]})});function zp(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vs.hasOwnProperty(t)&&Vs[t]?(""+e).trim():e+"px"}function Hp(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=zp(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var lv=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ru(t,e){if(e){if(lv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(C(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(C(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(C(61))}if(e.style!=null&&typeof e.style!="object")throw Error(C(62))}}function su(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ou=null;function Ec(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var iu=null,jr=null,zr=null;function _f(t){if(t=Io(t)){if(typeof iu!="function")throw Error(C(280));var e=t.stateNode;e&&(e=Pl(e),iu(t.stateNode,t.type,e))}}function Yp(t){jr?zr?zr.push(t):zr=[t]:jr=t}function Qp(){if(jr){var t=jr,e=zr;if(zr=jr=null,_f(t),e)for(t=0;t<e.length;t++)_f(e[t])}}function Kp(t,e){return t(e)}function qp(){}var ca=!1;function Xp(t,e,n){if(ca)return t(e,n);ca=!0;try{return Kp(t,e,n)}finally{ca=!1,(jr!==null||zr!==null)&&(qp(),Qp())}}function no(t,e){var n=t.stateNode;if(n===null)return null;var r=Pl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(C(231,e,typeof n));return n}var lu=!1;if(un)try{var ks={};Object.defineProperty(ks,"passive",{get:function(){lu=!0}}),window.addEventListener("test",ks,ks),window.removeEventListener("test",ks,ks)}catch{lu=!1}function av(t,e,n,r,s,o,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Gs=!1,Di=null,xi=!1,au=null,uv={onError:function(t){Gs=!0,Di=t}};function cv(t,e,n,r,s,o,i,a,l){Gs=!1,Di=null,av.apply(uv,arguments)}function dv(t,e,n,r,s,o,i,a,l){if(cv.apply(this,arguments),Gs){if(Gs){var u=Di;Gs=!1,Di=null}else throw Error(C(198));xi||(xi=!0,au=u)}}function Pr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Jp(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vf(t){if(Pr(t)!==t)throw Error(C(188))}function fv(t){var e=t.alternate;if(!e){if(e=Pr(t),e===null)throw Error(C(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return vf(s),t;if(o===r)return vf(s),e;o=o.sibling}throw Error(C(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(C(189))}}if(n.alternate!==r)throw Error(C(190))}if(n.tag!==3)throw Error(C(188));return n.stateNode.current===n?t:e}function Zp(t){return t=fv(t),t!==null?em(t):null}function em(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=em(t);if(e!==null)return e;t=t.sibling}return null}var tm=dt.unstable_scheduleCallback,wf=dt.unstable_cancelCallback,hv=dt.unstable_shouldYield,pv=dt.unstable_requestPaint,_e=dt.unstable_now,mv=dt.unstable_getCurrentPriorityLevel,Sc=dt.unstable_ImmediatePriority,nm=dt.unstable_UserBlockingPriority,Oi=dt.unstable_NormalPriority,gv=dt.unstable_LowPriority,rm=dt.unstable_IdlePriority,vl=null,Ht=null;function yv(t){if(Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(vl,t,void 0,(t.current.flags&128)===128)}catch{}}var Lt=Math.clz32?Math.clz32:wv,_v=Math.log,vv=Math.LN2;function wv(t){return t>>>=0,t===0?32:31-(_v(t)/vv|0)|0}var Zo=64,ei=4194304;function Ms(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ri(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=Ms(a):(o&=i,o!==0&&(r=Ms(o)))}else i=n&~s,i!==0?r=Ms(i):o!==0&&(r=Ms(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Lt(e),s=1<<n,r|=t[n],e&=~s;return r}function Ev(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sv(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-Lt(o),a=1<<i,l=s[i];l===-1?(!(a&n)||a&r)&&(s[i]=Ev(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function uu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sm(){var t=Zo;return Zo<<=1,!(Zo&4194240)&&(Zo=64),t}function da(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ro(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Lt(e),t[e]=n}function Pv(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Lt(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function Pc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Lt(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var q=0;function om(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var im,kc,lm,am,um,cu=!1,ti=[],An=null,Dn=null,xn=null,ro=new Map,so=new Map,Sn=[],kv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ef(t,e){switch(t){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":ro.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":so.delete(e.pointerId)}}function Cs(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=Io(e),e!==null&&kc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Cv(t,e,n,r,s){switch(e){case"focusin":return An=Cs(An,t,e,n,r,s),!0;case"dragenter":return Dn=Cs(Dn,t,e,n,r,s),!0;case"mouseover":return xn=Cs(xn,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return ro.set(o,Cs(ro.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,so.set(o,Cs(so.get(o)||null,t,e,n,r,s)),!0}return!1}function cm(t){var e=or(t.target);if(e!==null){var n=Pr(e);if(n!==null){if(e=n.tag,e===13){if(e=Jp(n),e!==null){t.blockedOn=e,um(t.priority,function(){lm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=du(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ou=r,n.target.dispatchEvent(r),ou=null}else return e=Io(n),e!==null&&kc(e),t.blockedOn=n,!1;e.shift()}return!0}function Sf(t,e,n){yi(t)&&n.delete(e)}function Tv(){cu=!1,An!==null&&yi(An)&&(An=null),Dn!==null&&yi(Dn)&&(Dn=null),xn!==null&&yi(xn)&&(xn=null),ro.forEach(Sf),so.forEach(Sf)}function Ts(t,e){t.blockedOn===e&&(t.blockedOn=null,cu||(cu=!0,dt.unstable_scheduleCallback(dt.unstable_NormalPriority,Tv)))}function oo(t){function e(s){return Ts(s,t)}if(0<ti.length){Ts(ti[0],t);for(var n=1;n<ti.length;n++){var r=ti[n];r.blockedOn===t&&(r.blockedOn=null)}}for(An!==null&&Ts(An,t),Dn!==null&&Ts(Dn,t),xn!==null&&Ts(xn,t),ro.forEach(e),so.forEach(e),n=0;n<Sn.length;n++)r=Sn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Sn.length&&(n=Sn[0],n.blockedOn===null);)cm(n),n.blockedOn===null&&Sn.shift()}var Hr=gn.ReactCurrentBatchConfig,Ni=!0;function bv(t,e,n,r){var s=q,o=Hr.transition;Hr.transition=null;try{q=1,Cc(t,e,n,r)}finally{q=s,Hr.transition=o}}function Av(t,e,n,r){var s=q,o=Hr.transition;Hr.transition=null;try{q=4,Cc(t,e,n,r)}finally{q=s,Hr.transition=o}}function Cc(t,e,n,r){if(Ni){var s=du(t,e,n,r);if(s===null)Ea(t,e,r,Ii,n),Ef(t,r);else if(Cv(s,t,e,n,r))r.stopPropagation();else if(Ef(t,r),e&4&&-1<kv.indexOf(t)){for(;s!==null;){var o=Io(s);if(o!==null&&im(o),o=du(t,e,n,r),o===null&&Ea(t,e,r,Ii,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Ea(t,e,r,null,n)}}var Ii=null;function du(t,e,n,r){if(Ii=null,t=Ec(r),t=or(t),t!==null)if(e=Pr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Jp(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ii=t,null}function dm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mv()){case Sc:return 1;case nm:return 4;case Oi:case gv:return 16;case rm:return 536870912;default:return 16}default:return 16}}var kn=null,Tc=null,_i=null;function fm(){if(_i)return _i;var t,e=Tc,n=e.length,r,s="value"in kn?kn.value:kn.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return _i=s.slice(t,1<r?1-r:void 0)}function vi(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ni(){return!0}function Pf(){return!1}function mt(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ni:Pf,this.isPropagationStopped=Pf,this}return fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ni)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ni)},persist:function(){},isPersistent:ni}),e}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bc=mt(hs),No=fe({},hs,{view:0,detail:0}),Dv=mt(No),fa,ha,bs,wl=fe({},No,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ac,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==bs&&(bs&&t.type==="mousemove"?(fa=t.screenX-bs.screenX,ha=t.screenY-bs.screenY):ha=fa=0,bs=t),fa)},movementY:function(t){return"movementY"in t?t.movementY:ha}}),kf=mt(wl),xv=fe({},wl,{dataTransfer:0}),Ov=mt(xv),Rv=fe({},No,{relatedTarget:0}),pa=mt(Rv),Nv=fe({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),Iv=mt(Nv),Lv=fe({},hs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),$v=mt(Lv),Mv=fe({},hs,{data:0}),Cf=mt(Mv),Uv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Vv[t])?!!e[t]:!1}function Ac(){return Gv}var Wv=fe({},No,{key:function(t){if(t.key){var e=Uv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ac,charCode:function(t){return t.type==="keypress"?vi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Bv=mt(Wv),jv=fe({},wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tf=mt(jv),zv=fe({},No,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ac}),Hv=mt(zv),Yv=fe({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qv=mt(Yv),Kv=fe({},wl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),qv=mt(Kv),Xv=[9,13,27,32],Dc=un&&"CompositionEvent"in window,Ws=null;un&&"documentMode"in document&&(Ws=document.documentMode);var Jv=un&&"TextEvent"in window&&!Ws,hm=un&&(!Dc||Ws&&8<Ws&&11>=Ws),bf=" ",Af=!1;function pm(t,e){switch(t){case"keyup":return Xv.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nr=!1;function Zv(t,e){switch(t){case"compositionend":return mm(e);case"keypress":return e.which!==32?null:(Af=!0,bf);case"textInput":return t=e.data,t===bf&&Af?null:t;default:return null}}function e0(t,e){if(Nr)return t==="compositionend"||!Dc&&pm(t,e)?(t=fm(),_i=Tc=kn=null,Nr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return hm&&e.locale!=="ko"?null:e.data;default:return null}}var t0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Df(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!t0[t.type]:e==="textarea"}function gm(t,e,n,r){Yp(r),e=Li(e,"onChange"),0<e.length&&(n=new bc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bs=null,io=null;function n0(t){bm(t,0)}function El(t){var e=$r(t);if(Vp(e))return t}function r0(t,e){if(t==="change")return e}var ym=!1;if(un){var ma;if(un){var ga="oninput"in document;if(!ga){var xf=document.createElement("div");xf.setAttribute("oninput","return;"),ga=typeof xf.oninput=="function"}ma=ga}else ma=!1;ym=ma&&(!document.documentMode||9<document.documentMode)}function Of(){Bs&&(Bs.detachEvent("onpropertychange",_m),io=Bs=null)}function _m(t){if(t.propertyName==="value"&&El(io)){var e=[];gm(e,io,t,Ec(t)),Xp(n0,e)}}function s0(t,e,n){t==="focusin"?(Of(),Bs=e,io=n,Bs.attachEvent("onpropertychange",_m)):t==="focusout"&&Of()}function o0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return El(io)}function i0(t,e){if(t==="click")return El(e)}function l0(t,e){if(t==="input"||t==="change")return El(e)}function a0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ut=typeof Object.is=="function"?Object.is:a0;function lo(t,e){if(Ut(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ya.call(e,s)||!Ut(t[s],e[s]))return!1}return!0}function Rf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Nf(t,e){var n=Rf(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Rf(n)}}function vm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function wm(){for(var t=window,e=Ai();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ai(t.document)}return e}function xc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function u0(t){var e=wm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&vm(n.ownerDocument.documentElement,n)){if(r!==null&&xc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=Nf(n,o);var i=Nf(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var c0=un&&"documentMode"in document&&11>=document.documentMode,Ir=null,fu=null,js=null,hu=!1;function If(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hu||Ir==null||Ir!==Ai(r)||(r=Ir,"selectionStart"in r&&xc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),js&&lo(js,r)||(js=r,r=Li(fu,"onSelect"),0<r.length&&(e=new bc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ir)))}function ri(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Lr={animationend:ri("Animation","AnimationEnd"),animationiteration:ri("Animation","AnimationIteration"),animationstart:ri("Animation","AnimationStart"),transitionend:ri("Transition","TransitionEnd")},ya={},Em={};un&&(Em=document.createElement("div").style,"AnimationEvent"in window||(delete Lr.animationend.animation,delete Lr.animationiteration.animation,delete Lr.animationstart.animation),"TransitionEvent"in window||delete Lr.transitionend.transition);function Sl(t){if(ya[t])return ya[t];if(!Lr[t])return t;var e=Lr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Em)return ya[t]=e[n];return t}var Sm=Sl("animationend"),Pm=Sl("animationiteration"),km=Sl("animationstart"),Cm=Sl("transitionend"),Tm=new Map,Lf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kn(t,e){Tm.set(t,e),Sr(e,[t])}for(var _a=0;_a<Lf.length;_a++){var va=Lf[_a],d0=va.toLowerCase(),f0=va[0].toUpperCase()+va.slice(1);Kn(d0,"on"+f0)}Kn(Sm,"onAnimationEnd");Kn(Pm,"onAnimationIteration");Kn(km,"onAnimationStart");Kn("dblclick","onDoubleClick");Kn("focusin","onFocus");Kn("focusout","onBlur");Kn(Cm,"onTransitionEnd");Xr("onMouseEnter",["mouseout","mouseover"]);Xr("onMouseLeave",["mouseout","mouseover"]);Xr("onPointerEnter",["pointerout","pointerover"]);Xr("onPointerLeave",["pointerout","pointerover"]);Sr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Us="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),h0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Us));function $f(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,dv(r,e,void 0,t),t.currentTarget=null}function bm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break e;$f(s,a,u),o=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break e;$f(s,a,u),o=l}}}if(xi)throw t=au,xi=!1,au=null,t}function se(t,e){var n=e[_u];n===void 0&&(n=e[_u]=new Set);var r=t+"__bubble";n.has(r)||(Am(e,t,2,!1),n.add(r))}function wa(t,e,n){var r=0;e&&(r|=4),Am(n,t,r,e)}var si="_reactListening"+Math.random().toString(36).slice(2);function ao(t){if(!t[si]){t[si]=!0,Lp.forEach(function(n){n!=="selectionchange"&&(h0.has(n)||wa(n,!1,t),wa(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[si]||(e[si]=!0,wa("selectionchange",!1,e))}}function Am(t,e,n,r){switch(dm(e)){case 1:var s=bv;break;case 4:s=Av;break;default:s=Cc}n=s.bind(null,e,n,t),s=void 0,!lu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Ea(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;a!==null;){if(i=or(a),i===null)return;if(l=i.tag,l===5||l===6){r=o=i;continue e}a=a.parentNode}}r=r.return}Xp(function(){var u=o,f=Ec(n),d=[];e:{var c=Tm.get(t);if(c!==void 0){var p=bc,m=t;switch(t){case"keypress":if(vi(n)===0)break e;case"keydown":case"keyup":p=Bv;break;case"focusin":m="focus",p=pa;break;case"focusout":m="blur",p=pa;break;case"beforeblur":case"afterblur":p=pa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=kf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Ov;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Hv;break;case Sm:case Pm:case km:p=Iv;break;case Cm:p=Qv;break;case"scroll":p=Dv;break;case"wheel":p=qv;break;case"copy":case"cut":case"paste":p=$v;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Tf}var g=(e&4)!==0,E=!g&&t==="scroll",_=g?c!==null?c+"Capture":null:c;g=[];for(var h=u,v;h!==null;){v=h;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,_!==null&&(S=no(h,_),S!=null&&g.push(uo(h,S,v)))),E)break;h=h.return}0<g.length&&(c=new p(c,m,null,n,f),d.push({event:c,listeners:g}))}}if(!(e&7)){e:{if(c=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",c&&n!==ou&&(m=n.relatedTarget||n.fromElement)&&(or(m)||m[cn]))break e;if((p||c)&&(c=f.window===f?f:(c=f.ownerDocument)?c.defaultView||c.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=u,m=m?or(m):null,m!==null&&(E=Pr(m),m!==E||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(g=kf,S="onMouseLeave",_="onMouseEnter",h="mouse",(t==="pointerout"||t==="pointerover")&&(g=Tf,S="onPointerLeave",_="onPointerEnter",h="pointer"),E=p==null?c:$r(p),v=m==null?c:$r(m),c=new g(S,h+"leave",p,n,f),c.target=E,c.relatedTarget=v,S=null,or(f)===u&&(g=new g(_,h+"enter",m,n,f),g.target=v,g.relatedTarget=E,S=g),E=S,p&&m)t:{for(g=p,_=m,h=0,v=g;v;v=Ar(v))h++;for(v=0,S=_;S;S=Ar(S))v++;for(;0<h-v;)g=Ar(g),h--;for(;0<v-h;)_=Ar(_),v--;for(;h--;){if(g===_||_!==null&&g===_.alternate)break t;g=Ar(g),_=Ar(_)}g=null}else g=null;p!==null&&Mf(d,c,p,g,!1),m!==null&&E!==null&&Mf(d,E,m,g,!0)}}e:{if(c=u?$r(u):window,p=c.nodeName&&c.nodeName.toLowerCase(),p==="select"||p==="input"&&c.type==="file")var P=r0;else if(Df(c))if(ym)P=l0;else{P=o0;var k=s0}else(p=c.nodeName)&&p.toLowerCase()==="input"&&(c.type==="checkbox"||c.type==="radio")&&(P=i0);if(P&&(P=P(t,u))){gm(d,P,n,f);break e}k&&k(t,c,u),t==="focusout"&&(k=c._wrapperState)&&k.controlled&&c.type==="number"&&eu(c,"number",c.value)}switch(k=u?$r(u):window,t){case"focusin":(Df(k)||k.contentEditable==="true")&&(Ir=k,fu=u,js=null);break;case"focusout":js=fu=Ir=null;break;case"mousedown":hu=!0;break;case"contextmenu":case"mouseup":case"dragend":hu=!1,If(d,n,f);break;case"selectionchange":if(c0)break;case"keydown":case"keyup":If(d,n,f)}var T;if(Dc)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Nr?pm(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(hm&&n.locale!=="ko"&&(Nr||A!=="onCompositionStart"?A==="onCompositionEnd"&&Nr&&(T=fm()):(kn=f,Tc="value"in kn?kn.value:kn.textContent,Nr=!0)),k=Li(u,A),0<k.length&&(A=new Cf(A,t,null,n,f),d.push({event:A,listeners:k}),T?A.data=T:(T=mm(n),T!==null&&(A.data=T)))),(T=Jv?Zv(t,n):e0(t,n))&&(u=Li(u,"onBeforeInput"),0<u.length&&(f=new Cf("onBeforeInput","beforeinput",null,n,f),d.push({event:f,listeners:u}),f.data=T))}bm(d,e)})}function uo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Li(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=no(t,n),o!=null&&r.unshift(uo(t,o,s)),o=no(t,e),o!=null&&r.push(uo(t,o,s))),t=t.return}return r}function Ar(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Mf(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=no(n,o),l!=null&&i.unshift(uo(n,l,a))):s||(l=no(n,o),l!=null&&i.push(uo(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var p0=/\r\n?/g,m0=/\u0000|\uFFFD/g;function Uf(t){return(typeof t=="string"?t:""+t).replace(p0,`
`).replace(m0,"")}function oi(t,e,n){if(e=Uf(e),Uf(t)!==e&&n)throw Error(C(425))}function $i(){}var pu=null,mu=null;function gu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yu=typeof setTimeout=="function"?setTimeout:void 0,g0=typeof clearTimeout=="function"?clearTimeout:void 0,Ff=typeof Promise=="function"?Promise:void 0,y0=typeof queueMicrotask=="function"?queueMicrotask:typeof Ff<"u"?function(t){return Ff.resolve(null).then(t).catch(_0)}:yu;function _0(t){setTimeout(function(){throw t})}function Sa(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),oo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);oo(e)}function On(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Vf(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ps=Math.random().toString(36).slice(2),zt="__reactFiber$"+ps,co="__reactProps$"+ps,cn="__reactContainer$"+ps,_u="__reactEvents$"+ps,v0="__reactListeners$"+ps,w0="__reactHandles$"+ps;function or(t){var e=t[zt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cn]||n[zt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Vf(t);t!==null;){if(n=t[zt])return n;t=Vf(t)}return e}t=n,n=t.parentNode}return null}function Io(t){return t=t[zt]||t[cn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $r(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(C(33))}function Pl(t){return t[co]||null}var vu=[],Mr=-1;function qn(t){return{current:t}}function oe(t){0>Mr||(t.current=vu[Mr],vu[Mr]=null,Mr--)}function ne(t,e){Mr++,vu[Mr]=t.current,t.current=e}var Gn={},Ve=qn(Gn),tt=qn(!1),hr=Gn;function Jr(t,e){var n=t.type.contextTypes;if(!n)return Gn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function nt(t){return t=t.childContextTypes,t!=null}function Mi(){oe(tt),oe(Ve)}function Gf(t,e,n){if(Ve.current!==Gn)throw Error(C(168));ne(Ve,e),ne(tt,n)}function Dm(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(C(108,sv(t)||"Unknown",s));return fe({},n,r)}function Ui(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Gn,hr=Ve.current,ne(Ve,t),ne(tt,tt.current),!0}function Wf(t,e,n){var r=t.stateNode;if(!r)throw Error(C(169));n?(t=Dm(t,e,hr),r.__reactInternalMemoizedMergedChildContext=t,oe(tt),oe(Ve),ne(Ve,t)):oe(tt),ne(tt,n)}var tn=null,kl=!1,Pa=!1;function xm(t){tn===null?tn=[t]:tn.push(t)}function E0(t){kl=!0,xm(t)}function Xn(){if(!Pa&&tn!==null){Pa=!0;var t=0,e=q;try{var n=tn;for(q=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}tn=null,kl=!1}catch(s){throw tn!==null&&(tn=tn.slice(t+1)),tm(Sc,Xn),s}finally{q=e,Pa=!1}}return null}var Ur=[],Fr=0,Fi=null,Vi=0,yt=[],_t=0,pr=null,nn=1,rn="";function tr(t,e){Ur[Fr++]=Vi,Ur[Fr++]=Fi,Fi=t,Vi=e}function Om(t,e,n){yt[_t++]=nn,yt[_t++]=rn,yt[_t++]=pr,pr=t;var r=nn;t=rn;var s=32-Lt(r)-1;r&=~(1<<s),n+=1;var o=32-Lt(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,nn=1<<32-Lt(e)+s|n<<s|r,rn=o+t}else nn=1<<o|n<<s|r,rn=t}function Oc(t){t.return!==null&&(tr(t,1),Om(t,1,0))}function Rc(t){for(;t===Fi;)Fi=Ur[--Fr],Ur[Fr]=null,Vi=Ur[--Fr],Ur[Fr]=null;for(;t===pr;)pr=yt[--_t],yt[_t]=null,rn=yt[--_t],yt[_t]=null,nn=yt[--_t],yt[_t]=null}var ut=null,at=null,le=!1,Nt=null;function Rm(t,e){var n=Et(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Bf(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ut=t,at=On(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ut=t,at=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pr!==null?{id:nn,overflow:rn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Et(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ut=t,at=null,!0):!1;default:return!1}}function wu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Eu(t){if(le){var e=at;if(e){var n=e;if(!Bf(t,e)){if(wu(t))throw Error(C(418));e=On(n.nextSibling);var r=ut;e&&Bf(t,e)?Rm(r,n):(t.flags=t.flags&-4097|2,le=!1,ut=t)}}else{if(wu(t))throw Error(C(418));t.flags=t.flags&-4097|2,le=!1,ut=t}}}function jf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ut=t}function ii(t){if(t!==ut)return!1;if(!le)return jf(t),le=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!gu(t.type,t.memoizedProps)),e&&(e=at)){if(wu(t))throw Nm(),Error(C(418));for(;e;)Rm(t,e),e=On(e.nextSibling)}if(jf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(C(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){at=On(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}at=null}}else at=ut?On(t.stateNode.nextSibling):null;return!0}function Nm(){for(var t=at;t;)t=On(t.nextSibling)}function Zr(){at=ut=null,le=!1}function Nc(t){Nt===null?Nt=[t]:Nt.push(t)}var S0=gn.ReactCurrentBatchConfig;function As(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(C(309));var r=n.stateNode}if(!r)throw Error(C(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(C(284));if(!n._owner)throw Error(C(290,t))}return t}function li(t,e){throw t=Object.prototype.toString.call(e),Error(C(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function zf(t){var e=t._init;return e(t._payload)}function Im(t){function e(_,h){if(t){var v=_.deletions;v===null?(_.deletions=[h],_.flags|=16):v.push(h)}}function n(_,h){if(!t)return null;for(;h!==null;)e(_,h),h=h.sibling;return null}function r(_,h){for(_=new Map;h!==null;)h.key!==null?_.set(h.key,h):_.set(h.index,h),h=h.sibling;return _}function s(_,h){return _=Ln(_,h),_.index=0,_.sibling=null,_}function o(_,h,v){return _.index=v,t?(v=_.alternate,v!==null?(v=v.index,v<h?(_.flags|=2,h):v):(_.flags|=2,h)):(_.flags|=1048576,h)}function i(_){return t&&_.alternate===null&&(_.flags|=2),_}function a(_,h,v,S){return h===null||h.tag!==6?(h=xa(v,_.mode,S),h.return=_,h):(h=s(h,v),h.return=_,h)}function l(_,h,v,S){var P=v.type;return P===Rr?f(_,h,v.props.children,S,v.key):h!==null&&(h.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===wn&&zf(P)===h.type)?(S=s(h,v.props),S.ref=As(_,h,v),S.return=_,S):(S=Ti(v.type,v.key,v.props,null,_.mode,S),S.ref=As(_,h,v),S.return=_,S)}function u(_,h,v,S){return h===null||h.tag!==4||h.stateNode.containerInfo!==v.containerInfo||h.stateNode.implementation!==v.implementation?(h=Oa(v,_.mode,S),h.return=_,h):(h=s(h,v.children||[]),h.return=_,h)}function f(_,h,v,S,P){return h===null||h.tag!==7?(h=cr(v,_.mode,S,P),h.return=_,h):(h=s(h,v),h.return=_,h)}function d(_,h,v){if(typeof h=="string"&&h!==""||typeof h=="number")return h=xa(""+h,_.mode,v),h.return=_,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case qo:return v=Ti(h.type,h.key,h.props,null,_.mode,v),v.ref=As(_,null,h),v.return=_,v;case Or:return h=Oa(h,_.mode,v),h.return=_,h;case wn:var S=h._init;return d(_,S(h._payload),v)}if($s(h)||Ps(h))return h=cr(h,_.mode,v,null),h.return=_,h;li(_,h)}return null}function c(_,h,v,S){var P=h!==null?h.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return P!==null?null:a(_,h,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case qo:return v.key===P?l(_,h,v,S):null;case Or:return v.key===P?u(_,h,v,S):null;case wn:return P=v._init,c(_,h,P(v._payload),S)}if($s(v)||Ps(v))return P!==null?null:f(_,h,v,S,null);li(_,v)}return null}function p(_,h,v,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return _=_.get(v)||null,a(h,_,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case qo:return _=_.get(S.key===null?v:S.key)||null,l(h,_,S,P);case Or:return _=_.get(S.key===null?v:S.key)||null,u(h,_,S,P);case wn:var k=S._init;return p(_,h,v,k(S._payload),P)}if($s(S)||Ps(S))return _=_.get(v)||null,f(h,_,S,P,null);li(h,S)}return null}function m(_,h,v,S){for(var P=null,k=null,T=h,A=h=0,z=null;T!==null&&A<v.length;A++){T.index>A?(z=T,T=null):z=T.sibling;var x=c(_,T,v[A],S);if(x===null){T===null&&(T=z);break}t&&T&&x.alternate===null&&e(_,T),h=o(x,h,A),k===null?P=x:k.sibling=x,k=x,T=z}if(A===v.length)return n(_,T),le&&tr(_,A),P;if(T===null){for(;A<v.length;A++)T=d(_,v[A],S),T!==null&&(h=o(T,h,A),k===null?P=T:k.sibling=T,k=T);return le&&tr(_,A),P}for(T=r(_,T);A<v.length;A++)z=p(T,_,A,v[A],S),z!==null&&(t&&z.alternate!==null&&T.delete(z.key===null?A:z.key),h=o(z,h,A),k===null?P=z:k.sibling=z,k=z);return t&&T.forEach(function(H){return e(_,H)}),le&&tr(_,A),P}function g(_,h,v,S){var P=Ps(v);if(typeof P!="function")throw Error(C(150));if(v=P.call(v),v==null)throw Error(C(151));for(var k=P=null,T=h,A=h=0,z=null,x=v.next();T!==null&&!x.done;A++,x=v.next()){T.index>A?(z=T,T=null):z=T.sibling;var H=c(_,T,x.value,S);if(H===null){T===null&&(T=z);break}t&&T&&H.alternate===null&&e(_,T),h=o(H,h,A),k===null?P=H:k.sibling=H,k=H,T=z}if(x.done)return n(_,T),le&&tr(_,A),P;if(T===null){for(;!x.done;A++,x=v.next())x=d(_,x.value,S),x!==null&&(h=o(x,h,A),k===null?P=x:k.sibling=x,k=x);return le&&tr(_,A),P}for(T=r(_,T);!x.done;A++,x=v.next())x=p(T,_,A,x.value,S),x!==null&&(t&&x.alternate!==null&&T.delete(x.key===null?A:x.key),h=o(x,h,A),k===null?P=x:k.sibling=x,k=x);return t&&T.forEach(function(xe){return e(_,xe)}),le&&tr(_,A),P}function E(_,h,v,S){if(typeof v=="object"&&v!==null&&v.type===Rr&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case qo:e:{for(var P=v.key,k=h;k!==null;){if(k.key===P){if(P=v.type,P===Rr){if(k.tag===7){n(_,k.sibling),h=s(k,v.props.children),h.return=_,_=h;break e}}else if(k.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===wn&&zf(P)===k.type){n(_,k.sibling),h=s(k,v.props),h.ref=As(_,k,v),h.return=_,_=h;break e}n(_,k);break}else e(_,k);k=k.sibling}v.type===Rr?(h=cr(v.props.children,_.mode,S,v.key),h.return=_,_=h):(S=Ti(v.type,v.key,v.props,null,_.mode,S),S.ref=As(_,h,v),S.return=_,_=S)}return i(_);case Or:e:{for(k=v.key;h!==null;){if(h.key===k)if(h.tag===4&&h.stateNode.containerInfo===v.containerInfo&&h.stateNode.implementation===v.implementation){n(_,h.sibling),h=s(h,v.children||[]),h.return=_,_=h;break e}else{n(_,h);break}else e(_,h);h=h.sibling}h=Oa(v,_.mode,S),h.return=_,_=h}return i(_);case wn:return k=v._init,E(_,h,k(v._payload),S)}if($s(v))return m(_,h,v,S);if(Ps(v))return g(_,h,v,S);li(_,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,h!==null&&h.tag===6?(n(_,h.sibling),h=s(h,v),h.return=_,_=h):(n(_,h),h=xa(v,_.mode,S),h.return=_,_=h),i(_)):n(_,h)}return E}var es=Im(!0),Lm=Im(!1),Gi=qn(null),Wi=null,Vr=null,Ic=null;function Lc(){Ic=Vr=Wi=null}function $c(t){var e=Gi.current;oe(Gi),t._currentValue=e}function Su(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yr(t,e){Wi=t,Ic=Vr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ze=!0),t.firstContext=null)}function Ct(t){var e=t._currentValue;if(Ic!==t)if(t={context:t,memoizedValue:e,next:null},Vr===null){if(Wi===null)throw Error(C(308));Vr=t,Wi.dependencies={lanes:0,firstContext:t}}else Vr=Vr.next=t;return e}var ir=null;function Mc(t){ir===null?ir=[t]:ir.push(t)}function $m(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Mc(e)):(n.next=s.next,s.next=n),e.interleaved=n,dn(t,r)}function dn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var En=!1;function Uc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function on(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Y&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,dn(t,n)}return s=r.interleaved,s===null?(e.next=e,Mc(r)):(e.next=s.next,s.next=e),r.interleaved=e,dn(t,n)}function wi(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pc(t,n)}}function Hf(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Bi(t,e,n,r){var s=t.updateQueue;En=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?o=u:i.next=u,i=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==i&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(o!==null){var d=s.baseState;i=0,f=u=l=null,a=o;do{var c=a.lane,p=a.eventTime;if((r&c)===c){f!==null&&(f=f.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(c=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){d=m.call(p,d,c);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,c=typeof m=="function"?m.call(p,d,c):m,c==null)break e;d=fe({},d,c);break e;case 2:En=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,c=s.effects,c===null?s.effects=[a]:c.push(a))}else p={eventTime:p,lane:c,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=p,l=d):f=f.next=p,i|=c;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;c=a,a=c.next,c.next=null,s.lastBaseUpdate=c,s.shared.pending=null}}while(!0);if(f===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);gr|=i,t.lanes=i,t.memoizedState=d}}function Yf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(C(191,s));s.call(r)}}}var Lo={},Yt=qn(Lo),fo=qn(Lo),ho=qn(Lo);function lr(t){if(t===Lo)throw Error(C(174));return t}function Fc(t,e){switch(ne(ho,e),ne(fo,t),ne(Yt,Lo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:nu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=nu(e,t)}oe(Yt),ne(Yt,e)}function ts(){oe(Yt),oe(fo),oe(ho)}function Um(t){lr(ho.current);var e=lr(Yt.current),n=nu(e,t.type);e!==n&&(ne(fo,t),ne(Yt,n))}function Vc(t){fo.current===t&&(oe(Yt),oe(fo))}var ue=qn(0);function ji(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ka=[];function Gc(){for(var t=0;t<ka.length;t++)ka[t]._workInProgressVersionPrimary=null;ka.length=0}var Ei=gn.ReactCurrentDispatcher,Ca=gn.ReactCurrentBatchConfig,mr=0,de=null,we=null,ke=null,zi=!1,zs=!1,po=0,P0=0;function $e(){throw Error(C(321))}function Wc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ut(t[n],e[n]))return!1;return!0}function Bc(t,e,n,r,s,o){if(mr=o,de=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ei.current=t===null||t.memoizedState===null?b0:A0,t=n(r,s),zs){o=0;do{if(zs=!1,po=0,25<=o)throw Error(C(301));o+=1,ke=we=null,e.updateQueue=null,Ei.current=D0,t=n(r,s)}while(zs)}if(Ei.current=Hi,e=we!==null&&we.next!==null,mr=0,ke=we=de=null,zi=!1,e)throw Error(C(300));return t}function jc(){var t=po!==0;return po=0,t}function jt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ke===null?de.memoizedState=ke=t:ke=ke.next=t,ke}function Tt(){if(we===null){var t=de.alternate;t=t!==null?t.memoizedState:null}else t=we.next;var e=ke===null?de.memoizedState:ke.next;if(e!==null)ke=e,we=t;else{if(t===null)throw Error(C(310));we=t,t={memoizedState:we.memoizedState,baseState:we.baseState,baseQueue:we.baseQueue,queue:we.queue,next:null},ke===null?de.memoizedState=ke=t:ke=ke.next=t}return ke}function mo(t,e){return typeof e=="function"?e(t):e}function Ta(t){var e=Tt(),n=e.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=t;var r=we,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,l=null,u=o;do{var f=u.lane;if((mr&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,i=r):l=l.next=d,de.lanes|=f,gr|=f}u=u.next}while(u!==null&&u!==o);l===null?i=r:l.next=a,Ut(r,e.memoizedState)||(Ze=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,de.lanes|=o,gr|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ba(t){var e=Tt(),n=e.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);Ut(o,e.memoizedState)||(Ze=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Fm(){}function Vm(t,e){var n=de,r=Tt(),s=e(),o=!Ut(r.memoizedState,s);if(o&&(r.memoizedState=s,Ze=!0),r=r.queue,zc(Bm.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||ke!==null&&ke.memoizedState.tag&1){if(n.flags|=2048,go(9,Wm.bind(null,n,r,s,e),void 0,null),Ae===null)throw Error(C(349));mr&30||Gm(n,e,s)}return s}function Gm(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=de.updateQueue,e===null?(e={lastEffect:null,stores:null},de.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Wm(t,e,n,r){e.value=n,e.getSnapshot=r,jm(e)&&zm(t)}function Bm(t,e,n){return n(function(){jm(e)&&zm(t)})}function jm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ut(t,n)}catch{return!0}}function zm(t){var e=dn(t,1);e!==null&&$t(e,t,1,-1)}function Qf(t){var e=jt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:t},e.queue=t,t=t.dispatch=T0.bind(null,de,t),[e.memoizedState,t]}function go(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=de.updateQueue,e===null?(e={lastEffect:null,stores:null},de.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Hm(){return Tt().memoizedState}function Si(t,e,n,r){var s=jt();de.flags|=t,s.memoizedState=go(1|e,n,void 0,r===void 0?null:r)}function Cl(t,e,n,r){var s=Tt();r=r===void 0?null:r;var o=void 0;if(we!==null){var i=we.memoizedState;if(o=i.destroy,r!==null&&Wc(r,i.deps)){s.memoizedState=go(e,n,o,r);return}}de.flags|=t,s.memoizedState=go(1|e,n,o,r)}function Kf(t,e){return Si(8390656,8,t,e)}function zc(t,e){return Cl(2048,8,t,e)}function Ym(t,e){return Cl(4,2,t,e)}function Qm(t,e){return Cl(4,4,t,e)}function Km(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qm(t,e,n){return n=n!=null?n.concat([t]):null,Cl(4,4,Km.bind(null,e,t),n)}function Hc(){}function Xm(t,e){var n=Tt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Jm(t,e){var n=Tt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Zm(t,e,n){return mr&21?(Ut(n,e)||(n=sm(),de.lanes|=n,gr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ze=!0),t.memoizedState=n)}function k0(t,e){var n=q;q=n!==0&&4>n?n:4,t(!0);var r=Ca.transition;Ca.transition={};try{t(!1),e()}finally{q=n,Ca.transition=r}}function eg(){return Tt().memoizedState}function C0(t,e,n){var r=In(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tg(t))ng(e,n);else if(n=$m(t,e,n,r),n!==null){var s=ze();$t(n,t,r,s),rg(n,e,r)}}function T0(t,e,n){var r=In(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tg(t))ng(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,Ut(a,i)){var l=e.interleaved;l===null?(s.next=s,Mc(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=$m(t,e,s,r),n!==null&&(s=ze(),$t(n,t,r,s),rg(n,e,r))}}function tg(t){var e=t.alternate;return t===de||e!==null&&e===de}function ng(t,e){zs=zi=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rg(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pc(t,n)}}var Hi={readContext:Ct,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useInsertionEffect:$e,useLayoutEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useDeferredValue:$e,useTransition:$e,useMutableSource:$e,useSyncExternalStore:$e,useId:$e,unstable_isNewReconciler:!1},b0={readContext:Ct,useCallback:function(t,e){return jt().memoizedState=[t,e===void 0?null:e],t},useContext:Ct,useEffect:Kf,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Si(4194308,4,Km.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Si(4194308,4,t,e)},useInsertionEffect:function(t,e){return Si(4,2,t,e)},useMemo:function(t,e){var n=jt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=C0.bind(null,de,t),[r.memoizedState,t]},useRef:function(t){var e=jt();return t={current:t},e.memoizedState=t},useState:Qf,useDebugValue:Hc,useDeferredValue:function(t){return jt().memoizedState=t},useTransition:function(){var t=Qf(!1),e=t[0];return t=k0.bind(null,t[1]),jt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=de,s=jt();if(le){if(n===void 0)throw Error(C(407));n=n()}else{if(n=e(),Ae===null)throw Error(C(349));mr&30||Gm(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,Kf(Bm.bind(null,r,o,t),[t]),r.flags|=2048,go(9,Wm.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=jt(),e=Ae.identifierPrefix;if(le){var n=rn,r=nn;n=(r&~(1<<32-Lt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=po++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=P0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},A0={readContext:Ct,useCallback:Xm,useContext:Ct,useEffect:zc,useImperativeHandle:qm,useInsertionEffect:Ym,useLayoutEffect:Qm,useMemo:Jm,useReducer:Ta,useRef:Hm,useState:function(){return Ta(mo)},useDebugValue:Hc,useDeferredValue:function(t){var e=Tt();return Zm(e,we.memoizedState,t)},useTransition:function(){var t=Ta(mo)[0],e=Tt().memoizedState;return[t,e]},useMutableSource:Fm,useSyncExternalStore:Vm,useId:eg,unstable_isNewReconciler:!1},D0={readContext:Ct,useCallback:Xm,useContext:Ct,useEffect:zc,useImperativeHandle:qm,useInsertionEffect:Ym,useLayoutEffect:Qm,useMemo:Jm,useReducer:ba,useRef:Hm,useState:function(){return ba(mo)},useDebugValue:Hc,useDeferredValue:function(t){var e=Tt();return we===null?e.memoizedState=t:Zm(e,we.memoizedState,t)},useTransition:function(){var t=ba(mo)[0],e=Tt().memoizedState;return[t,e]},useMutableSource:Fm,useSyncExternalStore:Vm,useId:eg,unstable_isNewReconciler:!1};function Ot(t,e){if(t&&t.defaultProps){e=fe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pu(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Tl={isMounted:function(t){return(t=t._reactInternals)?Pr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ze(),s=In(t),o=on(r,s);o.payload=e,n!=null&&(o.callback=n),e=Rn(t,o,s),e!==null&&($t(e,t,s,r),wi(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ze(),s=In(t),o=on(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Rn(t,o,s),e!==null&&($t(e,t,s,r),wi(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ze(),r=In(t),s=on(n,r);s.tag=2,e!=null&&(s.callback=e),e=Rn(t,s,r),e!==null&&($t(e,t,r,n),wi(e,t,r))}};function qf(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!lo(n,r)||!lo(s,o):!0}function sg(t,e,n){var r=!1,s=Gn,o=e.contextType;return typeof o=="object"&&o!==null?o=Ct(o):(s=nt(e)?hr:Ve.current,r=e.contextTypes,o=(r=r!=null)?Jr(t,s):Gn),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Tl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Xf(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Tl.enqueueReplaceState(e,e.state,null)}function ku(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Uc(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Ct(o):(o=nt(e)?hr:Ve.current,s.context=Jr(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Pu(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Tl.enqueueReplaceState(s,s.state,null),Bi(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ns(t,e){try{var n="",r=e;do n+=rv(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Aa(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Cu(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var x0=typeof WeakMap=="function"?WeakMap:Map;function og(t,e,n){n=on(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qi||(Qi=!0,Lu=r),Cu(t,e)},n}function ig(t,e,n){n=on(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Cu(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Cu(t,e),typeof r!="function"&&(Nn===null?Nn=new Set([this]):Nn.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function Jf(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new x0;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=j0.bind(null,t,e,n),e.then(t,t))}function Zf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function eh(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=on(-1,1),e.tag=2,Rn(n,e,1))),n.lanes|=1),t)}var O0=gn.ReactCurrentOwner,Ze=!1;function We(t,e,n,r){e.child=t===null?Lm(e,null,n,r):es(e,t.child,n,r)}function th(t,e,n,r,s){n=n.render;var o=e.ref;return Yr(e,s),r=Bc(t,e,n,r,o,s),n=jc(),t!==null&&!Ze?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fn(t,e,s)):(le&&n&&Oc(e),e.flags|=1,We(t,e,r,s),e.child)}function nh(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!ed(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,lg(t,e,o,r,s)):(t=Ti(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:lo,n(i,r)&&t.ref===e.ref)return fn(t,e,s)}return e.flags|=1,t=Ln(o,r),t.ref=e.ref,t.return=e,e.child=t}function lg(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(lo(o,r)&&t.ref===e.ref)if(Ze=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Ze=!0);else return e.lanes=t.lanes,fn(t,e,s)}return Tu(t,e,n,r,s)}function ag(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ne(Wr,it),it|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ne(Wr,it),it|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ne(Wr,it),it|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ne(Wr,it),it|=r;return We(t,e,s,n),e.child}function ug(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Tu(t,e,n,r,s){var o=nt(n)?hr:Ve.current;return o=Jr(e,o),Yr(e,s),n=Bc(t,e,n,r,o,s),r=jc(),t!==null&&!Ze?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fn(t,e,s)):(le&&r&&Oc(e),e.flags|=1,We(t,e,n,s),e.child)}function rh(t,e,n,r,s){if(nt(n)){var o=!0;Ui(e)}else o=!1;if(Yr(e,s),e.stateNode===null)Pi(t,e),sg(e,n,r),ku(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ct(u):(u=nt(n)?hr:Ve.current,u=Jr(e,u));var f=n.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Xf(e,i,r,u),En=!1;var c=e.memoizedState;i.state=c,Bi(e,r,i,s),l=e.memoizedState,a!==r||c!==l||tt.current||En?(typeof f=="function"&&(Pu(e,n,f,r),l=e.memoizedState),(a=En||qf(e,n,a,r,c,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),i.props=r,i.state=l,i.context=u,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,Mm(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ot(e.type,a),i.props=u,d=e.pendingProps,c=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ct(l):(l=nt(n)?hr:Ve.current,l=Jr(e,l));var p=n.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||c!==l)&&Xf(e,i,r,l),En=!1,c=e.memoizedState,i.state=c,Bi(e,r,i,s);var m=e.memoizedState;a!==d||c!==m||tt.current||En?(typeof p=="function"&&(Pu(e,n,p,r),m=e.memoizedState),(u=En||qf(e,n,u,r,c,m,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,m,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,m,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),i.props=r,i.state=m,i.context=l,r=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.flags|=1024),r=!1)}return bu(t,e,n,r,o,s)}function bu(t,e,n,r,s,o){ug(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&Wf(e,n,!1),fn(t,e,o);r=e.stateNode,O0.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=es(e,t.child,null,o),e.child=es(e,null,a,o)):We(t,e,a,o),e.memoizedState=r.state,s&&Wf(e,n,!0),e.child}function cg(t){var e=t.stateNode;e.pendingContext?Gf(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Gf(t,e.context,!1),Fc(t,e.containerInfo)}function sh(t,e,n,r,s){return Zr(),Nc(s),e.flags|=256,We(t,e,n,r),e.child}var Au={dehydrated:null,treeContext:null,retryLane:0};function Du(t){return{baseLanes:t,cachePool:null,transitions:null}}function dg(t,e,n){var r=e.pendingProps,s=ue.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ne(ue,s&1),t===null)return Eu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Dl(i,r,0,null),t=cr(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Du(n),e.memoizedState=Au,t):Yc(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return R0(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ln(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Ln(a,o):(o=cr(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?Du(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=Au,r}return o=t.child,t=o.sibling,r=Ln(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Yc(t,e){return e=Dl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ai(t,e,n,r){return r!==null&&Nc(r),es(e,t.child,null,n),t=Yc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function R0(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Aa(Error(C(422))),ai(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Dl({mode:"visible",children:r.children},s,0,null),o=cr(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&es(e,t.child,null,i),e.child.memoizedState=Du(i),e.memoizedState=Au,o);if(!(e.mode&1))return ai(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(C(419)),r=Aa(o,r,void 0),ai(t,e,i,r)}if(a=(i&t.childLanes)!==0,Ze||a){if(r=Ae,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,dn(t,s),$t(r,t,s,-1))}return Zc(),r=Aa(Error(C(421))),ai(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=z0.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,at=On(s.nextSibling),ut=e,le=!0,Nt=null,t!==null&&(yt[_t++]=nn,yt[_t++]=rn,yt[_t++]=pr,nn=t.id,rn=t.overflow,pr=e),e=Yc(e,r.children),e.flags|=4096,e)}function oh(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Su(t.return,e,n)}function Da(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function fg(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(We(t,e,r.children,n),r=ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&oh(t,n,e);else if(t.tag===19)oh(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ne(ue,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ji(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Da(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ji(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Da(e,!0,n,null,o);break;case"together":Da(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pi(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(C(153));if(e.child!==null){for(t=e.child,n=Ln(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ln(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function N0(t,e,n){switch(e.tag){case 3:cg(e),Zr();break;case 5:Um(e);break;case 1:nt(e.type)&&Ui(e);break;case 4:Fc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ne(Gi,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ne(ue,ue.current&1),e.flags|=128,null):n&e.child.childLanes?dg(t,e,n):(ne(ue,ue.current&1),t=fn(t,e,n),t!==null?t.sibling:null);ne(ue,ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return fg(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ne(ue,ue.current),r)break;return null;case 22:case 23:return e.lanes=0,ag(t,e,n)}return fn(t,e,n)}var hg,xu,pg,mg;hg=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xu=function(){};pg=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,lr(Yt.current);var o=null;switch(n){case"input":s=Ja(t,s),r=Ja(t,r),o=[];break;case"select":s=fe({},s,{value:void 0}),r=fe({},r,{value:void 0}),o=[];break;case"textarea":s=tu(t,s),r=tu(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$i)}ru(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(eo.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(eo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&se("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};mg=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ds(t,e){if(!le)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Me(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function I0(t,e,n){var r=e.pendingProps;switch(Rc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Me(e),null;case 1:return nt(e.type)&&Mi(),Me(e),null;case 3:return r=e.stateNode,ts(),oe(tt),oe(Ve),Gc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ii(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Nt!==null&&(Uu(Nt),Nt=null))),xu(t,e),Me(e),null;case 5:Vc(e);var s=lr(ho.current);if(n=e.type,t!==null&&e.stateNode!=null)pg(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(C(166));return Me(e),null}if(t=lr(Yt.current),ii(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[zt]=e,r[co]=o,t=(e.mode&1)!==0,n){case"dialog":se("cancel",r),se("close",r);break;case"iframe":case"object":case"embed":se("load",r);break;case"video":case"audio":for(s=0;s<Us.length;s++)se(Us[s],r);break;case"source":se("error",r);break;case"img":case"image":case"link":se("error",r),se("load",r);break;case"details":se("toggle",r);break;case"input":pf(r,o),se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},se("invalid",r);break;case"textarea":gf(r,o),se("invalid",r)}ru(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&oi(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&oi(r.textContent,a,t),s=["children",""+a]):eo.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&se("scroll",r)}switch(n){case"input":Xo(r),mf(r,o,!0);break;case"textarea":Xo(r),yf(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=$i)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Bp(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[zt]=e,t[co]=r,hg(t,e,!1,!1),e.stateNode=t;e:{switch(i=su(n,r),n){case"dialog":se("cancel",t),se("close",t),s=r;break;case"iframe":case"object":case"embed":se("load",t),s=r;break;case"video":case"audio":for(s=0;s<Us.length;s++)se(Us[s],t);s=r;break;case"source":se("error",t),s=r;break;case"img":case"image":case"link":se("error",t),se("load",t),s=r;break;case"details":se("toggle",t),s=r;break;case"input":pf(t,r),s=Ja(t,r),se("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=fe({},r,{value:void 0}),se("invalid",t);break;case"textarea":gf(t,r),s=tu(t,r),se("invalid",t);break;default:s=r}ru(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?Hp(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&jp(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&to(t,l):typeof l=="number"&&to(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(eo.hasOwnProperty(o)?l!=null&&o==="onScroll"&&se("scroll",t):l!=null&&yc(t,o,l,i))}switch(n){case"input":Xo(t),mf(t,r,!1);break;case"textarea":Xo(t),yf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vn(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Br(t,!!r.multiple,o,!1):r.defaultValue!=null&&Br(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Me(e),null;case 6:if(t&&e.stateNode!=null)mg(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(C(166));if(n=lr(ho.current),lr(Yt.current),ii(e)){if(r=e.stateNode,n=e.memoizedProps,r[zt]=e,(o=r.nodeValue!==n)&&(t=ut,t!==null))switch(t.tag){case 3:oi(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&oi(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[zt]=e,e.stateNode=r}return Me(e),null;case 13:if(oe(ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(le&&at!==null&&e.mode&1&&!(e.flags&128))Nm(),Zr(),e.flags|=98560,o=!1;else if(o=ii(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(C(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(C(317));o[zt]=e}else Zr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Me(e),o=!1}else Nt!==null&&(Uu(Nt),Nt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ue.current&1?Se===0&&(Se=3):Zc())),e.updateQueue!==null&&(e.flags|=4),Me(e),null);case 4:return ts(),xu(t,e),t===null&&ao(e.stateNode.containerInfo),Me(e),null;case 10:return $c(e.type._context),Me(e),null;case 17:return nt(e.type)&&Mi(),Me(e),null;case 19:if(oe(ue),o=e.memoizedState,o===null)return Me(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Ds(o,!1);else{if(Se!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ji(t),i!==null){for(e.flags|=128,Ds(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ne(ue,ue.current&1|2),e.child}t=t.sibling}o.tail!==null&&_e()>rs&&(e.flags|=128,r=!0,Ds(o,!1),e.lanes=4194304)}else{if(!r)if(t=ji(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ds(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!le)return Me(e),null}else 2*_e()-o.renderingStartTime>rs&&n!==1073741824&&(e.flags|=128,r=!0,Ds(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=_e(),e.sibling=null,n=ue.current,ne(ue,r?n&1|2:n&1),e):(Me(e),null);case 22:case 23:return Jc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?it&1073741824&&(Me(e),e.subtreeFlags&6&&(e.flags|=8192)):Me(e),null;case 24:return null;case 25:return null}throw Error(C(156,e.tag))}function L0(t,e){switch(Rc(e),e.tag){case 1:return nt(e.type)&&Mi(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ts(),oe(tt),oe(Ve),Gc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vc(e),null;case 13:if(oe(ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(C(340));Zr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return oe(ue),null;case 4:return ts(),null;case 10:return $c(e.type._context),null;case 22:case 23:return Jc(),null;case 24:return null;default:return null}}var ui=!1,Ue=!1,$0=typeof WeakSet=="function"?WeakSet:Set,R=null;function Gr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){he(t,e,r)}else n.current=null}function Ou(t,e,n){try{n()}catch(r){he(t,e,r)}}var ih=!1;function M0(t,e){if(pu=Ni,t=wm(),xc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,u=0,f=0,d=t,c=null;t:for(;;){for(var p;d!==n||s!==0&&d.nodeType!==3||(a=i+s),d!==o||r!==0&&d.nodeType!==3||(l=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)c=d,d=p;for(;;){if(d===t)break t;if(c===n&&++u===s&&(a=i),c===o&&++f===r&&(l=i),(p=d.nextSibling)!==null)break;d=c,c=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(mu={focusedElem:t,selectionRange:n},Ni=!1,R=e;R!==null;)if(e=R,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,R=t;else for(;R!==null;){e=R;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,E=m.memoizedState,_=e.stateNode,h=_.getSnapshotBeforeUpdate(e.elementType===e.type?g:Ot(e.type,g),E);_.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(C(163))}}catch(S){he(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,R=t;break}R=e.return}return m=ih,ih=!1,m}function Hs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Ou(e,n,o)}s=s.next}while(s!==r)}}function bl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ru(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gg(t){var e=t.alternate;e!==null&&(t.alternate=null,gg(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zt],delete e[co],delete e[_u],delete e[v0],delete e[w0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yg(t){return t.tag===5||t.tag===3||t.tag===4}function lh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Nu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$i));else if(r!==4&&(t=t.child,t!==null))for(Nu(t,e,n),t=t.sibling;t!==null;)Nu(t,e,n),t=t.sibling}function Iu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Iu(t,e,n),t=t.sibling;t!==null;)Iu(t,e,n),t=t.sibling}var Ne=null,Rt=!1;function vn(t,e,n){for(n=n.child;n!==null;)_g(t,e,n),n=n.sibling}function _g(t,e,n){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(vl,n)}catch{}switch(n.tag){case 5:Ue||Gr(n,e);case 6:var r=Ne,s=Rt;Ne=null,vn(t,e,n),Ne=r,Rt=s,Ne!==null&&(Rt?(t=Ne,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ne.removeChild(n.stateNode));break;case 18:Ne!==null&&(Rt?(t=Ne,n=n.stateNode,t.nodeType===8?Sa(t.parentNode,n):t.nodeType===1&&Sa(t,n),oo(t)):Sa(Ne,n.stateNode));break;case 4:r=Ne,s=Rt,Ne=n.stateNode.containerInfo,Rt=!0,vn(t,e,n),Ne=r,Rt=s;break;case 0:case 11:case 14:case 15:if(!Ue&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Ou(n,e,i),s=s.next}while(s!==r)}vn(t,e,n);break;case 1:if(!Ue&&(Gr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){he(n,e,a)}vn(t,e,n);break;case 21:vn(t,e,n);break;case 22:n.mode&1?(Ue=(r=Ue)||n.memoizedState!==null,vn(t,e,n),Ue=r):vn(t,e,n);break;default:vn(t,e,n)}}function ah(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new $0),e.forEach(function(r){var s=H0.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Dt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Ne=a.stateNode,Rt=!1;break e;case 3:Ne=a.stateNode.containerInfo,Rt=!0;break e;case 4:Ne=a.stateNode.containerInfo,Rt=!0;break e}a=a.return}if(Ne===null)throw Error(C(160));_g(o,i,s),Ne=null,Rt=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){he(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vg(e,t),e=e.sibling}function vg(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Dt(e,t),Bt(t),r&4){try{Hs(3,t,t.return),bl(3,t)}catch(g){he(t,t.return,g)}try{Hs(5,t,t.return)}catch(g){he(t,t.return,g)}}break;case 1:Dt(e,t),Bt(t),r&512&&n!==null&&Gr(n,n.return);break;case 5:if(Dt(e,t),Bt(t),r&512&&n!==null&&Gr(n,n.return),t.flags&32){var s=t.stateNode;try{to(s,"")}catch(g){he(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Gp(s,o),su(a,i);var u=su(a,o);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?Hp(s,d):f==="dangerouslySetInnerHTML"?jp(s,d):f==="children"?to(s,d):yc(s,f,d,u)}switch(a){case"input":Za(s,o);break;case"textarea":Wp(s,o);break;case"select":var c=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Br(s,!!o.multiple,p,!1):c!==!!o.multiple&&(o.defaultValue!=null?Br(s,!!o.multiple,o.defaultValue,!0):Br(s,!!o.multiple,o.multiple?[]:"",!1))}s[co]=o}catch(g){he(t,t.return,g)}}break;case 6:if(Dt(e,t),Bt(t),r&4){if(t.stateNode===null)throw Error(C(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(g){he(t,t.return,g)}}break;case 3:if(Dt(e,t),Bt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{oo(e.containerInfo)}catch(g){he(t,t.return,g)}break;case 4:Dt(e,t),Bt(t);break;case 13:Dt(e,t),Bt(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(qc=_e())),r&4&&ah(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Ue=(u=Ue)||f,Dt(e,t),Ue=u):Dt(e,t),Bt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(R=t,f=t.child;f!==null;){for(d=R=f;R!==null;){switch(c=R,p=c.child,c.tag){case 0:case 11:case 14:case 15:Hs(4,c,c.return);break;case 1:Gr(c,c.return);var m=c.stateNode;if(typeof m.componentWillUnmount=="function"){r=c,n=c.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){he(r,n,g)}}break;case 5:Gr(c,c.return);break;case 22:if(c.memoizedState!==null){ch(d);continue}}p!==null?(p.return=c,R=p):ch(d)}f=f.sibling}e:for(f=null,d=t;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=zp("display",i))}catch(g){he(t,t.return,g)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){he(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Dt(e,t),Bt(t),r&4&&ah(t);break;case 21:break;default:Dt(e,t),Bt(t)}}function Bt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yg(n)){var r=n;break e}n=n.return}throw Error(C(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(to(s,""),r.flags&=-33);var o=lh(t);Iu(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=lh(t);Nu(t,a,i);break;default:throw Error(C(161))}}catch(l){he(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function U0(t,e,n){R=t,wg(t)}function wg(t,e,n){for(var r=(t.mode&1)!==0;R!==null;){var s=R,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||ui;if(!i){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Ue;a=ui;var u=Ue;if(ui=i,(Ue=l)&&!u)for(R=s;R!==null;)i=R,l=i.child,i.tag===22&&i.memoizedState!==null?dh(s):l!==null?(l.return=i,R=l):dh(s);for(;o!==null;)R=o,wg(o),o=o.sibling;R=s,ui=a,Ue=u}uh(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,R=o):uh(t)}}function uh(t){for(;R!==null;){var e=R;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ue||bl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ue)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ot(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Yf(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Yf(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&oo(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(C(163))}Ue||e.flags&512&&Ru(e)}catch(c){he(e,e.return,c)}}if(e===t){R=null;break}if(n=e.sibling,n!==null){n.return=e.return,R=n;break}R=e.return}}function ch(t){for(;R!==null;){var e=R;if(e===t){R=null;break}var n=e.sibling;if(n!==null){n.return=e.return,R=n;break}R=e.return}}function dh(t){for(;R!==null;){var e=R;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bl(4,e)}catch(l){he(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){he(e,s,l)}}var o=e.return;try{Ru(e)}catch(l){he(e,o,l)}break;case 5:var i=e.return;try{Ru(e)}catch(l){he(e,i,l)}}}catch(l){he(e,e.return,l)}if(e===t){R=null;break}var a=e.sibling;if(a!==null){a.return=e.return,R=a;break}R=e.return}}var F0=Math.ceil,Yi=gn.ReactCurrentDispatcher,Qc=gn.ReactCurrentOwner,kt=gn.ReactCurrentBatchConfig,Y=0,Ae=null,ve=null,Ie=0,it=0,Wr=qn(0),Se=0,yo=null,gr=0,Al=0,Kc=0,Ys=null,qe=null,qc=0,rs=1/0,en=null,Qi=!1,Lu=null,Nn=null,ci=!1,Cn=null,Ki=0,Qs=0,$u=null,ki=-1,Ci=0;function ze(){return Y&6?_e():ki!==-1?ki:ki=_e()}function In(t){return t.mode&1?Y&2&&Ie!==0?Ie&-Ie:S0.transition!==null?(Ci===0&&(Ci=sm()),Ci):(t=q,t!==0||(t=window.event,t=t===void 0?16:dm(t.type)),t):1}function $t(t,e,n,r){if(50<Qs)throw Qs=0,$u=null,Error(C(185));Ro(t,n,r),(!(Y&2)||t!==Ae)&&(t===Ae&&(!(Y&2)&&(Al|=n),Se===4&&Pn(t,Ie)),rt(t,r),n===1&&Y===0&&!(e.mode&1)&&(rs=_e()+500,kl&&Xn()))}function rt(t,e){var n=t.callbackNode;Sv(t,e);var r=Ri(t,t===Ae?Ie:0);if(r===0)n!==null&&wf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&wf(n),e===1)t.tag===0?E0(fh.bind(null,t)):xm(fh.bind(null,t)),y0(function(){!(Y&6)&&Xn()}),n=null;else{switch(om(r)){case 1:n=Sc;break;case 4:n=nm;break;case 16:n=Oi;break;case 536870912:n=rm;break;default:n=Oi}n=Ag(n,Eg.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Eg(t,e){if(ki=-1,Ci=0,Y&6)throw Error(C(327));var n=t.callbackNode;if(Qr()&&t.callbackNode!==n)return null;var r=Ri(t,t===Ae?Ie:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=qi(t,r);else{e=r;var s=Y;Y|=2;var o=Pg();(Ae!==t||Ie!==e)&&(en=null,rs=_e()+500,ur(t,e));do try{W0();break}catch(a){Sg(t,a)}while(!0);Lc(),Yi.current=o,Y=s,ve!==null?e=0:(Ae=null,Ie=0,e=Se)}if(e!==0){if(e===2&&(s=uu(t),s!==0&&(r=s,e=Mu(t,s))),e===1)throw n=yo,ur(t,0),Pn(t,r),rt(t,_e()),n;if(e===6)Pn(t,r);else{if(s=t.current.alternate,!(r&30)&&!V0(s)&&(e=qi(t,r),e===2&&(o=uu(t),o!==0&&(r=o,e=Mu(t,o))),e===1))throw n=yo,ur(t,0),Pn(t,r),rt(t,_e()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(C(345));case 2:nr(t,qe,en);break;case 3:if(Pn(t,r),(r&130023424)===r&&(e=qc+500-_e(),10<e)){if(Ri(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ze(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=yu(nr.bind(null,t,qe,en),e);break}nr(t,qe,en);break;case 4:if(Pn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-Lt(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=_e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*F0(r/1960))-r,10<r){t.timeoutHandle=yu(nr.bind(null,t,qe,en),r);break}nr(t,qe,en);break;case 5:nr(t,qe,en);break;default:throw Error(C(329))}}}return rt(t,_e()),t.callbackNode===n?Eg.bind(null,t):null}function Mu(t,e){var n=Ys;return t.current.memoizedState.isDehydrated&&(ur(t,e).flags|=256),t=qi(t,e),t!==2&&(e=qe,qe=n,e!==null&&Uu(e)),t}function Uu(t){qe===null?qe=t:qe.push.apply(qe,t)}function V0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!Ut(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pn(t,e){for(e&=~Kc,e&=~Al,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Lt(e),r=1<<n;t[n]=-1,e&=~r}}function fh(t){if(Y&6)throw Error(C(327));Qr();var e=Ri(t,0);if(!(e&1))return rt(t,_e()),null;var n=qi(t,e);if(t.tag!==0&&n===2){var r=uu(t);r!==0&&(e=r,n=Mu(t,r))}if(n===1)throw n=yo,ur(t,0),Pn(t,e),rt(t,_e()),n;if(n===6)throw Error(C(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nr(t,qe,en),rt(t,_e()),null}function Xc(t,e){var n=Y;Y|=1;try{return t(e)}finally{Y=n,Y===0&&(rs=_e()+500,kl&&Xn())}}function yr(t){Cn!==null&&Cn.tag===0&&!(Y&6)&&Qr();var e=Y;Y|=1;var n=kt.transition,r=q;try{if(kt.transition=null,q=1,t)return t()}finally{q=r,kt.transition=n,Y=e,!(Y&6)&&Xn()}}function Jc(){it=Wr.current,oe(Wr)}function ur(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,g0(n)),ve!==null)for(n=ve.return;n!==null;){var r=n;switch(Rc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Mi();break;case 3:ts(),oe(tt),oe(Ve),Gc();break;case 5:Vc(r);break;case 4:ts();break;case 13:oe(ue);break;case 19:oe(ue);break;case 10:$c(r.type._context);break;case 22:case 23:Jc()}n=n.return}if(Ae=t,ve=t=Ln(t.current,null),Ie=it=e,Se=0,yo=null,Kc=Al=gr=0,qe=Ys=null,ir!==null){for(e=0;e<ir.length;e++)if(n=ir[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}ir=null}return t}function Sg(t,e){do{var n=ve;try{if(Lc(),Ei.current=Hi,zi){for(var r=de.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}zi=!1}if(mr=0,ke=we=de=null,zs=!1,po=0,Qc.current=null,n===null||n.return===null){Se=1,yo=e,ve=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=Ie,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var c=f.alternate;c?(f.updateQueue=c.updateQueue,f.memoizedState=c.memoizedState,f.lanes=c.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=Zf(i);if(p!==null){p.flags&=-257,eh(p,i,a,o,e),p.mode&1&&Jf(o,u,e),e=p,l=u;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){Jf(o,u,e),Zc();break e}l=Error(C(426))}}else if(le&&a.mode&1){var E=Zf(i);if(E!==null){!(E.flags&65536)&&(E.flags|=256),eh(E,i,a,o,e),Nc(ns(l,a));break e}}o=l=ns(l,a),Se!==4&&(Se=2),Ys===null?Ys=[o]:Ys.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var _=og(o,l,e);Hf(o,_);break e;case 1:a=l;var h=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof h.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Nn===null||!Nn.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=ig(o,a,e);Hf(o,S);break e}}o=o.return}while(o!==null)}Cg(n)}catch(P){e=P,ve===n&&n!==null&&(ve=n=n.return);continue}break}while(!0)}function Pg(){var t=Yi.current;return Yi.current=Hi,t===null?Hi:t}function Zc(){(Se===0||Se===3||Se===2)&&(Se=4),Ae===null||!(gr&268435455)&&!(Al&268435455)||Pn(Ae,Ie)}function qi(t,e){var n=Y;Y|=2;var r=Pg();(Ae!==t||Ie!==e)&&(en=null,ur(t,e));do try{G0();break}catch(s){Sg(t,s)}while(!0);if(Lc(),Y=n,Yi.current=r,ve!==null)throw Error(C(261));return Ae=null,Ie=0,Se}function G0(){for(;ve!==null;)kg(ve)}function W0(){for(;ve!==null&&!hv();)kg(ve)}function kg(t){var e=bg(t.alternate,t,it);t.memoizedProps=t.pendingProps,e===null?Cg(t):ve=e,Qc.current=null}function Cg(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=L0(n,e),n!==null){n.flags&=32767,ve=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Se=6,ve=null;return}}else if(n=I0(n,e,it),n!==null){ve=n;return}if(e=e.sibling,e!==null){ve=e;return}ve=e=t}while(e!==null);Se===0&&(Se=5)}function nr(t,e,n){var r=q,s=kt.transition;try{kt.transition=null,q=1,B0(t,e,n,r)}finally{kt.transition=s,q=r}return null}function B0(t,e,n,r){do Qr();while(Cn!==null);if(Y&6)throw Error(C(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(C(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Pv(t,o),t===Ae&&(ve=Ae=null,Ie=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ci||(ci=!0,Ag(Oi,function(){return Qr(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=kt.transition,kt.transition=null;var i=q;q=1;var a=Y;Y|=4,Qc.current=null,M0(t,n),vg(n,t),u0(mu),Ni=!!pu,mu=pu=null,t.current=n,U0(n),pv(),Y=a,q=i,kt.transition=o}else t.current=n;if(ci&&(ci=!1,Cn=t,Ki=s),o=t.pendingLanes,o===0&&(Nn=null),yv(n.stateNode),rt(t,_e()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Qi)throw Qi=!1,t=Lu,Lu=null,t;return Ki&1&&t.tag!==0&&Qr(),o=t.pendingLanes,o&1?t===$u?Qs++:(Qs=0,$u=t):Qs=0,Xn(),null}function Qr(){if(Cn!==null){var t=om(Ki),e=kt.transition,n=q;try{if(kt.transition=null,q=16>t?16:t,Cn===null)var r=!1;else{if(t=Cn,Cn=null,Ki=0,Y&6)throw Error(C(331));var s=Y;for(Y|=4,R=t.current;R!==null;){var o=R,i=o.child;if(R.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(R=u;R!==null;){var f=R;switch(f.tag){case 0:case 11:case 15:Hs(8,f,o)}var d=f.child;if(d!==null)d.return=f,R=d;else for(;R!==null;){f=R;var c=f.sibling,p=f.return;if(gg(f),f===u){R=null;break}if(c!==null){c.return=p,R=c;break}R=p}}}var m=o.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var E=g.sibling;g.sibling=null,g=E}while(g!==null)}}R=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,R=i;else e:for(;R!==null;){if(o=R,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Hs(9,o,o.return)}var _=o.sibling;if(_!==null){_.return=o.return,R=_;break e}R=o.return}}var h=t.current;for(R=h;R!==null;){i=R;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,R=v;else e:for(i=h;R!==null;){if(a=R,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bl(9,a)}}catch(P){he(a,a.return,P)}if(a===i){R=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,R=S;break e}R=a.return}}if(Y=s,Xn(),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(vl,t)}catch{}r=!0}return r}finally{q=n,kt.transition=e}}return!1}function hh(t,e,n){e=ns(n,e),e=og(t,e,1),t=Rn(t,e,1),e=ze(),t!==null&&(Ro(t,1,e),rt(t,e))}function he(t,e,n){if(t.tag===3)hh(t,t,n);else for(;e!==null;){if(e.tag===3){hh(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Nn===null||!Nn.has(r))){t=ns(n,t),t=ig(e,t,1),e=Rn(e,t,1),t=ze(),e!==null&&(Ro(e,1,t),rt(e,t));break}}e=e.return}}function j0(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ze(),t.pingedLanes|=t.suspendedLanes&n,Ae===t&&(Ie&n)===n&&(Se===4||Se===3&&(Ie&130023424)===Ie&&500>_e()-qc?ur(t,0):Kc|=n),rt(t,e)}function Tg(t,e){e===0&&(t.mode&1?(e=ei,ei<<=1,!(ei&130023424)&&(ei=4194304)):e=1);var n=ze();t=dn(t,e),t!==null&&(Ro(t,e,n),rt(t,n))}function z0(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Tg(t,n)}function H0(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(C(314))}r!==null&&r.delete(e),Tg(t,n)}var bg;bg=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||tt.current)Ze=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ze=!1,N0(t,e,n);Ze=!!(t.flags&131072)}else Ze=!1,le&&e.flags&1048576&&Om(e,Vi,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Pi(t,e),t=e.pendingProps;var s=Jr(e,Ve.current);Yr(e,n),s=Bc(null,e,r,t,s,n);var o=jc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nt(r)?(o=!0,Ui(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Uc(e),s.updater=Tl,e.stateNode=s,s._reactInternals=e,ku(e,r,t,n),e=bu(null,e,r,!0,o,n)):(e.tag=0,le&&o&&Oc(e),We(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Pi(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Q0(r),t=Ot(r,t),s){case 0:e=Tu(null,e,r,t,n);break e;case 1:e=rh(null,e,r,t,n);break e;case 11:e=th(null,e,r,t,n);break e;case 14:e=nh(null,e,r,Ot(r.type,t),n);break e}throw Error(C(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ot(r,s),Tu(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ot(r,s),rh(t,e,r,s,n);case 3:e:{if(cg(e),t===null)throw Error(C(387));r=e.pendingProps,o=e.memoizedState,s=o.element,Mm(t,e),Bi(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=ns(Error(C(423)),e),e=sh(t,e,r,n,s);break e}else if(r!==s){s=ns(Error(C(424)),e),e=sh(t,e,r,n,s);break e}else for(at=On(e.stateNode.containerInfo.firstChild),ut=e,le=!0,Nt=null,n=Lm(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Zr(),r===s){e=fn(t,e,n);break e}We(t,e,r,n)}e=e.child}return e;case 5:return Um(e),t===null&&Eu(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,gu(r,s)?i=null:o!==null&&gu(r,o)&&(e.flags|=32),ug(t,e),We(t,e,i,n),e.child;case 6:return t===null&&Eu(e),null;case 13:return dg(t,e,n);case 4:return Fc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=es(e,null,r,n):We(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ot(r,s),th(t,e,r,s,n);case 7:return We(t,e,e.pendingProps,n),e.child;case 8:return We(t,e,e.pendingProps.children,n),e.child;case 12:return We(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,ne(Gi,r._currentValue),r._currentValue=i,o!==null)if(Ut(o.value,i)){if(o.children===s.children&&!tt.current){e=fn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=on(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Su(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(C(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),Su(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}We(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Yr(e,n),s=Ct(s),r=r(s),e.flags|=1,We(t,e,r,n),e.child;case 14:return r=e.type,s=Ot(r,e.pendingProps),s=Ot(r.type,s),nh(t,e,r,s,n);case 15:return lg(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ot(r,s),Pi(t,e),e.tag=1,nt(r)?(t=!0,Ui(e)):t=!1,Yr(e,n),sg(e,r,s),ku(e,r,s,n),bu(null,e,r,!0,t,n);case 19:return fg(t,e,n);case 22:return ag(t,e,n)}throw Error(C(156,e.tag))};function Ag(t,e){return tm(t,e)}function Y0(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Et(t,e,n,r){return new Y0(t,e,n,r)}function ed(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Q0(t){if(typeof t=="function")return ed(t)?1:0;if(t!=null){if(t=t.$$typeof,t===vc)return 11;if(t===wc)return 14}return 2}function Ln(t,e){var n=t.alternate;return n===null?(n=Et(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ti(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")ed(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Rr:return cr(n.children,s,o,e);case _c:i=8,s|=8;break;case Qa:return t=Et(12,n,e,s|2),t.elementType=Qa,t.lanes=o,t;case Ka:return t=Et(13,n,e,s),t.elementType=Ka,t.lanes=o,t;case qa:return t=Et(19,n,e,s),t.elementType=qa,t.lanes=o,t;case Up:return Dl(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $p:i=10;break e;case Mp:i=9;break e;case vc:i=11;break e;case wc:i=14;break e;case wn:i=16,r=null;break e}throw Error(C(130,t==null?t:typeof t,""))}return e=Et(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function cr(t,e,n,r){return t=Et(7,t,r,e),t.lanes=n,t}function Dl(t,e,n,r){return t=Et(22,t,r,e),t.elementType=Up,t.lanes=n,t.stateNode={isHidden:!1},t}function xa(t,e,n){return t=Et(6,t,null,e),t.lanes=n,t}function Oa(t,e,n){return e=Et(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function K0(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=da(0),this.expirationTimes=da(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=da(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function td(t,e,n,r,s,o,i,a,l){return t=new K0(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Et(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uc(o),t}function q0(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Or,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Dg(t){if(!t)return Gn;t=t._reactInternals;e:{if(Pr(t)!==t||t.tag!==1)throw Error(C(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(C(171))}if(t.tag===1){var n=t.type;if(nt(n))return Dm(t,n,e)}return e}function xg(t,e,n,r,s,o,i,a,l){return t=td(n,r,!0,t,s,o,i,a,l),t.context=Dg(null),n=t.current,r=ze(),s=In(n),o=on(r,s),o.callback=e??null,Rn(n,o,s),t.current.lanes=s,Ro(t,s,r),rt(t,r),t}function xl(t,e,n,r){var s=e.current,o=ze(),i=In(s);return n=Dg(n),e.context===null?e.context=n:e.pendingContext=n,e=on(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Rn(s,e,i),t!==null&&($t(t,s,i,o),wi(t,s,i)),i}function Xi(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ph(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function nd(t,e){ph(t,e),(t=t.alternate)&&ph(t,e)}function X0(){return null}var Og=typeof reportError=="function"?reportError:function(t){console.error(t)};function rd(t){this._internalRoot=t}Ol.prototype.render=rd.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(C(409));xl(t,e,null,null)};Ol.prototype.unmount=rd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yr(function(){xl(null,t,null,null)}),e[cn]=null}};function Ol(t){this._internalRoot=t}Ol.prototype.unstable_scheduleHydration=function(t){if(t){var e=am();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Sn.length&&e!==0&&e<Sn[n].priority;n++);Sn.splice(n,0,t),n===0&&cm(t)}};function sd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Rl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mh(){}function J0(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=Xi(i);o.call(u)}}var i=xg(e,r,t,0,null,!1,!1,"",mh);return t._reactRootContainer=i,t[cn]=i.current,ao(t.nodeType===8?t.parentNode:t),yr(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=Xi(l);a.call(u)}}var l=td(t,0,!1,null,null,!1,!1,"",mh);return t._reactRootContainer=l,t[cn]=l.current,ao(t.nodeType===8?t.parentNode:t),yr(function(){xl(e,l,n,r)}),l}function Nl(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var l=Xi(i);a.call(l)}}xl(e,i,t,s)}else i=J0(n,e,t,s,r);return Xi(i)}im=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ms(e.pendingLanes);n!==0&&(Pc(e,n|1),rt(e,_e()),!(Y&6)&&(rs=_e()+500,Xn()))}break;case 13:yr(function(){var r=dn(t,1);if(r!==null){var s=ze();$t(r,t,1,s)}}),nd(t,1)}};kc=function(t){if(t.tag===13){var e=dn(t,134217728);if(e!==null){var n=ze();$t(e,t,134217728,n)}nd(t,134217728)}};lm=function(t){if(t.tag===13){var e=In(t),n=dn(t,e);if(n!==null){var r=ze();$t(n,t,e,r)}nd(t,e)}};am=function(){return q};um=function(t,e){var n=q;try{return q=t,e()}finally{q=n}};iu=function(t,e,n){switch(e){case"input":if(Za(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Pl(r);if(!s)throw Error(C(90));Vp(r),Za(r,s)}}}break;case"textarea":Wp(t,n);break;case"select":e=n.value,e!=null&&Br(t,!!n.multiple,e,!1)}};Kp=Xc;qp=yr;var Z0={usingClientEntryPoint:!1,Events:[Io,$r,Pl,Yp,Qp,Xc]},xs={findFiberByHostInstance:or,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ew={bundleType:xs.bundleType,version:xs.version,rendererPackageName:xs.rendererPackageName,rendererConfig:xs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Zp(t),t===null?null:t.stateNode},findFiberByHostInstance:xs.findFiberByHostInstance||X0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var di=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!di.isDisabled&&di.supportsFiber)try{vl=di.inject(ew),Ht=di}catch{}}pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z0;pt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sd(e))throw Error(C(200));return q0(t,e,null,n)};pt.createRoot=function(t,e){if(!sd(t))throw Error(C(299));var n=!1,r="",s=Og;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=td(t,1,!1,null,null,n,!1,r,s),t[cn]=e.current,ao(t.nodeType===8?t.parentNode:t),new rd(e)};pt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(C(188)):(t=Object.keys(t).join(","),Error(C(268,t)));return t=Zp(e),t=t===null?null:t.stateNode,t};pt.flushSync=function(t){return yr(t)};pt.hydrate=function(t,e,n){if(!Rl(e))throw Error(C(200));return Nl(null,t,e,!0,n)};pt.hydrateRoot=function(t,e,n){if(!sd(t))throw Error(C(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=Og;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=xg(e,null,t,1,n??null,s,!1,o,i),t[cn]=e.current,ao(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ol(e)};pt.render=function(t,e,n){if(!Rl(e))throw Error(C(200));return Nl(null,t,e,!1,n)};pt.unmountComponentAtNode=function(t){if(!Rl(t))throw Error(C(40));return t._reactRootContainer?(yr(function(){Nl(null,null,t,!1,function(){t._reactRootContainer=null,t[cn]=null})}),!0):!1};pt.unstable_batchedUpdates=Xc;pt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Rl(n))throw Error(C(200));if(t==null||t._reactInternals===void 0)throw Error(C(38));return Nl(t,e,n,!1,r)};pt.version="18.3.1-next-f1338f8080-20240426";function Rg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rg)}catch(t){console.error(t)}}Rg(),Rp.exports=pt;var tw=Rp.exports,gh=tw;Ha.createRoot=gh.createRoot,Ha.hydrateRoot=gh.hydrateRoot;const nw=()=>{};var yh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b=function(t,e){if(!t)throw ms(e)},ms=function(t){return new Error("Firebase Database ("+Ng.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},rw=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],i=t[n++],a=t[n++],l=((s&7)<<18|(o&63)<<12|(i&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const o=t[n++],i=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},od={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],i=s+1<t.length,a=i?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,f=o>>2,d=(o&3)<<4|a>>4;let c=(a&15)<<2|u>>6,p=u&63;l||(p=64,i||(c=64)),r.push(n[f],n[d],n[c],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ig(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):rw(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||a==null||u==null||d==null)throw new sw;const c=o<<2|a>>4;if(r.push(c),u!==64){const p=a<<4&240|u>>2;if(r.push(p),d!==64){const m=u<<6&192|d;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sw extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Lg=function(t){const e=Ig(t);return od.encodeByteArray(e,!0)},Ji=function(t){return Lg(t).replace(/\./g,"")},Zi=function(t){try{return od.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t){return _o(void 0,t)}function _o(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!iw(n)||(t[n]=_o(t[n],e[n]));return t}function iw(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw=()=>$g().__FIREBASE_DEFAULTS__,aw=()=>{if(typeof process>"u"||typeof yh>"u")return;const t=yh.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uw=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Zi(t[1]);return e&&JSON.parse(e)},cw=()=>{try{return nw()||lw()||aw()||uw()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},id=()=>{var t;return(t=cw())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ji(JSON.stringify(n)),Ji(JSON.stringify(i)),""].join(".")}const Ks={};function hw(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ks))Ks[e]?t.emulator.push(e):t.prod.push(e);return t}function pw(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let _h=!1;function mw(t,e){if(typeof window>"u"||typeof document>"u"||!ld(window.location.host)||Ks[t]===e||Ks[t]||_h)return;Ks[t]=e;function n(c){return`__firebase__banner__${c}`}const r="__firebase__banner",o=hw().prod.length>0;function i(){const c=document.getElementById(r);c&&c.remove()}function a(c){c.style.display="flex",c.style.background="#7faaf0",c.style.position="fixed",c.style.bottom="5px",c.style.left="5px",c.style.padding=".5em",c.style.borderRadius="5px",c.style.alignItems="center"}function l(c,p){c.setAttribute("width","24"),c.setAttribute("id",p),c.setAttribute("height","24"),c.setAttribute("viewBox","0 0 24 24"),c.setAttribute("fill","none"),c.style.marginLeft="-6px"}function u(){const c=document.createElement("span");return c.style.cursor="pointer",c.style.marginLeft="16px",c.style.fontSize="24px",c.innerHTML=" &times;",c.onclick=()=>{_h=!0,i()},c}function f(c,p){c.setAttribute("id",p),c.innerText="Learn more",c.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",c.setAttribute("target","__blank"),c.style.paddingLeft="5px",c.style.textDecoration="underline"}function d(){const c=pw(r),p=n("text"),m=document.getElementById(p)||document.createElement("span"),g=n("learnmore"),E=document.getElementById(g)||document.createElement("a"),_=n("preprendIcon"),h=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(c.created){const v=c.element;a(v),f(E,g);const S=u();l(h,_),v.append(h,m,E,S),document.body.appendChild(v)}o?(m.innerText="Preview backend disconnected.",h.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(h.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Mg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gw())}function yw(){return typeof window<"u"||Ug()}function Ug(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function _w(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vw(){return Ng.NODE_ADMIN===!0}function ww(){try{return typeof indexedDB=="object"}catch{return!1}}function Ew(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw="FirebaseError";class gs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Sw,Object.setPrototypeOf(this,gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Il.prototype.create)}}class Il{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?Pw(o,r):"Error",a=`${this.serviceName}: ${i} (${s}).`;return new gs(s,a,r)}}function Pw(t,e){return t.replace(kw,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const kw=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(t){return JSON.parse(t)}function Ee(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=function(t){let e={},n={},r={},s="";try{const o=t.split(".");e=vo(Zi(o[0])||""),n=vo(Zi(o[1])||""),s=o[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},Cw=function(t){const e=Fg(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Tw=function(t){const e=Fg(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _r(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Fu(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function el(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function tl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(vh(o)&&vh(i)){if(!tl(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function vh(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)r[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)r[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){const c=r[d-3]^r[d-8]^r[d-14]^r[d-16];r[d]=(c<<1|c>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],i=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,f;for(let d=0;d<80;d++){d<40?d<20?(u=a^o&(i^a),f=1518500249):(u=o^i^a,f=1859775393):d<60?(u=o&i|a&(o|i),f=2400959708):(u=o^i^a,f=3395469782);const c=(s<<5|s>>>27)+u+l+f+r[d]&4294967295;l=a,a=i,i=(o<<30|o>>>2)&4294967295,o=s,s=c}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+i&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const o=this.buf_;let i=this.inbuf_;for(;s<n;){if(i===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(o[i]=e.charCodeAt(s),++i,++s,i===this.blockSize){this.compress_(o),i=0;break}}else for(;s<n;)if(o[i]=e[s],++i,++s,i===this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[s]>>o&255,++r;return e}}function Dw(t,e){const n=new xw(t,e);return n.subscribe.bind(n)}class xw{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Ow(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Ra),s.error===void 0&&(s.error=Ra),s.complete===void 0&&(s.complete=Ra);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ow(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ra(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L=function(t,e,n,r){let s;if(r<e?s="at least "+e:r>n&&(s=n===0?"none":"no more than "+n),s){const o=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(o)}};function st(t,e){return`${t} failed: ${e} argument `}function Ce(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(st(t,e)+"must be a valid function.")}function wh(t,e,n,r){if(n&&(typeof n!="object"||n===null))throw new Error(st(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const o=s-55296;r++,b(r<t.length,"Surrogate pair missing trail surrogate.");const i=t.charCodeAt(r)-56320;s=65536+(o<<10)+i}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Ll=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t){return t&&t._delegate?t._delegate:t}class hn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Xe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Iw(e))try{this.getOrInitializeService({instanceIdentifier:rr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=rr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rr){return this.instances.has(e)}getOptions(e=rr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&i.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Nw(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=rr){return this.component?this.component.multipleInstances?e:rr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Nw(t){return t===rr?void 0:t}function Iw(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Vu(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ud=[];var Z;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Z||(Z={}));const Vg={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},Lw=Z.INFO,$w={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},Mw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=$w[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $l{constructor(e){this.name=e,this._logLevel=Lw,this._logHandler=Mw,this._userLogHandler=null,ud.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Vg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...e),this._logHandler(this,Z.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...e),this._logHandler(this,Z.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...e),this._logHandler(this,Z.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...e),this._logHandler(this,Z.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...e),this._logHandler(this,Z.ERROR,...e)}}function Uw(t){ud.forEach(e=>{e.setLogLevel(t)})}function Fw(t,e){for(const n of ud){let r=null;e&&e.level&&(r=Vg[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,o,...i)=>{const a=i.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");o>=(r??s.logLevel)&&t({level:Z[o].toLowerCase(),message:a,args:i,type:s.name})}}}const Vw=(t,e)=>e.some(n=>t instanceof n);let Eh,Sh;function Gw(){return Eh||(Eh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ww(){return Sh||(Sh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Gg=new WeakMap,Gu=new WeakMap,Wg=new WeakMap,Na=new WeakMap,cd=new WeakMap;function Bw(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{n($n(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&Gg.set(n,t)}).catch(()=>{}),cd.set(e,t),e}function jw(t){if(Gu.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});Gu.set(t,e)}let Wu={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Gu.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Wg.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $n(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function zw(t){Wu=t(Wu)}function Hw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ia(this),e,...n);return Wg.set(r,e.sort?e.sort():[e]),$n(r)}:Ww().includes(t)?function(...e){return t.apply(Ia(this),e),$n(Gg.get(this))}:function(...e){return $n(t.apply(Ia(this),e))}}function Yw(t){return typeof t=="function"?Hw(t):(t instanceof IDBTransaction&&jw(t),Vw(t,Gw())?new Proxy(t,Wu):t)}function $n(t){if(t instanceof IDBRequest)return Bw(t);if(Na.has(t))return Na.get(t);const e=Yw(t);return e!==t&&(Na.set(t,e),cd.set(e,t)),e}const Ia=t=>cd.get(t);function Qw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(t,e),a=$n(i);return r&&i.addEventListener("upgradeneeded",l=>{r($n(i.result),l.oldVersion,l.newVersion,$n(i.transaction),l)}),n&&i.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const Kw=["get","getKey","getAll","getAllKeys","count"],qw=["put","add","delete","clear"],La=new Map;function Ph(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(La.get(e))return La.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=qw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Kw.includes(n)))return;const o=async function(i,...a){const l=this.transaction(i,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return La.set(e,o),o}zw(t=>({...t,get:(e,n,r)=>Ph(e,n)||t.get(e,n,r),has:(e,n)=>!!Ph(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Jw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Jw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nl="@firebase/app",Bu="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn=new $l("@firebase/app"),Zw="@firebase/app-compat",eE="@firebase/analytics-compat",tE="@firebase/analytics",nE="@firebase/app-check-compat",rE="@firebase/app-check",sE="@firebase/auth",oE="@firebase/auth-compat",iE="@firebase/database",lE="@firebase/data-connect",aE="@firebase/database-compat",uE="@firebase/functions",cE="@firebase/functions-compat",dE="@firebase/installations",fE="@firebase/installations-compat",hE="@firebase/messaging",pE="@firebase/messaging-compat",mE="@firebase/performance",gE="@firebase/performance-compat",yE="@firebase/remote-config",_E="@firebase/remote-config-compat",vE="@firebase/storage",wE="@firebase/storage-compat",EE="@firebase/firestore",SE="@firebase/ai",PE="@firebase/firestore-compat",kE="firebase",CE="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="[DEFAULT]",TE={[nl]:"fire-core",[Zw]:"fire-core-compat",[tE]:"fire-analytics",[eE]:"fire-analytics-compat",[rE]:"fire-app-check",[nE]:"fire-app-check-compat",[sE]:"fire-auth",[oE]:"fire-auth-compat",[iE]:"fire-rtdb",[lE]:"fire-data-connect",[aE]:"fire-rtdb-compat",[uE]:"fire-fn",[cE]:"fire-fn-compat",[dE]:"fire-iid",[fE]:"fire-iid-compat",[hE]:"fire-fcm",[pE]:"fire-fcm-compat",[mE]:"fire-perf",[gE]:"fire-perf-compat",[yE]:"fire-rc",[_E]:"fire-rc-compat",[vE]:"fire-gcs",[wE]:"fire-gcs-compat",[EE]:"fire-fst",[PE]:"fire-fst-compat",[SE]:"fire-vertex","fire-js":"fire-js",[kE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn=new Map,ss=new Map,os=new Map;function wo(t,e){try{t.container.addComponent(e)}catch(n){pn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Bg(t,e){t.container.addOrOverwriteComponent(e)}function is(t){const e=t.name;if(os.has(e))return pn.debug(`There were multiple attempts to register component ${e}.`),!1;os.set(e,t);for(const n of Bn.values())wo(n,t);for(const n of ss.values())wo(n,t);return!0}function jg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function bE(t,e,n=Wn){jg(t,e).clearInstance(n)}function dd(t){return t.options!==void 0}function zg(t){return dd(t)?!1:"authIdToken"in t||"appCheckToken"in t||"releaseOnDeref"in t||"automaticDataCollectionEnabled"in t}function Hg(t){return t==null?!1:t.settings!==void 0}function AE(){os.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ct=new Il("app","Firebase",DE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yg=class{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ct.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(t,e){const n=Zi(t.split(".")[1]);if(n===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(n).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(n).exp*1e3,o=new Date().getTime();s-o<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class xE extends Yg{constructor(e,n,r,s){const o=n.automaticDataCollectionEnabled!==void 0?n.automaticDataCollectionEnabled:!0,i={name:r,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,i,s);else{const a=e;super(a.options,i,s)}this._serverConfig={automaticDataCollectionEnabled:o,...n},this._serverConfig.authIdToken&&kh(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&kh(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,ln(nl,Bu,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){pd(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ct.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=CE;function hd(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Wn,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ct.create("bad-app-name",{appName:String(s)});if(n||(n=id()),!n)throw ct.create("no-options");const o=Bn.get(s);if(o){if(tl(n,o.options)&&tl(r,o.config))return o;throw ct.create("duplicate-app",{appName:s})}const i=new ad(s);for(const l of os.values())i.addComponent(l);const a=new Yg(n,r,i);return Bn.set(s,a),a}function OE(t,e={}){if(yw()&&!Ug())throw ct.create("invalid-server-app-environment");let n,r=e||{};if(t&&(dd(t)?n=t.options:zg(t)?r=t:n=t),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),n||(n=id()),!n)throw ct.create("no-options");const s={...r,...n};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const o=f=>[...f].reduce((d,c)=>Math.imul(31,d)+c.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw ct.create("finalization-registry-not-supported",{});const i=""+o(JSON.stringify(s)),a=ss.get(i);if(a)return a.incRefCount(r.releaseOnDeref),a;const l=new ad(i);for(const f of os.values())l.addComponent(f);const u=new xE(n,r,i,l);return ss.set(i,u),u}function RE(t=Wn){const e=Bn.get(t);if(!e&&t===Wn&&id())return hd();if(!e)throw ct.create("no-app",{appName:t});return e}function NE(){return Array.from(Bn.values())}async function pd(t){let e=!1;const n=t.name;Bn.has(n)?(e=!0,Bn.delete(n)):ss.has(n)&&t.decRefCount()<=0&&(ss.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function ln(t,e,n){let r=TE[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const i=[`Unable to register library "${r}" with version "${e}":`];s&&i.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&i.push("and"),o&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pn.warn(i.join(" "));return}is(new hn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function Qg(t,e){if(t!==null&&typeof t!="function")throw ct.create("invalid-log-argument");Fw(t,e)}function Kg(t){Uw(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="firebase-heartbeat-database",LE=1,Eo="firebase-heartbeat-store";let $a=null;function qg(){return $a||($a=Qw(IE,LE,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Eo)}catch(n){console.warn(n)}}}}).catch(t=>{throw ct.create("idb-open",{originalErrorMessage:t.message})})),$a}async function $E(t){try{const n=(await qg()).transaction(Eo),r=await n.objectStore(Eo).get(Xg(t));return await n.done,r}catch(e){if(e instanceof gs)pn.warn(e.message);else{const n=ct.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pn.warn(n.message)}}}async function Ch(t,e){try{const r=(await qg()).transaction(Eo,"readwrite");await r.objectStore(Eo).put(e,Xg(t)),await r.done}catch(n){if(n instanceof gs)pn.warn(n.message);else{const r=ct.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});pn.warn(r.message)}}}function Xg(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME=1024,UE=30;class FE{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new GE(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Th();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(i=>i.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>UE){const i=WE(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){pn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Th(),{heartbeatsToSend:r,unsentEntries:s}=VE(this._heartbeatsCache.heartbeats),o=Ji(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return pn.warn(n),""}}}function Th(){return new Date().toISOString().substring(0,10)}function VE(t,e=ME){const n=[];let r=t.slice();for(const s of t){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),bh(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),bh(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class GE{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ww()?Ew().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await $E(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ch(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ch(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function bh(t){return Ji(JSON.stringify({version:2,heartbeats:t})).length}function WE(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){is(new hn("platform-logger",e=>new Xw(e),"PRIVATE")),is(new hn("heartbeat",e=>new FE(e),"PRIVATE")),ln(nl,Bu,t),ln(nl,Bu,"esm2020"),ln("fire-js","")}BE("");const jE=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:gs,SDK_VERSION:fd,_DEFAULT_ENTRY_NAME:Wn,_addComponent:wo,_addOrOverwriteComponent:Bg,_apps:Bn,_clearComponents:AE,_components:os,_getProvider:jg,_isFirebaseApp:dd,_isFirebaseServerApp:Hg,_isFirebaseServerAppSettings:zg,_registerComponent:is,_removeServiceInstance:bE,_serverApps:ss,deleteApp:pd,getApp:RE,getApps:NE,initializeApp:hd,initializeServerApp:OE,onLog:Qg,registerVersion:ln,setLogLevel:Kg},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,n){this._delegate=e,this.firebase=n,wo(e,new hn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),pd(this._delegate)))}_getService(e,n=Wn){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())==null?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=Wn){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){wo(this._delegate,e)}_addOrOverwriteComponent(e){Bg(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Ah=new Il("app-compat","Firebase",HE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(t){const e={},n={__esModule:!0,initializeApp:o,app:s,registerVersion:ln,setLogLevel:Kg,onLog:Qg,apps:null,SDK_VERSION:fd,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:jE}};n.default=n,Object.defineProperty(n,"apps",{get:i});function r(u){delete e[u]}function s(u){if(u=u||Wn,!ft(e,u))throw Ah.create("no-app",{appName:u});return e[u]}s.App=t;function o(u,f={}){const d=hd(u,f);if(ft(e,d.name))return e[d.name];const c=new t(d,n);return e[d.name]=c,c}function i(){return Object.keys(e).map(u=>e[u])}function a(u){const f=u.name,d=f.replace("-compat","");if(is(u)&&u.type==="PUBLIC"){const c=(p=s())=>{if(typeof p[d]!="function")throw Ah.create("invalid-app-argument",{appName:f});return p[d]()};u.serviceProps!==void 0&&_o(c,u.serviceProps),n[d]=c,t.prototype[d]=function(...p){return this._getService.bind(this,f).apply(this,u.multipleInstances?p:[])}}return u.type==="PUBLIC"?n[d]:null}function l(u,f){return f==="serverAuth"?null:f}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(){const t=YE(zE);t.INTERNAL={...t.INTERNAL,createFirebaseNamespace:Jg,extendNamespace:e,createSubscribe:Dw,ErrorFactory:Il,deepExtend:_o};function e(n){_o(t,n)}return t}const QE=Jg();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new $l("@firebase/app-compat"),KE="@firebase/app-compat",qE="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE(t){ln(KE,qE,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const t=$g();if(t.firebase!==void 0){Dh.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=t.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Dh.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const md=QE;XE();var JE="firebase",ZE="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */md.registerVersion(JE,ZE,"app-compat");var xh={};const Oh="@firebase/database",Rh="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zg="";function ey(t){Zg=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ee(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:vo(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return ft(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new eS(e)}}catch{}return new tS},ar=ty("localStorage"),ju=ty("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr=new $l("@firebase/database"),ny=function(){let t=1;return function(){return t++}}(),ry=function(t){const e=Rw(t),n=new Aw;n.update(e);const r=n.digest();return od.encodeByteArray(r)},$o=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=$o.apply(null,r):typeof r=="object"?e+=Ee(r):e+=r,e+=" "}return e};let dr=null,Nh=!0;const sy=function(t,e){b(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Kr.logLevel=Z.VERBOSE,dr=Kr.log.bind(Kr),e&&ju.set("logging_enabled",!0)):typeof t=="function"?dr=t:(dr=null,ju.remove("logging_enabled"))},be=function(...t){if(Nh===!0&&(Nh=!1,dr===null&&ju.get("logging_enabled")===!0&&sy(!0)),dr){const e=$o.apply(null,t);dr(e)}},Mo=function(t){return function(...e){be(t,...e)}},zu=function(...t){const e="FIREBASE INTERNAL ERROR: "+$o(...t);Kr.error(e)},Kt=function(...t){const e=`FIREBASE FATAL ERROR: ${$o(...t)}`;throw Kr.error(e),new Error(e)},Fe=function(...t){const e="FIREBASE WARNING: "+$o(...t);Kr.warn(e)},nS=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Fe("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ml=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},rS=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},jn="[MIN_NAME]",mn="[MAX_NAME]",kr=function(t,e){if(t===e)return 0;if(t===jn||e===mn)return-1;if(e===jn||t===mn)return 1;{const n=Ih(t),r=Ih(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},sS=function(t,e){return t===e?0:t<e?-1:1},Os=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ee(e))},gd=function(t){if(typeof t!="object"||t===null)return Ee(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ee(e[r]),n+=":",n+=gd(t[e[r]]);return n+="}",n},oy=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function De(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const iy=function(t){b(!Ml(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,o,i,a,l;t===0?(o=0,i=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),o=a+r,i=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(o=0,i=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(i%2?1:0),i=Math.floor(i/2);for(l=e;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(s?1:0),u.reverse();const f=u.join("");let d="";for(l=0;l<64;l+=8){let c=parseInt(f.substr(l,8),2).toString(16);c.length===1&&(c="0"+c),d=d+c}return d.toLowerCase()},oS=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},iS=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function lS(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const aS=new RegExp("^-?(0*)\\d{1,10}$"),uS=-2147483648,cS=2147483647,Ih=function(t){if(aS.test(t)){const e=Number(t);if(e>=uS&&e<=cS)return e}return null},ys=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Fe("Exception was thrown by user callback.",n),e},Math.floor(0))}},dS=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qs=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,Hg(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Fe(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(be("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Fe(e)}}class qr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}qr.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd="5",ly="v",ay="s",uy="r",cy="f",dy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,fy="ls",hy="p",Hu="ac",py="websocket",my="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e,n,r,s,o=!1,i="",a=!1,l=!1,u=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=i,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ar.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ar.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function pS(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function yy(t,e,n){b(typeof e=="string","typeof type must == string"),b(typeof n=="object","typeof params must == object");let r;if(e===py)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===my)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);pS(t)&&(n.ns=t.namespace);const s=[];return De(n,(o,i)=>{s.push(o+"="+i)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(){this.counters_={}}incrementCounter(e,n=1){ft(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return ow(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma={},Ua={};function _d(t){const e=t.toString();return Ma[e]||(Ma[e]=new mS),Ma[e]}function gS(t,e){const n=t.toString();return Ua[n]||(Ua[n]=e()),Ua[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&ys(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="start",_S="close",vS="pLPCommand",wS="pRTLPCB",_y="id",vy="pw",wy="ser",ES="cb",SS="seg",PS="ts",kS="d",CS="dframe",Ey=1870,Sy=30,TS=Ey-Sy,bS=25e3,AS=3e4;class Tn{constructor(e,n,r,s,o,i,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.transportSessionId=i,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Mo(e),this.stats_=_d(n),this.urlFn=l=>(this.appCheckToken&&(l[Hu]=this.appCheckToken),yy(n,my,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new yS(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(AS)),rS(()=>{if(this.isClosed_)return;this.scriptTagHolder=new vd((...o)=>{const[i,a,l,u,f]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,i===Lh)this.id=a,this.password=l;else if(i===_S)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+i)},(...o)=>{const[i,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(i,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[Lh]="t",r[wy]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[ES]=this.scriptTagHolder.uniqueCallbackIdentifier),r[ly]=yd,this.transportSessionId&&(r[ay]=this.transportSessionId),this.lastSessionId&&(r[fy]=this.lastSessionId),this.applicationId&&(r[hy]=this.applicationId),this.appCheckToken&&(r[Hu]=this.appCheckToken),typeof location<"u"&&location.hostname&&dy.test(location.hostname)&&(r[uy]=cy);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Tn.forceAllow_=!0}static forceDisallow(){Tn.forceDisallow_=!0}static isAvailable(){return Tn.forceAllow_?!0:!Tn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!oS()&&!iS()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Ee(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Lg(n),s=oy(r,TS);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[CS]="t",r[_y]=e,r[vy]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Ee(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class vd{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ny(),window[vS+this.uniqueCallbackIdentifier]=e,window[wS+this.uniqueCallbackIdentifier]=n,this.myIFrame=vd.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(a){be("frame writing exception"),a.stack&&be(a.stack),be(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||be("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[_y]=this.myID,e[vy]=this.myPW,e[wy]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Sy+r.length<=Ey;){const i=this.pendingSegs.shift();r=r+"&"+SS+s+"="+i.seg+"&"+PS+s+"="+i.ts+"&"+kS+s+"="+i.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(bS)),o=()=>{clearTimeout(s),r()};this.addTag(e,o)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{be("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS=16384,xS=45e3;let rl=null;typeof MozWebSocket<"u"?rl=MozWebSocket:typeof WebSocket<"u"&&(rl=WebSocket);class wt{constructor(e,n,r,s,o,i,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Mo(this.connId),this.stats_=_d(n),this.connURL=wt.connectionURL_(n,i,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,o){const i={};return i[ly]=yd,typeof location<"u"&&location.hostname&&dy.test(location.hostname)&&(i[uy]=cy),n&&(i[ay]=n),r&&(i[fy]=r),s&&(i[Hu]=s),o&&(i[hy]=o),yy(e,py,i)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ar.set("previous_websocket_failure",!0);try{let r;vw(),this.mySock=new rl(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){wt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&rl!==null&&!wt.forceDisallow_}static previouslyFailed(){return ar.isInMemoryStorage||ar.get("previous_websocket_failure")===!0}markConnectionHealthy(){ar.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=vo(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(b(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Ee(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=oy(n,DS);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(xS))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}wt.responsesRequiredToBeHealthy=2;wt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{static get ALL_TRANSPORTS(){return[Tn,wt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=wt&&wt.isAvailable();let r=n&&!wt.previouslyFailed();if(e.webSocketOnly&&(n||Fe("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[wt];else{const s=this.transports_=[];for(const o of ls.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);ls.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ls.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=6e4,RS=5e3,NS=10*1024,IS=100*1024,Fa="t",$h="d",LS="s",Mh="r",$S="e",Uh="o",Fh="a",Vh="n",Gh="p",MS="h";class US{constructor(e,n,r,s,o,i,a,l,u,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=i,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Mo("c:"+this.id+":"),this.transportManager_=new ls(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=qs(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>IS?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>NS?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Fa in e){const n=e[Fa];n===Fh?this.upgradeIfSecondaryHealthy_():n===Mh?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Uh&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Os("t",e),r=Os("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Gh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Fh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Vh,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Os("t",e),r=Os("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Os(Fa,e);if($h in e){const r=e[$h];if(n===MS){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===Vh){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===LS?this.onConnectionShutdown_(r):n===Mh?this.onReset_(r):n===$S?zu("Server Error: "+r):n===Uh?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):zu("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),yd!==r&&Fe("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),qs(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(OS))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qs(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(RS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Gh,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ar.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e){this.allowedEvents_=e,this.listeners_={},b(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===n&&(!r||r===s[o].context)){s.splice(o,1);return}}validateEventType_(e){b(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl extends ky{static getInstance(){return new sl}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Mg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return b(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh=32,Bh=768;class K{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Q(){return new K("")}function G(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function zn(t){return t.pieces_.length-t.pieceNum_}function ee(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new K(t.pieces_,e)}function wd(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function FS(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function So(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Cy(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new K(e,0)}function ae(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof K)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new K(n,0)}function W(t){return t.pieceNum_>=t.pieces_.length}function Be(t,e){const n=G(t),r=G(e);if(n===null)return e;if(n===r)return Be(ee(t),ee(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function VS(t,e){const n=So(t,0),r=So(e,0);for(let s=0;s<n.length&&s<r.length;s++){const o=kr(n[s],r[s]);if(o!==0)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Ed(t,e){if(zn(t)!==zn(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function St(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(zn(t)>zn(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class GS{constructor(e,n){this.errorPrefix_=n,this.parts_=So(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Ll(this.parts_[r]);Ty(this)}}function WS(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Ll(e),Ty(t)}function BS(t){const e=t.parts_.pop();t.byteLength_-=Ll(e),t.parts_.length>0&&(t.byteLength_-=1)}function Ty(t){if(t.byteLength_>Bh)throw new Error(t.errorPrefix_+"has a key path longer than "+Bh+" bytes ("+t.byteLength_+").");if(t.parts_.length>Wh)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Wh+") or object contains a cycle "+sr(t))}function sr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd extends ky{static getInstance(){return new Sd}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return b(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs=1e3,jS=60*5*1e3,jh=30*1e3,zS=1.3,HS=3e4,YS="server_kill",zh=3;class an extends Py{constructor(e,n,r,s,o,i,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=i,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=an.nextPersistentConnectionId_++,this.log_=Mo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Rs,this.maxReconnectDelay_=jS,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Sd.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&sl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,o={r:s,a:e,b:n};this.log_(Ee(o)),b(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Xe,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:i=>{const a=i.d;i.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),n.promise}listen(e,n,r,s){this.initConnection_();const o=e._queryIdentifier,i=e._path.toString();this.log_("Listen called for "+i+" "+o),this.listens.has(i)||this.listens.set(i,new Map),b(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),b(!this.listens.get(i).has(o),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(i).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const o={p:r},i="q";e.tag&&(o.q=n._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(i,o,a=>{const l=a.d,u=a.s;an.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&ft(e,"w")){const r=_r(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',o=n._path.toString();Fe(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Tw(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=jh)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Cw(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const o=s.s,i=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),b(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const o={p:e},i="n";s&&(o.q=r,o.t=s),this.sendRequest(i,o)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const o={p:n,d:r};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,i=>{s&&setTimeout(()=>{s(i.s,i.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,o){this.initConnection_();const i={p:n,d:r};o!==void 0&&(i.h=o),this.outstandingPuts_.push({action:e,request:i,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,o=>{this.log_(n+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ee(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):zu("Unrecognized action received from server: "+Ee(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){b(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Rs,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Rs,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>HS&&(this.reconnectDelay_=Rs),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*zS)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+an.nextConnectionId_++,o=this.lastSessionId;let i=!1,a=null;const l=function(){a?a.close():(i=!0,r())},u=function(d){b(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:u};const f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,c]=await Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);i?be("getToken() completed but was canceled"):(be("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=c&&c.token,a=new US(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,p=>{Fe(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(YS)},o))}catch(d){this.log_("Failed to get token: "+d),i||(this.repoInfo_.nodeAdmin&&Fe(d),l())}}}interrupt(e){be("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){be("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Fu(this.interruptReasons_)&&(this.reconnectDelay_=Rs,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(o=>gd(o)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new K(e).toString();let s;if(this.listens.has(r)){const o=this.listens.get(r);s=o.get(n),o.delete(n),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){be("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=zh&&(this.reconnectDelay_=jh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){be("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=zh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Zg.replace(/\./g,"-")]=1,Mg()?e["framework.cordova"]=1:_w()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=sl.getInstance().currentlyOnline();return Fu(this.interruptReasons_)&&e}}an.nextPersistentConnectionId_=0;an.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new B(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new B(jn,e),s=new B(jn,n);return this.compare(r,s)!==0}minPost(){return B.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fi;class by extends Ul{static get __EMPTY_NODE(){return fi}static set __EMPTY_NODE(e){fi=e}compare(e,n){return kr(e.name,n.name)}isDefinedOn(e){throw ms("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return B.MIN}maxPost(){return new B(mn,fi)}makePost(e,n){return b(typeof e=="string","KeyIndex indexValue must always be a string."),new B(e,fi)}toString(){return".key"}}const Qt=new by;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n,r,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let i=1;for(;!e.isEmpty();)if(e=e,i=n?r(e.key,n):1,s&&(i*=-1),i<0)this.isReverse_?e=e.left:e=e.right;else if(i===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Te{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??Te.RED,this.left=s??et.EMPTY_NODE,this.right=o??et.EMPTY_NODE}copy(e,n,r,s,o){return new Te(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return et.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return et.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Te.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Te.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Te.RED=!0;Te.BLACK=!1;class QS{copy(e,n,r,s,o){return this}insert(e,n,r){return new Te(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class et{constructor(e,n=et.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new et(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Te.BLACK,null,null))}remove(e){return new et(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Te.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new hi(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new hi(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new hi(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new hi(this.root_,null,this.comparator_,!0,e)}}et.EMPTY_NODE=new QS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(t,e){return kr(t.name,e.name)}function Pd(t,e){return kr(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yu;function qS(t){Yu=t}const Ay=function(t){return typeof t=="number"?"number:"+iy(t):"string:"+t},Dy=function(t){if(t.isLeafNode()){const e=t.val();b(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ft(e,".sv"),"Priority must be a string or number.")}else b(t===Yu||t.isEmpty(),"priority of unexpected type.");b(t===Yu||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hh;class Pe{static set __childrenNodeConstructor(e){Hh=e}static get __childrenNodeConstructor(){return Hh}constructor(e,n=Pe.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,b(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Dy(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Pe(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Pe.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return W(e)?this:G(e)===".priority"?this.priorityNode_:Pe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Pe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=G(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(b(r!==".priority"||zn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Pe.__childrenNodeConstructor.EMPTY_NODE.updateChild(ee(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ay(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=iy(this.value_):e+=this.value_,this.lazyHash_=ry(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Pe.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Pe.__childrenNodeConstructor?-1:(b(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Pe.VALUE_TYPE_ORDER.indexOf(n),o=Pe.VALUE_TYPE_ORDER.indexOf(r);return b(s>=0,"Unknown leaf type: "+n),b(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Pe.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xy,Oy;function XS(t){xy=t}function JS(t){Oy=t}class ZS extends Ul{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),o=r.compareTo(s);return o===0?kr(e.name,n.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return B.MIN}maxPost(){return new B(mn,new Pe("[PRIORITY-POST]",Oy))}makePost(e,n){const r=xy(e);return new B(n,new Pe("[PRIORITY-POST]",r))}toString(){return".priority"}}const re=new ZS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=Math.log(2);class tP{constructor(e){const n=o=>parseInt(Math.log(o)/eP,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ol=function(t,e,n,r){t.sort(e);const s=function(l,u){const f=u-l;let d,c;if(f===0)return null;if(f===1)return d=t[l],c=n?n(d):d,new Te(c,d.node,Te.BLACK,null,null);{const p=parseInt(f/2,10)+l,m=s(l,p),g=s(p+1,u);return d=t[p],c=n?n(d):d,new Te(c,d.node,Te.BLACK,m,g)}},o=function(l){let u=null,f=null,d=t.length;const c=function(m,g){const E=d-m,_=d;d-=m;const h=s(E+1,_),v=t[E],S=n?n(v):v;p(new Te(S,v.node,g,null,h))},p=function(m){u?(u.left=m,u=m):(f=m,u=m)};for(let m=0;m<l.count;++m){const g=l.nextBitIsOne(),E=Math.pow(2,l.count-(m+1));g?c(E,Te.BLACK):(c(E,Te.BLACK),c(E,Te.RED))}return f},i=new tP(t.length),a=o(i);return new et(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Va;const Dr={};class sn{static get Default(){return b(Dr&&re,"ChildrenNode.ts has not been loaded"),Va=Va||new sn({".priority":Dr},{".priority":re}),Va}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=_r(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof et?n:null}hasIndex(e){return ft(this.indexSet_,e.toString())}addIndex(e,n){b(e!==Qt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const o=n.getIterator(B.Wrap);let i=o.getNext();for(;i;)s=s||e.isDefinedOn(i.node),r.push(i),i=o.getNext();let a;s?a=ol(r,e.getCompare()):a=Dr;const l=e.toString(),u={...this.indexSet_};u[l]=e;const f={...this.indexes_};return f[l]=a,new sn(f,u)}addToIndexes(e,n){const r=el(this.indexes_,(s,o)=>{const i=_r(this.indexSet_,o);if(b(i,"Missing index implementation for "+o),s===Dr)if(i.isDefinedOn(e.node)){const a=[],l=n.getIterator(B.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),ol(a,i.getCompare())}else return Dr;else{const a=n.get(e.name);let l=s;return a&&(l=l.remove(new B(e.name,a))),l.insert(e,e.node)}});return new sn(r,this.indexSet_)}removeFromIndexes(e,n){const r=el(this.indexes_,s=>{if(s===Dr)return s;{const o=n.get(e.name);return o?s.remove(new B(e.name,o)):s}});return new sn(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ns;class I{static get EMPTY_NODE(){return Ns||(Ns=new I(new et(Pd),null,sn.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Dy(this.priorityNode_),this.children_.isEmpty()&&b(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ns}updatePriority(e){return this.children_.isEmpty()?this:new I(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Ns:n}}getChild(e){const n=G(e);return n===null?this:this.getImmediateChild(n).getChild(ee(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(b(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new B(e,n);let s,o;n.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));const i=s.isEmpty()?Ns:this.priorityNode_;return new I(s,i,o)}}updateChild(e,n){const r=G(e);if(r===null)return n;{b(G(e)!==".priority"||zn(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(ee(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,o=!0;if(this.forEachChild(re,(i,a)=>{n[i]=a.val(e),r++,o&&I.INTEGER_REGEXP_.test(i)?s=Math.max(s,Number(i)):o=!1}),!e&&o&&s<2*r){const i=[];for(const a in n)i[a]=n[a];return i}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ay(this.getPriority().val())+":"),this.forEachChild(re,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":ry(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const o=s.getPredecessorKey(new B(e,n));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new B(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new B(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,B.Wrap);let o=s.peek();for(;o!=null&&n.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,B.Wrap);let o=s.peek();for(;o!=null&&n.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Uo?-1:0}withIndex(e){if(e===Qt||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new I(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Qt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(re),s=n.getIterator(re);let o=r.getNext(),i=s.getNext();for(;o&&i;){if(o.name!==i.name||!o.node.equals(i.node))return!1;o=r.getNext(),i=s.getNext()}return o===null&&i===null}else return!1;else return!1}}resolveIndex_(e){return e===Qt?null:this.indexMap_.get(e.toString())}}I.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class nP extends I{constructor(){super(new et(Pd),I.EMPTY_NODE,sn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return I.EMPTY_NODE}isEmpty(){return!1}}const Uo=new nP;Object.defineProperties(B,{MIN:{value:new B(jn,I.EMPTY_NODE)},MAX:{value:new B(mn,Uo)}});by.__EMPTY_NODE=I.EMPTY_NODE;Pe.__childrenNodeConstructor=I;qS(Uo);JS(Uo);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP=!0;function ce(t,e=null){if(t===null)return I.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),b(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Pe(n,ce(e))}if(!(t instanceof Array)&&rP){const n=[];let r=!1;if(De(t,(i,a)=>{if(i.substring(0,1)!=="."){const l=ce(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new B(i,l)))}}),n.length===0)return I.EMPTY_NODE;const o=ol(n,KS,i=>i.name,Pd);if(r){const i=ol(n,re.getCompare());return new I(o,ce(e),new sn({".priority":i},{".priority":re}))}else return new I(o,ce(e),sn.Default)}else{let n=I.EMPTY_NODE;return De(t,(r,s)=>{if(ft(t,r)&&r.substring(0,1)!=="."){const o=ce(s);(o.isLeafNode()||!o.isEmpty())&&(n=n.updateImmediateChild(r,o))}}),n.updatePriority(ce(e))}}XS(ce);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd extends Ul{constructor(e){super(),this.indexPath_=e,b(!W(e)&&G(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),o=r.compareTo(s);return o===0?kr(e.name,n.name):o}makePost(e,n){const r=ce(e),s=I.EMPTY_NODE.updateChild(this.indexPath_,r);return new B(n,s)}maxPost(){const e=I.EMPTY_NODE.updateChild(this.indexPath_,Uo);return new B(mn,e)}toString(){return So(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP extends Ul{compare(e,n){const r=e.node.compareTo(n.node);return r===0?kr(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return B.MIN}maxPost(){return B.MAX}makePost(e,n){const r=ce(e);return new B(n,r)}toString(){return".value"}}const Cd=new sP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(t){return{type:"value",snapshotNode:t}}function as(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Po(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function ko(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function oP(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e){this.index_=e}updateChild(e,n,r,s,o,i){b(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(i!=null&&(r.isEmpty()?e.hasChild(n)?i.trackChildChange(Po(n,a)):b(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?i.trackChildChange(as(n,r)):i.trackChildChange(ko(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(re,(s,o)=>{n.hasChild(s)||r.trackChildChange(Po(s,o))}),n.isLeafNode()||n.forEachChild(re,(s,o)=>{if(e.hasChild(s)){const i=e.getImmediateChild(s);i.equals(o)||r.trackChildChange(ko(s,o,i))}else r.trackChildChange(as(s,o))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?I.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e){this.indexedFilter_=new Td(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Co.getStartPost_(e),this.endPost_=Co.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,o,i){return this.matches(new B(n,r))||(r=I.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,o,i)}updateFullNode(e,n,r){n.isLeafNode()&&(n=I.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(I.EMPTY_NODE);const o=this;return n.forEachChild(re,(i,a)=>{o.matches(new B(i,a))||(s=s.updateImmediateChild(i,I.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Co(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,o,i){return this.rangedFilter_.matches(new B(n,r))||(r=I.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,o,i):this.fullLimitUpdateChild_(e,n,r,o,i)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=I.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=I.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let i=0;for(;o.hasNext()&&i<this.limit_;){const a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),i++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(I.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let i=0;for(;o.hasNext();){const a=o.getNext();i<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?i++:s=s.updateImmediateChild(a.name,I.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,o){let i;if(this.reverse_){const d=this.index_.getCompare();i=(c,p)=>d(p,c)}else i=this.index_.getCompare();const a=e;b(a.numChildren()===this.limit_,"");const l=new B(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),f=this.rangedFilter_.matches(l);if(a.hasChild(n)){const d=a.getImmediateChild(n);let c=s.getChildAfterChild(this.index_,u,this.reverse_);for(;c!=null&&(c.name===n||a.hasChild(c.name));)c=s.getChildAfterChild(this.index_,c,this.reverse_);const p=c==null?1:i(c,l);if(f&&!r.isEmpty()&&p>=0)return o!=null&&o.trackChildChange(ko(n,r,d)),a.updateImmediateChild(n,r);{o!=null&&o.trackChildChange(Po(n,d));const g=a.updateImmediateChild(n,I.EMPTY_NODE);return c!=null&&this.rangedFilter_.matches(c)?(o!=null&&o.trackChildChange(as(c.name,c.node)),g.updateImmediateChild(c.name,c.node)):g}}else return r.isEmpty()?e:f&&i(u,l)>=0?(o!=null&&(o.trackChildChange(Po(u.name,u.node)),o.trackChildChange(as(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,I.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=re}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return b(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return b(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:jn}hasEnd(){return this.endSet_}getIndexEndValue(){return b(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return b(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:mn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return b(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===re}copy(){const e=new Fl;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function lP(t){return t.loadsAllData()?new Td(t.getIndex()):t.hasLimit()?new iP(t):new Co(t)}function aP(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function uP(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Qu(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function cP(t,e,n){let r;return t.index_===Qt||n?r=Qu(t,e,n):r=Qu(t,e,mn),r.startAfterSet_=!0,r}function Ku(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function dP(t,e,n){let r;return t.index_===Qt||n?r=Ku(t,e,n):r=Ku(t,e,jn),r.endBeforeSet_=!0,r}function Vl(t,e){const n=t.copy();return n.index_=e,n}function Yh(t){const e={};if(t.isDefault())return e;let n;if(t.index_===re?n="$priority":t.index_===Cd?n="$value":t.index_===Qt?n="$key":(b(t.index_ instanceof kd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ee(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=Ee(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Ee(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Ee(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Ee(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Qh(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==re&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il extends Py{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(b(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Mo("p:rest:"),this.listens_={}}listen(e,n,r,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const i=il.getListenId_(e,r),a={};this.listens_[i]=a;const l=Yh(e._queryParams);this.restRequest_(o+".json",l,(u,f)=>{let d=f;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(o,d,!1,r),_r(this.listens_,i)===a){let c;u?u===401?c="permission_denied":c="rest_error:"+u:c="ok",s(c,null)}})}unlisten(e,n){const r=il.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Yh(e._queryParams),r=e._path.toString(),s=new Xe;return this.restRequest_(r+".json",n,(o,i)=>{let a=i;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(n.auth=s.accessToken),o&&o.token&&(n.ac=o.token);const i=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+bw(n);this.log_("Sending REST request for "+i);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+i+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=vo(a.responseText)}catch{Fe("Failed to parse JSON response for "+i+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Fe("Got unsuccessful REST response for "+i+" Status: "+a.status),r(a.status);r=null}},a.open("GET",i,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(){this.rootNode_=I.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(){return{value:null,children:new Map}}function _s(t,e,n){if(W(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=G(e);t.children.has(r)||t.children.set(r,ll());const s=t.children.get(r);e=ee(e),_s(s,e,n)}}function qu(t,e){if(W(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(re,(r,s)=>{_s(t,new K(r),s)}),qu(t,e)}}else if(t.children.size>0){const n=G(e);return e=ee(e),t.children.has(n)&&qu(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Xu(t,e,n){t.value!==null?n(e,t.value):hP(t,(r,s)=>{const o=new K(e.toString()+"/"+r);Xu(s,o,n)})}function hP(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&De(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh=10*1e3,mP=30*1e3,gP=5*60*1e3;class yP{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new pP(e);const r=Kh+(mP-Kh)*Math.random();qs(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;De(e,(s,o)=>{o>0&&ft(this.statsToReport_,s)&&(n[s]=o,r=!0)}),r&&this.server_.reportStats(n),qs(this.reportStats_.bind(this),Math.floor(Math.random()*2*gP))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(It||(It={}));function bd(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ad(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Dd(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=It.ACK_USER_WRITE,this.source=bd()}operationForChild(e){if(W(this.path)){if(this.affectedTree.value!=null)return b(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new K(e));return new al(Q(),n,this.revert)}}else return b(G(this.path)===e,"operationForChild called for unrelated child."),new al(ee(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n){this.source=e,this.path=n,this.type=It.LISTEN_COMPLETE}operationForChild(e){return W(this.path)?new To(this.source,Q()):new To(this.source,ee(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=It.OVERWRITE}operationForChild(e){return W(this.path)?new vr(this.source,Q(),this.snap.getImmediateChild(e)):new vr(this.source,ee(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=It.MERGE}operationForChild(e){if(W(this.path)){const n=this.children.subtree(new K(e));return n.isEmpty()?null:n.value?new vr(this.source,Q(),n.value):new us(this.source,Q(),n)}else return b(G(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new us(this.source,ee(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(W(e))return this.isFullyInitialized()&&!this.filtered_;const n=G(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function vP(t,e,n,r){const s=[],o=[];return e.forEach(i=>{i.type==="child_changed"&&t.index_.indexedValueChanged(i.oldSnap,i.snapshotNode)&&o.push(oP(i.childName,i.snapshotNode))}),Is(t,s,"child_removed",e,r,n),Is(t,s,"child_added",e,r,n),Is(t,s,"child_moved",o,r,n),Is(t,s,"child_changed",e,r,n),Is(t,s,"value",e,r,n),s}function Is(t,e,n,r,s,o){const i=r.filter(a=>a.type===n);i.sort((a,l)=>EP(t,a,l)),i.forEach(a=>{const l=wP(t,a,o);s.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function wP(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function EP(t,e,n){if(e.childName==null||n.childName==null)throw ms("Should only compare child_ events.");const r=new B(e.childName,e.snapshotNode),s=new B(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(t,e){return{eventCache:t,serverCache:e}}function Xs(t,e,n,r){return Gl(new Hn(e,n,r),t.serverCache)}function Ny(t,e,n,r){return Gl(t.eventCache,new Hn(e,n,r))}function ul(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function wr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ga;const SP=()=>(Ga||(Ga=new et(sS)),Ga);class te{static fromObject(e){let n=new te(null);return De(e,(r,s)=>{n=n.set(new K(r),s)}),n}constructor(e,n=SP()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Q(),value:this.value};if(W(e))return null;{const r=G(e),s=this.children.get(r);if(s!==null){const o=s.findRootMostMatchingPathAndValue(ee(e),n);return o!=null?{path:ae(new K(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(W(e))return this;{const n=G(e),r=this.children.get(n);return r!==null?r.subtree(ee(e)):new te(null)}}set(e,n){if(W(e))return new te(n,this.children);{const r=G(e),o=(this.children.get(r)||new te(null)).set(ee(e),n),i=this.children.insert(r,o);return new te(this.value,i)}}remove(e){if(W(e))return this.children.isEmpty()?new te(null):new te(null,this.children);{const n=G(e),r=this.children.get(n);if(r){const s=r.remove(ee(e));let o;return s.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,s),this.value===null&&o.isEmpty()?new te(null):new te(this.value,o)}else return this}}get(e){if(W(e))return this.value;{const n=G(e),r=this.children.get(n);return r?r.get(ee(e)):null}}setTree(e,n){if(W(e))return n;{const r=G(e),o=(this.children.get(r)||new te(null)).setTree(ee(e),n);let i;return o.isEmpty()?i=this.children.remove(r):i=this.children.insert(r,o),new te(this.value,i)}}fold(e){return this.fold_(Q(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,o)=>{r[s]=o.fold_(ae(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Q(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(W(e))return null;{const o=G(e),i=this.children.get(o);return i?i.findOnPath_(ee(e),ae(n,o),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Q(),n)}foreachOnPath_(e,n,r){if(W(e))return this;{this.value&&r(n,this.value);const s=G(e),o=this.children.get(s);return o?o.foreachOnPath_(ee(e),ae(n,s),r):new te(null)}}foreach(e){this.foreach_(Q(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(ae(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.writeTree_=e}static empty(){return new Mt(new te(null))}}function Js(t,e,n){if(W(e))return new Mt(new te(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let o=r.value;const i=Be(s,e);return o=o.updateChild(i,n),new Mt(t.writeTree_.set(s,o))}else{const s=new te(n),o=t.writeTree_.setTree(e,s);return new Mt(o)}}}function Ju(t,e,n){let r=t;return De(n,(s,o)=>{r=Js(r,ae(e,s),o)}),r}function qh(t,e){if(W(e))return Mt.empty();{const n=t.writeTree_.setTree(e,new te(null));return new Mt(n)}}function Zu(t,e){return Cr(t,e)!=null}function Cr(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Be(n.path,e)):null}function Xh(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(re,(r,s)=>{e.push(new B(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new B(r,s.value))}),e}function Mn(t,e){if(W(e))return t;{const n=Cr(t,e);return n!=null?new Mt(new te(n)):new Mt(t.writeTree_.subtree(e))}}function ec(t){return t.writeTree_.isEmpty()}function cs(t,e){return Iy(Q(),t.writeTree_,e)}function Iy(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(b(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):n=Iy(ae(t,s),o,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(ae(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t,e){return Uy(e,t)}function PP(t,e,n,r,s){b(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Js(t.visibleWrites,e,n)),t.lastWriteId=r}function kP(t,e,n,r){b(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Ju(t.visibleWrites,e,n),t.lastWriteId=r}function CP(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function TP(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);b(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,o=!1,i=t.allWrites.length-1;for(;s&&i>=0;){const a=t.allWrites[i];a.visible&&(i>=n&&bP(a,r.path)?s=!1:St(r.path,a.path)&&(o=!0)),i--}if(s){if(o)return AP(t),!0;if(r.snap)t.visibleWrites=qh(t.visibleWrites,r.path);else{const a=r.children;De(a,l=>{t.visibleWrites=qh(t.visibleWrites,ae(r.path,l))})}return!0}else return!1}function bP(t,e){if(t.snap)return St(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&St(ae(t.path,n),e))return!0;return!1}function AP(t){t.visibleWrites=Ly(t.allWrites,DP,Q()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function DP(t){return t.visible}function Ly(t,e,n){let r=Mt.empty();for(let s=0;s<t.length;++s){const o=t[s];if(e(o)){const i=o.path;let a;if(o.snap)St(n,i)?(a=Be(n,i),r=Js(r,a,o.snap)):St(i,n)&&(a=Be(i,n),r=Js(r,Q(),o.snap.getChild(a)));else if(o.children){if(St(n,i))a=Be(n,i),r=Ju(r,a,o.children);else if(St(i,n))if(a=Be(i,n),W(a))r=Ju(r,Q(),o.children);else{const l=_r(o.children,G(a));if(l){const u=l.getChild(ee(a));r=Js(r,Q(),u)}}}else throw ms("WriteRecord should have .snap or .children")}}return r}function $y(t,e,n,r,s){if(!r&&!s){const o=Cr(t.visibleWrites,e);if(o!=null)return o;{const i=Mn(t.visibleWrites,e);if(ec(i))return n;if(n==null&&!Zu(i,Q()))return null;{const a=n||I.EMPTY_NODE;return cs(i,a)}}}else{const o=Mn(t.visibleWrites,e);if(!s&&ec(o))return n;if(!s&&n==null&&!Zu(o,Q()))return null;{const i=function(u){return(u.visible||s)&&(!r||!~r.indexOf(u.writeId))&&(St(u.path,e)||St(e,u.path))},a=Ly(t.allWrites,i,e),l=n||I.EMPTY_NODE;return cs(a,l)}}}function xP(t,e,n){let r=I.EMPTY_NODE;const s=Cr(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(re,(o,i)=>{r=r.updateImmediateChild(o,i)}),r;if(n){const o=Mn(t.visibleWrites,e);return n.forEachChild(re,(i,a)=>{const l=cs(Mn(o,new K(i)),a);r=r.updateImmediateChild(i,l)}),Xh(o).forEach(i=>{r=r.updateImmediateChild(i.name,i.node)}),r}else{const o=Mn(t.visibleWrites,e);return Xh(o).forEach(i=>{r=r.updateImmediateChild(i.name,i.node)}),r}}function OP(t,e,n,r,s){b(r||s,"Either existingEventSnap or existingServerSnap must exist");const o=ae(e,n);if(Zu(t.visibleWrites,o))return null;{const i=Mn(t.visibleWrites,o);return ec(i)?s.getChild(n):cs(i,s.getChild(n))}}function RP(t,e,n,r){const s=ae(e,n),o=Cr(t.visibleWrites,s);if(o!=null)return o;if(r.isCompleteForChild(n)){const i=Mn(t.visibleWrites,s);return cs(i,r.getNode().getImmediateChild(n))}else return null}function NP(t,e){return Cr(t.visibleWrites,e)}function IP(t,e,n,r,s,o,i){let a;const l=Mn(t.visibleWrites,e),u=Cr(l,Q());if(u!=null)a=u;else if(n!=null)a=cs(l,n);else return[];if(a=a.withIndex(i),!a.isEmpty()&&!a.isLeafNode()){const f=[],d=i.getCompare(),c=o?a.getReverseIteratorFrom(r,i):a.getIteratorFrom(r,i);let p=c.getNext();for(;p&&f.length<s;)d(p,r)!==0&&f.push(p),p=c.getNext();return f}else return[]}function LP(){return{visibleWrites:Mt.empty(),allWrites:[],lastWriteId:-1}}function cl(t,e,n,r){return $y(t.writeTree,t.treePath,e,n,r)}function xd(t,e){return xP(t.writeTree,t.treePath,e)}function Jh(t,e,n,r){return OP(t.writeTree,t.treePath,e,n,r)}function dl(t,e){return NP(t.writeTree,ae(t.treePath,e))}function $P(t,e,n,r,s,o){return IP(t.writeTree,t.treePath,e,n,r,s,o)}function Od(t,e,n){return RP(t.writeTree,t.treePath,e,n)}function My(t,e){return Uy(ae(t.treePath,e),t.writeTree)}function Uy(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;b(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),b(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const o=s.type;if(n==="child_added"&&o==="child_removed")this.changeMap.set(r,ko(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&o==="child_changed")this.changeMap.set(r,Po(r,s.oldSnap));else if(n==="child_changed"&&o==="child_added")this.changeMap.set(r,as(r,e.snapshotNode));else if(n==="child_changed"&&o==="child_changed")this.changeMap.set(r,ko(r,e.snapshotNode,s.oldSnap));else throw ms("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const Fy=new UP;class Rd{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Hn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Od(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:wr(this.viewCache_),o=$P(this.writes_,s,n,1,r,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FP(t){return{filter:t}}function VP(t,e){b(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),b(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function GP(t,e,n,r,s){const o=new MP;let i,a;if(n.type===It.OVERWRITE){const u=n;u.source.fromUser?i=tc(t,e,u.path,u.snap,r,s,o):(b(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!W(u.path),i=fl(t,e,u.path,u.snap,r,s,a,o))}else if(n.type===It.MERGE){const u=n;u.source.fromUser?i=BP(t,e,u.path,u.children,r,s,o):(b(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),i=nc(t,e,u.path,u.children,r,s,a,o))}else if(n.type===It.ACK_USER_WRITE){const u=n;u.revert?i=HP(t,e,u.path,r,s,o):i=jP(t,e,u.path,u.affectedTree,r,s,o)}else if(n.type===It.LISTEN_COMPLETE)i=zP(t,e,n.path,r,o);else throw ms("Unknown operation type: "+n.type);const l=o.getChanges();return WP(e,i,l),{viewCache:i,changes:l}}function WP(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=ul(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Ry(ul(e)))}}function Vy(t,e,n,r,s,o){const i=e.eventCache;if(dl(r,n)!=null)return e;{let a,l;if(W(n))if(b(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=wr(e),f=u instanceof I?u:I.EMPTY_NODE,d=xd(r,f);a=t.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{const u=cl(r,wr(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,o)}else{const u=G(n);if(u===".priority"){b(zn(n)===1,"Can't have a priority with additional path components");const f=i.getNode();l=e.serverCache.getNode();const d=Jh(r,n,f,l);d!=null?a=t.filter.updatePriority(f,d):a=i.getNode()}else{const f=ee(n);let d;if(i.isCompleteForChild(u)){l=e.serverCache.getNode();const c=Jh(r,n,i.getNode(),l);c!=null?d=i.getNode().getImmediateChild(u).updateChild(f,c):d=i.getNode().getImmediateChild(u)}else d=Od(r,u,e.serverCache);d!=null?a=t.filter.updateChild(i.getNode(),u,d,f,s,o):a=i.getNode()}}return Xs(e,a,i.isFullyInitialized()||W(n),t.filter.filtersNodes())}}function fl(t,e,n,r,s,o,i,a){const l=e.serverCache;let u;const f=i?t.filter:t.filter.getIndexedFilter();if(W(n))u=f.updateFullNode(l.getNode(),r,null);else if(f.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(n,r);u=f.updateFullNode(l.getNode(),p,null)}else{const p=G(n);if(!l.isCompleteForPath(n)&&zn(n)>1)return e;const m=ee(n),E=l.getNode().getImmediateChild(p).updateChild(m,r);p===".priority"?u=f.updatePriority(l.getNode(),E):u=f.updateChild(l.getNode(),p,E,m,Fy,null)}const d=Ny(e,u,l.isFullyInitialized()||W(n),f.filtersNodes()),c=new Rd(s,d,o);return Vy(t,d,n,s,c,a)}function tc(t,e,n,r,s,o,i){const a=e.eventCache;let l,u;const f=new Rd(s,e,o);if(W(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,i),l=Xs(e,u,!0,t.filter.filtersNodes());else{const d=G(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=Xs(e,u,a.isFullyInitialized(),a.isFiltered());else{const c=ee(n),p=a.getNode().getImmediateChild(d);let m;if(W(c))m=r;else{const g=f.getCompleteChild(d);g!=null?wd(c)===".priority"&&g.getChild(Cy(c)).isEmpty()?m=g:m=g.updateChild(c,r):m=I.EMPTY_NODE}if(p.equals(m))l=e;else{const g=t.filter.updateChild(a.getNode(),d,m,c,f,i);l=Xs(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Zh(t,e){return t.eventCache.isCompleteForChild(e)}function BP(t,e,n,r,s,o,i){let a=e;return r.foreach((l,u)=>{const f=ae(n,l);Zh(e,G(f))&&(a=tc(t,a,f,u,s,o,i))}),r.foreach((l,u)=>{const f=ae(n,l);Zh(e,G(f))||(a=tc(t,a,f,u,s,o,i))}),a}function ep(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function nc(t,e,n,r,s,o,i,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;W(n)?u=r:u=new te(null).setTree(n,r);const f=e.serverCache.getNode();return u.children.inorderTraversal((d,c)=>{if(f.hasChild(d)){const p=e.serverCache.getNode().getImmediateChild(d),m=ep(t,p,c);l=fl(t,l,new K(d),m,s,o,i,a)}}),u.children.inorderTraversal((d,c)=>{const p=!e.serverCache.isCompleteForChild(d)&&c.value===null;if(!f.hasChild(d)&&!p){const m=e.serverCache.getNode().getImmediateChild(d),g=ep(t,m,c);l=fl(t,l,new K(d),g,s,o,i,a)}}),l}function jP(t,e,n,r,s,o,i){if(dl(s,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(W(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return fl(t,e,n,l.getNode().getChild(n),s,o,a,i);if(W(n)){let u=new te(null);return l.getNode().forEachChild(Qt,(f,d)=>{u=u.set(new K(f),d)}),nc(t,e,n,u,s,o,a,i)}else return e}else{let u=new te(null);return r.foreach((f,d)=>{const c=ae(n,f);l.isCompleteForPath(c)&&(u=u.set(f,l.getNode().getChild(c)))}),nc(t,e,n,u,s,o,a,i)}}function zP(t,e,n,r,s){const o=e.serverCache,i=Ny(e,o.getNode(),o.isFullyInitialized()||W(n),o.isFiltered());return Vy(t,i,n,r,Fy,s)}function HP(t,e,n,r,s,o){let i;if(dl(r,n)!=null)return e;{const a=new Rd(r,e,s),l=e.eventCache.getNode();let u;if(W(n)||G(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=cl(r,wr(e));else{const d=e.serverCache.getNode();b(d instanceof I,"serverChildren would be complete if leaf node"),f=xd(r,d)}f=f,u=t.filter.updateFullNode(l,f,o)}else{const f=G(n);let d=Od(r,f,e.serverCache);d==null&&e.serverCache.isCompleteForChild(f)&&(d=l.getImmediateChild(f)),d!=null?u=t.filter.updateChild(l,f,d,ee(n),a,o):e.eventCache.getNode().hasChild(f)?u=t.filter.updateChild(l,f,I.EMPTY_NODE,ee(n),a,o):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(i=cl(r,wr(e)),i.isLeafNode()&&(u=t.filter.updateFullNode(u,i,o)))}return i=e.serverCache.isFullyInitialized()||dl(r,Q())!=null,Xs(e,u,i,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Td(r.getIndex()),o=lP(r);this.processor_=FP(o);const i=n.serverCache,a=n.eventCache,l=s.updateFullNode(I.EMPTY_NODE,i.getNode(),null),u=o.updateFullNode(I.EMPTY_NODE,a.getNode(),null),f=new Hn(l,i.isFullyInitialized(),s.filtersNodes()),d=new Hn(u,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=Gl(d,f),this.eventGenerator_=new _P(this.query_)}get query(){return this.query_}}function QP(t){return t.viewCache_.serverCache.getNode()}function KP(t){return ul(t.viewCache_)}function qP(t,e){const n=wr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!W(e)&&!n.getImmediateChild(G(e)).isEmpty())?n.getChild(e):null}function tp(t){return t.eventRegistrations_.length===0}function XP(t,e){t.eventRegistrations_.push(e)}function np(t,e,n){const r=[];if(n){b(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(o=>{const i=o.createCancelEvent(n,s);i&&r.push(i)})}if(e){let s=[];for(let o=0;o<t.eventRegistrations_.length;++o){const i=t.eventRegistrations_[o];if(!i.matches(e))s.push(i);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(o+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function rp(t,e,n,r){e.type===It.MERGE&&e.source.queryId!==null&&(b(wr(t.viewCache_),"We should always have a full cache before handling merges"),b(ul(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,o=GP(t.processor_,s,e,n,r);return VP(t.processor_,o.viewCache),b(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,Gy(t,o.changes,o.viewCache.eventCache.getNode(),null)}function JP(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(re,(o,i)=>{r.push(as(o,i))}),n.isFullyInitialized()&&r.push(Ry(n.getNode())),Gy(t,r,n.getNode(),e)}function Gy(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return vP(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl;class Wy{constructor(){this.views=new Map}}function ZP(t){b(!hl,"__referenceConstructor has already been defined"),hl=t}function e1(){return b(hl,"Reference.ts has not been loaded"),hl}function t1(t){return t.views.size===0}function Nd(t,e,n,r){const s=e.source.queryId;if(s!==null){const o=t.views.get(s);return b(o!=null,"SyncTree gave us an op for an invalid query."),rp(o,e,n,r)}else{let o=[];for(const i of t.views.values())o=o.concat(rp(i,e,n,r));return o}}function By(t,e,n,r,s){const o=e._queryIdentifier,i=t.views.get(o);if(!i){let a=cl(n,s?r:null),l=!1;a?l=!0:r instanceof I?(a=xd(n,r),l=!1):(a=I.EMPTY_NODE,l=!1);const u=Gl(new Hn(a,l,!1),new Hn(r,s,!1));return new YP(e,u)}return i}function n1(t,e,n,r,s,o){const i=By(t,e,r,s,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,i),XP(i,n),JP(i,n)}function r1(t,e,n,r){const s=e._queryIdentifier,o=[];let i=[];const a=Yn(t);if(s==="default")for(const[l,u]of t.views.entries())i=i.concat(np(u,n,r)),tp(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||o.push(u.query));else{const l=t.views.get(s);l&&(i=i.concat(np(l,n,r)),tp(l)&&(t.views.delete(s),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!Yn(t)&&o.push(new(e1())(e._repo,e._path)),{removed:o,events:i}}function jy(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Un(t,e){let n=null;for(const r of t.views.values())n=n||qP(r,e);return n}function zy(t,e){if(e._queryParams.loadsAllData())return Bl(t);{const r=e._queryIdentifier;return t.views.get(r)}}function Hy(t,e){return zy(t,e)!=null}function Yn(t){return Bl(t)!=null}function Bl(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl;function s1(t){b(!pl,"__referenceConstructor has already been defined"),pl=t}function o1(){return b(pl,"Reference.ts has not been loaded"),pl}let i1=1;class sp{constructor(e){this.listenProvider_=e,this.syncPointTree_=new te(null),this.pendingWriteTree_=LP(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Id(t,e,n,r,s){return PP(t.pendingWriteTree_,e,n,r,s),s?vs(t,new vr(bd(),e,n)):[]}function l1(t,e,n,r){kP(t.pendingWriteTree_,e,n,r);const s=te.fromObject(n);return vs(t,new us(bd(),e,s))}function bn(t,e,n=!1){const r=CP(t.pendingWriteTree_,e);if(TP(t.pendingWriteTree_,e)){let o=new te(null);return r.snap!=null?o=o.set(Q(),!0):De(r.children,i=>{o=o.set(new K(i),!0)}),vs(t,new al(r.path,o,n))}else return[]}function Fo(t,e,n){return vs(t,new vr(Ad(),e,n))}function a1(t,e,n){const r=te.fromObject(n);return vs(t,new us(Ad(),e,r))}function u1(t,e){return vs(t,new To(Ad(),e))}function c1(t,e,n){const r=Ld(t,n);if(r){const s=$d(r),o=s.path,i=s.queryId,a=Be(o,e),l=new To(Dd(i),a);return Md(t,o,l)}else return[]}function ml(t,e,n,r,s=!1){const o=e._path,i=t.syncPointTree_.get(o);let a=[];if(i&&(e._queryIdentifier==="default"||Hy(i,e))){const l=r1(i,e,n,r);t1(i)&&(t.syncPointTree_=t.syncPointTree_.remove(o));const u=l.removed;if(a=l.events,!s){const f=u.findIndex(c=>c._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(o,(c,p)=>Yn(p));if(f&&!d){const c=t.syncPointTree_.subtree(o);if(!c.isEmpty()){const p=h1(c);for(let m=0;m<p.length;++m){const g=p[m],E=g.query,_=qy(t,g);t.listenProvider_.startListening(Zs(E),bo(t,E),_.hashFn,_.onComplete)}}}!d&&u.length>0&&!r&&(f?t.listenProvider_.stopListening(Zs(e),null):u.forEach(c=>{const p=t.queryToTagMap.get(zl(c));t.listenProvider_.stopListening(Zs(c),p)}))}p1(t,u)}return a}function Yy(t,e,n,r){const s=Ld(t,r);if(s!=null){const o=$d(s),i=o.path,a=o.queryId,l=Be(i,e),u=new vr(Dd(a),l,n);return Md(t,i,u)}else return[]}function d1(t,e,n,r){const s=Ld(t,r);if(s){const o=$d(s),i=o.path,a=o.queryId,l=Be(i,e),u=te.fromObject(n),f=new us(Dd(a),l,u);return Md(t,i,f)}else return[]}function rc(t,e,n,r=!1){const s=e._path;let o=null,i=!1;t.syncPointTree_.foreachOnPath(s,(c,p)=>{const m=Be(c,s);o=o||Un(p,m),i=i||Yn(p)});let a=t.syncPointTree_.get(s);a?(i=i||Yn(a),o=o||Un(a,Q())):(a=new Wy,t.syncPointTree_=t.syncPointTree_.set(s,a));let l;o!=null?l=!0:(l=!1,o=I.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((p,m)=>{const g=Un(m,Q());g&&(o=o.updateImmediateChild(p,g))}));const u=Hy(a,e);if(!u&&!e._queryParams.loadsAllData()){const c=zl(e);b(!t.queryToTagMap.has(c),"View does not exist, but we have a tag");const p=m1();t.queryToTagMap.set(c,p),t.tagToQueryMap.set(p,c)}const f=Wl(t.pendingWriteTree_,s);let d=n1(a,e,n,f,o,l);if(!u&&!i&&!r){const c=zy(a,e);d=d.concat(g1(t,e,c))}return d}function jl(t,e,n){const s=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(e,(i,a)=>{const l=Be(i,e),u=Un(a,l);if(u)return u});return $y(s,e,o,n,!0)}function f1(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,f)=>{const d=Be(u,n);r=r||Un(f,d)});let s=t.syncPointTree_.get(n);s?r=r||Un(s,Q()):(s=new Wy,t.syncPointTree_=t.syncPointTree_.set(n,s));const o=r!=null,i=o?new Hn(r,!0,!1):null,a=Wl(t.pendingWriteTree_,e._path),l=By(s,e,a,o?i.getNode():I.EMPTY_NODE,o);return KP(l)}function vs(t,e){return Qy(e,t.syncPointTree_,null,Wl(t.pendingWriteTree_,Q()))}function Qy(t,e,n,r){if(W(t.path))return Ky(t,e,n,r);{const s=e.get(Q());n==null&&s!=null&&(n=Un(s,Q()));let o=[];const i=G(t.path),a=t.operationForChild(i),l=e.children.get(i);if(l&&a){const u=n?n.getImmediateChild(i):null,f=My(r,i);o=o.concat(Qy(a,l,u,f))}return s&&(o=o.concat(Nd(s,t,r,n))),o}}function Ky(t,e,n,r){const s=e.get(Q());n==null&&s!=null&&(n=Un(s,Q()));let o=[];return e.children.inorderTraversal((i,a)=>{const l=n?n.getImmediateChild(i):null,u=My(r,i),f=t.operationForChild(i);f&&(o=o.concat(Ky(f,a,l,u)))}),s&&(o=o.concat(Nd(s,t,r,n))),o}function qy(t,e){const n=e.query,r=bo(t,n);return{hashFn:()=>(QP(e)||I.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?c1(t,n._path,r):u1(t,n._path);{const o=lS(s,n);return ml(t,n,null,o)}}}}function bo(t,e){const n=zl(e);return t.queryToTagMap.get(n)}function zl(t){return t._path.toString()+"$"+t._queryIdentifier}function Ld(t,e){return t.tagToQueryMap.get(e)}function $d(t){const e=t.indexOf("$");return b(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new K(t.substr(0,e))}}function Md(t,e,n){const r=t.syncPointTree_.get(e);b(r,"Missing sync point for query tag that we're tracking");const s=Wl(t.pendingWriteTree_,e);return Nd(r,n,s,null)}function h1(t){return t.fold((e,n,r)=>{if(n&&Yn(n))return[Bl(n)];{let s=[];return n&&(s=jy(n)),De(r,(o,i)=>{s=s.concat(i)}),s}})}function Zs(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(o1())(t._repo,t._path):t}function p1(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=zl(r),o=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(o)}}}function m1(){return i1++}function g1(t,e,n){const r=e._path,s=bo(t,e),o=qy(t,n),i=t.listenProvider_.startListening(Zs(e),s,o.hashFn,o.onComplete),a=t.syncPointTree_.subtree(r);if(s)b(!Yn(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,f,d)=>{if(!W(u)&&f&&Yn(f))return[Bl(f).query];{let c=[];return f&&(c=c.concat(jy(f).map(p=>p.query))),De(d,(p,m)=>{c=c.concat(m)}),c}});for(let u=0;u<l.length;++u){const f=l[u];t.listenProvider_.stopListening(Zs(f),bo(t,f))}}return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Ud(n)}node(){return this.node_}}class Fd{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=ae(this.path_,e);return new Fd(this.syncTree_,n)}node(){return jl(this.syncTree_,this.path_)}}const y1=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},op=function(t,e,n){if(!t||typeof t!="object")return t;if(b(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return _1(t[".sv"],e,n);if(typeof t[".sv"]=="object")return v1(t[".sv"],e);b(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},_1=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:b(!1,"Unexpected server value: "+t)}},v1=function(t,e,n){t.hasOwnProperty("increment")||b(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&b(!1,"Unexpected increment value: "+r);const s=e.node();if(b(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const i=s.getValue();return typeof i!="number"?r:i+r},Xy=function(t,e,n,r){return Gd(e,new Fd(n,t),r)},Vd=function(t,e,n){return Gd(t,new Ud(e),n)};function Gd(t,e,n){const r=t.getPriority().val(),s=op(r,e.getImmediateChild(".priority"),n);let o;if(t.isLeafNode()){const i=t,a=op(i.getValue(),e,n);return a!==i.getValue()||s!==i.getPriority().val()?new Pe(a,ce(s)):t}else{const i=t;return o=i,s!==i.getPriority().val()&&(o=o.updatePriority(new Pe(s))),i.forEachChild(re,(a,l)=>{const u=Gd(l,e.getImmediateChild(a),n);u!==l&&(o=o.updateImmediateChild(a,u))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Hl(t,e){let n=e instanceof K?e:new K(e),r=t,s=G(n);for(;s!==null;){const o=_r(r.node.children,s)||{children:{},childCount:0};r=new Wd(s,r,o),n=ee(n),s=G(n)}return r}function Tr(t){return t.node.value}function Bd(t,e){t.node.value=e,sc(t)}function Jy(t){return t.node.childCount>0}function w1(t){return Tr(t)===void 0&&!Jy(t)}function Yl(t,e){De(t.node.children,(n,r)=>{e(new Wd(n,t,r))})}function Zy(t,e,n,r){n&&e(t),Yl(t,s=>{Zy(s,e,!0)})}function E1(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Vo(t){return new K(t.parent===null?t.name:Vo(t.parent)+"/"+t.name)}function sc(t){t.parent!==null&&S1(t.parent,t.name,t)}function S1(t,e,n){const r=w1(n),s=ft(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,sc(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,sc(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1=/[\[\].#$\/\u0000-\u001F\u007F]/,k1=/[\[\].#$\u0000-\u001F\u007F]/,Wa=10*1024*1024,Ql=function(t){return typeof t=="string"&&t.length!==0&&!P1.test(t)},e_=function(t){return typeof t=="string"&&t.length!==0&&!k1.test(t)},C1=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),e_(t)},Ao=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Ml(t)||t&&typeof t=="object"&&ft(t,".sv")},qt=function(t,e,n,r){r&&e===void 0||Go(st(t,"value"),e,n)},Go=function(t,e,n){const r=n instanceof K?new GS(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+sr(r));if(typeof e=="function")throw new Error(t+"contains a function "+sr(r)+" with contents = "+e.toString());if(Ml(e))throw new Error(t+"contains "+e.toString()+" "+sr(r));if(typeof e=="string"&&e.length>Wa/3&&Ll(e)>Wa)throw new Error(t+"contains a string greater than "+Wa+" utf8 bytes "+sr(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(De(e,(i,a)=>{if(i===".value")s=!0;else if(i!==".priority"&&i!==".sv"&&(o=!0,!Ql(i)))throw new Error(t+" contains an invalid key ("+i+") "+sr(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);WS(r,i),Go(t,a,r),BS(r)}),s&&o)throw new Error(t+' contains ".value" child '+sr(r)+" in addition to actual children.")}},T1=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const o=So(r);for(let i=0;i<o.length;i++)if(!(o[i]===".priority"&&i===o.length-1)){if(!Ql(o[i]))throw new Error(t+"contains an invalid key ("+o[i]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(VS);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&St(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},t_=function(t,e,n,r){const s=st(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];De(e,(i,a)=>{const l=new K(i);if(Go(s,a,ae(n,l)),wd(l)===".priority"&&!Ao(a))throw new Error(s+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(l)}),T1(s,o)},jd=function(t,e,n){if(Ml(e))throw new Error(st(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ao(e))throw new Error(st(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Wo=function(t,e,n,r){if(n!==void 0&&!Ql(n))throw new Error(st(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Do=function(t,e,n,r){if(!e_(n))throw new Error(st(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},b1=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Do(t,e,n)},Pt=function(t,e){if(G(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},n_=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ql(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!C1(n))throw new Error(st(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Kl(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],o=s.getPath();n!==null&&!Ed(o,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:o}),n.events.push(s)}n&&t.eventLists_.push(n)}function r_(t,e,n){Kl(t,n),s_(t,r=>Ed(r,e))}function ht(t,e,n){Kl(t,n),s_(t,r=>St(r,e)||St(e,r))}function s_(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const o=s.path;e(o)?(D1(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function D1(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();dr&&be("event: "+n.toString()),ys(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_="repo_interrupt",x1=25;class O1{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new A1,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ll(),this.transactionQueueTree_=new Wd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function R1(t,e,n){if(t.stats_=_d(t.repoInfo_),t.forceRestClient_||dS())t.server_=new il(t.repoInfo_,(r,s,o,i)=>{ip(t,r,s,o,i)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>lp(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ee(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new an(t.repoInfo_,e,(r,s,o,i)=>{ip(t,r,s,o,i)},r=>{lp(t,r)},r=>{N1(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=gS(t.repoInfo_,()=>new yP(t.stats_,t.server_)),t.infoData_=new fP,t.infoSyncTree_=new sp({startListening:(r,s,o,i)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Fo(t.infoSyncTree_,r._path,l),setTimeout(()=>{i("ok")},0)),a},stopListening:()=>{}}),zd(t,"connected",!1),t.serverSyncTree_=new sp({startListening:(r,s,o,i)=>(t.server_.listen(r,o,s,(a,l)=>{const u=i(a,l);ht(t.eventQueue_,r._path,u)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function i_(t){const n=t.infoData_.getNode(new K(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Bo(t){return y1({timestamp:i_(t)})}function ip(t,e,n,r,s){t.dataUpdateCount++;const o=new K(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let i=[];if(s)if(r){const l=el(n,u=>ce(u));i=d1(t.serverSyncTree_,o,l,s)}else{const l=ce(n);i=Yy(t.serverSyncTree_,o,l,s)}else if(r){const l=el(n,u=>ce(u));i=a1(t.serverSyncTree_,o,l)}else{const l=ce(n);i=Fo(t.serverSyncTree_,o,l)}let a=o;i.length>0&&(a=ds(t,o)),ht(t.eventQueue_,a,i)}function lp(t,e){zd(t,"connected",e),e===!1&&$1(t)}function N1(t,e){De(e,(n,r)=>{zd(t,n,r)})}function zd(t,e,n){const r=new K("/.info/"+e),s=ce(n);t.infoData_.updateSnapshot(r,s);const o=Fo(t.infoSyncTree_,r,s);ht(t.eventQueue_,r,o)}function ql(t){return t.nextWriteId_++}function I1(t,e,n){const r=f1(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const o=ce(s).withIndex(e._queryParams.getIndex());rc(t.serverSyncTree_,e,n,!0);let i;if(e._queryParams.loadsAllData())i=Fo(t.serverSyncTree_,e._path,o);else{const a=bo(t.serverSyncTree_,e);i=Yy(t.serverSyncTree_,e._path,o,a)}return ht(t.eventQueue_,e._path,i),ml(t.serverSyncTree_,e,n,null,!0),o},s=>(ws(t,"get for query "+Ee(e)+" failed: "+s),Promise.reject(new Error(s))))}function Hd(t,e,n,r,s){ws(t,"set",{path:e.toString(),value:n,priority:r});const o=Bo(t),i=ce(n,r),a=jl(t.serverSyncTree_,e),l=Vd(i,a,o),u=ql(t),f=Id(t.serverSyncTree_,e,l,u,!0);Kl(t.eventQueue_,f),t.server_.put(e.toString(),i.val(!0),(c,p)=>{const m=c==="ok";m||Fe("set at "+e+" failed: "+c);const g=bn(t.serverSyncTree_,u,!m);ht(t.eventQueue_,e,g),Qn(t,s,c,p)});const d=Qd(t,e);ds(t,d),ht(t.eventQueue_,d,[])}function L1(t,e,n,r){ws(t,"update",{path:e.toString(),value:n});let s=!0;const o=Bo(t),i={};if(De(n,(a,l)=>{s=!1,i[a]=Xy(ae(e,a),ce(l),t.serverSyncTree_,o)}),s)be("update() called with empty data.  Don't do anything."),Qn(t,r,"ok",void 0);else{const a=ql(t),l=l1(t.serverSyncTree_,e,i,a);Kl(t.eventQueue_,l),t.server_.merge(e.toString(),n,(u,f)=>{const d=u==="ok";d||Fe("update at "+e+" failed: "+u);const c=bn(t.serverSyncTree_,a,!d),p=c.length>0?ds(t,e):e;ht(t.eventQueue_,p,c),Qn(t,r,u,f)}),De(n,u=>{const f=Qd(t,ae(e,u));ds(t,f)}),ht(t.eventQueue_,e,[])}}function $1(t){ws(t,"onDisconnectEvents");const e=Bo(t),n=ll();Xu(t.onDisconnect_,Q(),(s,o)=>{const i=Xy(s,o,t.serverSyncTree_,e);_s(n,s,i)});let r=[];Xu(n,Q(),(s,o)=>{r=r.concat(Fo(t.serverSyncTree_,s,o));const i=Qd(t,s);ds(t,i)}),t.onDisconnect_=ll(),ht(t.eventQueue_,Q(),r)}function M1(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&qu(t.onDisconnect_,e),Qn(t,n,r,s)})}function ap(t,e,n,r){const s=ce(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,i)=>{o==="ok"&&_s(t.onDisconnect_,e,s),Qn(t,r,o,i)})}function U1(t,e,n,r,s){const o=ce(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(i,a)=>{i==="ok"&&_s(t.onDisconnect_,e,o),Qn(t,s,i,a)})}function F1(t,e,n,r){if(Fu(n)){be("onDisconnect().update() called with empty data.  Don't do anything."),Qn(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,o)=>{s==="ok"&&De(n,(i,a)=>{const l=ce(a);_s(t.onDisconnect_,ae(e,i),l)}),Qn(t,r,s,o)})}function V1(t,e,n){let r;G(e._path)===".info"?r=rc(t.infoSyncTree_,e,n):r=rc(t.serverSyncTree_,e,n),r_(t.eventQueue_,e._path,r)}function oc(t,e,n){let r;G(e._path)===".info"?r=ml(t.infoSyncTree_,e,n):r=ml(t.serverSyncTree_,e,n),r_(t.eventQueue_,e._path,r)}function l_(t){t.persistentConnection_&&t.persistentConnection_.interrupt(o_)}function G1(t){t.persistentConnection_&&t.persistentConnection_.resume(o_)}function ws(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),be(n,...e)}function Qn(t,e,n,r){e&&ys(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let o=s;r&&(o+=": "+r);const i=new Error(o);i.code=s,e(i)}})}function W1(t,e,n,r,s,o){ws(t,"transaction on "+e);const i={path:e,update:n,onComplete:r,status:null,order:ny(),applyLocally:o,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Yd(t,e,void 0);i.currentInputSnapshot=a;const l=i.update(a.val());if(l===void 0)i.unwatcher(),i.currentOutputSnapshotRaw=null,i.currentOutputSnapshotResolved=null,i.onComplete&&i.onComplete(null,!1,i.currentInputSnapshot);else{Go("transaction failed: Data returned ",l,i.path),i.status=0;const u=Hl(t.transactionQueueTree_,e),f=Tr(u)||[];f.push(i),Bd(u,f);let d;typeof l=="object"&&l!==null&&ft(l,".priority")?(d=_r(l,".priority"),b(Ao(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(jl(t.serverSyncTree_,e)||I.EMPTY_NODE).getPriority().val();const c=Bo(t),p=ce(l,d),m=Vd(p,a,c);i.currentOutputSnapshotRaw=p,i.currentOutputSnapshotResolved=m,i.currentWriteId=ql(t);const g=Id(t.serverSyncTree_,e,m,i.currentWriteId,i.applyLocally);ht(t.eventQueue_,e,g),Xl(t,t.transactionQueueTree_)}}function Yd(t,e,n){return jl(t.serverSyncTree_,e,n)||I.EMPTY_NODE}function Xl(t,e=t.transactionQueueTree_){if(e||Jl(t,e),Tr(e)){const n=u_(t,e);b(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&B1(t,Vo(e),n)}else Jy(e)&&Yl(e,n=>{Xl(t,n)})}function B1(t,e,n){const r=n.map(u=>u.currentWriteId),s=Yd(t,e,r);let o=s;const i=s.hash();for(let u=0;u<n.length;u++){const f=n[u];b(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const d=Be(e,f.path);o=o.updateChild(d,f.currentOutputSnapshotRaw)}const a=o.val(!0),l=e;t.server_.put(l.toString(),a,u=>{ws(t,"transaction put response",{path:l.toString(),status:u});let f=[];if(u==="ok"){const d=[];for(let c=0;c<n.length;c++)n[c].status=2,f=f.concat(bn(t.serverSyncTree_,n[c].currentWriteId)),n[c].onComplete&&d.push(()=>n[c].onComplete(null,!0,n[c].currentOutputSnapshotResolved)),n[c].unwatcher();Jl(t,Hl(t.transactionQueueTree_,e)),Xl(t,t.transactionQueueTree_),ht(t.eventQueue_,e,f);for(let c=0;c<d.length;c++)ys(d[c])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Fe("transaction at "+l.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}ds(t,e)}},i)}function ds(t,e){const n=a_(t,e),r=Vo(n),s=u_(t,n);return j1(t,s,r),r}function j1(t,e,n){if(e.length===0)return;const r=[];let s=[];const i=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=Be(n,l.path);let f=!1,d;if(b(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)f=!0,d=l.abortReason,s=s.concat(bn(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=x1)f=!0,d="maxretry",s=s.concat(bn(t.serverSyncTree_,l.currentWriteId,!0));else{const c=Yd(t,l.path,i);l.currentInputSnapshot=c;const p=e[a].update(c.val());if(p!==void 0){Go("transaction failed: Data returned ",p,l.path);let m=ce(p);typeof p=="object"&&p!=null&&ft(p,".priority")||(m=m.updatePriority(c.getPriority()));const E=l.currentWriteId,_=Bo(t),h=Vd(m,c,_);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=h,l.currentWriteId=ql(t),i.splice(i.indexOf(E),1),s=s.concat(Id(t.serverSyncTree_,l.path,h,l.currentWriteId,l.applyLocally)),s=s.concat(bn(t.serverSyncTree_,E,!0))}else f=!0,d="nodata",s=s.concat(bn(t.serverSyncTree_,l.currentWriteId,!0))}ht(t.eventQueue_,n,s),s=[],f&&(e[a].status=2,function(c){setTimeout(c,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Jl(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)ys(r[a]);Xl(t,t.transactionQueueTree_)}function a_(t,e){let n,r=t.transactionQueueTree_;for(n=G(e);n!==null&&Tr(r)===void 0;)r=Hl(r,n),e=ee(e),n=G(e);return r}function u_(t,e){const n=[];return c_(t,e,n),n.sort((r,s)=>r.order-s.order),n}function c_(t,e,n){const r=Tr(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Yl(e,s=>{c_(t,s,n)})}function Jl(t,e){const n=Tr(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,Bd(e,n.length>0?n:void 0)}Yl(e,r=>{Jl(t,r)})}function Qd(t,e){const n=Vo(a_(t,e)),r=Hl(t.transactionQueueTree_,e);return E1(r,s=>{Ba(t,s)}),Ba(t,r),Zy(r,s=>{Ba(t,s)}),n}function Ba(t,e){const n=Tr(e);if(n){const r=[];let s=[],o=-1;for(let i=0;i<n.length;i++)n[i].status===3||(n[i].status===1?(b(o===i-1,"All SENT items should be at beginning of queue."),o=i,n[i].status=3,n[i].abortReason="set"):(b(n[i].status===0,"Unexpected transaction status in abort"),n[i].unwatcher(),s=s.concat(bn(t.serverSyncTree_,n[i].currentWriteId,!0)),n[i].onComplete&&r.push(n[i].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Bd(e,void 0):n.length=o+1,ht(t.eventQueue_,Vo(e),s);for(let i=0;i<r.length;i++)ys(r[i])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function H1(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Fe(`Invalid query segment '${n}' in query '${t}'`)}return e}const ic=function(t,e){const n=Y1(t),r=n.namespace;n.domain==="firebase.com"&&Kt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Kt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||nS();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new gy(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new K(n.pathString)}},Y1=function(t){let e="",n="",r="",s="",o="",i=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let f=t.indexOf("/");f===-1&&(f=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(f,d)),f<d&&(s=z1(t.substring(f,d)));const c=H1(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(i=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const p=e.slice(0,u);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{const m=e.indexOf(".");r=e.substring(0,m).toLowerCase(),n=e.substring(m+1),o=r}"ns"in c&&(o=c.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:i,scheme:a,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Q1=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=up.charAt(n%64),n=Math.floor(n/64);b(n===0,"Cannot push at time == 0");let i=o.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)i+=up.charAt(e[s]);return b(i.length===20,"nextPushId: Length should be 20."),i}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ee(this.snapshot.exportVal())}}class f_{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return b(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let K1=class{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Xe;return M1(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Pt("OnDisconnect.remove",this._path);const e=new Xe;return ap(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Pt("OnDisconnect.set",this._path),qt("OnDisconnect.set",e,this._path,!1);const n=new Xe;return ap(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Pt("OnDisconnect.setWithPriority",this._path),qt("OnDisconnect.setWithPriority",e,this._path,!1),jd("OnDisconnect.setWithPriority",n);const r=new Xe;return U1(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Pt("OnDisconnect.update",this._path),t_("OnDisconnect.update",e,this._path);const n=new Xe;return F1(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return W(this._path)?null:wd(this._path)}get ref(){return new bt(this._repo,this._path)}get _queryIdentifier(){const e=Qh(this._queryParams),n=gd(e);return n==="{}"?"default":n}get _queryObject(){return Qh(this._queryParams)}isEqual(e){if(e=gt(e),!(e instanceof ot))return!1;const n=this._repo===e._repo,r=Ed(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+FS(this._path)}}function Zl(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Jn(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Qt){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==jn)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==mn)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===re){if(e!=null&&!Ao(e)||n!=null&&!Ao(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(b(t.getIndex()instanceof kd||t.getIndex()===Cd,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ea(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class bt extends ot{constructor(e,n){super(e,n,new Fl,!1)}get parent(){const e=Cy(this._path);return e===null?null:new bt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let ta=class lc{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new K(e),r=Er(this.ref,e);return new lc(this._node.getChild(n),r,re)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new lc(s,Er(this.ref,r),re)))}hasChild(e){const n=new K(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function h_(t,e){return t=gt(t),t._checkNotDeleted("ref"),e!==void 0?Er(t._root,e):t._root}function cp(t,e){t=gt(t),t._checkNotDeleted("refFromURL");const n=ic(e,t._repo.repoInfo_.nodeAdmin);n_("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Kt("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),h_(t,n.path.toString())}function Er(t,e){return t=gt(t),G(t._path)===null?b1("child","path",e):Do("child","path",e),new bt(t._repo,ae(t._path,e))}function q1(t,e){t=gt(t),Pt("push",t._path),qt("push",e,t._path,!0);const n=i_(t._repo),r=Q1(n),s=Er(t,r),o=Er(t,r);let i;return e!=null?i=qd(o,e).then(()=>o):i=Promise.resolve(o),s.then=i.then.bind(i),s.catch=i.then.bind(i,void 0),s}function X1(t){return Pt("remove",t._path),qd(t,null)}function qd(t,e){t=gt(t),Pt("set",t._path),qt("set",e,t._path,!1);const n=new Xe;return Hd(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function J1(t,e){t=gt(t),Pt("setPriority",t._path),jd("setPriority",e);const n=new Xe;return Hd(t._repo,ae(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function Z1(t,e,n){if(Pt("setWithPriority",t._path),qt("setWithPriority",e,t._path,!1),jd("setWithPriority",n),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new Xe;return Hd(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function ek(t,e){t_("update",e,t._path);const n=new Xe;return L1(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function tk(t){t=gt(t);const e=new Kd(()=>{}),n=new jo(e);return I1(t._repo,t,n).then(r=>new ta(r,new bt(t._repo,t._path),t._queryParams.getIndex()))}class jo{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new d_("value",this,new ta(e.snapshotNode,new bt(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new f_(this,e,n):null}matches(e){return e instanceof jo?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class na{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new f_(this,e,n):null}createEvent(e,n){b(e.childName!=null,"Child events should have a childName.");const r=Er(new bt(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new d_(e.type,this,new ta(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof na?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function zo(t,e,n,r,s){let o;if(typeof r=="object"&&(o=void 0,s=r),typeof r=="function"&&(o=r),s&&s.onlyOnce){const l=n,u=(f,d)=>{oc(t._repo,t,a),l(f,d)};u.userCallback=n.userCallback,u.context=n.context,n=u}const i=new Kd(n,o||void 0),a=e==="value"?new jo(i):new na(e,i);return V1(t._repo,t,a),()=>oc(t._repo,t,a)}function ac(t,e,n,r){return zo(t,"value",e,n,r)}function dp(t,e,n,r){return zo(t,"child_added",e,n,r)}function fp(t,e,n,r){return zo(t,"child_changed",e,n,r)}function hp(t,e,n,r){return zo(t,"child_moved",e,n,r)}function pp(t,e,n,r){return zo(t,"child_removed",e,n,r)}function mp(t,e,n){let r=null;const s=n?new Kd(n):null;e==="value"?r=new jo(s):e&&(r=new na(e,s)),oc(t._repo,t,r)}class Ft{}class p_ extends Ft{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){qt("endAt",this._value,e._path,!0);const n=Ku(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ot(e._repo,e._path,n,e._orderByCalled)}}function nk(t,e){return Wo("endAt","key",e),new p_(t,e)}class rk extends Ft{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){qt("endBefore",this._value,e._path,!1);const n=dP(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ot(e._repo,e._path,n,e._orderByCalled)}}function sk(t,e){return Wo("endBefore","key",e),new rk(t,e)}class m_ extends Ft{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){qt("startAt",this._value,e._path,!0);const n=Qu(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ot(e._repo,e._path,n,e._orderByCalled)}}function ok(t=null,e){return Wo("startAt","key",e),new m_(t,e)}class ik extends Ft{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){qt("startAfter",this._value,e._path,!1);const n=cP(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ot(e._repo,e._path,n,e._orderByCalled)}}function lk(t,e){return Wo("startAfter","key",e),new ik(t,e)}class ak extends Ft{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ot(e._repo,e._path,aP(e._queryParams,this._limit),e._orderByCalled)}}function uk(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ak(t)}class ck extends Ft{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ot(e._repo,e._path,uP(e._queryParams,this._limit),e._orderByCalled)}}function dk(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new ck(t)}class fk extends Ft{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Zl(e,"orderByChild");const n=new K(this._path);if(W(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new kd(n),s=Vl(e._queryParams,r);return Jn(s),new ot(e._repo,e._path,s,!0)}}function hk(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Do("orderByChild","path",t),new fk(t)}class pk extends Ft{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Zl(e,"orderByKey");const n=Vl(e._queryParams,Qt);return Jn(n),new ot(e._repo,e._path,n,!0)}}function mk(){return new pk}class gk extends Ft{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Zl(e,"orderByPriority");const n=Vl(e._queryParams,re);return Jn(n),new ot(e._repo,e._path,n,!0)}}function yk(){return new gk}class _k extends Ft{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Zl(e,"orderByValue");const n=Vl(e._queryParams,Cd);return Jn(n),new ot(e._repo,e._path,n,!0)}}function vk(){return new _k}class wk extends Ft{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(qt("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new p_(this._value,this._key)._apply(new m_(this._value,this._key)._apply(e))}}function Ek(t,e){return Wo("equalTo","key",e),new wk(t,e)}function xt(t,...e){let n=gt(t);for(const r of e)n=r._apply(n);return n}ZP(bt);s1(bt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk="FIREBASE_DATABASE_EMULATOR_HOST",uc={};let Pk=!1;function kk(t,e,n,r){const s=e.lastIndexOf(":"),o=e.substring(0,s),i=ld(o);t.repoInfo_=new gy(e,i,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function g_(t,e,n,r,s){let o=r||t.options.databaseURL;o===void 0&&(t.options.projectId||Kt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),be("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let i=ic(o,s),a=i.repoInfo,l,u;typeof process<"u"&&xh&&(u=xh[Sk]),u?(l=!0,o=`http://${u}?ns=${a.namespace}`,i=ic(o,s),a=i.repoInfo):l=!i.repoInfo.secure;const f=s&&l?new qr(qr.OWNER):new hS(t.name,t.options,e);n_("Invalid Firebase Database URL",i),W(i.path)||Kt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=Tk(a,t,f,new fS(t,n));return new bk(d,t)}function Ck(t,e){const n=uc[e];(!n||n[t.key]!==t)&&Kt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),l_(t),delete n[t.key]}function Tk(t,e,n,r){let s=uc[e.name];s||(s={},uc[e.name]=s);let o=s[t.toURLString()];return o&&Kt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new O1(t,Pk,n,r),s[t.toURLString()]=o,o}let bk=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(R1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new bt(this._repo,Q())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Ck(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Kt("Cannot call "+e+" on a deleted database.")}};function y_(){ls.IS_TRANSPORT_INITIALIZED&&Fe("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Ak(){y_(),Tn.forceDisallow()}function Dk(){y_(),wt.forceDisallow(),Tn.forceAllow()}function xk(t,e,n,r={}){t=gt(t),t._checkNotDeleted("useEmulator");const s=`${e}:${n}`,o=t._repoInternal;if(t._instanceStarted){if(s===t._repoInternal.repoInfo_.host&&tl(r,o.repoInfo_.emulatorOptions))return;Kt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let i;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&Kt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new qr(qr.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:fw(r.mockUserToken,t.app.options.projectId);i=new qr(a)}ld(e)&&(dw(e),mw("Database",!0)),kk(o,s,r,i)}function Ok(t){t=gt(t),t._checkNotDeleted("goOffline"),l_(t._repo)}function Rk(t){t=gt(t),t._checkNotDeleted("goOnline"),G1(t._repo)}function Nk(t,e){sy(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(t){ey(fd),is(new hn("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return g_(r,s,o,n)},"PUBLIC").setMultipleInstances(!0)),ln(Oh,Rh,t),ln(Oh,Rh,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk={".sv":"timestamp"};function $k(){return Lk}function Mk(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uk=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function Fk(t,e,n){if(t=gt(t),Pt("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(n==null?void 0:n.applyLocally)??!0,s=new Xe,o=(a,l,u)=>{let f=null;a?s.reject(a):(f=new ta(u,new bt(t._repo,t._path),re),s.resolve(new Uk(l,f)))},i=ac(t,()=>{});return W1(t._repo,t._path,e,o,i,r),s.promise}an.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};an.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Ik();const Vk="@firebase/database-compat",Gk="2.1.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk=new $l("@firebase/database-compat"),__=function(t){const e="FIREBASE WARNING: "+t;Wk.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk=function(t,e,n,r){if(n!==void 0&&typeof n!="boolean")throw new Error(st(t,e)+"must be a boolean.")},jk=function(t,e,n){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(st(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e){this._delegate=e}cancel(e){L("OnDisconnect.cancel",0,1,arguments.length),Ce("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){L("OnDisconnect.remove",0,1,arguments.length),Ce("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){L("OnDisconnect.set",1,2,arguments.length),Ce("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){L("OnDisconnect.setWithPriority",2,3,arguments.length),Ce("OnDisconnect.setWithPriority","onComplete",r,!0);const s=this._delegate.setWithPriority(e,n);return r&&s.then(()=>r(null),o=>r(o)),s}update(e,n){if(L("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,__("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ce("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),s=>n(s)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return L("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n){this._database=e,this._delegate=n}val(){return L("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return L("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return L("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return L("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return L("DataSnapshot.child",0,1,arguments.length),e=String(e),Do("DataSnapshot.child","path",e),new Fn(this._database,this._delegate.child(e))}hasChild(e){return L("DataSnapshot.hasChild",1,1,arguments.length),Do("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return L("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return L("DataSnapshot.forEach",1,1,arguments.length),Ce("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Fn(this._database,n)))}hasChildren(){return L("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return L("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return L("DataSnapshot.ref",0,0,arguments.length),new lt(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Re{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,s){var l;L("Query.on",2,4,arguments.length),Ce("Query.on","callback",n,!1);const o=Re.getCancelAndContextArgs_("Query.on",r,s),i=(u,f)=>{n.call(o.context,new Fn(this.database,u),f)};i.userCallback=n,i.context=o.context;const a=(l=o.cancel)==null?void 0:l.bind(o.context);switch(e){case"value":return ac(this._delegate,i,a),n;case"child_added":return dp(this._delegate,i,a),n;case"child_removed":return pp(this._delegate,i,a),n;case"child_changed":return fp(this._delegate,i,a),n;case"child_moved":return hp(this._delegate,i,a),n;default:throw new Error(st("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(L("Query.off",0,3,arguments.length),jk("Query.off",e),Ce("Query.off","callback",n,!0),wh("Query.off","context",r),n){const s=()=>{};s.userCallback=n,s.context=r,mp(this._delegate,e,s)}else mp(this._delegate,e)}get(){return tk(this._delegate).then(e=>new Fn(this.database,e))}once(e,n,r,s){L("Query.once",1,4,arguments.length),Ce("Query.once","callback",n,!0);const o=Re.getCancelAndContextArgs_("Query.once",r,s),i=new Xe,a=(u,f)=>{const d=new Fn(this.database,u);n&&n.call(o.context,d,f),i.resolve(d)};a.userCallback=n,a.context=o.context;const l=u=>{o.cancel&&o.cancel.call(o.context,u),i.reject(u)};switch(e){case"value":ac(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":dp(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":pp(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":fp(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":hp(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(st("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return i.promise}limitToFirst(e){return L("Query.limitToFirst",1,1,arguments.length),new Re(this.database,xt(this._delegate,uk(e)))}limitToLast(e){return L("Query.limitToLast",1,1,arguments.length),new Re(this.database,xt(this._delegate,dk(e)))}orderByChild(e){return L("Query.orderByChild",1,1,arguments.length),new Re(this.database,xt(this._delegate,hk(e)))}orderByKey(){return L("Query.orderByKey",0,0,arguments.length),new Re(this.database,xt(this._delegate,mk()))}orderByPriority(){return L("Query.orderByPriority",0,0,arguments.length),new Re(this.database,xt(this._delegate,yk()))}orderByValue(){return L("Query.orderByValue",0,0,arguments.length),new Re(this.database,xt(this._delegate,vk()))}startAt(e=null,n){return L("Query.startAt",0,2,arguments.length),new Re(this.database,xt(this._delegate,ok(e,n)))}startAfter(e=null,n){return L("Query.startAfter",0,2,arguments.length),new Re(this.database,xt(this._delegate,lk(e,n)))}endAt(e=null,n){return L("Query.endAt",0,2,arguments.length),new Re(this.database,xt(this._delegate,nk(e,n)))}endBefore(e=null,n){return L("Query.endBefore",0,2,arguments.length),new Re(this.database,xt(this._delegate,sk(e,n)))}equalTo(e,n){return L("Query.equalTo",1,2,arguments.length),new Re(this.database,xt(this._delegate,Ek(e,n)))}toString(){return L("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return L("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(L("Query.isEqual",1,1,arguments.length),!(e instanceof Re)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const s={cancel:void 0,context:void 0};if(n&&r)s.cancel=n,Ce(e,"cancel",s.cancel,!0),s.context=r,wh(e,"context",s.context);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(st(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new lt(this.database,new bt(this._delegate._repo,this._delegate._path))}}class lt extends Re{constructor(e,n){super(e,new ot(n._repo,n._path,new Fl,!1)),this.database=e,this._delegate=n}getKey(){return L("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return L("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new lt(this.database,Er(this._delegate,e))}getParent(){L("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new lt(this.database,e):null}getRoot(){return L("Reference.root",0,0,arguments.length),new lt(this.database,this._delegate.root)}set(e,n){L("Reference.set",1,2,arguments.length),Ce("Reference.set","onComplete",n,!0);const r=qd(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}update(e,n){if(L("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,__("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Pt("Reference.update",this._delegate._path),Ce("Reference.update","onComplete",n,!0);const r=ek(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){L("Reference.setWithPriority",2,3,arguments.length),Ce("Reference.setWithPriority","onComplete",r,!0);const s=Z1(this._delegate,e,n);return r&&s.then(()=>r(null),o=>r(o)),s}remove(e){L("Reference.remove",0,1,arguments.length),Ce("Reference.remove","onComplete",e,!0);const n=X1(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){L("Reference.transaction",1,3,arguments.length),Ce("Reference.transaction","transactionUpdate",e,!1),Ce("Reference.transaction","onComplete",n,!0),Bk("Reference.transaction","applyLocally",r);const s=Fk(this._delegate,e,{applyLocally:r}).then(o=>new Hk(o.committed,new Fn(this.database,o.snapshot)));return n&&s.then(o=>n(null,o.committed,o.snapshot),o=>n(o,!1,null)),s}setPriority(e,n){L("Reference.setPriority",1,2,arguments.length),Ce("Reference.setPriority","onComplete",n,!0);const r=J1(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}push(e,n){L("Reference.push",0,2,arguments.length),Ce("Reference.push","onComplete",n,!0);const r=q1(this._delegate,e),s=r.then(i=>new lt(this.database,i));n&&s.then(()=>n(null),i=>n(i));const o=new lt(this.database,r);return o.then=s.then.bind(s),o.catch=s.catch.bind(s,void 0),o}onDisconnect(){return Pt("Reference.onDisconnect",this._delegate._path),new zk(new K1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Ak,forceLongPolling:Dk}}useEmulator(e,n,r={}){xk(this._delegate,e,n,r)}ref(e){if(L("database.ref",0,1,arguments.length),e instanceof lt){const n=cp(this._delegate,e.toString());return new lt(this,n)}else{const n=h_(this._delegate,e);return new lt(this,n)}}refFromURL(e){L("database.refFromURL",1,1,arguments.length);const r=cp(this._delegate,e);return new lt(this,r)}goOffline(){return L("database.goOffline",0,0,arguments.length),Ok(this._delegate)}goOnline(){return L("database.goOnline",0,0,arguments.length),Rk(this._delegate)}}xo.ServerValue={TIMESTAMP:$k(),increment:t=>Mk(t)};function Yk({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:s,namespace:o,nodeAdmin:i=!1}){ey(n);const a=new ad("database-standalone"),l=new Vu("auth-internal",a);l.setComponent(new hn("auth-internal",()=>r,"PRIVATE"));let u;return s&&(u=new Vu("app-check-internal",a),u.setComponent(new hn("app-check-internal",()=>s,"PRIVATE"))),{instance:new xo(g_(t,l,u,e,i),t),namespace:o}}var Qk=Object.freeze({__proto__:null,initStandalone:Yk});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk=xo.ServerValue;function qk(t){t.INTERNAL.registerComponent(new hn("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new xo(s,r)},"PUBLIC").setServiceProps({Reference:lt,Query:Re,Database:xo,DataSnapshot:Fn,enableLogging:Nk,INTERNAL:Qk,ServerValue:Kk}).setMultipleInstances(!0)),t.registerVersion(Vk,Gk)}qk(md);window.firebase=md;const Xk=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],gp=5,Jk=1e3;function v_(t=4){return[...Xk].sort(()=>Math.random()-.5).slice(0,t)}const yp={red:{title:"Worker Manipulation",icon:"",actions:[{id:"gain3red",title:"Gain 3 ",description:"",round:1},{id:"gain2red",title:"Gain 2 ",description:"",round:1},{id:"redHybrid1",title:"+1  + Swap Workers",description:"(Both players get actions)",round:1},{id:"redRepeatAction",title:"Repeat an Action",description:"(That one of your workers is on)",round:1},{id:"forceRedPlacement",title:"Other Players Must Place on Red",description:"(Until red layer is full)",round:2},{id:"redHybrid2",title:"+1  + Swap Workers",description:"(Only you get action)",round:2},{id:"redRepeatAll",title:"Repeat All Your Worker Actions",description:"(In any order you choose)",round:3}]},yellow:{title:"Resource Manipulation",icon:"",actions:[{id:"gain3yellow",title:"Gain 3 resources",description:"(any colors)",round:1},{id:"gain2yellow",title:"Gain 2 resources",description:"(any colors)",round:1},{id:"steal2Gems",title:"Trade all resources for new ones",description:"(keep same total count)",round:1},{id:"yellowHybrid1",title:"Gain 2 resources",description:"(any colors)",round:1},{id:"steal3Gems",title:"Steal 3 resources from a player",description:"(any colors)",round:2},{id:"yellowHybrid2",title:"+1  + Double your next gain",description:"(doesn't stack with shop)",round:2},{id:"yellowSwapResources",title:"Swap all your resources with another player",description:"",round:3}]},blue:{title:"Shop Control",icon:"",actions:[{id:"gain3blue",title:"Gain 3 ",description:"",round:1},{id:"gain2blue",title:"Gain 2 ",description:"",round:1},{id:"blueR1ShopBenefit",title:"Gain an R1 Shop Benefit",description:"(Even if closed)",round:1},{id:"blueReduceCosts",title:"+1  + Reduce All Shop Costs",description:"(By 1  this round)",round:1},{id:"blueIncreaseCosts",title:"Increase All Shop Costs",description:"(By 2  for other players)",round:2},{id:"blueToggleShops",title:"+1  + Toggle All Shop Status",description:"(Including victory shops)",round:2},{id:"blueAnyShopBenefit",title:"Gain Any Shop Benefit",description:"(Even if closed)",round:3}]},purple:{title:"Timing/Order",icon:"",actions:[{id:"gain4purpleSkip",title:"Gain 4 , Skip Next Turn",description:"",round:1},{id:"gain3purple",title:"Gain 3 ",description:"",round:1},{id:"gain2purpleTakeBack",title:"Gain 2 , Take Back Worker",description:"(From different quad)",round:1},{id:"playTwoWorkers",title:"Play 2 More Workers",description:"(This turn)",round:1},{id:"gain5purpleSkip",title:"Gain 5 , Skip Turn",description:"",round:2},{id:"playThreeWorkers",title:"Play 3 More Workers",description:"(This turn)",round:2},{id:"gain4purpleWaitAll",title:"Gain 4 , Take Another Turn",description:"(After this one)",round:3}]},gold:{title:"Victory Points",icon:"",actions:[{id:"gain2gold",title:"Gain 2 Gold",description:"",round:1},{id:"convert2AnyTo2Gold",title:"Trade: 2 resources  2 Gold",description:"(any colors)",round:1},{id:"gain1gold",title:"Gain 1 Gold",description:"",round:1},{id:"convert1AnyTo1Gold",title:"Trade: 1 resource  1 Gold",description:"(any color)",round:1},{id:"gain3goldSkip",title:"Gain 3 Gold, skip your next turn",description:"",round:2},{id:"convert3AnyTo3Gold",title:"Trade: 3 resources  3 Gold",description:"(any colors)",round:2},{id:"goldVPPerGold",title:"Gain 1 VP for each Gold you have",description:"",round:3}]},white:{title:"White - VP Trading",icon:"",actions:[{id:"gain3vp",title:"Gain 3 VP",description:"",round:1},{id:"gain2vp",title:"Gain 2 VP",description:"",round:1},{id:"spend1AnyFor2VP",title:"Trade: 1 resource  2 VP",description:"(any color)",round:1},{id:"spend2AnyFor3VP",title:"Trade: 2 resources  3 VP",description:"(any colors)",round:1},{id:"lose1VPGain2Any",title:"Lose 1 VP, gain 2 resources",description:"(any colors)",round:2},{id:"lose2VPGain4Any",title:"Lose 2 VP, gain 4 resources",description:"(any colors)",round:2},{id:"gain5VPAnd5Any",title:"Gain 5 VP and 5 resources",description:"(any colors)",round:3}]},black:{title:"Destruction/Penalty",icon:"",actions:[{id:"gain3black",title:"Gain 3 ",description:"",round:1},{id:"gain2black",title:"Gain 2 ",description:"",round:1},{id:"blackSteal1VP",title:"+1 , steal 1 VP from a player",description:"",round:1},{id:"blackSteal2Any",title:"Steal 2 resources from a player",description:"(any colors)",round:1},{id:"blackStealWorker",title:"+1 , steal 4 resources from a player",description:"(any colors)",round:2},{id:"blackAllLose2VP",title:"All other players lose 2 VP",description:"",round:2},{id:"blackAllLose4VP",title:"+2 , all other players lose 4 VP",description:"",round:3}]},silver:{title:"Information/Planning",icon:"",actions:[{id:"silver4Others1",title:"+4 Silver for you, +1 for all others",description:"",round:1},{id:"silver3Others1",title:"+3 Silver for you, +1 for all others",description:"",round:1},{id:"silver2Plus1Others",title:"+2 Silver + 1 resource for you",description:"(others get 1 of same color)",round:1},{id:"silver2VPBoth",title:"+2 VP for you, pick a player for +2 VP",description:"",round:1},{id:"silverTakeBack2",title:"+2 Silver, take back 2 workers",description:"(others take back 1)",round:2},{id:"silver3Plus2Others1",title:"+3 Silver + 2 resources for you",description:"(others get 1 of that color)",round:2},{id:"silver8VPOthers3S",title:"+8 VP for you, +3 Silver for all others",description:"",round:3}]}};function gl(t,e="advanced"){let n;e==="basic"?n=["red","yellow","blue","purple"]:n=Object.keys(yp);const r=[...n];for(let i=r.length-1;i>0;i--){const a=Math.floor(Math.random()*(i+1));[r[i],r[a]]=[r[a],r[i]]}const s=r.slice(0,t),o={};return s.forEach(i=>{o[i]=yp[i]}),o}const Zk={red:{1:"Repeat one of your worker's actions",2:"Place the next player's worker for them",3:"Repeat all actions you took this round"},yellow:{1:"Double your next resource gain",2:"Gain 5 resources (any colors)",3:"Gain 7 resources (any colors)"},blue:{1:"Open or close any one shop",2:"Flip all shops (open  closed)",3:"Use any shop benefit for free"},purple:{1:"Take an extra turn after this one",2:"Place 2 more workers this turn",3:"Place all your remaining workers now"},gold:{1:"Trade: 1 Gold + 1 Any  2 Gold",2:"Trade: 2 Gold + 2 Any  4 Gold",3:"Trade: 3 Gold + 3 Any  Double your Gold"},white:{1:"Lose 1 VP, gain 1 resource (any color)",2:"Lose 3 VP, next player skips their turn",3:"Lose 5 VP, move one worker to any action"},black:{1:"Steal 1 VP from any player",2:"Steal 3 VP from any player",3:"Steal 5 VP from any player"},silver:{1:"Gain 2 VP",2:"You and another player each gain 4 VP",3:"Gain 7 Silver, all others gain 2 Silver"}},eC={red:{1:"1+2",2:"2+2",3:"4+4"},yellow:{1:"1+1",2:"2+2",3:"3+3"},blue:{1:"1+1",2:"2+2",3:"3+3"},purple:{1:"1+2",2:"2+2",3:"3+3"},gold:{1:"1+1",2:"2+2",3:"3+3"},white:{1:"1VP",2:"2VP",3:"3VP"},black:{1:"1+1",2:"2+2",3:"3+3"},silver:{1:"1+1",2:"2+2",3:"3+3"}},Fs=v_(4),yl={currentPlayer:1,turnDirection:1,gameMode:null,players:[{id:1,name:"Player 1",emoji:Fs[0],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0},{id:2,name:"Player 2",emoji:Fs[1],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0},{id:3,name:"Player 3",emoji:Fs[2],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0},{id:4,name:"Player 4",emoji:Fs[3],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0}],occupiedSpaces:{},round:1,turnOrder:[1,2,3,4],workerPlacedThisTurn:!1,workersToPlace:1,shopUsedBeforeWorkers:!1,shopUsedAfterWorkers:!1,modal:null,actionLog:[],gameLayers:null,automaticVPs:{},closedShops:{},skippedTurns:{},playersOutOfWorkers:[],waitingForOthers:{},roundActions:[],roundAdvancing:!1,roomCode:null,myPlayerId:null,myPlayerName:"",connectedPlayers:{},isHost:!1,gameStarted:!1,connectionStatus:"disconnected",gameOver:!1,syncingFromFirebase:!1,stateVersion:0,notifications:[],pendingPlacements:{}};function tC(t,e){console.log("Reducer called with action:",e.type,e);const n=(()=>{var r,s,o,i;switch(e.type){case"PLACE_WORKER":const a=e.playerId||t.currentPlayer,l=a===t.currentPlayer,u=l?Math.max(0,t.workersToPlace-1):t.workersToPlace,f=t.players.find(w=>w.id===a),d=Math.max(0,f.workersLeft-1),c=(f.effects||[]).some(w=>w.includes("Can place")&&w.includes("more workers this turn")),p=u===0&&c;return{...t,occupiedSpaces:{...t.occupiedSpaces,[e.actionId]:a},players:t.players.map(w=>{if(w.id===a){const D={...w,workersLeft:d};return p&&l&&(D.effects=(D.effects||[]).filter(M=>!M.includes("Can place")&&!M.includes("more workers this turn"))),D}return w}),workerPlacedThisTurn:l?!0:t.workerPlacedThisTurn,workersToPlace:u,roundActions:[...t.roundActions,{playerId:a,actionId:e.actionId}]};case"UPDATE_RESOURCES":console.log("UPDATE_RESOURCES reducer called with:",{playerId:e.playerId,resources:e.resources,currentPlayers:t.players.map(w=>({id:w.id,resources:w.resources}))});const m={...t,players:t.players.map(w=>{if(w.id===e.playerId){const D={red:w.resources.red+(e.resources.red||0),yellow:w.resources.yellow+(e.resources.yellow||0),blue:w.resources.blue+(e.resources.blue||0),purple:w.resources.purple+(e.resources.purple||0),gold:w.resources.gold+(e.resources.gold||0),white:w.resources.white+(e.resources.white||0),black:w.resources.black+(e.resources.black||0),silver:w.resources.silver+(e.resources.silver||0)};return console.log("UPDATE_RESOURCES - Updating player",w.id,"from",w.resources,"to",D),{...w,resources:D}}return w})};return console.log("UPDATE_RESOURCES - Updated state players:",m.players.map(w=>({id:w.id,resources:w.resources}))),console.log("UPDATE_RESOURCES - Returning updated state"),m;case"SET_RESOURCES":return{...t,players:t.players.map(w=>w.id===e.playerId?{...w,resources:e.resources}:w)};case"ADD_VICTORY_POINTS":return{...t,players:t.players.map(w=>{var D;return w.id===e.playerId?{...w,victoryPoints:w.victoryPoints+e.points,vpSources:{...w.vpSources,victoryShop:(((D=w.vpSources)==null?void 0:D.victoryShop)||0)+e.points}}:w})};case"UPDATE_VP":return{...t,players:t.players.map(w=>{var D;return w.id===e.playerId?{...w,victoryPoints:w.victoryPoints+e.vp,vpSources:{...w.vpSources,[e.source||"other"]:(((D=w.vpSources)==null?void 0:D[e.source||"other"])||0)+e.vp}}:w})};case"ADD_EFFECT":return{...t,players:t.players.map(w=>w.id===e.playerId?{...w,effects:[...w.effects||[],e.effect]}:w)};case"UPDATE_PLAYER_EFFECTS":return{...t,players:t.players.map(w=>w.id===e.playerId?{...w,effects:e.effects}:w)};case"SET_WORKERS_TO_PLACE":return{...t,workersToPlace:e.count,workerPlacedThisTurn:!1};case"ADD_WORKERS_TO_PLACE":return{...t,workersToPlace:t.workersToPlace+e.count};case"END_TURN":const g=t.players.find(w=>w.id===t.currentPlayer);let E=[...t.playersOutOfWorkers];g.workersLeft===0&&!E.includes(t.currentPlayer)&&E.push(t.currentPlayer);const _=[],h=t.players.filter(w=>w.workersLeft>0);if(E.length===1&&E[0]===t.currentPlayer&&_.push({playerId:t.currentPlayer,vp:3,reason:"first to run out of workers"}),h.length===1&&g.workersLeft===0){const w=h[0];E.includes(w.id)||(E.push(w.id),_.push({playerId:w.id,vp:3,reason:"last to run out of workers"}))}const v=t.turnOrder.indexOf(t.currentPlayer);let S=!1;t.turnDirection===1?v===t.turnOrder.length-1&&(S=!0,t.turnOrder[v]):v===0&&(S=!0,t.turnOrder[v]);const P=g.effects.some(w=>w.includes("Will take an extra turn after this one")),k=(g.extraTurns||0)>0,T=P||k,A=t.skippedTurns[t.currentPlayer]>0;if(T&&!S){const w={...t.skippedTurns};let D="";A?(w[t.currentPlayer]--,D=`Player ${t.currentPlayer}: Extra turn consumed by skip (${w[t.currentPlayer]} skips remaining)`):D=`Player ${t.currentPlayer}: Taking extra turn!`;const M=t.players.map(N=>{var X,Jt;const V=_.find(Oe=>Oe.playerId===N.id);return N.id===t.currentPlayer?{...N,effects:(N.effects||[]).filter(Oe=>Oe.includes("Can place")&&Oe.includes("more workers this turn")&&t.workersToPlace>0?!0:!Oe.includes("Will take an extra turn after this one")&&!Oe.includes("more workers this turn")&&!Oe.includes("Can place")&&!Oe.includes("Next gain will be doubled")&&!Oe.includes("Can place the next player's worker")),extraTurns:Math.max(0,(N.extraTurns||0)-1),victoryPoints:N.victoryPoints+(V?V.vp:0),vpSources:V?{...N.vpSources,purpleWorkers:(((X=N.vpSources)==null?void 0:X.purpleWorkers)||0)+V.vp}:N.vpSources}:{...N,victoryPoints:N.victoryPoints+(V?V.vp:0),vpSources:V?{...N.vpSources,purpleWorkers:(((Jt=N.vpSources)==null?void 0:Jt.purpleWorkers)||0)+V.vp}:N.vpSources}});if(!A){const V=(M.find(X=>X.id===t.currentPlayer).effects||[]).some(X=>X.includes("Can place")&&X.includes("more workers this turn"));return{...t,players:M,workerPlacedThisTurn:!1,workersToPlace:V?t.workersToPlace:1,shopUsedBeforeWorkers:!1,shopUsedAfterWorkers:!1,playersOutOfWorkers:E,skippedTurns:w,actionLog:[...t.actionLog.slice(-9),D,..._.map(X=>`Player ${X.playerId}: +${X.vp} VP (${X.reason})`)].filter(Boolean)}}}else if(T&&S){console.log(`Player ${t.currentPlayer}: Snake draft reversal - extra turn preserved`);const w=`Player ${t.currentPlayer}: At end of snake draft - gets another turn naturally (extra turn preserved)`;t.actionLog.push(w)}const z=T&&A&&!S?{...t.skippedTurns,[t.currentPlayer]:t.skippedTurns[t.currentPlayer]-1}:t.skippedTurns,x=T&&!S?t.players.map(w=>{var M,N;const D=_.find(V=>V.playerId===w.id);return w.id===t.currentPlayer?{...w,effects:(w.effects||[]).filter(V=>V.includes("Can place")&&V.includes("more workers this turn")&&t.workersToPlace>0?!0:!V.includes("Will take an extra turn after this one")&&!V.includes("more workers this turn")&&!V.includes("Can place")&&!V.includes("Next gain will be doubled")&&!V.includes("Can place the next player's worker")),extraTurns:Math.max(0,(w.extraTurns||0)-1),victoryPoints:w.victoryPoints+(D?D.vp:0),vpSources:D?{...w.vpSources,purpleWorkers:(((M=w.vpSources)==null?void 0:M.purpleWorkers)||0)+D.vp}:w.vpSources}:{...w,victoryPoints:w.victoryPoints+(D?D.vp:0),vpSources:D?{...w.vpSources,purpleWorkers:(((N=w.vpSources)==null?void 0:N.purpleWorkers)||0)+D.vp}:w.vpSources}}):t.players.map(w=>{var M;const D=_.find(N=>N.playerId===w.id);return D?{...w,victoryPoints:w.victoryPoints+D.vp,vpSources:{...w.vpSources,purpleWorkers:(((M=w.vpSources)==null?void 0:M.purpleWorkers)||0)+D.vp}}:w}),H=[];T&&A&&H.push(`Player ${t.currentPlayer}: Extra turn consumed by skip (${z[t.currentPlayer]} skips remaining)`);let xe=[],Qe={...t.waitingForOthers};t.players.filter(w=>!t.waitingForOthers[w.id]&&w.workersLeft>0).length===0&&Object.keys(t.waitingForOthers).forEach(w=>{if(t.waitingForOthers[w]){const D=t.players.find(M=>M.id===parseInt(w));D&&D.workersLeft>0&&(xe.push({playerId:parseInt(w),workers:D.workersLeft}),delete Qe[w])}});let J,Ke=t.turnDirection,Zn=0;const O=t.players.length*2,$={...z},F=[];console.log("END_TURN: Skip turns state",{effectiveSkippedTurns:z,tempSkippedTurns:$,currentPlayer:t.currentPlayer,turnOrder:t.turnOrder,turnDirection:t.turnDirection}),t.turnDirection===1?v===t.turnOrder.length-1?(Ke=-1,J=t.turnOrder[v]):J=t.turnOrder[v+1]:v===0?(Ke=1,J=t.turnOrder[v]):J=t.turnOrder[v-1];do{if(Zn++,Zn>O)break;if($[J]>0){console.log(`Player ${J} should skip turn. Skips remaining: ${$[J]}`),F.push(J),$[J]--;const M=t.turnOrder.indexOf(J);Ke===1?M===t.turnOrder.length-1?(Ke=-1,J=t.turnOrder[M]):J=t.turnOrder[M+1]:M===0?(Ke=1,J=t.turnOrder[M]):J=t.turnOrder[M-1];continue}const w=Qe[J],D=t.players.find(M=>M.id===J).workersLeft>0;if(w||!D){const M=t.turnOrder.indexOf(J);Ke===1?M===t.turnOrder.length-1?(Ke=-1,J=t.turnOrder[M-1]):J=t.turnOrder[M+1]:M===0?(Ke=1,J=t.turnOrder[M+1]):J=t.turnOrder[M-1];continue}break}while(Zn<O);const ie={...$};F.length>0&&console.log("Skip turn debug:",{skippedPlayers:F,currentPlayer:t.currentPlayer,nextPlayer:J,turnDirection:t.turnDirection,nextDirection:Ke,skippedTurns:ie});const pe=xe.find(w=>w.playerId===J),yn=x.find(w=>w.id===J),Xt=((yn==null?void 0:yn.effects)||[]).some(w=>w.includes("Can place")&&w.includes("more workers this turn")),Es=pe?pe.workers:Xt?t.workersToPlace:1,Vt=x.reduce((w,D)=>Qe[D.id]?w:w+D.workersLeft,0);if(Vt===0&&t.round===3&&!x.some(D=>(D.extraTurns||0)>0||(D.effects||[]).some(M=>M.includes("Will take an extra turn after this one")))){const D=[],M=x.map(N=>{var Jt,Oe;let V=0;const X={...N.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const U=Object.entries(N.resources).filter(([Wt,_n])=>_n>0).length;U>0&&(V+=U,X.yellowDiversity=(((Jt=N.vpSources)==null?void 0:Jt.yellowDiversity)||0)+U,D.push(`Player ${N.id}: +${U} VP for ${U} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const U=N.resources.gold||0;U>0&&(V+=U,X.goldAutomatic=(((Oe=N.vpSources)==null?void 0:Oe.goldAutomatic)||0)+U,D.push(`Player ${N.id}: +${U} VP for ${U} gold resources`))}return V>0?{...N,victoryPoints:N.victoryPoints+V,vpSources:X}:N});return{...t,players:M,gameOver:!0,actionLog:[...t.actionLog.slice(-9),...D,"Game Over! All players are out of workers."]}}if(Vt===0&&t.round<3&&!t.roundAdvancing){const w=[],D=x.map(U=>{var me,Zt;let Wt=0;const _n={...U.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const At=Object.entries(U.resources).filter(([YC,A_])=>A_>0).length;At>0&&(Wt+=At,_n.yellowDiversity=(((me=U.vpSources)==null?void 0:me.yellowDiversity)||0)+At,w.push(`Player ${U.id}: +${At} VP for ${At} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const At=U.resources.gold||0;At>0&&(Wt+=At,_n.goldAutomatic=(((Zt=U.vpSources)==null?void 0:Zt.goldAutomatic)||0)+At,w.push(`Player ${U.id}: +${At} VP for ${At} gold resources`))}return Wt>0?{...U,victoryPoints:U.victoryPoints+Wt,vpSources:_n}:U});let M=D;if(t.gameLayers&&t.gameLayers.silver){let U=Math.max(...D.map(me=>me.victoryPoints));const _n=D.filter(me=>me.victoryPoints===U).map(me=>me.id);M=D.map(me=>{var Zt;return _n.includes(me.id)?(w.push(`Player ${me.id}: +3 Silver (most VP)`),{...me,resources:{...me.resources,silver:(me.resources.silver||0)+3}}):(w.push(`Player ${me.id}: +2 VP (Silver automatic)`),{...me,victoryPoints:me.victoryPoints+2,vpSources:{...me.vpSources,silverAutomatic:(((Zt=me.vpSources)==null?void 0:Zt.silverAutomatic)||0)+2}})})}const N=t.round+1,V={...t.closedShops};["red","yellow","blue","purple","gold","white","black","silver"].forEach(U=>{delete V[`${U}${N}`]});const Jt=M.map(U=>({id:U.id,vp:U.victoryPoints}));Jt.sort((U,Wt)=>U.vp-Wt.vp);const Oe=Jt.map(U=>U.id);return{...t,round:N,roundAdvancing:!0,closedShops:V,players:M.map(U=>{const Wt=3+N,me=(U.effects||[]).some(Zt=>Zt.includes("Will get 2 extra workers next round"))?2:0;return{...U,workersLeft:Wt+me,effects:(U.effects||[]).filter(Zt=>!Zt.includes("Will get 2 extra workers next round"))}}),occupiedSpaces:{},turnOrder:Oe,currentPlayer:Oe[0],turnDirection:1,workerPlacedThisTurn:!1,workersToPlace:1,shopUsedBeforeWorkers:!1,shopUsedAfterWorkers:!1,shopCostModifier:0,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],actionLog:[...t.actionLog.slice(-9),...H,..._.map(U=>`Player ${U.playerId}: +${U.vp} VP (${U.reason})`),...xe.map(U=>`Player ${U.playerId}: Can now play all ${U.workers} workers!`),...w,`Round ${N} started automatically! Extra workers applied.`].filter(Boolean)}}return{...t,currentPlayer:J,turnDirection:Ke,workerPlacedThisTurn:!1,workersToPlace:Es,shopUsedBeforeWorkers:!1,shopUsedAfterWorkers:!1,skippedTurns:ie,waitingForOthers:Qe,playersOutOfWorkers:E,players:x,actionLog:[...t.actionLog.slice(-9),...H,..._.map(w=>`Player ${w.playerId}: +${w.vp} VP (${w.reason})`),...xe.map(w=>`Player ${w.playerId}: Can now play all ${w.workers} workers!`),...F.map(w=>`Player ${w}: Turn skipped (${$[w]} skips remaining)`)].filter(Boolean)};case"ADVANCE_ROUND":if(t.round>=3)return console.log("ADVANCE_ROUND: Already at round 3, ignoring"),t;console.log("ADVANCE_ROUND reducer called, current state:",{round:t.round,occupiedSpaces:t.occupiedSpaces,players:t.players.map(w=>({id:w.id,workersLeft:w.workersLeft}))});const Gt=[],Ho=t.players.map(w=>{var N,V;let D=0;const M={...w.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const X=Object.entries(w.resources).filter(([Jt,Oe])=>Oe>0).length;X>0&&(D+=X,M.yellowDiversity=(((N=w.vpSources)==null?void 0:N.yellowDiversity)||0)+X,Gt.push(`Player ${w.id}: +${X} VP for ${X} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const X=w.resources.gold||0;X>0&&(D+=X,M.goldAutomatic=(((V=w.vpSources)==null?void 0:V.goldAutomatic)||0)+X,Gt.push(`Player ${w.id}: +${X} VP for ${X} gold resources`))}return D>0?{...w,victoryPoints:w.victoryPoints+D,vpSources:M}:w});let sa=Ho;if(t.gameLayers&&t.gameLayers.silver){let w=Math.max(...Ho.map(N=>N.victoryPoints));const M=Ho.filter(N=>N.victoryPoints===w).map(N=>N.id);sa=Ho.map(N=>{var V;return M.includes(N.id)?(Gt.push(`Player ${N.id}: +3 Silver (most VP)`),{...N,resources:{...N.resources,silver:(N.resources.silver||0)+3}}):(Gt.push(`Player ${N.id}: +2 VP (Silver automatic)`),{...N,victoryPoints:N.victoryPoints+2,vpSources:{...N.vpSources,silverAutomatic:(((V=N.vpSources)==null?void 0:V.silverAutomatic)||0)+2}})})}const Yo=t.round+1,Xd={...t.closedShops};(t.gameLayers?Object.keys(t.gameLayers):[]).forEach(w=>{const D=`${w}${Yo}`;console.log(`Opening shop ${D} for round ${Yo}`),delete Xd[D]});const Jd=[...sa].sort((w,D)=>w.victoryPoints-D.victoryPoints).map(w=>w.id),Zd=Yo>3;Zd&&console.log("ADVANCE_ROUND: Game is over! Setting gameOver to true");const br={...t,round:Yo,gameOver:Zd,closedShops:Xd,players:sa.map(w=>{const D=3+(t.round+1),N=(w.effects||[]).some(V=>V.includes("Will get 2 extra workers next round"))?2:0;return{...w,workersLeft:D+N,effects:(w.effects||[]).filter(V=>!V.includes("Will get 2 extra workers next round")&&!V.includes("more workers this turn")&&!V.includes("Must place on red layer")),shopCostModifier:0}}),occupiedSpaces:{},turnOrder:Jd,currentPlayer:Jd[0],turnDirection:1,workerPlacedThisTurn:!1,workersToPlace:1,shopUsedBeforeWorkers:!1,shopUsedAfterWorkers:!1,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],roundAdvancing:!1,actionLog:[...t.actionLog.slice(-9),...Gt,`Round ${t.round+1} started! Extra workers applied.`]};return console.log("ADVANCE_ROUND - New state:",{round:br.round,occupiedSpaces:br.occupiedSpaces,players:br.players.map(w=>({id:w.id,workersLeft:w.workersLeft})),turnOrder:br.turnOrder,currentPlayer:br.currentPlayer}),br;case"ADD_LOG":return{...t,actionLog:[...t.actionLog.slice(-9),e.message]};case"ADD_NOTIFICATION":return!t.roomCode||!e.notification?t:{...t,notifications:[...t.notifications,{id:Date.now(),...e.notification,timestamp:Date.now()}].slice(-5)};case"CLEAR_NOTIFICATION":return{...t,notifications:t.notifications.filter(w=>w.id!==e.id)};case"RESET_GAME":const k_=v_(4);return{...yl,players:yl.players.map((w,D)=>({...w,emoji:e.preserveEmojis&&t.players[D]?t.players[D].emoji:k_[D]}))};case"SHOW_MODAL":const C_=((r=e.modal)==null?void 0:r.targetPlayerId)&&e.modal.targetPlayerId!==t.myPlayerId&&t.myPlayerId===t.currentPlayer;return{...t,modal:e.modal,waitingForPlayer:C_?e.modal.targetPlayerId:null};case"HIDE_MODAL":return{...t,modal:null,waitingForPlayer:null};case"UNDO_LAST_WORKER":const ef={...t.occupiedSpaces};return delete ef[e.actionId],{...t,occupiedSpaces:ef,players:t.players.map(w=>w.id===e.playerId?{...w,workersLeft:w.workersLeft+1}:w),workerPlacedThisTurn:!1,workersToPlace:Math.min(t.workersToPlace+1,1)};case"UPDATE_OCCUPIED_SPACES":return{...t,occupiedSpaces:e.occupiedSpaces};case"SET_TURN_ORDER":return{...t,turnOrder:e.turnOrder};case"CLOSE_SHOP":return console.log("CLOSE_SHOP action:",e.shopId),{...t,closedShops:{...t.closedShops,[e.shopId]:!0}};case"OPEN_SHOP":console.log("OPEN_SHOP action:",e.shopId);const tf={...t.closedShops};return delete tf[e.shopId],{...t,closedShops:tf};case"FLIP_ALL_SHOPS":const Qo={},T_=t.gameLayers?Object.keys(t.gameLayers):["red","yellow","blue","purple"],b_=[1,2,3];return T_.forEach(w=>{b_.forEach(M=>{const N=`${w}${M}`;Qo[N]=!t.closedShops[N]});const D=`${w}vp`;Qo[D]=!t.closedShops[D]}),t.roomCode&&e.playerId&&e.playerId!==t.myPlayerId?{...t,closedShops:Qo,notifications:[...t.notifications,{id:Date.now(),type:"shop_toggle",icon:"",title:"All Shops Toggled!",message:`${e.playerName||`Player ${e.playerId}`} flipped all shop statuses`,timestamp:Date.now()}].slice(-5)}:{...t,closedShops:Qo};case"ADD_SHOP_COST_MODIFIER":return{...t,players:t.players.map(w=>w.id===e.playerId?{...w,shopCostModifier:(w.shopCostModifier||0)+e.modifier}:w)};case"USE_SHOP":if(t.workerPlacedThisTurn){if(t.workersToPlace===0)return{...t,shopUsedAfterWorkers:!0}}else return{...t,shopUsedBeforeWorkers:!0};return t;case"SET_ROOM_INFO":return{...t,roomCode:e.roomCode,isHost:e.isHost};case"SET_MY_PLAYER_INFO":return{...t,myPlayerId:e.playerId,myPlayerName:e.playerName};case"UPDATE_CONNECTED_PLAYERS":return{...t,connectedPlayers:e.connectedPlayers};case"START_GAME":const oa={};(t.gameLayers?Object.keys(t.gameLayers):["red","yellow","blue","purple"]).forEach(w=>{oa[`${w}2`]=!0,oa[`${w}3`]=!0});let nf=t.players;t.gameLayers&&t.gameLayers.white&&(nf=t.players.map(w=>({...w,victoryPoints:w.victoryPoints+5,vpSources:{...w.vpSources,whiteStarting:5}})));const er=[...t.turnOrder];for(let w=er.length-1;w>0;w--){const D=Math.floor(Math.random()*(w+1));[er[w],er[D]]=[er[D],er[w]]}return{...t,gameStarted:!0,closedShops:oa,players:nf,turnOrder:er,currentPlayer:er[0]};case"SET_GAME_LAYERS":const rf={};return e.layers.blue&&(rf.blue=!0),{...t,gameLayers:e.layers,automaticVPs:rf};case"SET_GAME_MODE":return{...t,gameMode:e.mode};case"UPDATE_CONNECTION_STATUS":return{...t,connectionStatus:e.status};case"SET_SKIPPED_TURNS":return{...t,skippedTurns:e.skippedTurns};case"SET_WAITING_FOR_OTHERS":return{...t,waitingForOthers:e.waitingForOthers};case"REMOVE_WORKER":const sf={...t.occupiedSpaces};return delete sf[e.actionId],{...t,occupiedSpaces:sf,players:t.players.map(w=>w.id===e.playerId?{...w,workersLeft:w.workersLeft+1}:w)};case"CLEAR_SYNC_FLAG":return{...t,justSyncedFromFirebase:!1};case"SYNC_GAME_STATE":if(console.log("SYNC_GAME_STATE reducer called with:",{round:e.gameState.round,currentPlayer:e.gameState.currentPlayer,myPlayerId:t.myPlayerId,gameStarted:e.gameState.gameStarted,gameLayers:e.gameState.gameLayers?Object.keys(e.gameState.gameLayers):null,occupiedSpaces:e.gameState.occupiedSpaces,closedShops:e.gameState.closedShops,players:(s=e.gameState.players)==null?void 0:s.map(w=>({id:w.id,resources:w.resources,workersLeft:w.workersLeft}))}),e.gameState.players&&(console.log("SYNC_GAME_STATE - Player 1 resources from Firebase:",(o=e.gameState.players.find(w=>w.id===1))==null?void 0:o.resources),console.log("SYNC_GAME_STATE - All players from Firebase:",e.gameState.players)),console.log("SYNC_GAME_STATE - Echo detection:",{lastUpdatedBy:e.gameState.lastUpdatedBy,myPlayerId:t.myPlayerId,isOurUpdate:e.gameState.lastUpdatedBy===t.myPlayerId}),e.gameState.lastUpdatedBy&&t.myPlayerId&&e.gameState.lastUpdatedBy===t.myPlayerId)return console.log("SYNC_GAME_STATE - Ignoring our own update echo"),t;const Ss={...t,...e.gameState,syncingFromFirebase:!0,occupiedSpaces:e.gameState.occupiedSpaces||{},players:e.gameState.players?e.gameState.players.map(w=>({...w,effects:w.effects||[],emoji:w.emoji||Fs[w.id-1]||"",resources:w.resources||{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},vpSources:w.vpSources||{},shopCostModifier:w.shopCostModifier!==void 0?w.shopCostModifier:0})):t.players,roomCode:t.roomCode,myPlayerId:t.myPlayerId,myPlayerName:t.myPlayerName,connectedPlayers:t.connectedPlayers,isHost:t.isHost,gameStarted:e.gameState.gameStarted!==void 0?e.gameState.gameStarted:t.gameStarted,connectionStatus:t.connectionStatus,gameLayers:e.gameState.gameLayers||t.gameLayers,closedShops:e.gameState.closedShops||t.closedShops,automaticVPs:e.gameState.automaticVPs||t.automaticVPs,pendingPlacements:e.gameState.pendingPlacements||{},lastSyncTimestamp:e.gameState.timestamp||Date.now(),justSyncedFromFirebase:!0};return console.log("SYNC_GAME_STATE - After merge, new state:",{round:Ss.round,gameOver:Ss.gameOver,occupiedSpaces:Ss.occupiedSpaces,players:(i=Ss.players)==null?void 0:i.map(w=>({id:w.id,resources:w.resources,workersLeft:w.workersLeft}))}),Ss;case"SET_PENDING_PLACEMENT":return{...t,pendingPlacements:{...t.pendingPlacements,[e.actionId]:e.playerId}};case"CLEAR_PENDING_PLACEMENT":const of={...t.pendingPlacements};return delete of[e.actionId],{...t,pendingPlacements:of};default:return t}})();return n!==t&&console.log("Reducer returning new state for action:",e.type),n}const nC={apiKey:"AIzaSyB0c0iUOG3llUzLd9FhQ6Qc1qCB0DoajVw",authDomain:"cornycolonies.firebaseapp.com",databaseURL:"https://cornycolonies-default-rtdb.firebaseio.com",projectId:"cornycolonies",storageBucket:"cornycolonies.firebasestorage.app",messagingSenderId:"566795956627",appId:"1:566795956627:web:585b66a3277696f3b0b866"};let je=null;try{typeof firebase<"u"&&(firebase.initializeApp(nC),je=firebase.database())}catch{console.log("Firebase not available, using local mode")}const w_=Je.createContext();function rC({children:t}){const[e,n]=Je.useReducer(tC,yl);return(window.location.search.includes("test=true")||window.location.search.includes("debug=true"))&&(window.lastKnownState=e,window.lastKnownDispatch=n),y.createElement(w_.Provider,{value:{state:e,dispatch:n}},t)}function Ge(){const t=Je.useContext(w_);if(!t)throw new Error("useGame must be used within a GameProvider");return t}function sC(){return Math.random().toString(36).substring(2,8).toUpperCase()}function oC(t,e){const n=sC(),r=1;if(je){t({type:"UPDATE_CONNECTION_STATUS",status:"connecting"});const s=je.ref(`rooms/${n}`),o=setTimeout(()=>{console.error("Room creation timeout"),alert("Failed to create room - connection timeout. Please try local mode or set up Firebase."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})},5e3);s.set({host:r,gameState:{...yl,gameStarted:!1},players:{[r]:{id:r,name:e,connected:!0,joinedAt:Date.now()}}}).then(()=>{clearTimeout(o),t({type:"SET_ROOM_INFO",roomCode:n,isHost:!0}),t({type:"SET_MY_PLAYER_INFO",playerId:r,playerName:e}),t({type:"UPDATE_CONNECTION_STATUS",status:"connected"}),S_(n,t,r)}).catch(i=>{clearTimeout(o),console.error("Error creating room:",i),alert("Failed to create room. Firebase is not properly configured. Please use local mode for now."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})})}else alert("Multiplayer requires Firebase setup. Please use local mode for now."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})}function iC(t,e,n){if(je){t({type:"UPDATE_CONNECTION_STATUS",status:"connecting"});const r=setTimeout(()=>{console.error("Room join timeout"),alert("Failed to join room - connection timeout. Please try local mode or check the room code."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})},5e3),s=je.ref(`rooms/${e}`);s.once("value").then(o=>{if(clearTimeout(r),o.exists()){const i=o.val(),a=i.players||{};let l=null;for(let u=1;u<=4;u++)if(!a[u]||!a[u].connected){l=u;break}l?s.child(`players/${l}`).set({id:l,name:n,connected:!0,joinedAt:Date.now()}).then(()=>{t({type:"SET_ROOM_INFO",roomCode:e,isHost:!1}),t({type:"SET_MY_PLAYER_INFO",playerId:l,playerName:n}),t({type:"UPDATE_CONNECTION_STATUS",status:"connected"}),i.gameState&&t({type:"SYNC_GAME_STATE",gameState:i.gameState}),S_(e,t,l)}):(alert("Room is full (4 players max)"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"}))}else alert("Room not found"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})}).catch(o=>{console.error("Error joining room:",o),alert("Failed to join room"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})})}else alert("Firebase not available. Using local mode.")}let bi=null,xr=0;function E_(t,e,n){if(xr>=gp){console.error("Max reconnection attempts reached"),e({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"}),alert("Connection lost. Please refresh the page to rejoin.");return}xr++;const r=Jk*Math.pow(2,xr-1);console.log(`Attempting to reconnect (attempt ${xr}/${gp}) in ${r}ms...`),bi=setTimeout(()=>{je.ref(`rooms/${t}/players/${n}/connected`).set(!0).then(()=>{console.log("Reconnection successful"),xr=0,e({type:"UPDATE_CONNECTION_STATUS",status:"connected"})}).catch(s=>{console.error("Reconnection failed:",s),E_(t,e,n)})},r)}function S_(t,e,n){if(!je)return;const r=je.ref(`rooms/${t}`);r.child("players").on("value",i=>{const a=i.val()||{};e({type:"UPDATE_CONNECTED_PLAYERS",connectedPlayers:a});const l=Object.values(a).filter(f=>f.connected);!l.find(f=>f.id===1)&&l.length>0&&l.reduce((d,c)=>c.id<d.id?c:d).id===n&&(e({type:"SET_ROOM_INFO",roomCode:t,isHost:!0}),console.log(`Player ${n} is now the host`))});let s=0;r.child("gameState").on("value",i=>{var l;const a=i.val();if(a){if(a.timestamp&&a.timestamp<=s){console.log("Skipping older gameState update:",a.timestamp,"<=",s);return}console.log("Firebase gameState update received:",{round:a.round,currentPlayer:a.currentPlayer,gameOver:a.gameOver,lastUpdatedBy:a.lastUpdatedBy,timestamp:a.timestamp,occupiedSpaces:a.occupiedSpaces,players:(l=a.players)==null?void 0:l.map(u=>({id:u.id,resources:u.resources,workersLeft:u.workersLeft}))}),s=a.timestamp||Date.now(),e({type:"SYNC_GAME_STATE",gameState:a})}}),r.child(`players/${n}/connected`).onDisconnect().set(!1),je.ref(".info/connected").on("value",i=>{i.val()===!0?(console.log("Firebase connection established"),bi&&(clearTimeout(bi),bi=null),xr=0,e({type:"UPDATE_CONNECTION_STATUS",status:"connected"})):(console.log("Firebase connection lost"),e({type:"UPDATE_CONNECTION_STATUS",status:"reconnecting"}),E_(t,e,n))})}let pi=!1;function lC(t,e){var n,r;if(je&&t&&!pi){pi=!0,console.log("syncGameState - Syncing to Firebase:",{roomCode:t,round:e.round,currentPlayer:e.currentPlayer,gameOver:e.gameOver,lastUpdatedBy:e.lastUpdatedBy,occupiedSpaces:e.occupiedSpaces,players:(n=e.players)==null?void 0:n.map(i=>({id:i.id,resources:i.resources,workersLeft:i.workersLeft}))});const s=(r=e.players)==null?void 0:r.find(i=>i.id===1);s&&console.log("syncGameState - Player 1 resources being sent:",s.resources);const o={...e,lastUpdatedBy:e.lastUpdatedBy||null,timestamp:e.timestamp||Date.now(),gameLayers:e.gameLayers||null};je.ref(`rooms/${t}/gameState`).set(o).then(()=>{pi=!1}).catch(i=>{console.error("Failed to sync game state:",i),console.error("Problematic game state:",e),pi=!1})}}function _p(t,e=null,n="basic"){je&&t&&je.ref(`rooms/${t}/players`).once("value",r=>{const s=r.val()||{};Object.keys(s).length;const o=[];Object.values(s).forEach((u,f)=>{o.push({id:u.id,name:u.name,resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0})});let i={};e&&e.blue&&(i.blue=!0);let a=o;e&&e.white&&(a=o.map(u=>({...u,victoryPoints:u.victoryPoints+5})));const l={currentPlayer:1,turnDirection:1,players:a,occupiedSpaces:{},round:1,turnOrder:o.map(u=>u.id),workerPlacedThisTurn:!1,workersToPlace:1,actionLog:[],gameStarted:!0,gameLayers:e,gameMode:n,automaticVPs:i,closedShops:{},shopUsedBeforeWorkers:!1,shopUsedAfterWorkers:!1,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],gameOver:!1,timestamp:Date.now(),lastUpdatedBy:"host-start"};console.log("Starting multiplayer game with state:",{players:l.players.length,gameLayers:e?Object.keys(e):"null",gameMode:n,automaticVPs:i}),je.ref(`rooms/${t}/gameState`).set(l).then(()=>{console.log("Game state successfully written to Firebase"),je.ref(`rooms/${t}/lastUpdate`).set(Date.now())}).catch(u=>{console.error("Failed to write game state to Firebase:",u)})})}function aC(){const{state:t,dispatch:e}=Ge(),[n,r]=Je.useState(""),[s,o]=Je.useState(""),[i,a]=Je.useState("menu"),[l,u]=Je.useState(null),f=()=>{if(!n.trim()){alert("Please enter your name");return}oC(e,n.trim())},d=()=>{if(!n.trim()){alert("Please enter your name");return}if(!s.trim()){alert("Please enter room code");return}iC(e,s.trim().toUpperCase(),n.trim())},c=()=>{a("gameMode")},p=m=>{const g=gl(4,m);e({type:"SET_GAME_MODE",mode:m}),e({type:"SET_GAME_LAYERS",layers:g}),e({type:"START_GAME"})};return y.createElement("div",{className:"min-h-screen flex items-center justify-center p-4"},y.createElement("div",{className:"glass rounded-xl shadow-2xl p-8 max-w-md w-full"},[y.createElement("div",{key:"header",className:"text-center mb-8"},[y.createElement("h1",{key:"title",className:"text-3xl font-bold text-gray-800 mb-2"},"Patrons"),y.createElement("p",{key:"subtitle",className:"text-gray-600"},"Choose your game mode")]),i==="menu"&&y.createElement("div",{key:"menu",className:"space-y-4"},[y.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:m=>r(m.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),y.createElement("button",{key:"create",onClick:()=>a("create"),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Create Online Game"),y.createElement("button",{key:"join",onClick:()=>a("join"),className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Join Online Game"),y.createElement("button",{key:"local",onClick:c,className:"w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Play Local (Same Device)")]),i==="create"&&y.createElement("div",{key:"create",className:"space-y-4"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Create Room"),y.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:m=>r(m.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),y.createElement("button",{key:"create",onClick:f,disabled:t.connectionStatus==="connecting",className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 disabled:transform-none"},t.connectionStatus==="connecting"?"Creating...":"Create Room"),y.createElement("button",{key:"back",onClick:()=>a("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")]),i==="join"&&y.createElement("div",{key:"join",className:"space-y-4"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Join Room"),y.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:m=>r(m.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),y.createElement("input",{key:"code",type:"text",placeholder:"Enter room code",value:s,onChange:m=>o(m.target.value.toUpperCase()),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"}),y.createElement("button",{key:"join",onClick:d,disabled:t.connectionStatus==="connecting",className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 disabled:transform-none"},t.connectionStatus==="connecting"?"Joining...":"Join Room"),y.createElement("button",{key:"back",onClick:()=>a("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")]),i==="gameMode"&&y.createElement("div",{key:"gameMode",className:"space-y-4"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Select Game Mode"),y.createElement("div",{key:"description",className:"text-sm text-gray-600 text-center mb-6 space-y-2"},[y.createElement("p",{key:"basic"},"Basic: Play with the classic 4 colors (Red, Yellow, Blue, Purple)"),y.createElement("p",{key:"advanced"},"Advanced: Play with 4 randomly selected colors from all 8 available")]),y.createElement("button",{key:"basic",onClick:()=>p("basic"),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Basic Mode"),y.createElement("button",{key:"advanced",onClick:()=>p("advanced"),className:"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Advanced Mode"),y.createElement("button",{key:"back",onClick:()=>a("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")])]))}function vp(){const{state:t,dispatch:e}=Ge(),n=Object.keys(t.connectedPlayers).length,[r,s]=Je.useState(!1),[o,i]=Je.useState("basic"),a=()=>{n>=2?s(!0):alert("Need at least 2 players to start")},l=()=>{confirm("Are you sure you want to leave the room?")&&window.location.reload()};return t.gameStarted?null:y.createElement("div",{className:"glass rounded-lg p-4 mb-6"},[y.createElement("div",{key:"header",className:"flex justify-between items-center mb-4"},[y.createElement("div",{key:"info"},[y.createElement("h3",{key:"title",className:"text-lg font-bold text-gray-800"},`Room: ${t.roomCode}`),y.createElement("p",{key:"count",className:"text-sm text-gray-600"},`${n}/4 players connected`)]),y.createElement("button",{key:"leave",onClick:l,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm"},"Leave")]),y.createElement("div",{key:"players",className:"grid grid-cols-2 gap-2 mb-4"},Object.values(t.connectedPlayers).map(u=>y.createElement("div",{key:u.id,className:`p-2 rounded border-2 ${u.connected?"border-green-400 bg-green-50":"border-gray-300 bg-gray-50"} ${u.id===t.myPlayerId?"ring-2 ring-blue-400":""}`},[y.createElement("div",{key:"name",className:"font-semibold"},`Player ${u.id}: ${u.name}`),y.createElement("div",{key:"status",className:`text-xs ${u.connected?"text-green-600":"text-gray-500"}`},u.connected?" Connected":u.id===t.myPlayerId&&t.connectionStatus==="reconnecting"?" Reconnecting...":" Disconnected"),u.id===t.myPlayerId&&y.createElement("div",{key:"you",className:"text-xs text-blue-600 font-bold"},"(You)")]))),t.isHost&&!t.gameStarted&&!r&&y.createElement("button",{key:"start",onClick:a,disabled:n<2,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-all duration-200"},n>=2?"Start Game":"Need 2+ Players to Start"),r&&y.createElement("div",{key:"gameMode",className:"space-y-3 mt-4"},[y.createElement("h4",{key:"title",className:"text-md font-bold text-center"},"Select Game Mode"),y.createElement("div",{key:"buttons",className:"flex gap-2"},[y.createElement("button",{key:"basic",onClick:()=>{console.log("Starting game with",n,"players in basic mode");const u=gl(n,"basic");console.log("Selected layers:",Object.keys(u)),e({type:"SET_GAME_MODE",mode:"basic"}),e({type:"SET_GAME_LAYERS",layers:u}),_p(t.roomCode,u,"basic"),e({type:"START_GAME"}),console.log("Game started successfully")},className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-3 rounded-lg text-sm"},"Basic"),y.createElement("button",{key:"advanced",onClick:()=>{console.log("Starting game with",n,"players in advanced mode");const u=gl(n,"advanced");console.log("Selected layers:",Object.keys(u)),e({type:"SET_GAME_MODE",mode:"advanced"}),e({type:"SET_GAME_LAYERS",layers:u}),_p(t.roomCode,u,"advanced"),e({type:"START_GAME"}),console.log("Game started successfully")},className:"flex-1 bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-3 rounded-lg text-sm"},"Advanced"),y.createElement("button",{key:"cancel",onClick:()=>s(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 rounded-lg text-sm"},"Cancel")])])])}function uC({notifications:t,myPlayerId:e}){const n=t.filter(r=>!r.forPlayer||r.forPlayer===e);return n.length===0?null:y.createElement("div",{className:"fixed top-4 right-4 z-50 space-y-2"},n.slice(-3).map(r=>y.createElement("div",{key:r.id,className:"bg-gray-800 text-white p-4 rounded-lg shadow-lg transform transition-all duration-300 hover:scale-105",style:{minWidth:"300px"}},[y.createElement("div",{key:"header",className:"flex items-center gap-2 mb-1"},[y.createElement("span",{key:"icon",className:"text-2xl"},r.icon||""),y.createElement("span",{key:"title",className:"font-bold"},r.title)]),y.createElement("div",{key:"message",className:"text-sm opacity-90"},r.message),y.createElement("div",{key:"time",className:"text-xs opacity-60 mt-1"},`${Math.floor((Date.now()-r.timestamp)/1e3)}s ago`)])))}function cC({actionId:t,title:e,description:n,round:r,available:s=!0,compact:o=!1}){const{state:i,dispatch:a}=Ge(),l=i.occupiedSpaces[t],u=l?i.players.find(g=>g.id===l):null,f=i.pendingPlacements&&i.pendingPlacements[t],d=async()=>{if(l||!s)return;if(i.roomCode&&i.myPlayerId!==i.currentPlayer){alert("It's not your turn!");return}if(i.roomCode){if(i.pendingPlacements&&i.pendingPlacements[t]){alert("Another player is placing a worker here!");return}a({type:"SET_PENDING_PLACEMENT",actionId:t,playerId:i.myPlayerId})}const g=i.players.find(h=>h.id===i.currentPlayer);if(i.workersToPlace<=0){alert("You have already placed all your workers this turn. End your turn or buy from shops.");return}if(g.workersLeft<=0&&i.workersToPlace<=1){alert("You have no workers left to place!");return}const E=g.effects&&g.effects.some(h=>h.includes("Must place on red layer"));if(E&&console.log("FORCE_RED_DEBUG - Current player must place on red:",g.id,g.effects),E){const h=i.gameLayers&&i.gameLayers.red,v=h&&h.actions.some(S=>S.id===t);if(console.log("FORCE_RED_DEBUG - Checking action:",t,"Red layer exists:",!!h,"Is red action:",v),!v){const S=h?h.actions.filter(k=>k.round<=i.round).map(k=>k.id):[],P=S.length===0||S.every(k=>i.occupiedSpaces[k]);if(console.log("FORCE_RED_DEBUG - Available red actions for round",i.round,":",S,"Red is full:",P),P)console.log("Red layer is full, clearing force red effects"),i.players.forEach(k=>{k.effects&&k.effects.some(T=>T.includes("Must place on red layer"))&&a({type:"UPDATE_PLAYER_EFFECTS",playerId:k.id,effects:k.effects.filter(T=>!T.includes("Must place on red layer"))})});else{alert("You must place workers on the red layer until it is full!");return}}}if((t==="redHybrid1"||t==="redHybrid2")&&Object.entries(i.occupiedSpaces).filter(([v,S])=>S===i.currentPlayer&&v!==t).length===0){const v=[];if(Object.entries(i.gameLayers||{}).forEach(([S,P])=>{P.actions.forEach(k=>{k.round<=i.round&&!i.occupiedSpaces[k.id]&&v.push(k.id)})}),v.length>1&&!confirm("WARNING: You have no other workers on the board to swap! This action will only give you the resource bonus. Continue anyway?"))return}if(t==="gain2purpleTakeBack"&&Object.entries(i.occupiedSpaces).filter(([v,S])=>S!==i.currentPlayer?!1:!(i.gameLayers.purple&&i.gameLayers.purple.actions.some(k=>k.id===v))).length===0){const v=[];if(Object.entries(i.gameLayers||{}).forEach(([S,P])=>{P.actions.forEach(k=>{k.round<=i.round&&!i.occupiedSpaces[k.id]&&v.push(k.id)})}),v.length>1&&!confirm("WARNING: You have no workers on non-purple quads to take back! This action will only give you the purple resources. Continue anyway?"))return}if(t==="playTwoWorkers"&&g.workersLeft<2&&!confirm(`WARNING: You only have ${g.workersLeft} worker(s) left. You won't be able to place 2 workers. Continue anyway?`)||t==="playThreeWorkers"&&g.workersLeft<3&&!confirm(`WARNING: You only have ${g.workersLeft} worker(s) left. You won't be able to place 3 workers. Continue anyway?`))return;if(t==="gain4purpleWaitAll"){const h=(g.effects||[]).some(S=>S.includes("Will take an extra turn after this one")),v=(g.extraTurns||0)>0;if((h||v)&&!confirm("WARNING: You already have an extra turn queued! This action will have no additional effect. Continue anyway?"))return}if(t==="spend2AnyFor3VP"){const h=Object.values(g.resources).reduce((v,S)=>v+S,0);if(h<2&&!confirm("WARNING: You need at least 2 resources to use this action. You only have "+h+". Continue anyway?"))return}if(t==="spend1AnyFor2VP"&&Object.values(g.resources).reduce((v,S)=>v+S,0)<1&&!confirm("WARNING: You need at least 1 resource to use this action. You have none. Continue anyway?"))return;const _={actionId:t,playerId:i.currentPlayer};try{a({type:"PLACE_WORKER",actionId:t});const h={...i,occupiedSpaces:{...i.occupiedSpaces,[t]:i.currentPlayer},players:i.players.map(P=>P.id===i.currentPlayer?{...P,workersLeft:P.workersLeft-1}:P),workerPlacedThisTurn:!0,workersToPlace:Math.max(0,i.workersToPlace-1)},v=h.players.find(P=>P.id===i.currentPlayer);await vt(t,v,a,h,i.gameLayers,0,_);const S=`Action completed: ${t} for Player ${g.id}`;a({type:"ADD_LOG",message:S}),console.log(S)}finally{i.roomCode&&a({type:"CLEAR_PENDING_PLACEMENT",actionId:t})}},c=()=>r===1?"bg-gray-100 border-gray-300":r===2?"bg-green-100 border-green-500":r===3?"bg-yellow-100 border-yellow-500":"bg-gray-100 border-gray-300",p=()=>s?l?"bg-red-100 border-red-400 cursor-not-allowed":f?"bg-yellow-100 border-yellow-400 cursor-wait animate-pulse":"hover:bg-blue-50 hover:border-blue-500 hover:shadow-lg cursor-pointer transform hover:scale-102 border-blue-300":"opacity-50 cursor-not-allowed bg-gray-300 border-gray-400",m=()=>{const g="absolute top-1 left-1 px-3 py-1 rounded-full text-sm font-bold text-white shadow-md";switch(r){case 1:return`${g} bg-gray-500`;case 2:return`${g} bg-green-500`;case 3:return`${g} bg-yellow-600`;default:return`${g} bg-gray-500`}};return y.createElement("div",{className:`relative border-2 rounded-lg flex flex-col p-2 min-h-[80px] transition-all duration-200 shadow ${c()} ${p()}`,onClick:d},[y.createElement("div",{key:"round-indicator",className:m()},`R${r}`),u&&y.createElement("div",{key:"worker",className:"absolute top-1 right-1 text-2xl drop-shadow-lg"},u.emoji||u.id),y.createElement("div",{key:"title",className:`font-bold text-xs mb-1 px-6 text-center ${s?"text-gray-900":"text-gray-500"}`},e),y.createElement("div",{key:"desc",className:`text-xs text-center px-2 ${s?"text-gray-600":"text-gray-400"} leading-tight`},n)])}async function vt(t,e,n,r,s,o=0,i=null){if(o>5){n({type:"ADD_LOG",message:" Max recursion depth reached - stopping to prevent infinite loop"});return}o>0&&n({type:"ADD_LOG",message:` Action chain depth: ${o}`});const a={gain3red:{red:3},gain2red:{red:2},gain3blue:{blue:3},gain2blue:{blue:2},gain3purple:{purple:3},gain2purple:{purple:2},gain2gold:{gold:2},gain1gold:{gold:1},gain3white:{white:3},gain2white:{white:2},gain3black:{black:3},gain2black:{black:2},gain3silver:{silver:3},gain2silver:{silver:2}};if(a[t]){let l={...a[t]};if((e.effects||[]).some(f=>f.includes("Next gain will be doubled"))){Object.keys(l).forEach(d=>{l[d]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))});const f=`Player ${e.id}: ${t}  +${Object.entries(l).map(([d,c])=>`${c} ${d}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:f})}else{const f=`Player ${e.id}: ${t}  +${Object.entries(l).map(([d,c])=>`${c} ${d}`).join(", ")}`;n({type:"ADD_LOG",message:f})}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:l}),t.includes("red")&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`}));return}if(t==="gain3yellow"){const l=(i==null?void 0:i.playerId)||e.id,u=r.players.find(E=>E.id===l),f=i&&i.placedBy&&i.placedBy!==l,c=await ge(n,f?"Your worker was placed! Select 3 Resources ( Colors):":"Select 3 Resources ( Colors)",3,null,i,f?l:null);if(console.log("gain3yellow - selectedGems:",c),!c){n({type:"UPDATE_RESOURCES",playerId:l,resources:{red:1,yellow:1,blue:1}});const _=`Player ${l}: gain3yellow  +1 red, +1 yellow, +1 blue (default)`;n({type:"ADD_LOG",message:_});return}const p=c;console.log("gain3yellow - resources object before processing:",p),console.log("gain3yellow - actualPlayerId:",l),console.log("gain3yellow - actualPlayer:",u);const m={};if(Object.entries(p).forEach(([E,_])=>{_>0&&(m[E]=_)}),console.log("gain3yellow - filteredResources (zeros removed):",m),(u.effects||[]).some(E=>E.includes("Next gain will be doubled"))){Object.keys(m).forEach(_=>{m[_]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:l,effects:(u.effects||[]).filter(_=>!_.includes("Next gain will be doubled"))});const E=`Player ${l}: ${t}  +${Object.entries(m).map(([_,h])=>`${h} ${_}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:E})}else{const E=`Player ${l}: ${t}  +${Object.entries(m).map(([_,h])=>`${h} ${_}`).join(", ")}`;n({type:"ADD_LOG",message:E})}console.log("gain3yellow - About to dispatch UPDATE_RESOURCES with:",{type:"UPDATE_RESOURCES",playerId:l,resources:m});try{n({type:"UPDATE_RESOURCES",playerId:l,resources:m}),console.log("gain3yellow - UPDATE_RESOURCES dispatched successfully")}catch(E){console.error("gain3yellow - Error dispatching UPDATE_RESOURCES:",E)}return}if(t==="gain2yellow"){console.log("gain2yellow - Starting for player",e.id,"workerInfo:",i);const l=(i==null?void 0:i.playerId)||e.id,u=r.players.find(g=>g.id===l);console.log("gain2yellow - actualPlayerId:",l,"actualPlayer:",u);const f=i&&i.placedBy&&i.placedBy!==l,c=await ge(n,f?"Your worker was placed! Select 2 Resources ( Colors):":"Select 2 Resources ( Colors)",2,null,i,f?l:null);if(console.log("gain2yellow - selectedGems:",c),!c){const g={red:1,yellow:1};console.log("gain2yellow - Using default resources:",g),n({type:"UPDATE_RESOURCES",playerId:l,resources:g});const E=`Player ${l}: gain2yellow  +1 red, +1 yellow (default)`;n({type:"ADD_LOG",message:E});return}const p=c;if(console.log("gain2yellow - resources object:",p),(u.effects||[]).some(g=>g.includes("Next gain will be doubled"))){Object.keys(p).forEach(E=>{p[E]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:l,effects:(u.effects||[]).filter(E=>!E.includes("Next gain will be doubled"))});const g=`Player ${l}: ${t}  +${Object.entries(p).map(([E,_])=>`${_} ${E}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:g})}else{const g=`Player ${l}: ${t}  +${Object.entries(p).map(([E,_])=>`${_} ${E}`).join(", ")}`;n({type:"ADD_LOG",message:g})}console.log("gain2yellow - About to dispatch UPDATE_RESOURCES with:",{playerId:l,resources:p}),n({type:"UPDATE_RESOURCES",playerId:l,resources:p});return}if(t==="playTwoWorkers"){const l=e.workersLeft,u=Math.min(2,l);if(u===0){const d=`Player ${e.id}: playTwoWorkers  No workers left to place`;n({type:"ADD_LOG",message:d});return}n({type:"ADD_WORKERS_TO_PLACE",count:u}),n({type:"ADD_EFFECT",playerId:e.id,effect:`Can place ${u} more worker${u>1?"s":""} this turn`});const f=`Player ${e.id}: playTwoWorkers  Can now place ${u} MORE worker${u>1?"s":""} this turn`;n({type:"ADD_LOG",message:f}),console.log(f);return}if(t==="gain4purpleSkip"){const l=(e.effects||[]).some(c=>c.includes("Next gain will be doubled"));let u=4;l&&(u*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:u}});const f={...r.skippedTurns};f[e.id]=(f[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:f});const d=`Player ${e.id}: gain4purpleSkip  +${u} purple${l?" (DOUBLED!)":""}, will skip next turn (total skips: ${f[e.id]})`;n({type:"ADD_LOG",message:d});return}if(t==="gain2purpleTakeBack"){const l=(e.effects||[]).some(c=>c.includes("Next gain will be doubled"));let u=2;l&&(u*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:u}});const f=Object.entries(r.occupiedSpaces||{}).filter(([c,p])=>p!==e.id?!1:!(s.purple&&s.purple.actions.some(g=>g.id===c)));if(f.length>0){const c={};f.forEach(([m,g])=>{const E=Object.keys(s).find(_=>s[_].actions.some(h=>h.id===m));E&&(c[E]||(c[E]=[]),c[E].push(m))});const p=[];if(Object.entries(c).forEach(([m,g])=>{g.forEach(E=>{const _=s[m].actions.find(h=>h.id===E);_&&p.push({label:`${m} - ${_.title}`,value:E})})}),p.length>0){const m=await ye(n,"Choose a worker to take back",p);m&&(n({type:"REMOVE_WORKER",actionId:m,playerId:e.id}),n({type:"ADD_LOG",message:`Player ${e.id}: Took back worker from ${m}`}))}}const d=`Player ${e.id}: gain2purpleTakeBack  +${u} purple${l?" (DOUBLED!)":""} + take back worker`;n({type:"ADD_LOG",message:d});return}if(t==="gain5purpleSkip"){const l=(e.effects||[]).some(c=>c.includes("Next gain will be doubled"));let u=5;l&&(u*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:u}});const f={...r.skippedTurns};f[e.id]=(f[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:f});const d=`Player ${e.id}: gain5purpleSkip  +${u} purple${l?" (DOUBLED!)":""}, will skip next turn (total skips: ${f[e.id]})`;n({type:"ADD_LOG",message:d});return}if(t==="playThreeWorkers"){const l=e.workersLeft,u=Math.min(3,l);if(u===0){const d=`Player ${e.id}: playThreeWorkers  No workers left to place`;n({type:"ADD_LOG",message:d});return}n({type:"ADD_WORKERS_TO_PLACE",count:u}),n({type:"ADD_EFFECT",playerId:e.id,effect:`Can place ${u} more worker${u>1?"s":""} this turn`});const f=`Player ${e.id}: playThreeWorkers  Can now place ${u} MORE worker${u>1?"s":""} this turn`;n({type:"ADD_LOG",message:f});return}if(t==="gain4purpleWaitAll"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:4}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Will take an extra turn after this one"}),n({type:"UPDATE_PLAYER",playerId:e.id,updates:{extraTurns:(e.extraTurns||0)+1}});const l=`Player ${e.id}: gain4purpleWaitAll  +4 purple + extra turn after this one`;n({type:"ADD_LOG",message:l});return}if(t==="extraWorkers"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Will get 2 extra workers next round"}),console.log(`Player ${e.id} will get 2 extra workers next round`);return}if(t==="purpleShopHybrid"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}});const u=await ye(n,"Choose  Round 1 shop benefit",[{label:" R1: Repeat worker action",value:"red1"},{label:" R1: Double next gain",value:"yellow1"},{label:" R1: Close  shop this round",value:"blue1"},{label:" R1: Take an extra turn after this one",value:"purple1"}]);if(u){switch(u){case"red1":await P_(e,n,r,s);break;case"yellow1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Next gain will be doubled"});break;case"blue1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Can close  shop this round"});break;case"purple1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Will take an extra turn after this one"}),n({type:"UPDATE_PLAYER",playerId:e.id,updates:{extraTurns:(e.extraTurns||0)+1}});break}const f={red1:"Repeat worker action",yellow1:"Double next gain",blue1:"Close shop ability",purple1:"Extra turn"},d=`Player ${e.id}: purpleShopHybrid  +1 purple + ${f[u]}`;n({type:"ADD_LOG",message:d})}return}if(t==="purpleHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}});const u=await ye(n,"Choose new turn order for next round",[{label:"1  2  3  4",value:[1,2,3,4]},{label:"4  3  2  1",value:[4,3,2,1]},{label:"2  1  4  3",value:[2,1,4,3]},{label:"3  4  1  2",value:[3,4,1,2]}]);if(u){n({type:"SET_TURN_ORDER",turnOrder:u});const f=`Player ${e.id}: purpleHybrid2  +1 purple + set turn order to ${u.join("  ")}`;n({type:"ADD_LOG",message:f})}return}if(t==="redRepeatAction"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const l=`DEBUG: Occupied spaces: ${JSON.stringify(r.occupiedSpaces)}`;n({type:"ADD_LOG",message:l});const u=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"],f=Object.entries(r.occupiedSpaces).filter(([m,g])=>g===e.id&&!u.includes(m)).map(([m])=>m),d=`DEBUG: Player spaces to repeat: ${f.join(", ")}`;if(n({type:"ADD_LOG",message:d}),f.length===0){const m=`Player ${e.id}: redRepeatAction  +1 red (no valid workers to repeat - swap/repeat actions excluded)`;n({type:"ADD_LOG",message:m});return}const c=f.map(m=>{let g=m;for(const E of Object.values(s)){const _=E.actions.find(h=>h.id===m);if(_){g=_.title;break}}return{label:`Repeat: ${g}`,value:m}}),p=await ye(n,"Choose an action to repeat",c);if(p){let m=p;for(const E of Object.values(s)){const _=E.actions.find(h=>h.id===p);if(_){m=_.title;break}}const g=`Player ${e.id}: redRepeatAction  +1 red + repeating ${m}`;n({type:"ADD_LOG",message:g}),await vt(p,e,n,r,s,o+1,i)}return}if(t==="redHybrid1"||t==="redHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const l=Object.entries(r.occupiedSpaces);if(l.length<2){const h=`Player ${e.id}: ${t}  +1 red (not enough workers to swap)`;n({type:"ADD_LOG",message:h});return}const u=l.filter(([h,v])=>v===e.id&&h!==t&&h!=="redHybrid1"&&h!=="redHybrid2"),f=l.filter(([h,v])=>v!==e.id&&h!==t&&h!=="redHybrid1"&&h!=="redHybrid2");if(u.length===0||f.length===0){const h=`Player ${e.id}: ${t}  +1 red (need valid workers from both players - swap actions excluded)`;n({type:"ADD_LOG",message:h});return}const d=u.map(([h,v])=>{let S=h;for(const[P,k]of Object.entries(s)){const T=k.actions.find(A=>A.id===h);if(T){S=`${P} - ${T.title}`;break}}return{label:`Your worker on: ${S}`,value:{spaceId:h,playerId:v}}}),c=await ye(n,"Choose your worker to swap",d,!1,i);if(!c)return;const p=f.map(([h,v])=>{let S=h;for(const[T,A]of Object.entries(s)){const z=A.actions.find(x=>x.id===h);if(z){S=`${T} - ${z.title}`;break}}const P=r.players.find(T=>T.id===v);return{label:`${P?`${P.name} ${P.emoji||""}`:`Player ${v}`}'s worker on: ${S}`,value:{spaceId:h,playerId:v}}}),m=await ye(n,"Choose another player's worker to swap with",p,!1,i);if(!m)return;const g={...r.occupiedSpaces};g[c.spaceId]=m.playerId,g[m.spaceId]=c.playerId,n({type:"UPDATE_OCCUPIED_SPACES",occupiedSpaces:g}),m.playerId,n({type:"ADD_LOG",message:"Workers swapped between actions"});const E=["playTwoWorkers","playThreeWorkers"];t==="redHybrid1"?r.roomCode?(n({type:"ADD_LOG",message:"In multiplayer, only current player gets the swap benefit"}),E.includes(m.spaceId)?n({type:"ADD_LOG",message:`Player ${e.id}: Cannot execute ${m.spaceId} from swap (would interfere with swap)`}):await vt(m.spaceId,e,n,r,s,o+1)):(E.includes(c.spaceId)||await vt(c.spaceId,r.players.find(h=>h.id===m.playerId),n,r,s,o+1),E.includes(m.spaceId)||await vt(m.spaceId,r.players.find(h=>h.id===c.playerId),n,r,s,o+1)):E.includes(m.spaceId)?n({type:"ADD_LOG",message:`Player ${e.id}: Cannot execute ${m.spaceId} from swap (would interfere with swap)`}):await vt(m.spaceId,e,n,r,s,o+1);const _=`Player ${e.id}: ${t}  +1 red + swapped workers`;n({type:"ADD_LOG",message:_});return}if(t==="forceRedPlacement"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`}),r.players.forEach(u=>{u.id!==e.id&&n({type:"ADD_EFFECT",playerId:u.id,effect:`Must place on red layer (forced by Player ${e.id})`})});const l=`Player ${e.id}: forceRedPlacement  +1 red + forcing red placement on others`;n({type:"ADD_LOG",message:l});return}if(t==="redRepeatAll"){n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const l=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","playTwoWorkers","playThreeWorkers","gain4purpleWaitAll","gain2purpleTakeBack","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"];console.log("redRepeatAll - All occupied spaces:",r.occupiedSpaces),console.log("redRepeatAll - Current player:",e.id);const u=Object.entries(r.occupiedSpaces).filter(([d,c])=>{const p=c===e.id,m=l.includes(d),g=d===t;return console.log(`Checking ${d}: player=${c}, isPlayerSpace=${p}, isExcluded=${m}, isCurrentAction=${g}`),p&&!m&&!g}).map(([d])=>d);if(u.length===0){const d=`Player ${e.id}: redRepeatAll  No other workers to repeat`;n({type:"ADD_LOG",message:d});return}n({type:"ADD_LOG",message:`Player ${e.id}: redRepeatAll  Will repeat ${u.length} actions`});const f=[...u];for(;f.length>0;){const d=f.map(m=>{let g=m;for(const[E,_]of Object.entries(s)){const h=_.actions.find(v=>v.id===m);if(h){g=`${E} - ${h.title}`;break}}return{label:g,value:m}}),c=await ye(n,`Choose next action to repeat (${f.length} remaining)`,d,!1,i);if(!c){n({type:"ADD_LOG",message:`Player ${e.id}: Stopped repeating actions`});break}await vt(c,e,n,r,s,o+1);const p=f.indexOf(c);p>-1&&f.splice(p,1)}return}if(t==="steal2Gems"){const l=Object.values(e.resources).reduce((c,p)=>c+p,0);if(l===0){const c=`Player ${e.id}: Trade All  for   No resources to trade`;n({type:"ADD_LOG",message:c});return}const u=await ge(n,`Trade all ${l} resources for new ones`,l,null,i);if(!u){const c=`Player ${e.id}: Trade All  for   Cancelled`;n({type:"ADD_LOG",message:c});return}const f={};Object.keys(e.resources).forEach(c=>{e.resources[c]>0&&(f[c]=-e.resources[c])}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:u});const d=`Player ${e.id}: Trade All  for   Traded ${l} resources`;n({type:"ADD_LOG",message:d});return}if(t==="steal3Gems"){const u=r.players.filter(E=>E.id!==e.id);if(u.length===0){const E=`Player ${e.id}: ${t}  No other players to steal from`;n({type:"ADD_LOG",message:E});return}const f=u.filter(E=>Object.values(E.resources).some(_=>_>0)).map(E=>({label:`Player ${E.id} (${Object.entries(E.resources).filter(([,_])=>_>0).map(([_,h])=>`${h} ${_}`).join(", ")})`,value:E.id}));if(f.length===0){const E=`Player ${e.id}: ${t}  No players have resources to steal`;n({type:"ADD_LOG",message:E});return}const d=await ye(n,"Choose player to steal from",f,!1,i);if(!d){const E=`Player ${e.id}: ${t}  Cancelled`;n({type:"ADD_LOG",message:E});return}const c=u.find(E=>E.id===d),p=await ja(n,`Steal up to 3 resources from Player ${d}`,c,3,i);if(!p){const E=`Player ${e.id}: ${t}  Cancelled`;n({type:"ADD_LOG",message:E});return}const m=[];Object.entries(p).forEach(([E,_])=>{_>0&&(n({type:"UPDATE_RESOURCES",playerId:d,resources:{[E]:-_}}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[E]:_}}),m.push(`${_} ${E}`))});const g=`Player ${e.id}: ${t}  Stole ${m.join(", ")} from Player ${d}`;n({type:"ADD_LOG",message:g});return}if(t==="yellowHybrid1"){const l=await ge(n,"Choose 2 Resources ( Color)",2,null,i);if(!l){const d={yellow:2};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d}),n({type:"ADD_LOG",message:`Player ${e.id}: yellowHybrid1  +2 yellow (default)`});return}const u=l;if((e.effects||[]).some(d=>d.includes("Next gain will be doubled"))){Object.keys(u).forEach(c=>{u[c]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))});const d=`Player ${e.id}: yellowHybrid1  +${Object.entries(u).map(([c,p])=>`${p} ${c}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:d})}else{const d=`Player ${e.id}: yellowHybrid1  +${Object.entries(u).map(([c,p])=>`${p} ${c}`).join(", ")}`;n({type:"ADD_LOG",message:d})}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:u});return}if(t==="yellowHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{yellow:1}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Next gain will be doubled"});const l=`Player ${e.id}: yellowHybrid2  +1 yellow + next gain doubled`;n({type:"ADD_LOG",message:l});return}if(t==="yellowSwapResources"){const l=r.players.filter(d=>d.id!==e.id);if(l.length===0){const d=`Player ${e.id}: yellowSwapResources  No other players to swap with`;n({type:"ADD_LOG",message:d});return}const u=l.map(d=>({label:`Player ${d.id} (${Object.entries(d.resources).filter(([,c])=>c>0).map(([c,p])=>`${p} ${c}`).join(", ")||"no resources"})`,value:d.id})),f=await ye(n,"Choose player to swap all resources with",u,!1,i);if(f){const d=l.find(g=>g.id===f),c={...e.resources},p={...d.resources};n({type:"SET_RESOURCES",playerId:e.id,resources:p}),n({type:"SET_RESOURCES",playerId:f,resources:c});const m=`Player ${e.id}: yellowSwapResources  Swapped all resources with Player ${f}`;n({type:"ADD_LOG",message:m})}return}if(t==="blueR1ShopBenefit"){console.log("Executing blueR1ShopBenefit for player",e.id);const l=[],u=r.gameLayers?Object.keys(r.gameLayers):["red","yellow","blue","purple"];console.log("Available game layers:",u);const f={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""},d={red:"Red/Yellow",yellow:"Red/Yellow",blue:"Blue/Purple",purple:"Blue/Purple",gold:"Gold/White",white:"Gold/White",black:"Black/Silver",silver:"Black/Silver"};u.forEach(g=>{const E={red:{1:"Repeat a worker's action"},yellow:{1:"Double your next gain action"},blue:{1:"Toggle any shop (open/closed)"},purple:{1:"Take an extra turn after this one"},gold:{1:"1 Gold + 1  = 2 Gold"},white:{1:"Lose 1 VP, Gain 1 "},black:{1:"Steal 1 VP from another player"},silver:{1:"Gain 2 VP"}},_=d[g];l.push({label:`${g} R1: ${E[g][1]}`,shortLabel:`${f[g]} ${E[g][1]}`,value:{color:g,round:1},group:_})});const c=()=>{const g=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","blueR1ShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"];return Object.entries(r.occupiedSpaces).filter(([_,h])=>h===e.id&&!g.includes(_)).length>0},p=l.filter(g=>g.value.color==="red"&&g.value.round===1?c():!0);if(p.length===0){n({type:"ADD_LOG",message:`Player ${e.id}: No valid R1 shop benefits available`});return}const m=await ye(n,"Choose any R1 shop benefit (ignores closed status)",p,!0,i);m?(console.log("Player chose shop:",m.color,"R",m.round),await cc(m.color,m.round,e,n,r,o+1),n({type:"ADD_LOG",message:`Player ${e.id}: Executed ${m.color} R1 shop benefit`}),r.automaticVPs&&r.automaticVPs.blue&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (blue automatic VP for shop use)`}))):(console.log("Player cancelled R1 shop selection"),n({type:"ADD_LOG",message:`Player ${e.id}: Cancelled R1 shop benefit selection`}));return}if(t==="blueAnyShopBenefit"){console.log("Executing blueAnyShopBenefit for player",e.id);const l=[],u=r.gameLayers?Object.keys(r.gameLayers):["red","yellow","blue","purple"];console.log("Available game layers:",u);const f={red:{1:"Repeat a worker's action",2:"Place the next player's worker",3:"Repeat all actions taken this round"},yellow:{1:"Double your next gain action",2:"Gain 5 ",3:"Gain 7 "},blue:{1:"Close any shop this round",2:"Toggle the status of all shops",3:"Gain any shop benefit"},purple:{1:"Take an extra turn",2:"Play 2 more workers",3:"Play all remaining workers"},gold:{1:"1 gold + 1 any  2 gold",2:"2 gold + 2 any  4 gold",3:"3 gold + 3 any  2x gold"},white:{1:"Pay 1 VP  Gain 1 any gem",2:"Pay 3 VP  Skip next player",3:"Pay 5 VP  Move a worker"},black:{1:"Steal 1 VP from a player",2:"Steal 3 VP from a player",3:"Steal 5 VP from a player"},silver:{1:"Gain 2 VP",2:"Gain 4 VP, pick player for 4 VP",3:"Gain 7 silver, others get 2"}};u.forEach(c=>{const p=c.charAt(0).toUpperCase()+c.slice(1);l.push({label:`${c} R1: ${f[c][1]}`,shortLabel:`R1: ${f[c][1]}`,value:{color:c,round:1},group:p}),l.push({label:`${c} R2: ${f[c][2]}`,shortLabel:`R2: ${f[c][2]}`,value:{color:c,round:2},group:p}),c==="blue"&&t==="blueAnyShopBenefit"||l.push({label:`${c} R3: ${f[c][3]}`,shortLabel:`R3: ${f[c][3]}`,value:{color:c,round:3},group:p});const m={red:{cost:"5 red",vp:5},yellow:{cost:"5 ",vp:3},blue:{cost:"5 blue",vp:5},purple:{cost:"6 purple",vp:5},white:{cost:"4 white",vp:4},black:{cost:"6 black",vp:"Steal 2 from each"},silver:{cost:"6 silver",vp:8},gold:null};if(m[c]){const g=m[c];l.push({label:`Victory: ${typeof g.vp=="number"?g.vp+" VP":g.vp}`,shortLabel:`Victory: ${typeof g.vp=="number"?g.vp+" VP":g.vp}`,value:{color:c,round:"vp"},group:p})}});const d=await ye(n,"Choose any shop benefit (ignores closed status)",l,!0,i);if(d){if(d.round==="vp")if(d.color==="black")state.players.filter(p=>p.id!==e.id).forEach(p=>{const m=Math.min(2,p.victoryPoints);m>0&&(n({type:"UPDATE_VP",playerId:p.id,vp:-m,source:"blackSteal"}),n({type:"UPDATE_VP",playerId:e.id,vp:m,source:"blackSteal"}))}),n({type:"ADD_LOG",message:`Player ${e.id}: Black Victory shop  Stole 2 VP from each other player`});else{const p={red:5,yellow:3,blue:5,purple:5,white:4,silver:8}[d.color]||3;n({type:"UPDATE_VP",playerId:e.id,vp:p,source:"victoryShop"}),n({type:"ADD_LOG",message:`Player ${e.id}: ${d.color} Victory shop  +${p} VP`})}else console.log("Blue R3: About to execute shop benefit for",d.color,"R"+d.round),await cc(d.color,d.round,e,n,r,o+1),n({type:"ADD_LOG",message:`Player ${e.id}: Executed ${d.color} R${d.round} shop benefit`});n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (used a shop benefit)`})}return}if(t==="blueReduceCosts"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:1}}),n({type:"ADD_SHOP_COST_MODIFIER",playerId:e.id,modifier:-1});const l=`Player ${e.id}: blueReduceCosts  +1 blue + your shop costs reduced by 1 `;n({type:"ADD_LOG",message:l});return}if(t==="blueIncreaseCosts"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:2}}),r.players.forEach(u=>{u.id!==e.id&&n({type:"ADD_SHOP_COST_MODIFIER",playerId:u.id,modifier:2})});const l=`Player ${e.id}: blueIncreaseCosts  +2 blue, all other players' shop costs increased by 2 `;n({type:"ADD_LOG",message:l});return}if(t==="blueToggleShops"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:2}}),n({type:"FLIP_ALL_SHOPS"});const l=`Player ${e.id}: blueToggleShops  +2 blue + all shops toggled`;n({type:"ADD_LOG",message:l});return}if(t==="convert2AnyTo2Gold"){const l=r.players.find(p=>p.id===e.id);if(Object.entries(l.resources).filter(([p,m])=>p!=="gold"&&m>0).reduce((p,[m,g])=>p+g,0)<2){const p=`Player ${e.id}: convert2AnyTo2Gold  Need at least 2 gems`;n({type:"ADD_LOG",message:p});return}const f=await ge(n,"Choose 2 gems to convert to Gold",2,l,i);if(!f){const p=`Player ${e.id}: convert2AnyTo2Gold  Cancelled`;n({type:"ADD_LOG",message:p});return}const d={gold:2};Object.entries(f).forEach(([p,m])=>{d[p]=-m}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const c=`Player ${e.id}: convert2AnyTo2Gold  Converted 2 gems to 2 gold`;n({type:"ADD_LOG",message:c});return}if(t==="convert1AnyTo1Gold"){const l=r.players.find(p=>p.id===e.id);if(Object.entries(l.resources).filter(([p,m])=>p!=="gold"&&m>0).reduce((p,[m,g])=>p+g,0)<1){const p=`Player ${e.id}: convert1AnyTo1Gold  Need at least 1 gem`;n({type:"ADD_LOG",message:p});return}const f=await ge(n,"Choose 1 gem to convert to Gold",1,l,i);if(!f){const p=`Player ${e.id}: convert1AnyTo1Gold  Cancelled`;n({type:"ADD_LOG",message:p});return}const d={gold:1};Object.entries(f).forEach(([p,m])=>{d[p]=-m}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const c=`Player ${e.id}: convert1AnyTo1Gold  Converted 1 gem to 1 gold`;n({type:"ADD_LOG",message:c});return}if(t==="gain3goldSkip"){const l=(e.effects||[]).some(c=>c.includes("Next gain will be doubled"));let u=3;l&&(u*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{gold:u}});const f={...r.skippedTurns};f[e.id]=(f[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:f});const d=`Player ${e.id}: gain3goldSkip  +${u} gold${l?" (DOUBLED!)":""}, will skip next turn (total skips: ${f[e.id]})`;n({type:"ADD_LOG",message:d});return}if(t==="convert3AnyTo3Gold"){const l=r.players.find(p=>p.id===e.id);if(Object.entries(l.resources).filter(([p,m])=>p!=="gold"&&m>0).reduce((p,[m,g])=>p+g,0)<3){const p=`Player ${e.id}: convert3AnyTo3Gold  Need at least 3 gems`;n({type:"ADD_LOG",message:p});return}const f=await ge(n,"Choose 3 gems to convert to Gold",3,l,i);if(!f){const p=`Player ${e.id}: convert3AnyTo3Gold  Cancelled`;n({type:"ADD_LOG",message:p});return}const d={gold:3};Object.entries(f).forEach(([p,m])=>{d[p]=-m}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const c=`Player ${e.id}: convert3AnyTo3Gold  Converted 3 gems to 3 gold`;n({type:"ADD_LOG",message:c});return}if(t==="goldVPPerGold"){const u=r.players.find(f=>f.id===e.id).resources.gold||0;if(u>0){n({type:"UPDATE_VP",playerId:e.id,vp:u,source:"goldVPPerGold"});const f=`Player ${e.id}: goldVPPerGold  +${u} VP (1 per gold)`;n({type:"ADD_LOG",message:f})}else{const f=`Player ${e.id}: goldVPPerGold  No gold, no VP gained`;n({type:"ADD_LOG",message:f})}return}if(t==="gain3vp"){let l=3;if((e.effects||[]).some(f=>f.includes("Next gain will be doubled"))){l*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))});const f=`Player ${e.id}: gain3vp  +${l} VP (DOUBLED!)`;n({type:"ADD_LOG",message:f})}else{const f=`Player ${e.id}: gain3vp  +${l} VP`;n({type:"ADD_LOG",message:f})}n({type:"UPDATE_VP",playerId:e.id,vp:l,source:"whiteAction"});return}if(t==="gain2vp"){let l=2;if((e.effects||[]).some(f=>f.includes("Next gain will be doubled"))){l*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))});const f=`Player ${e.id}: gain2vp  +${l} VP (DOUBLED!)`;n({type:"ADD_LOG",message:f})}else{const f=`Player ${e.id}: gain2vp  +${l} VP`;n({type:"ADD_LOG",message:f})}n({type:"UPDATE_VP",playerId:e.id,vp:l,source:"whiteAction"});return}if(t==="spend1AnyFor2VP"){const l=r.players.find(p=>p.id===e.id);if(Object.values(l.resources).reduce((p,m)=>p+m,0)<1){const p=`Player ${e.id}: spend1AnyFor2VP  Need at least 1 gem`;n({type:"ADD_LOG",message:p});return}const f=await ge(n,"Choose 1 gem to spend for 2 VP",1,l,i);if(!f){const p=`Player ${e.id}: spend1AnyFor2VP  Cancelled`;n({type:"ADD_LOG",message:p});return}const d={};Object.entries(f).forEach(([p,m])=>{d[p]=-m}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d}),n({type:"UPDATE_VP",playerId:e.id,vp:2,source:"whiteAction"});const c=`Player ${e.id}: spend1AnyFor2VP  Spent 1 gem for 2 VP`;n({type:"ADD_LOG",message:c});return}if(t==="spend2AnyFor3VP"){const l=r.players.find(p=>p.id===e.id);if(Object.values(l.resources).reduce((p,m)=>p+m,0)<2){const p=`Player ${e.id}: spend2AnyFor3VP  Need at least 2 gems`;n({type:"ADD_LOG",message:p});return}const f=await ge(n,"Choose 2 gems to spend for 3 VP",2,l,i);if(!f){const p=`Player ${e.id}: spend2AnyFor3VP  Cancelled`;n({type:"ADD_LOG",message:p});return}const d={};Object.entries(f).forEach(([p,m])=>{d[p]=-m}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d}),n({type:"UPDATE_VP",playerId:e.id,vp:3,source:"whiteAction"});const c=`Player ${e.id}: spend2AnyFor3VP  Spent 2 gems for 3 VP`;n({type:"ADD_LOG",message:c});return}if(t==="lose1VPGain2Any"){if(e.victoryPoints<1){const c=`Player ${e.id}: lose1VPGain2Any  Need at least 1 VP`;n({type:"ADD_LOG",message:c});return}n({type:"UPDATE_VP",playerId:e.id,vp:-1,source:"whiteAction"});let l=2;const u=(e.effects||[]).some(c=>c.includes("Next gain will be doubled"));u&&(l*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))}));const f=await ge(n,`Choose ${l} gems to gain`,l,null,i);if(!f){const c={},p=r.gameLayers?Object.keys(r.gameLayers):["red","blue"];for(let g=0;g<l&&g<p.length;g++)c[p[g]]=(c[p[g]]||0)+1;n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});const m=`Player ${e.id}: lose1VPGain2Any  -1 VP, +${l} gems (default)${u?" (DOUBLED!)":""}`;n({type:"ADD_LOG",message:m});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});const d=`Player ${e.id}: lose1VPGain2Any  -1 VP, gained ${l} gems${u?" (DOUBLED!)":""}`;n({type:"ADD_LOG",message:d});return}if(t==="lose2VPGain4Any"){if(e.victoryPoints<2){const f=`Player ${e.id}: lose2VPGain4Any  Need at least 2 VP`;n({type:"ADD_LOG",message:f});return}n({type:"UPDATE_VP",playerId:e.id,vp:-2,source:"whiteAction"});const l=await ge(n,"Choose 4 gems to gain",4,null,i);if(!l){const f={red:1,yellow:1,blue:1,purple:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});const d=`Player ${e.id}: lose2VPGain4Any  -2 VP, +1 of each color (default)`;n({type:"ADD_LOG",message:d});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:l});const u=`Player ${e.id}: lose2VPGain4Any  -2 VP, gained 4 gems`;n({type:"ADD_LOG",message:u});return}if(t==="gain5VPAnd5Any"){n({type:"UPDATE_VP",playerId:e.id,vp:5,source:"whiteAction"});const l=await ge(n,"Choose 5 gems to gain",5);if(!l){const f={red:1,yellow:1,blue:1,purple:1,gold:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});const d=`Player ${e.id}: gain5VPAnd5Any  +5 VP, +1 of each color (default)`;n({type:"ADD_LOG",message:d});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:l});const u=`Player ${e.id}: gain5VPAnd5Any  +5 VP and 5 gems`;n({type:"ADD_LOG",message:u});return}if(t==="blackSteal1VP"){if(n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:1}}),r.players.filter(d=>d.id!==e.id).length===0){const d=`Player ${e.id}: blackSteal1VP  +1 black (no other players)`;n({type:"ADD_LOG",message:d});return}const u=await fr(n,"Choose a player to steal 1 VP from",r.players,e.id,i);if(!u){const d=`Player ${e.id}: blackSteal1VP  +1 black (cancelled)`;n({type:"ADD_LOG",message:d});return}n({type:"UPDATE_VP",playerId:u.id,vp:-1,source:"blackSteal"}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackSteal"});const f=`Player ${e.id}: blackSteal1VP  +1 black, stole 1 VP from Player ${u.id}`;n({type:"ADD_LOG",message:f}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackSteal2Any"){if(r.players.filter(g=>g.id===e.id?!1:Object.values(g.resources).reduce((_,h)=>_+h,0)>0).length===0){const g=`Player ${e.id}: blackSteal2Any  No players with gems to steal from`;n({type:"ADD_LOG",message:g});return}const u=await fr(n,"Choose a player to steal 2 gems from",r.players,e.id,i);if(!u){const g=`Player ${e.id}: blackSteal2Any  Cancelled`;n({type:"ADD_LOG",message:g});return}const f=Object.values(u.resources).reduce((g,E)=>g+E,0),d=Math.min(2,f);if(d===0){const g=`Player ${e.id}: blackSteal2Any  Player ${u.id} has no gems`;n({type:"ADD_LOG",message:g});return}const c=await ja(n,`Choose ${d} gems to steal from Player ${u.id}`,u,d,i);if(!c){const g=`Player ${e.id}: blackSteal2Any  Cancelled`;n({type:"ADD_LOG",message:g});return}const p={};Object.entries(c).forEach(([g,E])=>{p[g]=-E}),n({type:"UPDATE_RESOURCES",playerId:u.id,resources:p}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});const m=`Player ${e.id}: blackSteal2Any  Stole ${Object.entries(c).map(([g,E])=>`${E} ${g}`).join(", ")} from Player ${u.id}`;n({type:"ADD_LOG",message:m}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackStealWorker"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:1}});const l=4,u=r.players.filter(h=>h.id!==e.id);if(u.length===0){const h=`Player ${e.id}: blackStealWorker  +1 black (no other players to steal from)`;n({type:"ADD_LOG",message:h});return}const f=u.filter(h=>Object.values(h.resources).some(v=>v>0)).map(h=>({label:`Player ${h.id} (${Object.entries(h.resources).filter(([,v])=>v>0).map(([v,S])=>`${S} ${v}`).join(", ")})`,value:h.id}));if(f.length===0){const h=`Player ${e.id}: blackStealWorker  +1 black (no players have resources to steal)`;n({type:"ADD_LOG",message:h});return}const d=await ye(n,"Choose player to steal 4 resources from",f,!1,i);if(!d){const h=`Player ${e.id}: blackStealWorker  +1 black (cancelled)`;n({type:"ADD_LOG",message:h});return}const c=u.find(h=>h.id===d),p=Object.values(c.resources).reduce((h,v)=>h+v,0),m=Math.min(l,p),g=await ja(n,`Steal up to ${m} resources from Player ${d}`,c,m,i);if(!g){const h=`Player ${e.id}: blackStealWorker  +1 black (cancelled)`;n({type:"ADD_LOG",message:h});return}const E=[];Object.entries(g).forEach(([h,v])=>{v>0&&(n({type:"UPDATE_RESOURCES",playerId:d,resources:{[h]:-v}}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[h]:v}}),E.push(`${v} ${h}`))});const _=`Player ${e.id}: blackStealWorker  +1 black, stole ${E.join(", ")} from Player ${d}`;n({type:"ADD_LOG",message:_}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackAllLose2VP"){r.players.filter(f=>f.id!==e.id).forEach(f=>{n({type:"UPDATE_VP",playerId:f.id,vp:-2,source:"blackPenalty"})});const u=`Player ${e.id}: blackAllLose2VP  All other players lose 2 VP`;n({type:"ADD_LOG",message:u});return}if(t==="blackAllLose4VP"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:2}}),r.players.filter(f=>f.id!==e.id).forEach(f=>{n({type:"UPDATE_VP",playerId:f.id,vp:-4,source:"blackPenalty"})});const u=`Player ${e.id}: blackAllLose4VP  +2 black, all other players lose 4 VP`;n({type:"ADD_LOG",message:u});return}if(t==="silver4Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:4}}),r.players.filter(f=>f.id!==e.id).forEach(f=>{n({type:"UPDATE_RESOURCES",playerId:f.id,resources:{silver:1}})});const u=`Player ${e.id}: silver4Others1  +4 silver, all other players +1 silver`;n({type:"ADD_LOG",message:u});return}if(t==="silver3Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:3}}),r.players.filter(f=>f.id!==e.id).forEach(f=>{n({type:"UPDATE_RESOURCES",playerId:f.id,resources:{silver:1}})});const u=`Player ${e.id}: silver3Others1  +3 silver, all other players +1 silver`;n({type:"ADD_LOG",message:u});return}if(t==="silver2Plus1Others"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:2}});const l=await ge(n,"Choose 1 gem (others will get the same)",1,null,i,e.id);if(!l){const c={red:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c}),r.players.filter(g=>g.id!==e.id).forEach(g=>{n({type:"UPDATE_RESOURCES",playerId:g.id,resources:{red:1}})});const m=`Player ${e.id}: silver2Plus1Others  +2 silver +1 red, others +1 red`;n({type:"ADD_LOG",message:m});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:l});const u=Object.keys(l)[0];r.players.filter(c=>c.id!==e.id).forEach(c=>{n({type:"UPDATE_RESOURCES",playerId:c.id,resources:{[u]:1}})});const d=`Player ${e.id}: silver2Plus1Others  +2 silver +1 ${u}, others +1 ${u}`;n({type:"ADD_LOG",message:d});return}if(t==="silver2VPBoth"){n({type:"UPDATE_VP",playerId:e.id,vp:2,source:"silverAction"});const l=r.players.filter(d=>d.id!==e.id),u=await fr(n,"Choose a player to also gain 2 VP",r.players,e.id,i);if(!u){const d=l[0];if(d){n({type:"UPDATE_VP",playerId:d.id,vp:2,source:"silverAction"});const c=`Player ${e.id}: silver2VPBoth  +2 VP, Player ${d.id} +2 VP`;n({type:"ADD_LOG",message:c})}else{const c=`Player ${e.id}: silver2VPBoth  +2 VP (no other players)`;n({type:"ADD_LOG",message:c})}return}n({type:"UPDATE_VP",playerId:u.id,vp:2,source:"silverAction"});const f=`Player ${e.id}: silver2VPBoth  +2 VP, Player ${u.id} +2 VP`;n({type:"ADD_LOG",message:f});return}if(t==="silverTakeBack2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:2}});const l=Object.entries(r.occupiedSpaces||{}).filter(([c,p])=>p===e.id);let u=0;for(let c=0;c<Math.min(2,l.length);c++){const[p]=l[c];n({type:"REMOVE_WORKER",actionId:p,playerId:e.id}),u++}r.players.filter(c=>c.id!==e.id).forEach(c=>{const p=Object.entries(r.occupiedSpaces||{}).filter(([m,g])=>g===c.id);if(p.length>0){const[m]=p[0];n({type:"REMOVE_WORKER",actionId:m,playerId:c.id})}});const d=`Player ${e.id}: silverTakeBack2  +2 silver, took back ${u} workers, others took back 1`;n({type:"ADD_LOG",message:d});return}if(t==="silver3Plus2Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:3}});const l=await ge(n,"Choose 1 color to get 2 gems of (others will get 1 of that color)",1,null,i,e.id);if(!l){const c={red:2};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c}),r.players.filter(g=>g.id!==e.id).forEach(g=>{n({type:"UPDATE_RESOURCES",playerId:g.id,resources:{red:1}})});const m=`Player ${e.id}: silver3Plus2Others1  +3 silver +2 red, others +1 red`;n({type:"ADD_LOG",message:m});return}const u=Object.keys(l)[0];n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[u]:2}}),r.players.filter(c=>c.id!==e.id).forEach(c=>{n({type:"UPDATE_RESOURCES",playerId:c.id,resources:{[u]:1}})});const d=`Player ${e.id}: silver3Plus2Others1  +3 silver +2 ${u}, others +1 ${u}`;n({type:"ADD_LOG",message:d});return}if(t==="silver8VPOthers3S"){let l=8;const u=(e.effects||[]).some(c=>c.includes("Next gain will be doubled"));u&&(l*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),n({type:"UPDATE_VP",playerId:e.id,vp:l,source:"silverAction"}),r.players.filter(c=>c.id!==e.id).forEach(c=>{n({type:"UPDATE_RESOURCES",playerId:c.id,resources:{silver:3}})});const d=`Player ${e.id}: silver8VPOthers3S  +${l} VP${u?" (DOUBLED!)":""}, each other player +3 silver`;n({type:"ADD_LOG",message:d});return}console.log(`Player ${e.id} executed action: ${t}`)}function dC({isOpen:t,onClose:e,children:n}){return y.useEffect(()=>{if(t)return requestAnimationFrame(()=>{const r=window.innerWidth-document.documentElement.clientWidth;document.body.style.paddingRight=`${r}px`,document.documentElement.style.paddingRight=`${r}px`,document.body.classList.add("modal-open"),document.querySelectorAll('[style*="position: fixed"]').forEach(o=>{o.dataset.originalPadding=o.style.paddingRight||"",o.style.paddingRight=`${r}px`})}),()=>{document.body.classList.remove("modal-open"),document.body.style.paddingRight="",document.documentElement.style.paddingRight="",document.querySelectorAll('[style*="position: fixed"]').forEach(s=>{s.style.paddingRight=s.dataset.originalPadding||"",delete s.dataset.originalPadding})}},[t]),t?y.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-hidden",onClick:e},y.createElement("div",{className:"glass rounded-xl p-6 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto",onClick:r=>r.stopPropagation()},n)):null}function fC({title:t,options:e,onSelect:n,onCancel:r,columnMode:s=!1}){const{dispatch:o}=Ge(),i=l=>{o({type:"HIDE_MODAL"}),n(l)},a=()=>{o({type:"HIDE_MODAL"}),r&&r()};if(s&&e.some(l=>l.group)){const l=e.reduce((f,d)=>{const c=d.group||"Other";return f[c]||(f[c]=[]),f[c].push(d),f},{}),u={"Red/Yellow":"from-red-400 to-yellow-400","Blue/Purple":"from-blue-400 to-purple-400","Gold/White":"from-yellow-500 to-gray-100","Black/Silver":"from-gray-800 to-gray-400","Red Quad":"from-red-400 to-red-500","Yellow Quad":"from-yellow-400 to-yellow-500","Blue Quad":"from-blue-400 to-blue-500","Purple Quad":"from-purple-400 to-purple-500","Gold Quad":"from-yellow-500 to-yellow-600","White Quad":"from-gray-100 to-gray-200","Black Quad":"from-gray-800 to-gray-900","Silver Quad":"from-gray-400 to-gray-500"};return y.createElement("div",{className:"text-center"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-4"},t),y.createElement("div",{key:"columns",className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 max-h-96 overflow-y-auto"},Object.entries(l).map(([f,d])=>y.createElement("div",{key:f,className:"space-y-2"},[y.createElement("h4",{key:"header",className:`text-sm font-bold text-gray-700 mb-2 p-1 rounded bg-gradient-to-r ${u[f]||"from-gray-200 to-gray-300"}`},f),...d.map((c,p)=>y.createElement("button",{key:`${f}-${p}`,onClick:()=>i(c.value||c),className:"w-full text-xs bg-gradient-to-r from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 text-gray-800 font-semibold py-1 px-2 rounded-md shadow-sm hover:shadow-md transform hover:scale-105 transition-all duration-200 text-left",title:c.label||c},c.label||c.shortLabel||c))]))),y.createElement("button",{key:"cancel",onClick:a,className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel")])}return y.createElement("div",{className:"text-center"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-4"},t),y.createElement("div",{key:"options",className:"space-y-2 mb-6"},e.map((l,u)=>y.createElement("button",{key:u,onClick:()=>i(l.value||l),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},l.label||l))),y.createElement("button",{key:"cancel",onClick:a,className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel")])}function hC({title:t,message:e,onConfirm:n,onCancel:r}){const{dispatch:s}=Ge(),o=()=>{s({type:"HIDE_MODAL"}),n()},i=()=>{s({type:"HIDE_MODAL"}),r&&r()};return y.createElement("div",{className:"text-center"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),y.createElement("p",{key:"message",className:"text-gray-600 mb-6"},e),y.createElement("div",{key:"buttons",className:"flex gap-3"},[y.createElement("button",{key:"cancel",onClick:i,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),y.createElement("button",{key:"confirm",onClick:o,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Confirm")])])}function pC({round:t,players:e}){const{state:n,dispatch:r}=Ge(),s=()=>{r({type:"HIDE_MODAL"}),r({type:"ADVANCE_ROUND"})},o=a=>Object.entries(a.resources).filter(([l,u])=>u>0).map(([l,u])=>`${u}${{red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""}[l]}`).join(" "),i=[...e].sort((a,l)=>l.victoryPoints-a.victoryPoints);return y.createElement("div",{className:"text-center max-w-2xl"},[y.createElement("h2",{key:"title",className:"text-3xl font-bold text-gray-800 mb-6"},`Starting Round ${t}`),y.createElement("h3",{key:"subtitle",className:"text-xl font-semibold text-gray-700 mb-4"},"Current Standings"),y.createElement("div",{key:"players",className:"space-y-3 mb-6"},i.map((a,l)=>y.createElement("div",{key:a.id,className:`p-4 rounded-lg ${l===0?"bg-yellow-100 border-2 border-yellow-400":"bg-gray-100"}`},[y.createElement("div",{key:"header",className:"flex items-center justify-between mb-2"},[y.createElement("div",{key:"name",className:"flex items-center gap-2"},[y.createElement("span",{key:"emoji",className:"text-2xl"},a.emoji||""),y.createElement("span",{key:"text",className:"font-semibold text-lg"},a.name||`Player ${a.id}`),l===0&&y.createElement("span",{key:"crown",className:"text-xl"},"")]),y.createElement("div",{key:"vp",className:"text-xl font-bold text-green-600"},`${a.victoryPoints} VP`)]),y.createElement("div",{key:"resources",className:"text-sm text-gray-600"},o(a)||"No resources")]))),y.createElement("button",{key:"close",onClick:s,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200"},"Continue to Round "+t)])}function mC({title:t,maxGems:e,onSelect:n,onCancel:r,availableResources:s}){const{state:o,dispatch:i}=Ge(),[a,l]=y.useState({}),[u,f]=y.useState(0),d=o.gameLayers?Object.keys(o.gameLayers):["red","yellow","blue","purple"];y.useEffect(()=>{const h={};d.forEach(v=>{h[v]=0}),l(h)},[]);const c={red:{emoji:"",gradient:"from-red-500 to-red-600"},yellow:{emoji:"",gradient:"from-yellow-400 to-yellow-500"},blue:{emoji:"",gradient:"from-blue-500 to-blue-600"},purple:{emoji:"",gradient:"from-purple-500 to-purple-600"},gold:{emoji:"",gradient:"from-yellow-600 to-yellow-700"},white:{emoji:"",gradient:"from-gray-200 to-gray-300"},black:{emoji:"",gradient:"from-gray-700 to-gray-900"},silver:{emoji:"",gradient:"from-gray-400 to-gray-500"}},p=d.map(h=>({color:h,emoji:c[h].emoji,gradient:c[h].gradient})),m=h=>{const v=a[h]||0,S=s?s[h]||0:1/0;if(u<e&&v<S){const P={...a,[h]:a[h]+1},k=u+1;l(P),f(k),k===e&&setTimeout(()=>{i({type:"HIDE_MODAL"}),n(P)},300)}},g=h=>{a[h]>0&&(l({...a,[h]:a[h]-1}),f(u-1))},E=()=>{i({type:"HIDE_MODAL"}),n(a)},_=()=>{i({type:"HIDE_MODAL"}),r&&r()};return y.createElement("div",{className:"text-center"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),y.createElement("p",{key:"progress",className:"text-gray-600 mb-4"},`Selected: ${u}/${e}`),y.createElement("div",{key:"gem-grid",className:"grid grid-cols-4 gap-4 mb-4"},p.map(({color:h,emoji:v,gradient:S})=>{const P=a[h]||0,k=s?s[h]||0:1/0,T=u<e&&P<k;return y.createElement("div",{key:h,className:"text-center"},[y.createElement("button",{key:`${h}-button`,onClick:()=>m(h),disabled:!T,className:`w-16 h-16 rounded-lg bg-gradient-to-r ${S} ${T?"hover:scale-110":"opacity-50 cursor-not-allowed"} transition-all duration-200 flex items-center justify-center text-2xl shadow-lg relative`},[y.createElement("span",{key:"emoji"},v),s&&k>0&&y.createElement("span",{key:"count",className:"absolute -bottom-2 right-0 bg-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md"},k-P)]),y.createElement("div",{key:`${h}-count`,className:"mt-2 font-semibold text-gray-700"},a[h]>0?`${a[h]}`:"")])})),u>0&&y.createElement("div",{key:"selected-display",className:"mb-4 p-3 bg-gray-100 rounded-lg"},[y.createElement("p",{key:"selected-label",className:"text-sm text-gray-600 mb-2"},"Selected gems:"),y.createElement("div",{key:"selected-gems",className:"flex justify-center gap-2 flex-wrap"},Object.entries(a).flatMap(([h,v])=>Array(v).fill(null).map((S,P)=>{const k=p.find(T=>T.color===h);return y.createElement("button",{key:`${h}-${P}`,onClick:()=>g(h),className:"text-xl hover:scale-125 transition-transform cursor-pointer",title:"Click to remove"},k.emoji)})))]),y.createElement("div",{key:"buttons",className:"flex gap-3"},[y.createElement("button",{key:"cancel",onClick:_,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),y.createElement("button",{key:"confirm",onClick:E,disabled:u===0,className:`flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 ${u===0?"opacity-50 cursor-not-allowed":""}`},"Confirm")])])}function gC({title:t,targetPlayer:e,maxGems:n,onSelect:r,onCancel:s}){const{state:o,dispatch:i}=Ge(),[a,l]=y.useState({}),[u,f]=y.useState(0),d=o.gameLayers?Object.keys(o.gameLayers):["red","yellow","blue","purple"];y.useEffect(()=>{const h={};d.forEach(v=>{h[v]=0}),l(h)},[]);const c={red:{emoji:"",gradient:"from-red-500 to-red-600"},yellow:{emoji:"",gradient:"from-yellow-400 to-yellow-500"},blue:{emoji:"",gradient:"from-blue-500 to-blue-600"},purple:{emoji:"",gradient:"from-purple-500 to-purple-600"},gold:{emoji:"",gradient:"from-yellow-600 to-yellow-700"},white:{emoji:"",gradient:"from-gray-200 to-gray-300"},black:{emoji:"",gradient:"from-gray-700 to-gray-900"},silver:{emoji:"",gradient:"from-gray-400 to-gray-500"}},p=d.map(h=>({color:h,emoji:c[h].emoji,gradient:c[h].gradient})),m=h=>{const v=e.resources[h]||0,S=a[h];if(u<n&&S<v){const P={...a,[h]:a[h]+1},k=u+1;l(P),f(k),k===n&&setTimeout(()=>{i({type:"HIDE_MODAL"}),r(P)},300)}},g=h=>{a[h]>0&&(l({...a,[h]:a[h]-1}),f(u-1))},E=()=>{i({type:"HIDE_MODAL"}),r(a)},_=()=>{i({type:"HIDE_MODAL"}),s&&s()};return y.createElement("div",{className:"text-center"},[y.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),y.createElement("p",{key:"target",className:"text-gray-600 mb-2"},`Stealing from Player ${e.id}`),y.createElement("p",{key:"progress",className:"text-gray-600 mb-4"},`Selected: ${u}/${n}`),y.createElement("div",{key:"available-label",className:"text-sm text-gray-600 mb-2"},"Available gems:"),y.createElement("div",{key:"gem-grid",className:"grid grid-cols-4 gap-4 mb-4"},p.map(({color:h,emoji:v,gradient:S})=>{const P=e.resources[h]||0,k=a[h],T=P-k,A=u<n&&T>0;return y.createElement("div",{key:h,className:"text-center"},[y.createElement("button",{key:`${h}-button`,onClick:()=>m(h),disabled:!A,className:`w-16 h-16 rounded-lg bg-gradient-to-r ${S} ${A?"hover:scale-110":"opacity-50 cursor-not-allowed"} transition-all duration-200 flex items-center justify-center text-2xl shadow-lg relative`},[y.createElement("span",{key:"emoji"},v),P>0&&y.createElement("span",{key:"count",className:"absolute -top-2 -right-2 bg-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md"},P)]),y.createElement("div",{key:`${h}-info`,className:"mt-2 text-sm text-gray-700"},k>0?`Taking ${k}`:T>0?`${T} left`:"None")])})),u>0&&y.createElement("div",{key:"selected-display",className:"mb-4 p-3 bg-gray-100 rounded-lg"},[y.createElement("p",{key:"selected-label",className:"text-sm text-gray-600 mb-2"},"Gems to steal:"),y.createElement("div",{key:"selected-gems",className:"flex justify-center gap-2 flex-wrap"},Object.entries(a).flatMap(([h,v])=>Array(v).fill(null).map((S,P)=>{const k=p.find(T=>T.color===h);return y.createElement("button",{key:`${h}-${P}`,onClick:()=>g(h),className:"text-xl hover:scale-125 transition-transform cursor-pointer",title:"Click to remove"},k.emoji)})))]),y.createElement("div",{key:"buttons",className:"flex gap-3"},[y.createElement("button",{key:"cancel",onClick:_,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),y.createElement("button",{key:"confirm",onClick:E,disabled:u===0,className:`flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 ${u===0?"opacity-50 cursor-not-allowed":""}`},"Confirm")])])}function ye(t,e,n,r=!1,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"choice",title:e,options:n,columnMode:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}function yC(t,e,n,r=null){return new Promise(s=>{t({type:"SHOW_MODAL",modal:{type:"confirm",title:e,message:n,onConfirm:()=>s(!0),onCancel:()=>{r&&t({type:"UNDO_LAST_WORKER",...r}),s(!1)}}})})}function ge(t,e,n,r,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"gemSelection",title:e,maxGems:n,availableResources:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}function ja(t,e,n,r,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"stealGems",title:e,targetPlayer:n,maxGems:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}async function fr(t,e,n,r,s=null){const o=n.filter(l=>l.id!==r);if(o.length===0)return null;const i=o.map(l=>{const u=Object.entries(l.resources).filter(([,f])=>f>0).map(([f,d])=>`${d} ${f}`).join(", ")||"no resources";return{label:`${l.name||`Player ${l.id}`} ${l.emoji||""} (${u}, ${l.victoryPoints||0} VP)`,value:l.id}}),a=await ye(t,e,i,!1,s);return a?n.find(l=>l.id===a):null}function _C({onEndTurn:t}){const{state:e,dispatch:n}=Ge(),r=e.players.find(l=>l.id===e.currentPlayer),s=()=>"End Turn",o=r&&r.workersLeft===0,i=!e.workerPlacedThisTurn&&!o,a=e.workersToPlace===0&&e.workerPlacedThisTurn;return y.createElement("div",{className:"mt-3 text-center"},y.createElement("button",{onClick:t,disabled:i,className:`w-full font-bold py-2 px-4 rounded-lg shadow-lg transition-all duration-200 ${i?"bg-gray-400 text-gray-200 cursor-not-allowed":a?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white hover:shadow-xl transform hover:scale-105 animate-pulse":"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white hover:shadow-xl transform hover:scale-105"}`},s()))}async function P_(t,e,n,r,s=0){const o=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","blueR1ShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"],i=Object.entries(n.occupiedSpaces).filter(([a,l])=>l===t.id&&!o.includes(a)).map(([a])=>a);if(i.length===0){const a=`Player ${t.id}: Red shop  No valid workers to repeat (swap/repeat actions excluded)`;return e({type:"ADD_LOG",message:a}),!1}if(i.length>=1){const a=i.map(u=>{let f=u;for(const d of Object.values(r)){const c=d.actions.find(p=>p.id===u);if(c){f=c.title;break}}return{label:`Repeat: ${f}`,value:u}}),l=await ye(e,"Choose an action to repeat",a);if(l){let u=l;for(const p of Object.values(r)){const m=p.actions.find(g=>g.id===l);if(m){u=m.title;break}}const f=`Player ${t.id}: Red shop  Repeating ${u}`;e({type:"ADD_LOG",message:f}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"redAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP for red action`});const d=n.players.find(p=>p.id===t.id),c={...n,players:n.players.map(p=>p.id===t.id?d:p)};return await vt(l,d,e,c,r,s+1),!0}}return!1}async function vC(t,e,n){console.log("executeYellow3Shop - Starting for player",t.id);const r=await ge(e,"Choose 7 gems of any color",7);if(!r){const l=`Player ${t.id}: Yellow R3 shop  Cancelled`;e({type:"ADD_LOG",message:l});return}console.log("executeYellow3Shop - Player",t.id,"selected gems:",r);const s=(t.effects||[]).some(l=>l.includes("Next gain will be doubled"));let o={...r};s&&(Object.keys(o).forEach(l=>{o[l]*=2}),e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(l=>!l.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=Object.values(o).reduce((l,u)=>l+u,0),a=`Player ${t.id}: Yellow R3 shop  Gained ${i} gems${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:a})}async function wC(t,e,n){console.log("executeYellow2Shop - Starting for player",t.id);const r=await ge(e,"Choose 5 gems of any color",5);if(!r){const l=`Player ${t.id}: Yellow R2 shop  Cancelled`;e({type:"ADD_LOG",message:l});return}console.log("executeYellow2Shop - Player",t.id,"selected gems:",r);const s=(t.effects||[]).some(l=>l.includes("Next gain will be doubled"));let o={...r};s&&(Object.keys(o).forEach(l=>{o[l]*=2}),e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(l=>!l.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=Object.values(o).reduce((l,u)=>l+u,0),a=`Player ${t.id}: Yellow R2 shop  Gained ${i} gems${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:a})}async function EC(t,e,n){const r=[],s=n.gameLayers?Object.keys(n.gameLayers):["red","yellow","blue","purple"],o={red:{1:"Repeat a worker's action",2:"Place the next player's worker",3:"Repeat all actions taken this round"},yellow:{1:"Double your next gain action",2:"Gain 5",3:"Gain 7"},blue:{1:"Toggle any shop (open/closed)",2:"Toggle all shop statuses",3:"Gain any shop benefit"},purple:{1:"Take an extra turn",2:"Play 2 more workers this turn",3:"Play all remaining workers"},gold:{1:"1 Gold + 1 Any = 2 Gold",2:"2 Gold + 2 Any = 4 Gold",3:"3 Gold + 3 Any = Double Your Gold"},white:{1:"Lose 1 VP, Gain 1 ",2:"Lose 3 VP, Skip next player's turn",3:"Lose 5 VP, Move worker to action"},black:{1:"Steal 1 VP from another player",2:"Steal 3 VP from another player",3:"Steal 5 VP from another player"},silver:{1:"Gain 2 VP",2:"Gain 4 VP, Pick Another Player to Gain 4 VP",3:"Gain 7 Silver, Each Other Player Gains 2 Silver"}},i={red:{1:"1+2",2:"2+2",3:"4+4"},yellow:{1:"1+1",2:"2+2",3:"3+3"},blue:{1:"1+1",2:"2+2",3:"3+3"},purple:{1:"1+2",2:"2+2",3:"3+3"},gold:{1:"1+1",2:"2+2",3:"3+3"},white:{1:"1VP",2:"2VP",3:"3VP"},black:{1:"1+1",2:"2+2",3:"3+3"},silver:{1:"1+1",2:"2+2",3:"3+3"}},a={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""},l={red:"Red Quad",yellow:"Yellow Quad",blue:"Blue Quad",purple:"Purple Quad",gold:"Gold Quad",white:"White Quad",black:"Black Quad",silver:"Silver Quad"};s.forEach(f=>{const d=l[f]||f,c=n.closedShops[`${f}1`];n.round>=1,r.push({label:`${a[f]} R1 ${c?"(Closed)":"(Open)"}: ${o[f][1]} - Cost: ${i[f][1]}`,shortLabel:`${c?"":""} R1: ${i[f][1]}`,value:`${f}1`,group:d});const p=n.closedShops[`${f}2`],m=n.round>=2;r.push({label:`${a[f]} R2 ${p?"(Closed)":"(Open)"}: ${o[f][2]} - Cost: ${i[f][2]}${m?"":" (Available Round 2)"}`,shortLabel:`${p?"":""} R2: ${i[f][2]}`,value:`${f}2`,group:d});const g=n.closedShops[`${f}3`],E=n.round>=3;r.push({label:`${a[f]} R3 ${g?"(Closed)":"(Open)"}: ${o[f][3]} - Cost: ${i[f][3]}${E?"":" (Available Round 3)"}`,shortLabel:`${g?"":""} R3: ${i[f][3]}`,value:`${f}3`,group:d});const _=n.closedShops[`${f}vp`],h=f==="purple"?"4":f==="yellow"?"4":`4${f==="red"?"":""}`,v=f==="yellow"?"3":"5";r.push({label:`${_?"Closed":"Open"} ${h} - ${v} Victory Points`,shortLabel:`${_?"":""} VP: ${h}`,value:`${f}vp`,group:d})});const u=await ye(e,"Choose a shop to toggle (Closed/Open)",r,!0);u&&(n.closedShops[u]?(e({type:"OPEN_SHOP",shopId:u}),e({type:"ADD_LOG",message:`Player ${t.id}: Opened ${u} shop`})):(e({type:"CLOSE_SHOP",shopId:u}),e({type:"ADD_LOG",message:`Player ${t.id}: Closed ${u} shop`})))}async function SC(t,e,n,r=0){await vt("blueAnyShopBenefit",t,e,n,n.gameLayers,r)}async function PC(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((d,c)=>d+c,0);if(r<1||s<2){const d=`Player ${t.id}: Gold R1 shop  Need 1 gold + 1  resource`;e({type:"ADD_LOG",message:d});return}const o=Object.entries(t.resources).filter(([d,c])=>d!=="gold"&&c>0).reduce((d,[,c])=>d+c,0);let i;if(o===0&&r>=2)i={gold:1};else if(i=await ge(e,"Choose 1  resource to pay",1,t),!i){const d=`Player ${t.id}: Gold R1 shop  Cancelled`;e({type:"ADD_LOG",message:d});return}const a={gold:-1};Object.entries(i).forEach(([d,c])=>{a[d]=a[d]?a[d]-c:-c}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:a});const l=(t.effects||[]).some(d=>d.includes("Next gain will be doubled"));let u=2;l&&(u*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:u}});const f=`Player ${t.id}: Gold R1 shop  Paid 1 gold + 1 resource, gained ${u} gold${l?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:f})}async function kC(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((f,d)=>f+d,0);if(r<2||s<4){const f=`Player ${t.id}: Gold R2 shop  Need 2 gold + 2  resources`;e({type:"ADD_LOG",message:f});return}const o=await ge(e,"Choose 2  resources to pay",2,t);if(!o){const f=`Player ${t.id}: Gold R2 shop  Cancelled`;e({type:"ADD_LOG",message:f});return}const i={gold:-2};Object.entries(o).forEach(([f,d])=>{i[f]=i[f]?i[f]-d:-d}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:i});const a=(t.effects||[]).some(f=>f.includes("Next gain will be doubled"));let l=4;a&&(l*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(f=>!f.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:l}});const u=`Player ${t.id}: Gold R2 shop  Paid 2 gold + 2 resources, gained ${l} gold${a?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:u})}async function CC(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((d,c)=>d+c,0);if(r<3||s<6){const d=`Player ${t.id}: Gold R3 shop  Need 3 gold + 3  resources`;e({type:"ADD_LOG",message:d});return}const o=await ge(e,"Choose 3  resources to pay",3,t);if(!o){const d=`Player ${t.id}: Gold R3 shop  Cancelled`;e({type:"ADD_LOG",message:d});return}const i={gold:-3};Object.entries(o).forEach(([d,c])=>{i[d]=i[d]?i[d]-c:-c}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:i});const a=(t.effects||[]).some(d=>d.includes("Next gain will be doubled"));let l=r*2;a&&(l*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:l}});const u=r-3+l,f=`Player ${t.id}: Gold R3 shop  Paid 3 gold + 3 resources, gold went from ${r} to ${u}${a?" (DOUBLE DOUBLED!)":""}`;e({type:"ADD_LOG",message:f})}async function TC(t,e,n){if(t.victoryPoints<1){const a=`Player ${t.id}: White R1 shop  Need at least 1 VP`;e({type:"ADD_LOG",message:a});return}e({type:"UPDATE_VP",playerId:t.id,vp:-1,source:"whiteShop"});let r=1;const s=(t.effects||[]).some(a=>a.includes("Next gain will be doubled"));s&&(r*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(a=>!a.includes("Next gain will be doubled"))}));const o=await ge(e,`Choose ${r} gem${r>1?"s":""} to gain`,r);if(!o){const a={red:r};e({type:"UPDATE_RESOURCES",playerId:t.id,resources:a});const l=`Player ${t.id}: White R1 shop  -1 VP, +${r} red (default)${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:l});return}e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=`Player ${t.id}: White R1 shop  -1 VP, gained ${r} gem${r>1?"s":""}${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:i})}async function bC(t,e,n){if(t.victoryPoints<3){const l=`Player ${t.id}: White R2 shop  Need at least 3 VP`;e({type:"ADD_LOG",message:l});return}e({type:"UPDATE_VP",playerId:t.id,vp:-3,source:"whiteShop"});const s=(n.turnOrder.indexOf(n.currentPlayer)+n.turnDirection+n.turnOrder.length)%n.turnOrder.length,o=n.turnOrder[s],i={...n.skippedTurns};i[o]=(i[o]||0)+1,e({type:"SET_SKIPPED_TURNS",skippedTurns:i});const a=`Player ${t.id}: White R2 shop  -2 VP, Player ${o} will skip next turn`;e({type:"ADD_LOG",message:a})}async function AC(t,e,n){if(t.victoryPoints<3){const d=`Player ${t.id}: White R3 shop  Need at least 3 VP`;e({type:"ADD_LOG",message:d});return}const r=Object.entries(n.occupiedSpaces).filter(([d,c])=>c===t.id).map(([d])=>d);if(r.length===0){const d=`Player ${t.id}: White R3 shop  No workers to move`;e({type:"ADD_LOG",message:d});return}const s=r.map(d=>{let c=d;for(const[p,m]of Object.entries(n.gameLayers||{})){const g=m.actions.find(E=>E.id===d);if(g){c=`${p} - ${g.title}`;break}}return{label:c,value:d}}),o=await ye(e,"Choose a worker to move",s);if(!o)return;const i=[];if(Object.entries(n.gameLayers||{}).forEach(([d,c])=>{c.actions.forEach(p=>{p.round<=n.round&&!n.occupiedSpaces[p.id]&&i.push({label:`${d} - ${p.title}`,value:p.id,color:d})})}),i.length===0){const d=`Player ${t.id}: White R3 shop  No unclaimed actions available`;e({type:"ADD_LOG",message:d});return}const a=await ye(e,"Choose an unclaimed action to move to",i);if(!a)return;e({type:"UPDATE_VP",playerId:t.id,vp:-3,source:"whiteShop"});const l={...n.occupiedSpaces};delete l[o],l[a]=t.id,e({type:"UPDATE_OCCUPIED_SPACES",occupiedSpaces:l});const u={...n,occupiedSpaces:l};await vt(a,t,e,u,n.gameLayers,0);const f=`Player ${t.id}: White R3 shop  -3 VP, moved worker to ${a}`;e({type:"ADD_LOG",message:f})}async function DC(t,e,n){if(n.players.filter(o=>o.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  No other players`});return}const s=await fr(e,"Choose a player to steal 1 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  Cancelled`});return}e({type:"UPDATE_VP",playerId:s.id,vp:-1,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  Stole 1 VP from Player ${s.id}`}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function xC(t,e,n){if(n.players.filter(i=>i.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  No other players`});return}const s=await fr(e,"Choose a player to steal 3 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  Cancelled`});return}const o=Math.min(3,s.victoryPoints);e({type:"UPDATE_VP",playerId:s.id,vp:-o,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:o,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  Stole ${o} VP from Player ${s.id}`}),n.roomCode&&e({type:"ADD_NOTIFICATION",notification:{type:"steal",icon:"",title:"VP Stolen!",message:`${t.name||`Player ${t.id}`} stole ${o} VP from you`,forPlayer:s.id}}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function OC(t,e,n){if(n.players.filter(i=>i.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  No other players`});return}const s=await fr(e,"Choose a player to steal 5 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  Cancelled`});return}const o=Math.min(5,s.victoryPoints);e({type:"UPDATE_VP",playerId:s.id,vp:-o,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:o,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  Stole ${o} VP from Player ${s.id}`}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function RC(t,e,n){e({type:"UPDATE_VP",playerId:t.id,vp:4,source:"silverShop"});const r=n.players.filter(o=>o.id!==t.id);if(r.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP (no other players)`});return}if(r.length===1){const o=r[0];e({type:"UPDATE_VP",playerId:o.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${o.id} +4 VP`});return}const s=await fr(e,"Choose a player to give 4 VP",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP (gift cancelled)`});return}if(n.roomCode&&s.id!==t.id){const o=`${t.name||`Player ${t.id}`} ${t.emoji||""}`;await ye(e,`${o} wants to give you 4 VP! `,[{label:"Graciously Accept (+4 VP)",value:!0},{label:"Politely Decline",value:!1}],!1,null,s.id)?(e({type:"UPDATE_VP",playerId:s.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${s.id} accepted +4 VP gift! `})):e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${s.id} declined the gift`})}else e({type:"UPDATE_VP",playerId:s.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, gave Player ${s.id} +4 VP`})}async function NC(t,e,n){const r=(t.effects||[]).some(i=>i.includes("Next gain will be doubled"));let s=7;r&&(s*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(i=>!i.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{silver:s}}),n.players.filter(i=>i.id!==t.id).forEach(i=>{e({type:"UPDATE_RESOURCES",playerId:i.id,resources:{silver:2}})}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R3 shop  +${s} silver${r?" (DOUBLED!)":""}, all other players +2 silver`})}async function cc(t,e,n,r,s,o=0){const i=`${t}${e}`;switch(i){case"red1":if(!await P_(n,r,s,s.gameLayers,o))return!1;break;case"red2":await IC(n,r,s);break;case"red3":await LC(n,r,s,o);break;case"yellow1":r({type:"ADD_EFFECT",playerId:n.id,effect:"Next gain will be doubled"}),r({type:"ADD_LOG",message:`Player ${n.id}: Yellow R1 shop  Next gain will be doubled`});break;case"yellow2":await wC(n,r);break;case"yellow3":await vC(n,r);break;case"blue1":await EC(n,r,s),r({type:"ADD_LOG",message:`Player ${n.id}: Blue R1 shop  Toggle any shop (open/closed)`});break;case"blue2":r({type:"FLIP_ALL_SHOPS",playerId:n.id,playerName:n.name}),r({type:"ADD_LOG",message:`Player ${n.id}: Blue R2 shop  All shops toggled!`});break;case"blue3":await SC(n,r,s);break;case"purple1":r({type:"ADD_EFFECT",playerId:n.id,effect:"Will take an extra turn after this one"}),r({type:"UPDATE_PLAYER",playerId:n.id,updates:{extraTurns:(n.extraTurns||0)+1}}),r({type:"ADD_LOG",message:`Player ${n.id}: Purple R1 shop  Will take an extra turn after this one`});break;case"purple2":const l=n.workersLeft,u=Math.min(2,l);if(u===0){r({type:"ADD_LOG",message:`Player ${n.id}: Purple R2 shop  No workers left to place`});break}r({type:"ADD_WORKERS_TO_PLACE",count:u}),r({type:"ADD_EFFECT",playerId:n.id,effect:`Can place ${u} more worker${u>1?"s":""} this turn`}),r({type:"ADD_LOG",message:`Player ${n.id}: Can place ${u} more worker${u>1?"s":""}${u<2?" (limited by available workers)":""} this turn!`});break;case"purple3":const f=n.workersLeft;f>0&&(r({type:"ADD_WORKERS_TO_PLACE",count:f}),r({type:"ADD_EFFECT",playerId:n.id,effect:`Can place ${f} more workers this turn`}),r({type:"ADD_LOG",message:`Player ${n.id}: Can place all ${f} remaining workers!`}));break;case"gold1":await PC(n,r);break;case"gold2":await kC(n,r);break;case"gold3":await CC(n,r);break;case"white1":await TC(n,r);break;case"white2":await bC(n,r,s);break;case"white3":await AC(n,r,s);break;case"black1":await DC(n,r,s);break;case"black2":await xC(n,r,s);break;case"black3":await OC(n,r,s);break;case"silver1":r({type:"UPDATE_VP",playerId:n.id,vp:2,source:"silverShop"}),r({type:"ADD_LOG",message:`Player ${n.id}: Silver R1 shop benefit  +2 VP`});break;case"silver2":await RC(n,r,s);break;case"silver3":await NC(n,r,s);break;default:r({type:"ADD_LOG",message:`Player ${n.id}: Shop benefit ${i} not implemented yet`})}return!0}async function IC(t,e,n){let s=n.turnOrder.indexOf(t.id),o=null,i=null,a=0,l=n.turnDirection;for(;!o&&a<n.players.length;){s=s+l,l===1&&s>=n.turnOrder.length?(l=-1,s=n.turnOrder.length-1):l===-1&&s<0&&(l=1,s=0),i=n.turnOrder[s];const d=n.players.find(c=>c.id===i);if(d&&d.workersLeft>0&&(!n.skippedTurns||n.skippedTurns[i]===0)){o=d;break}a++}if(!o){e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  No players with workers remaining in turn order`});return}const u=[];if(Object.entries(n.gameLayers||{}).forEach(([d,c])=>{c.actions.forEach(p=>{p.round<=n.round&&!n.occupiedSpaces[p.id]&&u.push({label:`${d} - ${p.title}`,value:p.id,color:d})})}),u.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  No available actions`});return}const f=await ye(e,`Choose where to place Player ${i}'s worker (they have ${o.workersLeft} workers left)`,u);if(f){e({type:"PLACE_WORKER",actionId:f,playerId:i}),e({type:"UPDATE_PLAYER",playerId:i,updates:{workersLeft:o.workersLeft-1}});const d={actionId:f,playerId:i,placedBy:t.id};await vt(f,o,e,n,n.gameLayers,0,d);let c=f;for(const[p,m]of Object.entries(n.gameLayers||{})){const g=m.actions.find(E=>E.id===f);if(g){c=`${p} - ${g.title}`;break}}e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  Placed Player ${i}'s worker on ${c}`}),n.roomCode&&e({type:"ADD_NOTIFICATION",notification:{type:"worker_placed",icon:"",title:"Worker Placed For You!",message:`${t.name||`Player ${t.id}`} placed your worker on ${c}`,forPlayer:i}})}}async function LC(t,e,n,r=0){const s=[],o={};Object.entries(n.occupiedSpaces).forEach(([m,g])=>{o[g]||(o[g]=[],s.push(g)),o[g].push(m)});const i=s.filter(m=>m!==t.id);if(i.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  No other players have placed workers!`});return}const a=i.map(m=>({label:`Player ${m} (${o[m].length} worker${o[m].length>1?"s":""})`,value:m})),l=await ye(e,"Choose a player whose worker actions to repeat",a);if(!l){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Cancelled`});return}const u=o[l],f=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","playTwoWorkers","playThreeWorkers","gain4purpleWaitAll","gain2purpleTakeBack","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"],d=u.filter(m=>!f.includes(m)).map(m=>{let g=m,E="";return Object.entries(n.gameLayers||{}).forEach(([_,h])=>{const v=h.actions.find(S=>S.id===m);v&&(g=v.title,E=_)}),{label:`${E} - ${g}`,value:m}});if(d.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  No valid actions to repeat (swap/repeat actions excluded)`});return}e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Will repeat ${d.length} actions from Player ${l}`});const c=[...d];for(;c.length>0;){const m=await ye(e,`Choose next action to repeat from Player ${l} (${c.length} remaining)`,c,!1);if(!m){e({type:"ADD_LOG",message:`Player ${t.id}: Stopped repeating actions`});break}console.log(`Red R3 shop - Executing action ${m} for player ${t.id}`),await vt(m,t,e,n,n.gameLayers,r+1),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"redAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP for red action (repeat)`});const g=c.findIndex(E=>E.value===m);g>-1&&c.splice(g,1)}const p=d;p.length>0&&e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Repeated ${p.length} actions from Player ${l}!`})}function $C({player:t,isCurrentPlayer:e,onEndTurn:n,turnPosition:r}){const{state:s,dispatch:o}=Ge(),i=s.gameLayers?Object.keys(s.gameLayers):["red","yellow","blue","purple"],a={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""};return y.createElement("div",{className:`flex items-center gap-3 px-4 py-2 rounded-lg glass shadow ${e?"ring-2 ring-blue-400":""}`},[y.createElement("div",{key:"name",className:"font-bold text-base whitespace-nowrap"},[y.createElement("span",{key:"emoji",className:"text-xl mr-1"},t.emoji||""),t.name,e&&y.createElement("span",{key:"indicator",className:"ml-1"},"")]),y.createElement("div",{key:"vp",className:"text-lg font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded whitespace-nowrap"},`${t.victoryPoints}VP`),y.createElement("div",{key:"resources",className:"flex gap-1"},i.map(l=>y.createElement("div",{key:l,className:"text-sm font-medium"},`${a[l]}${t.resources[l]||0}`))),y.createElement("div",{key:"workers",className:"text-base whitespace-nowrap"},Array(t.workersLeft).fill(t.emoji||"").join("")),e&&s.workersToPlace===0&&!s.shopUsedAfterWorkers&&y.createElement(_C,{key:"end-turn",onEndTurn:n})])}function MC({color:t,title:e,icon:n,actions:r,round:s}){const{state:o}=Ge();o.players.find(u=>u.id===o.currentPlayer);const i=()=>{const u="glass rounded-lg shadow-lg p-5 border-t-6 hover:shadow-xl transition-all duration-300 h-full flex flex-col";switch(t){case"red":return`${u} border-t-red-500`;case"yellow":return`${u} border-t-yellow-500`;case"blue":return`${u} border-t-blue-500`;case"purple":return`${u} border-t-purple-500`;case"gold":return`${u} border-t-yellow-600`;case"white":return`${u} border-t-gray-300`;case"black":return`${u} border-t-gray-800`;case"silver":return`${u} border-t-gray-400`;default:return`${u} border-t-gray-500`}},a=()=>{switch(t){case"red":return"text-red-500";case"yellow":return"text-yellow-500";case"blue":return"text-blue-500";case"purple":return"text-purple-500";case"gold":return"text-yellow-600";case"white":return"text-gray-600";case"black":return"text-gray-800";case"silver":return"text-gray-400";default:return"text-gray-500"}},l=r;return y.createElement("div",{className:i()},[y.createElement("div",{key:"header",className:"flex justify-between items-center mb-3"},[y.createElement("h2",{key:"title",className:`text-2xl font-bold ${a()}`},`${n} ${t.charAt(0).toUpperCase()+t.slice(1)}`),y.createElement("span",{key:"round",className:"text-gray-600 text-base bg-white px-3 py-1 rounded shadow"},`Round ${s}`)]),y.createElement("div",{key:"auto-vp",className:"text-sm text-gray-700 bg-yellow-100 rounded p-2 mb-3 leading-relaxed"},UC(t)),y.createElement("div",{key:"shops",className:"mb-3 bg-white bg-opacity-10 rounded-lg p-3"},[y.createElement("div",{key:"shop-header",className:"text-sm font-semibold text-gray-700 mb-2"}," Shops"),y.createElement("div",{key:"shop-grid",className:"grid grid-cols-4 gap-2"},[y.createElement(za,{key:"shop-r1",color:t,round:1,label:"R1",currentRound:s}),y.createElement(za,{key:"shop-r2",color:t,round:2,label:"R2",currentRound:s}),y.createElement(za,{key:"shop-r3",color:t,round:3,label:"R3",currentRound:s}),y.createElement(FC,{key:"shop-vp",color:t})])]),y.createElement("div",{key:"actions-section",className:"flex-1"},[y.createElement("h3",{key:"actions-title",className:"text-xl font-semibold mb-3 text-gray-800"}," Actions"),y.createElement("div",{key:"actions",className:"grid grid-cols-2 gap-3"},l.map(u=>y.createElement(cC,{key:u.id,actionId:u.id,title:u.title,description:u.description,round:u.round,available:u.round<=s,compact:!0})))])])}function UC(t){switch(t){case"red":return" +1 VP each time you use or repeat a red layer action";case"yellow":return" +1 VP per different color gem at end of each round";case"blue":return" Get 1 VP when you activate a shop effect";case"purple":return" First & last to run out of workers each round get 4 VP";case"white":return" All players start game with 5 VP when white is in play";case"gold":return" +1 VP per gold gem at end of each round";case"black":return" +1 VP whenever you steal from another player";case"silver":return" End of Round: Most VP get 3 Silver, others get 2 VP";default:return""}}function za({color:t,round:e,label:n,currentRound:r}){const{state:s,dispatch:o}=Ge(),i=Zk[t][e],a=eC[t][e],u={cost:(P=>{const k={};if(P.includes("VP")){const T=P.match(/(\d+)VP/);T&&(k.vp=parseInt(T[1]))}else P.split("+").forEach(A=>{const z=A.match(/(\d+)([])/);if(z){const x=parseInt(z[1]),H=z[2];H===""?k.any=x:H===""?k.red=x:H===""?k.yellow=x:H===""?k.blue=x:H===""?k.purple=x:H===""?k.gold=x:H===""?k.white=x:H===""?k.black=x:H===""&&(k.silver=x)}});return k})(a),fullEffect:i},f=`${t}${e}`,d=s.closedShops[f],c=!d,p=u.cost.vp||0,m=u.cost[t]||0,g=s.players.find(P=>P.id===s.currentPlayer),E=Math.max(0,(u.cost.any||0)+((g==null?void 0:g.shopCostModifier)||0)),_=async()=>{if(d){alert("This shop is closed!");return}if(s.roomCode&&s.myPlayerId!==s.currentPlayer){alert("It's not your turn!");return}if(s.workerPlacedThisTurn)if(s.workersToPlace===0){if(s.shopUsedAfterWorkers){alert("You have already used a shop after placing workers!");return}}else{alert("You must finish placing all your workers before using a shop!");return}else if(s.shopUsedBeforeWorkers){alert("You have already used a shop before placing workers!");return}const P=s.players.find(x=>x.id===s.currentPlayer);if(p>0){if(P.victoryPoints<p){alert(`Need ${p} VP. You have ${P.victoryPoints}.`);return}}else if(P.resources[t]<m){alert(`Need ${m} ${t} gems.`);return}const k=Object.values(P.resources).reduce((x,H)=>x+H,0);if((p>0?k:k-m)<E){alert(`Need ${E} additional gems.`);return}if(t==="red"&&e===1){const x=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","blueR1ShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"];if(Object.entries(s.occupiedSpaces).filter(([xe,Qe])=>Qe===P.id&&!x.includes(xe)).length===0){alert("You have no valid workers to repeat! Swap and repeat actions cannot be repeated.");return}}const A={};if(m>0&&(A[t]=-m),E>0){const x={...P.resources};m>0&&t in x&&(x[t]=Math.max(0,x[t]-m));const H=await ge(o,`Choose ${E} ${E===1?"gem":"gems"} to spend`,E,x);if(H)Object.entries(H).forEach(([xe,Qe])=>{A[xe]=(A[xe]||0)-Qe});else return}if(p>0&&o({type:"UPDATE_VP",playerId:P.id,vp:-p,source:"shopCost"}),o({type:"UPDATE_RESOURCES",playerId:P.id,resources:A}),!await cc(t,e,P,o,s,0)){p>0&&o({type:"UPDATE_VP",playerId:P.id,vp:p,source:"shopRefund"});const x={};Object.entries(A).forEach(([H,xe])=>{x[H]=-xe}),o({type:"UPDATE_RESOURCES",playerId:P.id,resources:x}),o({type:"ADD_LOG",message:`Player ${P.id}: Shop purchase cancelled - costs refunded`});return}o({type:"USE_SHOP"}),o({type:"UPDATE_VP",playerId:P.id,vp:1,source:"blueShopUsage"}),o({type:"ADD_LOG",message:`Player ${P.id}: +1 VP (activated a shop effect)`})},h=()=>{switch(t){case"red":return"";case"yellow":return"";case"blue":return"";case"purple":return"";case"gold":return"";case"white":return"";case"black":return"";case"silver":return"";default:return""}},v=()=>{if(!c)return"bg-gray-100";switch(t){case"red":return"bg-gradient-to-br from-red-50 to-red-100";case"yellow":return"bg-gradient-to-br from-yellow-50 to-yellow-100";case"blue":return"bg-gradient-to-br from-blue-50 to-blue-100";case"purple":return"bg-gradient-to-br from-purple-50 to-purple-100";case"gold":return"bg-gradient-to-br from-yellow-100 to-amber-100";case"white":return"bg-gradient-to-br from-gray-50 to-gray-100";case"black":return"bg-gradient-to-br from-gray-700 to-gray-800";case"silver":return"bg-gradient-to-br from-gray-200 to-gray-300";default:return"bg-white"}},S=()=>{if(!c)return"border-gray-300";switch(t){case"red":return"border-red-300";case"yellow":return"border-yellow-300";case"blue":return"border-blue-300";case"purple":return"border-purple-300";case"gold":return"border-amber-400";case"white":return"border-gray-400";case"black":return"border-gray-600";case"silver":return"border-gray-400";default:return"border-gray-300"}};return y.createElement("div",{className:`relative rounded-lg ${v()} ${S()} border-2 transition-all flex flex-col shadow hover:shadow-md overflow-hidden ${c?"":"opacity-60"}`},[y.createElement("div",{key:"header",className:"bg-white bg-opacity-50 px-2 py-1 flex items-center justify-between border-b "+S()},[y.createElement("span",{key:"round-label",className:"text-xs font-bold text-gray-700"},`R${e}`),y.createElement("div",{key:"cost",className:"text-sm font-bold flex items-center gap-0.5"},p>0?[y.createElement("span",{key:"vp",className:"text-purple-700"},`${p}VP`),E>0&&y.createElement("span",{key:"any",className:"text-gray-600"},`+${E}`)]:[y.createElement("span",{key:"color"},`${m}${h()}`),E>0&&y.createElement("span",{key:"any",className:"text-gray-600"},`+${E}`)])]),y.createElement("div",{key:"effect",className:`p-2 text-xs font-medium ${t==="black"?"text-white":"text-gray-900"} leading-tight text-center min-h-[60px] flex items-center justify-center`},u.fullEffect),y.createElement("button",{key:"btn",onClick:_,className:`py-1.5 text-sm font-bold transition-all ${c?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-400 cursor-not-allowed text-gray-600"}`,disabled:!c},c?"BUY":"")])}function FC({color:t}){const{state:e,dispatch:n}=Ge(),r={red:{cost:4,vp:5},yellow:{cost:4,vp:3},blue:{cost:4,vp:5},purple:{cost:4,vp:5},white:{cost:4,vp:4},black:{cost:6,vp:0,special:"steal2FromEach"},silver:{cost:6,vp:8}};if(t==="gold")return null;const s=r[t],o=`${t}vp`,i=e.closedShops[o],a=e.players.find(p=>p.id===e.currentPlayer),l=t==="black"||t==="white"?s.cost:Math.max(0,s.cost+((a==null?void 0:a.shopCostModifier)||0)),u=()=>{if(i){alert("This shop is closed!");return}if(e.roomCode&&e.myPlayerId!==e.currentPlayer){alert("It's not your turn!");return}if(e.workerPlacedThisTurn)if(e.workersToPlace===0){if(e.shopUsedAfterWorkers){alert("You have already used a shop after placing workers!");return}}else{alert("You must finish placing all your workers before using a shop!");return}else if(e.shopUsedBeforeWorkers){alert("You have already used a shop before placing workers!");return}const p=e.players.find(E=>E.id===e.currentPlayer),m=t==="black"||t==="white"?s.cost:Math.max(0,s.cost+(p.shopCostModifier||0));if(t==="yellow"){if(Object.values(p.resources).reduce((_,h)=>_+h,0)<m){alert(`Need ${m} gems total.`);return}}else if(p.resources[t]<m){alert(`Need ${m} ${t} gems.`);return}const g={};if(t==="yellow"){let E=m;["red","yellow","blue","purple"].forEach(_=>{const h=Math.min(p.resources[_],E);h>0&&(g[_]=-h,E-=h)})}else g[t]=-m;if(n({type:"UPDATE_RESOURCES",playerId:p.id,resources:g}),t==="black"&&s.special==="steal2FromEach"){const E=e.players.filter(h=>h.id!==p.id);let _=0;E.forEach(h=>{const v=Math.min(2,h.victoryPoints);v>0&&(n({type:"UPDATE_VP",playerId:h.id,vp:-v,source:"blackVictoryShop"}),_+=v)}),_>0?(n({type:"UPDATE_VP",playerId:p.id,vp:_,source:"blackVictoryShop"}),n({type:"ADD_LOG",message:`Player ${p.id}: Black Victory Shop  Stole ${_} VP (2 from each player)`}),n({type:"UPDATE_VP",playerId:p.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${p.id}: +1 VP (Black automatic: stealing bonus)`})):n({type:"ADD_LOG",message:`Player ${p.id}: Black Victory Shop  No VP to steal`})}else n({type:"UPDATE_VP",playerId:p.id,vp:s.vp,source:"victoryShop"});n({type:"USE_SHOP"}),n({type:"UPDATE_VP",playerId:p.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${p.id}: +1 VP (activated a shop effect)`})},f=()=>{switch(t){case"red":return"";case"yellow":return"";case"blue":return"";case"purple":return"";case"gold":return"";case"white":return"";case"black":return"";case"silver":return"";default:return""}},d=()=>i?"bg-gray-100":"bg-gradient-to-br from-emerald-50 to-emerald-100",c=()=>t==="black"&&s.special==="steal2FromEach"?"Steal 2 VP from each player":`Gain ${s.vp} Victory Points`;return y.createElement("div",{className:`p-2 rounded-lg ${d()} border-2 border-emerald-400 transition-all flex flex-col shadow-sm hover:shadow-md ${i?"opacity-50":""}`},[y.createElement("div",{key:"header",className:"flex items-center justify-between mb-1"},[y.createElement("div",{key:"vp-label",className:"text-xs font-bold text-emerald-700"}," VP"),y.createElement("div",{key:"cost",className:"text-xs font-bold"},t==="yellow"?`${l}`:`${l}${f()}`)]),y.createElement("div",{key:"effect",className:"text-xs text-gray-700 font-medium leading-tight mb-2 min-h-[2rem]"},c()),y.createElement("button",{key:"btn",onClick:u,className:`text-xs py-1 px-2 rounded font-semibold transition-all ${i?"bg-gray-300 cursor-not-allowed text-gray-500":"bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm hover:shadow"}`,disabled:i},"Buy")])}function VC(){var a;const{state:t,dispatch:e}=Ge(),n=y.useRef(null),r=y.useRef(t);r.current=t,Je.useEffect(()=>{if(t.justSyncedFromFirebase){const l=setTimeout(()=>{e({type:"CLEAR_SYNC_FLAG"})},100);return()=>clearTimeout(l)}},[t.justSyncedFromFirebase]),Je.useEffect(()=>(t.roomCode&&t.gameStarted&&!t.justSyncedFromFirebase&&(n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{const l=r.current,u={currentPlayer:l.currentPlayer,turnDirection:l.turnDirection,players:l.players,occupiedSpaces:l.occupiedSpaces,round:l.round,turnOrder:l.turnOrder,workerPlacedThisTurn:l.workerPlacedThisTurn,workersToPlace:l.workersToPlace,actionLog:l.actionLog,gameStarted:l.gameStarted,gameLayers:l.gameLayers,closedShops:l.closedShops,shopUsedBeforeWorkers:l.shopUsedBeforeWorkers,shopUsedAfterWorkers:l.shopUsedAfterWorkers,playersOutOfWorkers:l.playersOutOfWorkers,skippedTurns:l.skippedTurns,waitingForOthers:l.waitingForOthers,roundActions:l.roundActions,gameOver:l.gameOver,automaticVPs:l.automaticVPs,pendingPlacements:l.pendingPlacements||{},lastUpdatedBy:l.myPlayerId,timestamp:Date.now()};console.log("Syncing game state to Firebase:",{myPlayerId:l.myPlayerId,currentPlayer:u.currentPlayer,gameLayers:u.gameLayers?Object.keys(u.gameLayers):null,gameStarted:u.gameStarted}),lC(l.roomCode,u)},200)),()=>{n.current&&clearTimeout(n.current)}),[t.currentPlayer,t.players,t.occupiedSpaces,t.round,t.actionLog,t.workersToPlace,t.gameLayers,t.closedShops,t.shopUsedBeforeWorkers,t.shopUsedAfterWorkers,t.playersOutOfWorkers,t.skippedTurns,t.waitingForOthers,t.roundActions,t.gameOver,t.automaticVPs,t.pendingPlacements]);const s=async()=>{if(t.roomCode&&t.myPlayerId!==t.currentPlayer){alert("It's not your turn!");return}if(t.players.find(l=>l.id===t.currentPlayer),t.workersToPlace>0){const l=t.workersToPlace;if(!await yC(e,"End Turn Early?",`You can still place ${l} more worker${l>1?"s":""} this turn. Are you sure you want to end your turn?`))return}e({type:"END_TURN"})},o=()=>{t.round<3?e({type:"SHOW_MODAL",modal:{type:"roundTransition",round:t.round+1,players:t.players}}):alert("Game is already at Round 3 (final round)")},i=()=>{e({type:"RESET_GAME",preserveEmojis:!0})};if(!t.gameLayers){if(console.log("No game layers found. State:",{roomCode:t.roomCode,gameStarted:t.gameStarted,gameLayers:t.gameLayers,myPlayerId:t.myPlayerId,currentPlayer:t.currentPlayer}),!t.roomCode){console.log("Local play - selecting 4 layers");const l=gl(4);e({type:"SET_GAME_LAYERS",layers:l})}return y.createElement("div",{className:"min-h-screen flex items-center justify-center"},y.createElement("div",{className:"text-center glass rounded-xl p-8"},[y.createElement("h2",{key:"title",className:"text-2xl font-bold mb-4"},"Setting up game layers..."),y.createElement("div",{key:"spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),y.createElement("div",{key:"debug",className:"text-sm text-gray-600 mt-4"},[y.createElement("div",{key:"line1"},`Room: ${t.roomCode||"None"}, Started: ${t.gameStarted}`),y.createElement("div",{key:"line2"},`You are Player ${t.myPlayerId}, Current Turn: Player ${t.currentPlayer}`)])]))}return console.log("GameBoard rendering with layers:",Object.keys(t.gameLayers)),t.players.reduce((l,u)=>l+u.workersLeft,0),Object.values(t.gameLayers).reduce((l,u)=>l+u.actions.filter(f=>f.round<=t.round).length,0),y.createElement("div",{className:"min-h-screen p-4 overflow-x-hidden w-full max-w-full"},[y.createElement(uC,{key:"notifications",notifications:t.notifications,myPlayerId:t.myPlayerId}),y.createElement("div",{key:"container",className:"w-full px-6"},[y.createElement("div",{key:"main-layout",className:"flex gap-6"},[y.createElement("div",{key:"sidebar",className:"flex-shrink-0 w-48"},[y.createElement("div",{key:"round",className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-3 rounded-lg shadow-lg flex flex-col items-center gap-2 mb-4"},[y.createElement("span",{key:"icon",className:"text-2xl"},""),y.createElement("span",{key:"text",className:"text-lg font-bold"},`Round ${t.round}`)]),t.currentPlayer&&y.createElement("div",{key:"current-turn",className:"bg-gray-700 text-white px-4 py-3 rounded-lg shadow-md flex flex-col items-center gap-2 mb-4"},[y.createElement("span",{key:"icon",className:"text-sm"},""),y.createElement("span",{key:"text",className:"text-sm text-center"},`${((a=t.players.find(l=>l.id===t.currentPlayer))==null?void 0:a.name)||`Player ${t.currentPlayer}`}'s Turn`),t.roomCode&&y.createElement("div",{key:"debug",className:"text-xs mt-1 text-gray-300"},`(You are P${t.myPlayerId}, Current: P${t.currentPlayer})`)]),t.roomCode&&y.createElement("div",{key:"room-badge",className:"bg-gray-700 text-white px-4 py-3 rounded-lg shadow-md flex flex-col items-center gap-2"},[y.createElement("span",{key:"icon",className:"text-sm"},""),y.createElement("span",{key:"text",className:"font-semibold text-sm"},`Room: ${t.roomCode}`)])]),y.createElement("div",{key:"game-area",className:"flex-1 game-board"},[y.createElement("div",{key:"players",className:"flex flex-wrap gap-3 mb-6"},t.turnOrder.map((l,u)=>{const f=t.players.find(d=>d.id===l);return y.createElement($C,{key:f.id,player:f,isCurrentPlayer:f.id===t.currentPlayer,onEndTurn:s,turnPosition:u+1})})),y.createElement("div",{key:"layers",className:"grid grid-cols-2 gap-6 mb-6"},Object.entries(t.gameLayers).map(([l,u])=>y.createElement(MC,{key:l,color:l,title:u.title,icon:u.icon,actions:u.actions,round:t.round}))),y.createElement("div",{key:"controls",className:"text-center glass rounded-lg p-4 shadow-lg"},[y.createElement("button",{key:"advance",onClick:o,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-2 px-4 rounded-lg mr-3 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},`Advance to Round ${Math.min(t.round+1,3)}`),y.createElement("button",{key:"reset",onClick:i,className:"bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},"Reset Game"),y.createElement("div",{key:"instructions",className:"text-gray-600 mt-3 text-sm"},"Place worker  Buy from shops  End turn (button under current player)"),t.actionLog.length>0&&y.createElement("div",{key:"action-log",className:"mt-4 p-3 bg-gray-100 rounded-lg max-h-32 overflow-y-auto"},[y.createElement("div",{key:"log-title",className:"font-bold text-gray-700 mb-2 text-sm"},"Action Log (Last 10):"),...t.actionLog.map((l,u)=>y.createElement("div",{key:u,className:"text-xs text-gray-600 mb-1 font-mono"},l))])])])]),t.waitingForPlayer&&t.myPlayerId===t.currentPlayer&&y.createElement("div",{key:"waiting-indicator",className:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-yellow-100 border-2 border-yellow-400 rounded-lg p-4 shadow-lg z-50"},[y.createElement("div",{className:"flex items-center space-x-3"},[y.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"}),y.createElement("div",{className:"text-yellow-800 font-semibold"},`Waiting for Player ${t.waitingForPlayer} to make a choice...`)])]),t.modal&&t.roomCode&&t.modal.targetPlayerId&&t.modal.targetPlayerId!==t.myPlayerId&&y.createElement("div",{key:"modal-waiting-indicator",className:"fixed bottom-4 right-4 bg-blue-100 border-2 border-blue-400 rounded-lg p-3 shadow-lg z-40"},[y.createElement("div",{className:"flex items-center space-x-2"},[y.createElement("div",{className:"animate-pulse rounded-full h-3 w-3 bg-blue-600"}),y.createElement("div",{className:"text-blue-800 text-sm font-medium"},`Player ${t.modal.targetPlayerId} is making a decision...`)])]),t.modal&&(!t.roomCode||t.myPlayerId===t.currentPlayer||t.modal.targetPlayerId===t.myPlayerId)&&y.createElement(dC,{key:"modal",isOpen:!0,onClose:()=>e({type:"HIDE_MODAL"})},t.modal.type==="choice"?y.createElement(fC,t.modal):t.modal.type==="gemSelection"?y.createElement(mC,t.modal):t.modal.type==="stealGems"?y.createElement(gC,t.modal):t.modal.type==="roundTransition"?y.createElement(pC,t.modal):y.createElement(hC,t.modal))])])}function GC(){const{state:t,dispatch:e}=Ge(),n=[...t.players].sort((o,i)=>i.victoryPoints-o.victoryPoints),r=n[0],s=()=>{t.roomCode?e({type:"RESET_GAME"}):window.location.reload()};return y.createElement("div",{className:"min-h-screen bg-gradient-to-br from-yellow-100 via-purple-100 to-blue-100 flex items-center justify-center p-4"},y.createElement("div",{className:"glass rounded-xl p-8 max-w-2xl w-full text-center"},[y.createElement("h1",{key:"title",className:"text-4xl font-bold mb-2 bg-gradient-to-r from-yellow-600 to-purple-600 bg-clip-text text-transparent"},"Game Over!"),y.createElement("div",{key:"winner",className:"text-6xl mb-4"},""),y.createElement("h2",{key:"winner-name",className:"text-3xl font-bold mb-6"},`${r.name} ${r.emoji||""} Wins!`),y.createElement("div",{key:"winner-score",className:"text-2xl mb-8 text-gray-700"},`Final Score: ${r.victoryPoints} VP`),y.createElement("div",{key:"standings",className:"mb-8"},[y.createElement("h3",{key:"standings-title",className:"text-xl font-semibold mb-4"},"Final Standings"),y.createElement("div",{key:"players-list",className:"space-y-3"},n.map((o,i)=>y.createElement("div",{key:o.id,className:`glass rounded-lg p-3 flex items-center justify-between ${i===0?"ring-2 ring-yellow-400":""}`},[y.createElement("div",{key:"left",className:"flex items-center gap-3"},[y.createElement("div",{key:"rank",className:"text-2xl font-bold"},i===0?"":i===1?"":i===2?"":`${i+1}.`),y.createElement("div",{key:"name",className:"text-lg"},`${o.name} ${o.emoji||""}`)]),y.createElement("div",{key:"score",className:"text-xl font-semibold"},`${o.victoryPoints} VP`)])))]),y.createElement("button",{key:"play-again",onClick:s,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-8 py-3 rounded-lg font-semibold text-lg transform hover:scale-105 transition-all"},t.roomCode?"Back to Lobby":"Play Again")]))}function WC(){return y.createElement(rC,{},y.createElement(BC,{}))}function BC(){const{state:t}=Ge();try{return t.gameStarted?t.gameOver?y.createElement(GC,{}):y.createElement("div",{className:"min-h-screen"},[t.roomCode&&y.createElement(vp,{key:"players"}),y.createElement(VC,{key:"game"})]):t.roomCode?y.createElement("div",{className:"min-h-screen p-4 overflow-x-hidden w-full max-w-full"},[y.createElement(vp,{key:"players"}),y.createElement("div",{key:"waiting",className:"text-center mt-8"},[y.createElement("div",{key:"spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),y.createElement("h2",{key:"text",className:"text-xl text-gray-600"},t.isHost?"Waiting for you to start the game...":"Waiting for host to start the game...")])]):y.createElement(aC,{})}catch(e){return console.error("Render error:",e),console.error("Error stack:",e.stack),console.error("Game state at error:",t),y.createElement("div",{className:"min-h-screen flex items-center justify-center p-4"},y.createElement("div",{className:"glass rounded-xl p-8 text-center"},[y.createElement("h1",{key:"title",className:"text-2xl font-bold text-red-600 mb-4"},"Game Error"),y.createElement("p",{key:"message",className:"text-gray-600 mb-4"},"Something went wrong. Check browser console for details."),y.createElement("div",{key:"error-details",className:"text-sm text-gray-500 mb-4 p-2 bg-gray-100 rounded"},`Error: ${e.message}`),y.createElement("button",{key:"reload",onClick:()=>window.location.reload(),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded"},"Reload Game")]))}}const wp=new URLSearchParams(window.location.search);(wp.get("test")==="true"||wp.get("debug")==="true")&&(window.debugGetState=()=>{const t=document.getElementById("root")._reactRootContainer;if(!t)return null;let e=null;const n=r=>{r&&(r.memoizedState&&r.memoizedState.element&&r.memoizedState.element.type&&r.memoizedState.element.type.name==="App"&&r.memoizedState.memoizedState&&(e=r.memoizedState.memoizedState[0]),r.child&&n(r.child),r.sibling&&n(r.sibling))};return t._internalRoot&&n(t._internalRoot.current),e||window.lastKnownState||null},window.debugDispatch=t=>window.lastKnownDispatch?(window.lastKnownDispatch(t),!0):!1,window.debugLog=t=>{console.log("[DEBUG]",t)},console.log("Debug mode enabled. Available functions: debugGetState(), debugDispatch(action), debugLog(message)"));Ha.createRoot(document.getElementById("root")).render(cf.jsx(y.StrictMode,{children:cf.jsx(WC,{})}));
