(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function O_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pp={exports:{}},_l={},Cp={exports:{}},z={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oo=Symbol.for("react.element"),N_=Symbol.for("react.portal"),R_=Symbol.for("react.fragment"),I_=Symbol.for("react.strict_mode"),L_=Symbol.for("react.profiler"),$_=Symbol.for("react.provider"),M_=Symbol.for("react.context"),U_=Symbol.for("react.forward_ref"),F_=Symbol.for("react.suspense"),V_=Symbol.for("react.memo"),G_=Symbol.for("react.lazy"),lf=Symbol.iterator;function W_(t){return t===null||typeof t!="object"?null:(t=lf&&t[lf]||t["@@iterator"],typeof t=="function"?t:null)}var kp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bp=Object.assign,Tp={};function fs(t,e,n){this.props=t,this.context=e,this.refs=Tp,this.updater=n||kp}fs.prototype.isReactComponent={};fs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ap(){}Ap.prototype=fs.prototype;function dc(t,e,n){this.props=t,this.context=e,this.refs=Tp,this.updater=n||kp}var fc=dc.prototype=new Ap;fc.constructor=dc;bp(fc,fs.prototype);fc.isPureReactComponent=!0;var af=Array.isArray,Dp=Object.prototype.hasOwnProperty,hc={current:null},xp={key:!0,ref:!0,__self:!0,__source:!0};function Op(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)Dp.call(e,r)&&!xp.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),a=0;a<l;a++)u[a]=arguments[a+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Oo,type:t,key:o,ref:i,props:s,_owner:hc.current}}function B_(t,e){return{$$typeof:Oo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function pc(t){return typeof t=="object"&&t!==null&&t.$$typeof===Oo}function j_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var uf=/\/+/g;function ia(t,e){return typeof t=="object"&&t!==null&&t.key!=null?j_(""+t.key):e.toString(36)}function mi(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Oo:case N_:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+ia(i,0):r,af(s)?(n="",t!=null&&(n=t.replace(uf,"$&/")+"/"),mi(s,e,n,"",function(a){return a})):s!=null&&(pc(s)&&(s=B_(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(uf,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",af(t))for(var l=0;l<t.length;l++){o=t[l];var u=r+ia(o,l);i+=mi(o,e,n,u,s)}else if(u=W_(t),typeof u=="function")for(t=u.call(t),l=0;!(o=t.next()).done;)o=o.value,u=r+ia(o,l++),i+=mi(o,e,n,u,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Ko(t,e,n){if(t==null)return t;var r=[],s=0;return mi(t,r,"","",function(o){return e.call(n,o,s++)}),r}function z_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ze={current:null},gi={transition:null},H_={ReactCurrentDispatcher:ze,ReactCurrentBatchConfig:gi,ReactCurrentOwner:hc};function Np(){throw Error("act(...) is not supported in production builds of React.")}z.Children={map:Ko,forEach:function(t,e,n){Ko(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ko(t,function(){e++}),e},toArray:function(t){return Ko(t,function(e){return e})||[]},only:function(t){if(!pc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};z.Component=fs;z.Fragment=R_;z.Profiler=L_;z.PureComponent=dc;z.StrictMode=I_;z.Suspense=F_;z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H_;z.act=Np;z.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=bp({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=hc.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Dp.call(e,u)&&!xp.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var a=0;a<u;a++)l[a]=arguments[a+2];r.children=l}return{$$typeof:Oo,type:t.type,key:s,ref:o,props:r,_owner:i}};z.createContext=function(t){return t={$$typeof:M_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$_,_context:t},t.Consumer=t};z.createElement=Op;z.createFactory=function(t){var e=Op.bind(null,t);return e.type=t,e};z.createRef=function(){return{current:null}};z.forwardRef=function(t){return{$$typeof:U_,render:t}};z.isValidElement=pc;z.lazy=function(t){return{$$typeof:G_,_payload:{_status:-1,_result:t},_init:z_}};z.memo=function(t,e){return{$$typeof:V_,type:t,compare:e===void 0?null:e}};z.startTransition=function(t){var e=gi.transition;gi.transition={};try{t()}finally{gi.transition=e}};z.unstable_act=Np;z.useCallback=function(t,e){return ze.current.useCallback(t,e)};z.useContext=function(t){return ze.current.useContext(t)};z.useDebugValue=function(){};z.useDeferredValue=function(t){return ze.current.useDeferredValue(t)};z.useEffect=function(t,e){return ze.current.useEffect(t,e)};z.useId=function(){return ze.current.useId()};z.useImperativeHandle=function(t,e,n){return ze.current.useImperativeHandle(t,e,n)};z.useInsertionEffect=function(t,e){return ze.current.useInsertionEffect(t,e)};z.useLayoutEffect=function(t,e){return ze.current.useLayoutEffect(t,e)};z.useMemo=function(t,e){return ze.current.useMemo(t,e)};z.useReducer=function(t,e,n){return ze.current.useReducer(t,e,n)};z.useRef=function(t){return ze.current.useRef(t)};z.useState=function(t){return ze.current.useState(t)};z.useSyncExternalStore=function(t,e,n){return ze.current.useSyncExternalStore(t,e,n)};z.useTransition=function(){return ze.current.useTransition()};z.version="18.3.1";Cp.exports=z;var qe=Cp.exports;const _=O_(qe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_=qe,Q_=Symbol.for("react.element"),K_=Symbol.for("react.fragment"),q_=Object.prototype.hasOwnProperty,X_=Y_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J_={key:!0,ref:!0,__self:!0,__source:!0};function Rp(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)q_.call(e,r)&&!J_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Q_,type:t,key:o,ref:i,props:s,_owner:X_.current}}_l.Fragment=K_;_l.jsx=Rp;_l.jsxs=Rp;Pp.exports=_l;var cf=Pp.exports,Ha={},Ip={exports:{}},ft={},Lp={exports:{}},$p={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(x,$){var F=x.length;x.push($);e:for(;0<F;){var oe=F-1>>>1,pe=x[oe];if(0<s(pe,$))x[oe]=$,x[F]=pe,F=oe;else break e}}function n(x){return x.length===0?null:x[0]}function r(x){if(x.length===0)return null;var $=x[0],F=x.pop();if(F!==$){x[0]=F;e:for(var oe=0,pe=x.length,yn=pe>>>1;oe<yn;){var Xt=2*(oe+1)-1,ws=x[Xt],Vt=Xt+1,Gt=x[Vt];if(0>s(ws,F))Vt<pe&&0>s(Gt,ws)?(x[oe]=Gt,x[Vt]=F,oe=Vt):(x[oe]=ws,x[Xt]=F,oe=Xt);else if(Vt<pe&&0>s(Gt,F))x[oe]=Gt,x[Vt]=F,oe=Vt;else break e}}return $}function s(x,$){var F=x.sortIndex-$.sortIndex;return F!==0?F:x.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var u=[],a=[],f=1,c=null,d=3,h=!1,m=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(x){for(var $=n(a);$!==null;){if($.callback===null)r(a);else if($.startTime<=x)r(a),$.sortIndex=$.expirationTime,e(u,$);else break;$=n(a)}}function S(x){if(v=!1,g(x),!m)if(n(u)!==null)m=!0,Ye(P);else{var $=n(a);$!==null&&Zn(S,$.startTime-x)}}function P(x,$){m=!1,v&&(v=!1,y(T),T=-1),h=!0;var F=d;try{for(g($),c=n(u);c!==null&&(!(c.expirationTime>$)||x&&!he());){var oe=c.callback;if(typeof oe=="function"){c.callback=null,d=c.priorityLevel;var pe=oe(c.expirationTime<=$);$=t.unstable_now(),typeof pe=="function"?c.callback=pe:c===n(u)&&r(u),g($)}else r(u);c=n(u)}if(c!==null)var yn=!0;else{var Xt=n(a);Xt!==null&&Zn(S,Xt.startTime-$),yn=!1}return yn}finally{c=null,d=F,h=!1}}var b=!1,A=null,T=-1,j=5,R=-1;function he(){return!(t.unstable_now()-R<j)}function Ut(){if(A!==null){var x=t.unstable_now();R=x;var $=!0;try{$=A(!0,x)}finally{$?Ft():(b=!1,A=null)}}else b=!1}var Ft;if(typeof p=="function")Ft=function(){p(Ut)};else if(typeof MessageChannel<"u"){var ra=new MessageChannel,X=ra.port2;ra.port1.onmessage=Ut,Ft=function(){X.postMessage(null)}}else Ft=function(){w(Ut,0)};function Ye(x){A=x,b||(b=!0,Ft())}function Zn(x,$){T=w(function(){x(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(x){x.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,Ye(P))},t.unstable_forceFrameRate=function(x){0>x||125<x?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<x?Math.floor(1e3/x):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(x){switch(d){case 1:case 2:case 3:var $=3;break;default:$=d}var F=d;d=$;try{return x()}finally{d=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(x,$){switch(x){case 1:case 2:case 3:case 4:case 5:break;default:x=3}var F=d;d=x;try{return $()}finally{d=F}},t.unstable_scheduleCallback=function(x,$,F){var oe=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?oe+F:oe):F=oe,x){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=F+pe,x={id:f++,callback:$,priorityLevel:x,startTime:F,expirationTime:pe,sortIndex:-1},F>oe?(x.sortIndex=F,e(a,x),n(u)===null&&x===n(a)&&(v?(y(T),T=-1):v=!0,Zn(S,F-oe))):(x.sortIndex=pe,e(u,x),m||h||(m=!0,Ye(P))),x},t.unstable_shouldYield=he,t.unstable_wrapCallback=function(x){var $=d;return function(){var F=d;d=$;try{return x.apply(this,arguments)}finally{d=F}}}})($p);Lp.exports=$p;var Z_=Lp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev=qe,ut=Z_;function C(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mp=new Set,eo={};function Sr(t,e){Xr(t,e),Xr(t+"Capture",e)}function Xr(t,e){for(eo[t]=e,t=0;t<e.length;t++)Mp.add(e[t])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ya=Object.prototype.hasOwnProperty,tv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,df={},ff={};function nv(t){return Ya.call(ff,t)?!0:Ya.call(df,t)?!1:tv.test(t)?ff[t]=!0:(df[t]=!0,!1)}function rv(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sv(t,e,n,r){if(e===null||typeof e>"u"||rv(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function He(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Re={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Re[t]=new He(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Re[e]=new He(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Re[t]=new He(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Re[t]=new He(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Re[t]=new He(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Re[t]=new He(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Re[t]=new He(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Re[t]=new He(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Re[t]=new He(t,5,!1,t.toLowerCase(),null,!1,!1)});var mc=/[\-:]([a-z])/g;function gc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(mc,gc);Re[e]=new He(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(mc,gc);Re[e]=new He(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(mc,gc);Re[e]=new He(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Re[t]=new He(t,1,!1,t.toLowerCase(),null,!1,!1)});Re.xlinkHref=new He("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Re[t]=new He(t,1,!1,t.toLowerCase(),null,!0,!0)});function yc(t,e,n,r){var s=Re.hasOwnProperty(e)?Re[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sv(e,n,s,r)&&(n=null),r||s===null?nv(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gn=ev.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qo=Symbol.for("react.element"),Or=Symbol.for("react.portal"),Nr=Symbol.for("react.fragment"),_c=Symbol.for("react.strict_mode"),Qa=Symbol.for("react.profiler"),Up=Symbol.for("react.provider"),Fp=Symbol.for("react.context"),vc=Symbol.for("react.forward_ref"),Ka=Symbol.for("react.suspense"),qa=Symbol.for("react.suspense_list"),Ec=Symbol.for("react.memo"),En=Symbol.for("react.lazy"),Vp=Symbol.for("react.offscreen"),hf=Symbol.iterator;function Ps(t){return t===null||typeof t!="object"?null:(t=hf&&t[hf]||t["@@iterator"],typeof t=="function"?t:null)}var de=Object.assign,la;function Ls(t){if(la===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);la=e&&e[1]||""}return`
`+la+t}var aa=!1;function ua(t,e){if(!t||aa)return"";aa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(a){var r=a}Reflect.construct(t,[],e)}else{try{e.call()}catch(a){r=a}t.call(e.prototype)}else{try{throw Error()}catch(a){r=a}t()}}catch(a){if(a&&r&&typeof a.stack=="string"){for(var s=a.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var u=`
`+s[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=l);break}}}finally{aa=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ls(t):""}function ov(t){switch(t.tag){case 5:return Ls(t.type);case 16:return Ls("Lazy");case 13:return Ls("Suspense");case 19:return Ls("SuspenseList");case 0:case 2:case 15:return t=ua(t.type,!1),t;case 11:return t=ua(t.type.render,!1),t;case 1:return t=ua(t.type,!0),t;default:return""}}function Xa(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Nr:return"Fragment";case Or:return"Portal";case Qa:return"Profiler";case _c:return"StrictMode";case Ka:return"Suspense";case qa:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Fp:return(t.displayName||"Context")+".Consumer";case Up:return(t._context.displayName||"Context")+".Provider";case vc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ec:return e=t.displayName||null,e!==null?e:Xa(t.type)||"Memo";case En:e=t._payload,t=t._init;try{return Xa(t(e))}catch{}}return null}function iv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xa(e);case 8:return e===_c?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Gp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lv(t){var e=Gp(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Xo(t){t._valueTracker||(t._valueTracker=lv(t))}function Wp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Gp(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ai(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ja(t,e){var n=e.checked;return de({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function pf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Bp(t,e){e=e.checked,e!=null&&yc(t,"checked",e,!1)}function Za(t,e){Bp(t,e);var n=Vn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?eu(t,e.type,n):e.hasOwnProperty("defaultValue")&&eu(t,e.type,Vn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function mf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function eu(t,e,n){(e!=="number"||Ai(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $s=Array.isArray;function Br(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vn(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function tu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(C(91));return de({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function gf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(C(92));if($s(n)){if(1<n.length)throw Error(C(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vn(n)}}function jp(t,e){var n=Vn(e.value),r=Vn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function yf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Jo,Hp=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Jo=Jo||document.createElement("div"),Jo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Jo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function to(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},av=["Webkit","ms","Moz","O"];Object.keys(Vs).forEach(function(t){av.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vs[e]=Vs[t]})});function Yp(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vs.hasOwnProperty(t)&&Vs[t]?(""+e).trim():e+"px"}function Qp(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Yp(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var uv=de({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ru(t,e){if(e){if(uv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(C(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(C(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(C(61))}if(e.style!=null&&typeof e.style!="object")throw Error(C(62))}}function su(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ou=null;function wc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var iu=null,jr=null,zr=null;function _f(t){if(t=Io(t)){if(typeof iu!="function")throw Error(C(280));var e=t.stateNode;e&&(e=Pl(e),iu(t.stateNode,t.type,e))}}function Kp(t){jr?zr?zr.push(t):zr=[t]:jr=t}function qp(){if(jr){var t=jr,e=zr;if(zr=jr=null,_f(t),e)for(t=0;t<e.length;t++)_f(e[t])}}function Xp(t,e){return t(e)}function Jp(){}var ca=!1;function Zp(t,e,n){if(ca)return t(e,n);ca=!0;try{return Xp(t,e,n)}finally{ca=!1,(jr!==null||zr!==null)&&(Jp(),qp())}}function no(t,e){var n=t.stateNode;if(n===null)return null;var r=Pl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(C(231,e,typeof n));return n}var lu=!1;if(un)try{var Cs={};Object.defineProperty(Cs,"passive",{get:function(){lu=!0}}),window.addEventListener("test",Cs,Cs),window.removeEventListener("test",Cs,Cs)}catch{lu=!1}function cv(t,e,n,r,s,o,i,l,u){var a=Array.prototype.slice.call(arguments,3);try{e.apply(n,a)}catch(f){this.onError(f)}}var Gs=!1,Di=null,xi=!1,au=null,dv={onError:function(t){Gs=!0,Di=t}};function fv(t,e,n,r,s,o,i,l,u){Gs=!1,Di=null,cv.apply(dv,arguments)}function hv(t,e,n,r,s,o,i,l,u){if(fv.apply(this,arguments),Gs){if(Gs){var a=Di;Gs=!1,Di=null}else throw Error(C(198));xi||(xi=!0,au=a)}}function Pr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function em(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vf(t){if(Pr(t)!==t)throw Error(C(188))}function pv(t){var e=t.alternate;if(!e){if(e=Pr(t),e===null)throw Error(C(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return vf(s),t;if(o===r)return vf(s),e;o=o.sibling}throw Error(C(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i)throw Error(C(189))}}if(n.alternate!==r)throw Error(C(190))}if(n.tag!==3)throw Error(C(188));return n.stateNode.current===n?t:e}function tm(t){return t=pv(t),t!==null?nm(t):null}function nm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nm(t);if(e!==null)return e;t=t.sibling}return null}var rm=ut.unstable_scheduleCallback,Ef=ut.unstable_cancelCallback,mv=ut.unstable_shouldYield,gv=ut.unstable_requestPaint,_e=ut.unstable_now,yv=ut.unstable_getCurrentPriorityLevel,Sc=ut.unstable_ImmediatePriority,sm=ut.unstable_UserBlockingPriority,Oi=ut.unstable_NormalPriority,_v=ut.unstable_LowPriority,om=ut.unstable_IdlePriority,vl=null,Ht=null;function vv(t){if(Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(vl,t,void 0,(t.current.flags&128)===128)}catch{}}var Rt=Math.clz32?Math.clz32:Sv,Ev=Math.log,wv=Math.LN2;function Sv(t){return t>>>=0,t===0?32:31-(Ev(t)/wv|0)|0}var Zo=64,ei=4194304;function Ms(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ni(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=Ms(l):(o&=i,o!==0&&(r=Ms(o)))}else i=n&~s,i!==0?r=Ms(i):o!==0&&(r=Ms(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Rt(e),s=1<<n,r|=t[n],e&=~s;return r}function Pv(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cv(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-Rt(o),l=1<<i,u=s[i];u===-1?(!(l&n)||l&r)&&(s[i]=Pv(l,e)):u<=e&&(t.expiredLanes|=l),o&=~l}}function uu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function im(){var t=Zo;return Zo<<=1,!(Zo&4194240)&&(Zo=64),t}function da(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function No(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rt(e),t[e]=n}function kv(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Rt(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function Pc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Rt(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var K=0;function lm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var am,Cc,um,cm,dm,cu=!1,ti=[],An=null,Dn=null,xn=null,ro=new Map,so=new Map,Sn=[],bv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wf(t,e){switch(t){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":ro.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":so.delete(e.pointerId)}}function ks(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=Io(e),e!==null&&Cc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Tv(t,e,n,r,s){switch(e){case"focusin":return An=ks(An,t,e,n,r,s),!0;case"dragenter":return Dn=ks(Dn,t,e,n,r,s),!0;case"mouseover":return xn=ks(xn,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return ro.set(o,ks(ro.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,so.set(o,ks(so.get(o)||null,t,e,n,r,s)),!0}return!1}function fm(t){var e=or(t.target);if(e!==null){var n=Pr(e);if(n!==null){if(e=n.tag,e===13){if(e=em(n),e!==null){t.blockedOn=e,dm(t.priority,function(){um(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=du(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ou=r,n.target.dispatchEvent(r),ou=null}else return e=Io(n),e!==null&&Cc(e),t.blockedOn=n,!1;e.shift()}return!0}function Sf(t,e,n){yi(t)&&n.delete(e)}function Av(){cu=!1,An!==null&&yi(An)&&(An=null),Dn!==null&&yi(Dn)&&(Dn=null),xn!==null&&yi(xn)&&(xn=null),ro.forEach(Sf),so.forEach(Sf)}function bs(t,e){t.blockedOn===e&&(t.blockedOn=null,cu||(cu=!0,ut.unstable_scheduleCallback(ut.unstable_NormalPriority,Av)))}function oo(t){function e(s){return bs(s,t)}if(0<ti.length){bs(ti[0],t);for(var n=1;n<ti.length;n++){var r=ti[n];r.blockedOn===t&&(r.blockedOn=null)}}for(An!==null&&bs(An,t),Dn!==null&&bs(Dn,t),xn!==null&&bs(xn,t),ro.forEach(e),so.forEach(e),n=0;n<Sn.length;n++)r=Sn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Sn.length&&(n=Sn[0],n.blockedOn===null);)fm(n),n.blockedOn===null&&Sn.shift()}var Hr=gn.ReactCurrentBatchConfig,Ri=!0;function Dv(t,e,n,r){var s=K,o=Hr.transition;Hr.transition=null;try{K=1,kc(t,e,n,r)}finally{K=s,Hr.transition=o}}function xv(t,e,n,r){var s=K,o=Hr.transition;Hr.transition=null;try{K=4,kc(t,e,n,r)}finally{K=s,Hr.transition=o}}function kc(t,e,n,r){if(Ri){var s=du(t,e,n,r);if(s===null)wa(t,e,r,Ii,n),wf(t,r);else if(Tv(s,t,e,n,r))r.stopPropagation();else if(wf(t,r),e&4&&-1<bv.indexOf(t)){for(;s!==null;){var o=Io(s);if(o!==null&&am(o),o=du(t,e,n,r),o===null&&wa(t,e,r,Ii,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else wa(t,e,r,null,n)}}var Ii=null;function du(t,e,n,r){if(Ii=null,t=wc(r),t=or(t),t!==null)if(e=Pr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=em(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ii=t,null}function hm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yv()){case Sc:return 1;case sm:return 4;case Oi:case _v:return 16;case om:return 536870912;default:return 16}default:return 16}}var Cn=null,bc=null,_i=null;function pm(){if(_i)return _i;var t,e=bc,n=e.length,r,s="value"in Cn?Cn.value:Cn.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return _i=s.slice(t,1<r?1-r:void 0)}function vi(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ni(){return!0}function Pf(){return!1}function ht(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ni:Pf,this.isPropagationStopped=Pf,this}return de(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ni)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ni)},persist:function(){},isPersistent:ni}),e}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tc=ht(hs),Ro=de({},hs,{view:0,detail:0}),Ov=ht(Ro),fa,ha,Ts,El=de({},Ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ac,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ts&&(Ts&&t.type==="mousemove"?(fa=t.screenX-Ts.screenX,ha=t.screenY-Ts.screenY):ha=fa=0,Ts=t),fa)},movementY:function(t){return"movementY"in t?t.movementY:ha}}),Cf=ht(El),Nv=de({},El,{dataTransfer:0}),Rv=ht(Nv),Iv=de({},Ro,{relatedTarget:0}),pa=ht(Iv),Lv=de({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),$v=ht(Lv),Mv=de({},hs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Uv=ht(Mv),Fv=de({},hs,{data:0}),kf=ht(Fv),Vv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Wv[t])?!!e[t]:!1}function Ac(){return Bv}var jv=de({},Ro,{key:function(t){if(t.key){var e=Vv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Gv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ac,charCode:function(t){return t.type==="keypress"?vi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),zv=ht(jv),Hv=de({},El,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bf=ht(Hv),Yv=de({},Ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ac}),Qv=ht(Yv),Kv=de({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),qv=ht(Kv),Xv=de({},El,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Jv=ht(Xv),Zv=[9,13,27,32],Dc=un&&"CompositionEvent"in window,Ws=null;un&&"documentMode"in document&&(Ws=document.documentMode);var e0=un&&"TextEvent"in window&&!Ws,mm=un&&(!Dc||Ws&&8<Ws&&11>=Ws),Tf=" ",Af=!1;function gm(t,e){switch(t){case"keyup":return Zv.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ym(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Rr=!1;function t0(t,e){switch(t){case"compositionend":return ym(e);case"keypress":return e.which!==32?null:(Af=!0,Tf);case"textInput":return t=e.data,t===Tf&&Af?null:t;default:return null}}function n0(t,e){if(Rr)return t==="compositionend"||!Dc&&gm(t,e)?(t=pm(),_i=bc=Cn=null,Rr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mm&&e.locale!=="ko"?null:e.data;default:return null}}var r0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Df(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!r0[t.type]:e==="textarea"}function _m(t,e,n,r){Kp(r),e=Li(e,"onChange"),0<e.length&&(n=new Tc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bs=null,io=null;function s0(t){Dm(t,0)}function wl(t){var e=$r(t);if(Wp(e))return t}function o0(t,e){if(t==="change")return e}var vm=!1;if(un){var ma;if(un){var ga="oninput"in document;if(!ga){var xf=document.createElement("div");xf.setAttribute("oninput","return;"),ga=typeof xf.oninput=="function"}ma=ga}else ma=!1;vm=ma&&(!document.documentMode||9<document.documentMode)}function Of(){Bs&&(Bs.detachEvent("onpropertychange",Em),io=Bs=null)}function Em(t){if(t.propertyName==="value"&&wl(io)){var e=[];_m(e,io,t,wc(t)),Zp(s0,e)}}function i0(t,e,n){t==="focusin"?(Of(),Bs=e,io=n,Bs.attachEvent("onpropertychange",Em)):t==="focusout"&&Of()}function l0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wl(io)}function a0(t,e){if(t==="click")return wl(e)}function u0(t,e){if(t==="input"||t==="change")return wl(e)}function c0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $t=typeof Object.is=="function"?Object.is:c0;function lo(t,e){if($t(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ya.call(e,s)||!$t(t[s],e[s]))return!1}return!0}function Nf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Rf(t,e){var n=Nf(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Nf(n)}}function wm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Sm(){for(var t=window,e=Ai();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ai(t.document)}return e}function xc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function d0(t){var e=Sm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&wm(n.ownerDocument.documentElement,n)){if(r!==null&&xc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=Rf(n,o);var i=Rf(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var f0=un&&"documentMode"in document&&11>=document.documentMode,Ir=null,fu=null,js=null,hu=!1;function If(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hu||Ir==null||Ir!==Ai(r)||(r=Ir,"selectionStart"in r&&xc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),js&&lo(js,r)||(js=r,r=Li(fu,"onSelect"),0<r.length&&(e=new Tc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ir)))}function ri(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Lr={animationend:ri("Animation","AnimationEnd"),animationiteration:ri("Animation","AnimationIteration"),animationstart:ri("Animation","AnimationStart"),transitionend:ri("Transition","TransitionEnd")},ya={},Pm={};un&&(Pm=document.createElement("div").style,"AnimationEvent"in window||(delete Lr.animationend.animation,delete Lr.animationiteration.animation,delete Lr.animationstart.animation),"TransitionEvent"in window||delete Lr.transitionend.transition);function Sl(t){if(ya[t])return ya[t];if(!Lr[t])return t;var e=Lr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Pm)return ya[t]=e[n];return t}var Cm=Sl("animationend"),km=Sl("animationiteration"),bm=Sl("animationstart"),Tm=Sl("transitionend"),Am=new Map,Lf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kn(t,e){Am.set(t,e),Sr(e,[t])}for(var _a=0;_a<Lf.length;_a++){var va=Lf[_a],h0=va.toLowerCase(),p0=va[0].toUpperCase()+va.slice(1);Kn(h0,"on"+p0)}Kn(Cm,"onAnimationEnd");Kn(km,"onAnimationIteration");Kn(bm,"onAnimationStart");Kn("dblclick","onDoubleClick");Kn("focusin","onFocus");Kn("focusout","onBlur");Kn(Tm,"onTransitionEnd");Xr("onMouseEnter",["mouseout","mouseover"]);Xr("onMouseLeave",["mouseout","mouseover"]);Xr("onPointerEnter",["pointerout","pointerover"]);Xr("onPointerLeave",["pointerout","pointerover"]);Sr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Us="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Us));function $f(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,hv(r,e,void 0,t),t.currentTarget=null}function Dm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],u=l.instance,a=l.currentTarget;if(l=l.listener,u!==o&&s.isPropagationStopped())break e;$f(s,l,a),o=u}else for(i=0;i<r.length;i++){if(l=r[i],u=l.instance,a=l.currentTarget,l=l.listener,u!==o&&s.isPropagationStopped())break e;$f(s,l,a),o=u}}}if(xi)throw t=au,xi=!1,au=null,t}function re(t,e){var n=e[_u];n===void 0&&(n=e[_u]=new Set);var r=t+"__bubble";n.has(r)||(xm(e,t,2,!1),n.add(r))}function Ea(t,e,n){var r=0;e&&(r|=4),xm(n,t,r,e)}var si="_reactListening"+Math.random().toString(36).slice(2);function ao(t){if(!t[si]){t[si]=!0,Mp.forEach(function(n){n!=="selectionchange"&&(m0.has(n)||Ea(n,!1,t),Ea(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[si]||(e[si]=!0,Ea("selectionchange",!1,e))}}function xm(t,e,n,r){switch(hm(e)){case 1:var s=Dv;break;case 4:s=xv;break;default:s=kc}n=s.bind(null,e,n,t),s=void 0,!lu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function wa(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;i=i.return}for(;l!==null;){if(i=or(l),i===null)return;if(u=i.tag,u===5||u===6){r=o=i;continue e}l=l.parentNode}}r=r.return}Zp(function(){var a=o,f=wc(n),c=[];e:{var d=Am.get(t);if(d!==void 0){var h=Tc,m=t;switch(t){case"keypress":if(vi(n)===0)break e;case"keydown":case"keyup":h=zv;break;case"focusin":m="focus",h=pa;break;case"focusout":m="blur",h=pa;break;case"beforeblur":case"afterblur":h=pa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Cf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Rv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Qv;break;case Cm:case km:case bm:h=$v;break;case Tm:h=qv;break;case"scroll":h=Ov;break;case"wheel":h=Jv;break;case"copy":case"cut":case"paste":h=Uv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=bf}var v=(e&4)!==0,w=!v&&t==="scroll",y=v?d!==null?d+"Capture":null:d;v=[];for(var p=a,g;p!==null;){g=p;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,y!==null&&(S=no(p,y),S!=null&&v.push(uo(p,S,g)))),w)break;p=p.return}0<v.length&&(d=new h(d,m,null,n,f),c.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",d&&n!==ou&&(m=n.relatedTarget||n.fromElement)&&(or(m)||m[cn]))break e;if((h||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=a,m=m?or(m):null,m!==null&&(w=Pr(m),m!==w||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=a),h!==m)){if(v=Cf,S="onMouseLeave",y="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(v=bf,S="onPointerLeave",y="onPointerEnter",p="pointer"),w=h==null?d:$r(h),g=m==null?d:$r(m),d=new v(S,p+"leave",h,n,f),d.target=w,d.relatedTarget=g,S=null,or(f)===a&&(v=new v(y,p+"enter",m,n,f),v.target=g,v.relatedTarget=w,S=v),w=S,h&&m)t:{for(v=h,y=m,p=0,g=v;g;g=Ar(g))p++;for(g=0,S=y;S;S=Ar(S))g++;for(;0<p-g;)v=Ar(v),p--;for(;0<g-p;)y=Ar(y),g--;for(;p--;){if(v===y||y!==null&&v===y.alternate)break t;v=Ar(v),y=Ar(y)}v=null}else v=null;h!==null&&Mf(c,d,h,v,!1),m!==null&&w!==null&&Mf(c,w,m,v,!0)}}e:{if(d=a?$r(a):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var P=o0;else if(Df(d))if(vm)P=u0;else{P=l0;var b=i0}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(P=a0);if(P&&(P=P(t,a))){_m(c,P,n,f);break e}b&&b(t,d,a),t==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&eu(d,"number",d.value)}switch(b=a?$r(a):window,t){case"focusin":(Df(b)||b.contentEditable==="true")&&(Ir=b,fu=a,js=null);break;case"focusout":js=fu=Ir=null;break;case"mousedown":hu=!0;break;case"contextmenu":case"mouseup":case"dragend":hu=!1,If(c,n,f);break;case"selectionchange":if(f0)break;case"keydown":case"keyup":If(c,n,f)}var A;if(Dc)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Rr?gm(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(mm&&n.locale!=="ko"&&(Rr||T!=="onCompositionStart"?T==="onCompositionEnd"&&Rr&&(A=pm()):(Cn=f,bc="value"in Cn?Cn.value:Cn.textContent,Rr=!0)),b=Li(a,T),0<b.length&&(T=new kf(T,t,null,n,f),c.push({event:T,listeners:b}),A?T.data=A:(A=ym(n),A!==null&&(T.data=A)))),(A=e0?t0(t,n):n0(t,n))&&(a=Li(a,"onBeforeInput"),0<a.length&&(f=new kf("onBeforeInput","beforeinput",null,n,f),c.push({event:f,listeners:a}),f.data=A))}Dm(c,e)})}function uo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Li(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=no(t,n),o!=null&&r.unshift(uo(t,o,s)),o=no(t,e),o!=null&&r.push(uo(t,o,s))),t=t.return}return r}function Ar(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Mf(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var l=n,u=l.alternate,a=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&a!==null&&(l=a,s?(u=no(n,o),u!=null&&i.unshift(uo(n,u,l))):s||(u=no(n,o),u!=null&&i.push(uo(n,u,l)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var g0=/\r\n?/g,y0=/\u0000|\uFFFD/g;function Uf(t){return(typeof t=="string"?t:""+t).replace(g0,`
`).replace(y0,"")}function oi(t,e,n){if(e=Uf(e),Uf(t)!==e&&n)throw Error(C(425))}function $i(){}var pu=null,mu=null;function gu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yu=typeof setTimeout=="function"?setTimeout:void 0,_0=typeof clearTimeout=="function"?clearTimeout:void 0,Ff=typeof Promise=="function"?Promise:void 0,v0=typeof queueMicrotask=="function"?queueMicrotask:typeof Ff<"u"?function(t){return Ff.resolve(null).then(t).catch(E0)}:yu;function E0(t){setTimeout(function(){throw t})}function Sa(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),oo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);oo(e)}function On(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Vf(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ps=Math.random().toString(36).slice(2),zt="__reactFiber$"+ps,co="__reactProps$"+ps,cn="__reactContainer$"+ps,_u="__reactEvents$"+ps,w0="__reactListeners$"+ps,S0="__reactHandles$"+ps;function or(t){var e=t[zt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cn]||n[zt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Vf(t);t!==null;){if(n=t[zt])return n;t=Vf(t)}return e}t=n,n=t.parentNode}return null}function Io(t){return t=t[zt]||t[cn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $r(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(C(33))}function Pl(t){return t[co]||null}var vu=[],Mr=-1;function qn(t){return{current:t}}function se(t){0>Mr||(t.current=vu[Mr],vu[Mr]=null,Mr--)}function te(t,e){Mr++,vu[Mr]=t.current,t.current=e}var Gn={},Fe=qn(Gn),Ze=qn(!1),hr=Gn;function Jr(t,e){var n=t.type.contextTypes;if(!n)return Gn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function et(t){return t=t.childContextTypes,t!=null}function Mi(){se(Ze),se(Fe)}function Gf(t,e,n){if(Fe.current!==Gn)throw Error(C(168));te(Fe,e),te(Ze,n)}function Om(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(C(108,iv(t)||"Unknown",s));return de({},n,r)}function Ui(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Gn,hr=Fe.current,te(Fe,t),te(Ze,Ze.current),!0}function Wf(t,e,n){var r=t.stateNode;if(!r)throw Error(C(169));n?(t=Om(t,e,hr),r.__reactInternalMemoizedMergedChildContext=t,se(Ze),se(Fe),te(Fe,t)):se(Ze),te(Ze,n)}var tn=null,Cl=!1,Pa=!1;function Nm(t){tn===null?tn=[t]:tn.push(t)}function P0(t){Cl=!0,Nm(t)}function Xn(){if(!Pa&&tn!==null){Pa=!0;var t=0,e=K;try{var n=tn;for(K=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}tn=null,Cl=!1}catch(s){throw tn!==null&&(tn=tn.slice(t+1)),rm(Sc,Xn),s}finally{K=e,Pa=!1}}return null}var Ur=[],Fr=0,Fi=null,Vi=0,mt=[],gt=0,pr=null,nn=1,rn="";function tr(t,e){Ur[Fr++]=Vi,Ur[Fr++]=Fi,Fi=t,Vi=e}function Rm(t,e,n){mt[gt++]=nn,mt[gt++]=rn,mt[gt++]=pr,pr=t;var r=nn;t=rn;var s=32-Rt(r)-1;r&=~(1<<s),n+=1;var o=32-Rt(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,nn=1<<32-Rt(e)+s|n<<s|r,rn=o+t}else nn=1<<o|n<<s|r,rn=t}function Oc(t){t.return!==null&&(tr(t,1),Rm(t,1,0))}function Nc(t){for(;t===Fi;)Fi=Ur[--Fr],Ur[Fr]=null,Vi=Ur[--Fr],Ur[Fr]=null;for(;t===pr;)pr=mt[--gt],mt[gt]=null,rn=mt[--gt],mt[gt]=null,nn=mt[--gt],mt[gt]=null}var lt=null,it=null,ie=!1,Ot=null;function Im(t,e){var n=vt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Bf(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,lt=t,it=On(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,lt=t,it=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pr!==null?{id:nn,overflow:rn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=vt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,lt=t,it=null,!0):!1;default:return!1}}function Eu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wu(t){if(ie){var e=it;if(e){var n=e;if(!Bf(t,e)){if(Eu(t))throw Error(C(418));e=On(n.nextSibling);var r=lt;e&&Bf(t,e)?Im(r,n):(t.flags=t.flags&-4097|2,ie=!1,lt=t)}}else{if(Eu(t))throw Error(C(418));t.flags=t.flags&-4097|2,ie=!1,lt=t}}}function jf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;lt=t}function ii(t){if(t!==lt)return!1;if(!ie)return jf(t),ie=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!gu(t.type,t.memoizedProps)),e&&(e=it)){if(Eu(t))throw Lm(),Error(C(418));for(;e;)Im(t,e),e=On(e.nextSibling)}if(jf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(C(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){it=On(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}it=null}}else it=lt?On(t.stateNode.nextSibling):null;return!0}function Lm(){for(var t=it;t;)t=On(t.nextSibling)}function Zr(){it=lt=null,ie=!1}function Rc(t){Ot===null?Ot=[t]:Ot.push(t)}var C0=gn.ReactCurrentBatchConfig;function As(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(C(309));var r=n.stateNode}if(!r)throw Error(C(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(C(284));if(!n._owner)throw Error(C(290,t))}return t}function li(t,e){throw t=Object.prototype.toString.call(e),Error(C(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function zf(t){var e=t._init;return e(t._payload)}function $m(t){function e(y,p){if(t){var g=y.deletions;g===null?(y.deletions=[p],y.flags|=16):g.push(p)}}function n(y,p){if(!t)return null;for(;p!==null;)e(y,p),p=p.sibling;return null}function r(y,p){for(y=new Map;p!==null;)p.key!==null?y.set(p.key,p):y.set(p.index,p),p=p.sibling;return y}function s(y,p){return y=Ln(y,p),y.index=0,y.sibling=null,y}function o(y,p,g){return y.index=g,t?(g=y.alternate,g!==null?(g=g.index,g<p?(y.flags|=2,p):g):(y.flags|=2,p)):(y.flags|=1048576,p)}function i(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,p,g,S){return p===null||p.tag!==6?(p=xa(g,y.mode,S),p.return=y,p):(p=s(p,g),p.return=y,p)}function u(y,p,g,S){var P=g.type;return P===Nr?f(y,p,g.props.children,S,g.key):p!==null&&(p.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===En&&zf(P)===p.type)?(S=s(p,g.props),S.ref=As(y,p,g),S.return=y,S):(S=bi(g.type,g.key,g.props,null,y.mode,S),S.ref=As(y,p,g),S.return=y,S)}function a(y,p,g,S){return p===null||p.tag!==4||p.stateNode.containerInfo!==g.containerInfo||p.stateNode.implementation!==g.implementation?(p=Oa(g,y.mode,S),p.return=y,p):(p=s(p,g.children||[]),p.return=y,p)}function f(y,p,g,S,P){return p===null||p.tag!==7?(p=cr(g,y.mode,S,P),p.return=y,p):(p=s(p,g),p.return=y,p)}function c(y,p,g){if(typeof p=="string"&&p!==""||typeof p=="number")return p=xa(""+p,y.mode,g),p.return=y,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case qo:return g=bi(p.type,p.key,p.props,null,y.mode,g),g.ref=As(y,null,p),g.return=y,g;case Or:return p=Oa(p,y.mode,g),p.return=y,p;case En:var S=p._init;return c(y,S(p._payload),g)}if($s(p)||Ps(p))return p=cr(p,y.mode,g,null),p.return=y,p;li(y,p)}return null}function d(y,p,g,S){var P=p!==null?p.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return P!==null?null:l(y,p,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case qo:return g.key===P?u(y,p,g,S):null;case Or:return g.key===P?a(y,p,g,S):null;case En:return P=g._init,d(y,p,P(g._payload),S)}if($s(g)||Ps(g))return P!==null?null:f(y,p,g,S,null);li(y,g)}return null}function h(y,p,g,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(g)||null,l(p,y,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case qo:return y=y.get(S.key===null?g:S.key)||null,u(p,y,S,P);case Or:return y=y.get(S.key===null?g:S.key)||null,a(p,y,S,P);case En:var b=S._init;return h(y,p,g,b(S._payload),P)}if($s(S)||Ps(S))return y=y.get(g)||null,f(p,y,S,P,null);li(p,S)}return null}function m(y,p,g,S){for(var P=null,b=null,A=p,T=p=0,j=null;A!==null&&T<g.length;T++){A.index>T?(j=A,A=null):j=A.sibling;var R=d(y,A,g[T],S);if(R===null){A===null&&(A=j);break}t&&A&&R.alternate===null&&e(y,A),p=o(R,p,T),b===null?P=R:b.sibling=R,b=R,A=j}if(T===g.length)return n(y,A),ie&&tr(y,T),P;if(A===null){for(;T<g.length;T++)A=c(y,g[T],S),A!==null&&(p=o(A,p,T),b===null?P=A:b.sibling=A,b=A);return ie&&tr(y,T),P}for(A=r(y,A);T<g.length;T++)j=h(A,y,T,g[T],S),j!==null&&(t&&j.alternate!==null&&A.delete(j.key===null?T:j.key),p=o(j,p,T),b===null?P=j:b.sibling=j,b=j);return t&&A.forEach(function(he){return e(y,he)}),ie&&tr(y,T),P}function v(y,p,g,S){var P=Ps(g);if(typeof P!="function")throw Error(C(150));if(g=P.call(g),g==null)throw Error(C(151));for(var b=P=null,A=p,T=p=0,j=null,R=g.next();A!==null&&!R.done;T++,R=g.next()){A.index>T?(j=A,A=null):j=A.sibling;var he=d(y,A,R.value,S);if(he===null){A===null&&(A=j);break}t&&A&&he.alternate===null&&e(y,A),p=o(he,p,T),b===null?P=he:b.sibling=he,b=he,A=j}if(R.done)return n(y,A),ie&&tr(y,T),P;if(A===null){for(;!R.done;T++,R=g.next())R=c(y,R.value,S),R!==null&&(p=o(R,p,T),b===null?P=R:b.sibling=R,b=R);return ie&&tr(y,T),P}for(A=r(y,A);!R.done;T++,R=g.next())R=h(A,y,T,R.value,S),R!==null&&(t&&R.alternate!==null&&A.delete(R.key===null?T:R.key),p=o(R,p,T),b===null?P=R:b.sibling=R,b=R);return t&&A.forEach(function(Ut){return e(y,Ut)}),ie&&tr(y,T),P}function w(y,p,g,S){if(typeof g=="object"&&g!==null&&g.type===Nr&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case qo:e:{for(var P=g.key,b=p;b!==null;){if(b.key===P){if(P=g.type,P===Nr){if(b.tag===7){n(y,b.sibling),p=s(b,g.props.children),p.return=y,y=p;break e}}else if(b.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===En&&zf(P)===b.type){n(y,b.sibling),p=s(b,g.props),p.ref=As(y,b,g),p.return=y,y=p;break e}n(y,b);break}else e(y,b);b=b.sibling}g.type===Nr?(p=cr(g.props.children,y.mode,S,g.key),p.return=y,y=p):(S=bi(g.type,g.key,g.props,null,y.mode,S),S.ref=As(y,p,g),S.return=y,y=S)}return i(y);case Or:e:{for(b=g.key;p!==null;){if(p.key===b)if(p.tag===4&&p.stateNode.containerInfo===g.containerInfo&&p.stateNode.implementation===g.implementation){n(y,p.sibling),p=s(p,g.children||[]),p.return=y,y=p;break e}else{n(y,p);break}else e(y,p);p=p.sibling}p=Oa(g,y.mode,S),p.return=y,y=p}return i(y);case En:return b=g._init,w(y,p,b(g._payload),S)}if($s(g))return m(y,p,g,S);if(Ps(g))return v(y,p,g,S);li(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,p!==null&&p.tag===6?(n(y,p.sibling),p=s(p,g),p.return=y,y=p):(n(y,p),p=xa(g,y.mode,S),p.return=y,y=p),i(y)):n(y,p)}return w}var es=$m(!0),Mm=$m(!1),Gi=qn(null),Wi=null,Vr=null,Ic=null;function Lc(){Ic=Vr=Wi=null}function $c(t){var e=Gi.current;se(Gi),t._currentValue=e}function Su(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yr(t,e){Wi=t,Ic=Vr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xe=!0),t.firstContext=null)}function Pt(t){var e=t._currentValue;if(Ic!==t)if(t={context:t,memoizedValue:e,next:null},Vr===null){if(Wi===null)throw Error(C(308));Vr=t,Wi.dependencies={lanes:0,firstContext:t}}else Vr=Vr.next=t;return e}var ir=null;function Mc(t){ir===null?ir=[t]:ir.push(t)}function Um(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Mc(e)):(n.next=s.next,s.next=n),e.interleaved=n,dn(t,r)}function dn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var wn=!1;function Uc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function on(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Nn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,H&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,dn(t,n)}return s=r.interleaved,s===null?(e.next=e,Mc(r)):(e.next=s.next,s.next=e),r.interleaved=e,dn(t,n)}function Ei(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pc(t,n)}}function Hf(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Bi(t,e,n,r){var s=t.updateQueue;wn=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,a=u.next;u.next=null,i===null?o=a:i.next=a,i=u;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==i&&(l===null?f.firstBaseUpdate=a:l.next=a,f.lastBaseUpdate=u))}if(o!==null){var c=s.baseState;i=0,f=a=u=null,l=o;do{var d=l.lane,h=l.eventTime;if((r&d)===d){f!==null&&(f=f.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,v=l;switch(d=e,h=n,v.tag){case 1:if(m=v.payload,typeof m=="function"){c=m.call(h,c,d);break e}c=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,d=typeof m=="function"?m.call(h,c,d):m,d==null)break e;c=de({},c,d);break e;case 2:wn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[l]:d.push(l))}else h={eventTime:h,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(a=f=h,u=c):f=f.next=h,i|=d;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;d=l,l=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(f===null&&(u=c),s.baseState=u,s.firstBaseUpdate=a,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);gr|=i,t.lanes=i,t.memoizedState=c}}function Yf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(C(191,s));s.call(r)}}}var Lo={},Yt=qn(Lo),fo=qn(Lo),ho=qn(Lo);function lr(t){if(t===Lo)throw Error(C(174));return t}function Fc(t,e){switch(te(ho,e),te(fo,t),te(Yt,Lo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:nu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=nu(e,t)}se(Yt),te(Yt,e)}function ts(){se(Yt),se(fo),se(ho)}function Vm(t){lr(ho.current);var e=lr(Yt.current),n=nu(e,t.type);e!==n&&(te(fo,t),te(Yt,n))}function Vc(t){fo.current===t&&(se(Yt),se(fo))}var ae=qn(0);function ji(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ca=[];function Gc(){for(var t=0;t<Ca.length;t++)Ca[t]._workInProgressVersionPrimary=null;Ca.length=0}var wi=gn.ReactCurrentDispatcher,ka=gn.ReactCurrentBatchConfig,mr=0,ce=null,Ee=null,Ce=null,zi=!1,zs=!1,po=0,k0=0;function Le(){throw Error(C(321))}function Wc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!$t(t[n],e[n]))return!1;return!0}function Bc(t,e,n,r,s,o){if(mr=o,ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wi.current=t===null||t.memoizedState===null?D0:x0,t=n(r,s),zs){o=0;do{if(zs=!1,po=0,25<=o)throw Error(C(301));o+=1,Ce=Ee=null,e.updateQueue=null,wi.current=O0,t=n(r,s)}while(zs)}if(wi.current=Hi,e=Ee!==null&&Ee.next!==null,mr=0,Ce=Ee=ce=null,zi=!1,e)throw Error(C(300));return t}function jc(){var t=po!==0;return po=0,t}function jt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ce===null?ce.memoizedState=Ce=t:Ce=Ce.next=t,Ce}function Ct(){if(Ee===null){var t=ce.alternate;t=t!==null?t.memoizedState:null}else t=Ee.next;var e=Ce===null?ce.memoizedState:Ce.next;if(e!==null)Ce=e,Ee=t;else{if(t===null)throw Error(C(310));Ee=t,t={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},Ce===null?ce.memoizedState=Ce=t:Ce=Ce.next=t}return Ce}function mo(t,e){return typeof e=="function"?e(t):e}function ba(t){var e=Ct(),n=e.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=t;var r=Ee,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,u=null,a=o;do{var f=a.lane;if((mr&f)===f)u!==null&&(u=u.next={lane:0,action:a.action,hasEagerState:a.hasEagerState,eagerState:a.eagerState,next:null}),r=a.hasEagerState?a.eagerState:t(r,a.action);else{var c={lane:f,action:a.action,hasEagerState:a.hasEagerState,eagerState:a.eagerState,next:null};u===null?(l=u=c,i=r):u=u.next=c,ce.lanes|=f,gr|=f}a=a.next}while(a!==null&&a!==o);u===null?i=r:u.next=l,$t(r,e.memoizedState)||(Xe=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,ce.lanes|=o,gr|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ta(t){var e=Ct(),n=e.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);$t(o,e.memoizedState)||(Xe=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Gm(){}function Wm(t,e){var n=ce,r=Ct(),s=e(),o=!$t(r.memoizedState,s);if(o&&(r.memoizedState=s,Xe=!0),r=r.queue,zc(zm.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Ce!==null&&Ce.memoizedState.tag&1){if(n.flags|=2048,go(9,jm.bind(null,n,r,s,e),void 0,null),Ae===null)throw Error(C(349));mr&30||Bm(n,e,s)}return s}function Bm(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function jm(t,e,n,r){e.value=n,e.getSnapshot=r,Hm(e)&&Ym(t)}function zm(t,e,n){return n(function(){Hm(e)&&Ym(t)})}function Hm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!$t(t,n)}catch{return!0}}function Ym(t){var e=dn(t,1);e!==null&&It(e,t,1,-1)}function Qf(t){var e=jt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:t},e.queue=t,t=t.dispatch=A0.bind(null,ce,t),[e.memoizedState,t]}function go(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Qm(){return Ct().memoizedState}function Si(t,e,n,r){var s=jt();ce.flags|=t,s.memoizedState=go(1|e,n,void 0,r===void 0?null:r)}function kl(t,e,n,r){var s=Ct();r=r===void 0?null:r;var o=void 0;if(Ee!==null){var i=Ee.memoizedState;if(o=i.destroy,r!==null&&Wc(r,i.deps)){s.memoizedState=go(e,n,o,r);return}}ce.flags|=t,s.memoizedState=go(1|e,n,o,r)}function Kf(t,e){return Si(8390656,8,t,e)}function zc(t,e){return kl(2048,8,t,e)}function Km(t,e){return kl(4,2,t,e)}function qm(t,e){return kl(4,4,t,e)}function Xm(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Jm(t,e,n){return n=n!=null?n.concat([t]):null,kl(4,4,Xm.bind(null,e,t),n)}function Hc(){}function Zm(t,e){var n=Ct();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function eg(t,e){var n=Ct();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function tg(t,e,n){return mr&21?($t(n,e)||(n=im(),ce.lanes|=n,gr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xe=!0),t.memoizedState=n)}function b0(t,e){var n=K;K=n!==0&&4>n?n:4,t(!0);var r=ka.transition;ka.transition={};try{t(!1),e()}finally{K=n,ka.transition=r}}function ng(){return Ct().memoizedState}function T0(t,e,n){var r=In(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rg(t))sg(e,n);else if(n=Um(t,e,n,r),n!==null){var s=je();It(n,t,r,s),og(n,e,r)}}function A0(t,e,n){var r=In(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rg(t))sg(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,$t(l,i)){var u=e.interleaved;u===null?(s.next=s,Mc(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Um(t,e,s,r),n!==null&&(s=je(),It(n,t,r,s),og(n,e,r))}}function rg(t){var e=t.alternate;return t===ce||e!==null&&e===ce}function sg(t,e){zs=zi=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function og(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pc(t,n)}}var Hi={readContext:Pt,useCallback:Le,useContext:Le,useEffect:Le,useImperativeHandle:Le,useInsertionEffect:Le,useLayoutEffect:Le,useMemo:Le,useReducer:Le,useRef:Le,useState:Le,useDebugValue:Le,useDeferredValue:Le,useTransition:Le,useMutableSource:Le,useSyncExternalStore:Le,useId:Le,unstable_isNewReconciler:!1},D0={readContext:Pt,useCallback:function(t,e){return jt().memoizedState=[t,e===void 0?null:e],t},useContext:Pt,useEffect:Kf,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Si(4194308,4,Xm.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Si(4194308,4,t,e)},useInsertionEffect:function(t,e){return Si(4,2,t,e)},useMemo:function(t,e){var n=jt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=T0.bind(null,ce,t),[r.memoizedState,t]},useRef:function(t){var e=jt();return t={current:t},e.memoizedState=t},useState:Qf,useDebugValue:Hc,useDeferredValue:function(t){return jt().memoizedState=t},useTransition:function(){var t=Qf(!1),e=t[0];return t=b0.bind(null,t[1]),jt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ce,s=jt();if(ie){if(n===void 0)throw Error(C(407));n=n()}else{if(n=e(),Ae===null)throw Error(C(349));mr&30||Bm(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,Kf(zm.bind(null,r,o,t),[t]),r.flags|=2048,go(9,jm.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=jt(),e=Ae.identifierPrefix;if(ie){var n=rn,r=nn;n=(r&~(1<<32-Rt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=po++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=k0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},x0={readContext:Pt,useCallback:Zm,useContext:Pt,useEffect:zc,useImperativeHandle:Jm,useInsertionEffect:Km,useLayoutEffect:qm,useMemo:eg,useReducer:ba,useRef:Qm,useState:function(){return ba(mo)},useDebugValue:Hc,useDeferredValue:function(t){var e=Ct();return tg(e,Ee.memoizedState,t)},useTransition:function(){var t=ba(mo)[0],e=Ct().memoizedState;return[t,e]},useMutableSource:Gm,useSyncExternalStore:Wm,useId:ng,unstable_isNewReconciler:!1},O0={readContext:Pt,useCallback:Zm,useContext:Pt,useEffect:zc,useImperativeHandle:Jm,useInsertionEffect:Km,useLayoutEffect:qm,useMemo:eg,useReducer:Ta,useRef:Qm,useState:function(){return Ta(mo)},useDebugValue:Hc,useDeferredValue:function(t){var e=Ct();return Ee===null?e.memoizedState=t:tg(e,Ee.memoizedState,t)},useTransition:function(){var t=Ta(mo)[0],e=Ct().memoizedState;return[t,e]},useMutableSource:Gm,useSyncExternalStore:Wm,useId:ng,unstable_isNewReconciler:!1};function Dt(t,e){if(t&&t.defaultProps){e=de({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pu(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:de({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bl={isMounted:function(t){return(t=t._reactInternals)?Pr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=je(),s=In(t),o=on(r,s);o.payload=e,n!=null&&(o.callback=n),e=Nn(t,o,s),e!==null&&(It(e,t,s,r),Ei(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=je(),s=In(t),o=on(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Nn(t,o,s),e!==null&&(It(e,t,s,r),Ei(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=je(),r=In(t),s=on(n,r);s.tag=2,e!=null&&(s.callback=e),e=Nn(t,s,r),e!==null&&(It(e,t,r,n),Ei(e,t,r))}};function qf(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!lo(n,r)||!lo(s,o):!0}function ig(t,e,n){var r=!1,s=Gn,o=e.contextType;return typeof o=="object"&&o!==null?o=Pt(o):(s=et(e)?hr:Fe.current,r=e.contextTypes,o=(r=r!=null)?Jr(t,s):Gn),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Xf(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&bl.enqueueReplaceState(e,e.state,null)}function Cu(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Uc(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Pt(o):(o=et(e)?hr:Fe.current,s.context=Jr(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Pu(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&bl.enqueueReplaceState(s,s.state,null),Bi(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ns(t,e){try{var n="",r=e;do n+=ov(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Aa(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ku(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var N0=typeof WeakMap=="function"?WeakMap:Map;function lg(t,e,n){n=on(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qi||(Qi=!0,Lu=r),ku(t,e)},n}function ag(t,e,n){n=on(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){ku(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){ku(t,e),typeof r!="function"&&(Rn===null?Rn=new Set([this]):Rn.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function Jf(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new N0;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=H0.bind(null,t,e,n),e.then(t,t))}function Zf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function eh(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=on(-1,1),e.tag=2,Nn(n,e,1))),n.lanes|=1),t)}var R0=gn.ReactCurrentOwner,Xe=!1;function Ge(t,e,n,r){e.child=t===null?Mm(e,null,n,r):es(e,t.child,n,r)}function th(t,e,n,r,s){n=n.render;var o=e.ref;return Yr(e,s),r=Bc(t,e,n,r,o,s),n=jc(),t!==null&&!Xe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fn(t,e,s)):(ie&&n&&Oc(e),e.flags|=1,Ge(t,e,r,s),e.child)}function nh(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!ed(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,ug(t,e,o,r,s)):(t=bi(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:lo,n(i,r)&&t.ref===e.ref)return fn(t,e,s)}return e.flags|=1,t=Ln(o,r),t.ref=e.ref,t.return=e,e.child=t}function ug(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(lo(o,r)&&t.ref===e.ref)if(Xe=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Xe=!0);else return e.lanes=t.lanes,fn(t,e,s)}return bu(t,e,n,r,s)}function cg(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},te(Wr,st),st|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,te(Wr,st),st|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,te(Wr,st),st|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,te(Wr,st),st|=r;return Ge(t,e,s,n),e.child}function dg(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function bu(t,e,n,r,s){var o=et(n)?hr:Fe.current;return o=Jr(e,o),Yr(e,s),n=Bc(t,e,n,r,o,s),r=jc(),t!==null&&!Xe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fn(t,e,s)):(ie&&r&&Oc(e),e.flags|=1,Ge(t,e,n,s),e.child)}function rh(t,e,n,r,s){if(et(n)){var o=!0;Ui(e)}else o=!1;if(Yr(e,s),e.stateNode===null)Pi(t,e),ig(e,n,r),Cu(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var u=i.context,a=n.contextType;typeof a=="object"&&a!==null?a=Pt(a):(a=et(n)?hr:Fe.current,a=Jr(e,a));var f=n.getDerivedStateFromProps,c=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";c||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||u!==a)&&Xf(e,i,r,a),wn=!1;var d=e.memoizedState;i.state=d,Bi(e,r,i,s),u=e.memoizedState,l!==r||d!==u||Ze.current||wn?(typeof f=="function"&&(Pu(e,n,f,r),u=e.memoizedState),(l=wn||qf(e,n,l,r,d,u,a))?(c||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=a,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,Fm(t,e),l=e.memoizedProps,a=e.type===e.elementType?l:Dt(e.type,l),i.props=a,c=e.pendingProps,d=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Pt(u):(u=et(n)?hr:Fe.current,u=Jr(e,u));var h=n.getDerivedStateFromProps;(f=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==c||d!==u)&&Xf(e,i,r,u),wn=!1,d=e.memoizedState,i.state=d,Bi(e,r,i,s);var m=e.memoizedState;l!==c||d!==m||Ze.current||wn?(typeof h=="function"&&(Pu(e,n,h,r),m=e.memoizedState),(a=wn||qf(e,n,a,r,d,m,u)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,m,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,m,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),i.props=r,i.state=m,i.context=u,r=a):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Tu(t,e,n,r,o,s)}function Tu(t,e,n,r,s,o){dg(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&Wf(e,n,!1),fn(t,e,o);r=e.stateNode,R0.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=es(e,t.child,null,o),e.child=es(e,null,l,o)):Ge(t,e,l,o),e.memoizedState=r.state,s&&Wf(e,n,!0),e.child}function fg(t){var e=t.stateNode;e.pendingContext?Gf(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Gf(t,e.context,!1),Fc(t,e.containerInfo)}function sh(t,e,n,r,s){return Zr(),Rc(s),e.flags|=256,Ge(t,e,n,r),e.child}var Au={dehydrated:null,treeContext:null,retryLane:0};function Du(t){return{baseLanes:t,cachePool:null,transitions:null}}function hg(t,e,n){var r=e.pendingProps,s=ae.current,o=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),te(ae,s&1),t===null)return wu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Dl(i,r,0,null),t=cr(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Du(n),e.memoizedState=Au,t):Yc(e,i));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return I0(t,e,i,r,l,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ln(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Ln(l,o):(o=cr(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?Du(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=Au,r}return o=t.child,t=o.sibling,r=Ln(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Yc(t,e){return e=Dl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ai(t,e,n,r){return r!==null&&Rc(r),es(e,t.child,null,n),t=Yc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function I0(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Aa(Error(C(422))),ai(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Dl({mode:"visible",children:r.children},s,0,null),o=cr(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&es(e,t.child,null,i),e.child.memoizedState=Du(i),e.memoizedState=Au,o);if(!(e.mode&1))return ai(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(C(419)),r=Aa(o,r,void 0),ai(t,e,i,r)}if(l=(i&t.childLanes)!==0,Xe||l){if(r=Ae,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,dn(t,s),It(r,t,s,-1))}return Zc(),r=Aa(Error(C(421))),ai(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Y0.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,it=On(s.nextSibling),lt=e,ie=!0,Ot=null,t!==null&&(mt[gt++]=nn,mt[gt++]=rn,mt[gt++]=pr,nn=t.id,rn=t.overflow,pr=e),e=Yc(e,r.children),e.flags|=4096,e)}function oh(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Su(t.return,e,n)}function Da(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function pg(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(Ge(t,e,r.children,n),r=ae.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&oh(t,n,e);else if(t.tag===19)oh(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(te(ae,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ji(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Da(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ji(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Da(e,!0,n,null,o);break;case"together":Da(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pi(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(C(153));if(e.child!==null){for(t=e.child,n=Ln(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ln(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function L0(t,e,n){switch(e.tag){case 3:fg(e),Zr();break;case 5:Vm(e);break;case 1:et(e.type)&&Ui(e);break;case 4:Fc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;te(Gi,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(te(ae,ae.current&1),e.flags|=128,null):n&e.child.childLanes?hg(t,e,n):(te(ae,ae.current&1),t=fn(t,e,n),t!==null?t.sibling:null);te(ae,ae.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return pg(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),te(ae,ae.current),r)break;return null;case 22:case 23:return e.lanes=0,cg(t,e,n)}return fn(t,e,n)}var mg,xu,gg,yg;mg=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xu=function(){};gg=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,lr(Yt.current);var o=null;switch(n){case"input":s=Ja(t,s),r=Ja(t,r),o=[];break;case"select":s=de({},s,{value:void 0}),r=de({},r,{value:void 0}),o=[];break;case"textarea":s=tu(t,s),r=tu(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$i)}ru(n,r);var i;n=null;for(a in s)if(!r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&s[a]!=null)if(a==="style"){var l=s[a];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else a!=="dangerouslySetInnerHTML"&&a!=="children"&&a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(eo.hasOwnProperty(a)?o||(o=[]):(o=o||[]).push(a,null));for(a in r){var u=r[a];if(l=s!=null?s[a]:void 0,r.hasOwnProperty(a)&&u!==l&&(u!=null||l!=null))if(a==="style")if(l){for(i in l)!l.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&l[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(o||(o=[]),o.push(a,n)),n=u;else a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(o=o||[]).push(a,u)):a==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(a,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&(eo.hasOwnProperty(a)?(u!=null&&a==="onScroll"&&re("scroll",t),o||l===u||(o=[])):(o=o||[]).push(a,u))}n&&(o=o||[]).push("style",n);var a=o;(e.updateQueue=a)&&(e.flags|=4)}};yg=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ds(t,e){if(!ie)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $e(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function $0(t,e,n){var r=e.pendingProps;switch(Nc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $e(e),null;case 1:return et(e.type)&&Mi(),$e(e),null;case 3:return r=e.stateNode,ts(),se(Ze),se(Fe),Gc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ii(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ot!==null&&(Uu(Ot),Ot=null))),xu(t,e),$e(e),null;case 5:Vc(e);var s=lr(ho.current);if(n=e.type,t!==null&&e.stateNode!=null)gg(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(C(166));return $e(e),null}if(t=lr(Yt.current),ii(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[zt]=e,r[co]=o,t=(e.mode&1)!==0,n){case"dialog":re("cancel",r),re("close",r);break;case"iframe":case"object":case"embed":re("load",r);break;case"video":case"audio":for(s=0;s<Us.length;s++)re(Us[s],r);break;case"source":re("error",r);break;case"img":case"image":case"link":re("error",r),re("load",r);break;case"details":re("toggle",r);break;case"input":pf(r,o),re("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},re("invalid",r);break;case"textarea":gf(r,o),re("invalid",r)}ru(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&oi(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&oi(r.textContent,l,t),s=["children",""+l]):eo.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&re("scroll",r)}switch(n){case"input":Xo(r),mf(r,o,!0);break;case"textarea":Xo(r),yf(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=$i)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zp(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[zt]=e,t[co]=r,mg(t,e,!1,!1),e.stateNode=t;e:{switch(i=su(n,r),n){case"dialog":re("cancel",t),re("close",t),s=r;break;case"iframe":case"object":case"embed":re("load",t),s=r;break;case"video":case"audio":for(s=0;s<Us.length;s++)re(Us[s],t);s=r;break;case"source":re("error",t),s=r;break;case"img":case"image":case"link":re("error",t),re("load",t),s=r;break;case"details":re("toggle",t),s=r;break;case"input":pf(t,r),s=Ja(t,r),re("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=de({},r,{value:void 0}),re("invalid",t);break;case"textarea":gf(t,r),s=tu(t,r),re("invalid",t);break;default:s=r}ru(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var u=l[o];o==="style"?Qp(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Hp(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&to(t,u):typeof u=="number"&&to(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(eo.hasOwnProperty(o)?u!=null&&o==="onScroll"&&re("scroll",t):u!=null&&yc(t,o,u,i))}switch(n){case"input":Xo(t),mf(t,r,!1);break;case"textarea":Xo(t),yf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vn(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Br(t,!!r.multiple,o,!1):r.defaultValue!=null&&Br(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $e(e),null;case 6:if(t&&e.stateNode!=null)yg(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(C(166));if(n=lr(ho.current),lr(Yt.current),ii(e)){if(r=e.stateNode,n=e.memoizedProps,r[zt]=e,(o=r.nodeValue!==n)&&(t=lt,t!==null))switch(t.tag){case 3:oi(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&oi(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[zt]=e,e.stateNode=r}return $e(e),null;case 13:if(se(ae),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ie&&it!==null&&e.mode&1&&!(e.flags&128))Lm(),Zr(),e.flags|=98560,o=!1;else if(o=ii(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(C(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(C(317));o[zt]=e}else Zr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$e(e),o=!1}else Ot!==null&&(Uu(Ot),Ot=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ae.current&1?Se===0&&(Se=3):Zc())),e.updateQueue!==null&&(e.flags|=4),$e(e),null);case 4:return ts(),xu(t,e),t===null&&ao(e.stateNode.containerInfo),$e(e),null;case 10:return $c(e.type._context),$e(e),null;case 17:return et(e.type)&&Mi(),$e(e),null;case 19:if(se(ae),o=e.memoizedState,o===null)return $e(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Ds(o,!1);else{if(Se!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ji(t),i!==null){for(e.flags|=128,Ds(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return te(ae,ae.current&1|2),e.child}t=t.sibling}o.tail!==null&&_e()>rs&&(e.flags|=128,r=!0,Ds(o,!1),e.lanes=4194304)}else{if(!r)if(t=ji(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ds(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!ie)return $e(e),null}else 2*_e()-o.renderingStartTime>rs&&n!==1073741824&&(e.flags|=128,r=!0,Ds(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=_e(),e.sibling=null,n=ae.current,te(ae,r?n&1|2:n&1),e):($e(e),null);case 22:case 23:return Jc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?st&1073741824&&($e(e),e.subtreeFlags&6&&(e.flags|=8192)):$e(e),null;case 24:return null;case 25:return null}throw Error(C(156,e.tag))}function M0(t,e){switch(Nc(e),e.tag){case 1:return et(e.type)&&Mi(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ts(),se(Ze),se(Fe),Gc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vc(e),null;case 13:if(se(ae),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(C(340));Zr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return se(ae),null;case 4:return ts(),null;case 10:return $c(e.type._context),null;case 22:case 23:return Jc(),null;case 24:return null;default:return null}}var ui=!1,Me=!1,U0=typeof WeakSet=="function"?WeakSet:Set,O=null;function Gr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){fe(t,e,r)}else n.current=null}function Ou(t,e,n){try{n()}catch(r){fe(t,e,r)}}var ih=!1;function F0(t,e){if(pu=Ri,t=Sm(),xc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,u=-1,a=0,f=0,c=t,d=null;t:for(;;){for(var h;c!==n||s!==0&&c.nodeType!==3||(l=i+s),c!==o||r!==0&&c.nodeType!==3||(u=i+r),c.nodeType===3&&(i+=c.nodeValue.length),(h=c.firstChild)!==null;)d=c,c=h;for(;;){if(c===t)break t;if(d===n&&++a===s&&(l=i),d===o&&++f===r&&(u=i),(h=c.nextSibling)!==null)break;c=d,d=c.parentNode}c=h}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(mu={focusedElem:t,selectionRange:n},Ri=!1,O=e;O!==null;)if(e=O,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,O=t;else for(;O!==null;){e=O;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,w=m.memoizedState,y=e.stateNode,p=y.getSnapshotBeforeUpdate(e.elementType===e.type?v:Dt(e.type,v),w);y.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(C(163))}}catch(S){fe(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,O=t;break}O=e.return}return m=ih,ih=!1,m}function Hs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Ou(e,n,o)}s=s.next}while(s!==r)}}function Tl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Nu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _g(t){var e=t.alternate;e!==null&&(t.alternate=null,_g(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zt],delete e[co],delete e[_u],delete e[w0],delete e[S0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vg(t){return t.tag===5||t.tag===3||t.tag===4}function lh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ru(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$i));else if(r!==4&&(t=t.child,t!==null))for(Ru(t,e,n),t=t.sibling;t!==null;)Ru(t,e,n),t=t.sibling}function Iu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Iu(t,e,n),t=t.sibling;t!==null;)Iu(t,e,n),t=t.sibling}var Oe=null,xt=!1;function vn(t,e,n){for(n=n.child;n!==null;)Eg(t,e,n),n=n.sibling}function Eg(t,e,n){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(vl,n)}catch{}switch(n.tag){case 5:Me||Gr(n,e);case 6:var r=Oe,s=xt;Oe=null,vn(t,e,n),Oe=r,xt=s,Oe!==null&&(xt?(t=Oe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Oe.removeChild(n.stateNode));break;case 18:Oe!==null&&(xt?(t=Oe,n=n.stateNode,t.nodeType===8?Sa(t.parentNode,n):t.nodeType===1&&Sa(t,n),oo(t)):Sa(Oe,n.stateNode));break;case 4:r=Oe,s=xt,Oe=n.stateNode.containerInfo,xt=!0,vn(t,e,n),Oe=r,xt=s;break;case 0:case 11:case 14:case 15:if(!Me&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Ou(n,e,i),s=s.next}while(s!==r)}vn(t,e,n);break;case 1:if(!Me&&(Gr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){fe(n,e,l)}vn(t,e,n);break;case 21:vn(t,e,n);break;case 22:n.mode&1?(Me=(r=Me)||n.memoizedState!==null,vn(t,e,n),Me=r):vn(t,e,n);break;default:vn(t,e,n)}}function ah(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new U0),e.forEach(function(r){var s=Q0.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Tt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:Oe=l.stateNode,xt=!1;break e;case 3:Oe=l.stateNode.containerInfo,xt=!0;break e;case 4:Oe=l.stateNode.containerInfo,xt=!0;break e}l=l.return}if(Oe===null)throw Error(C(160));Eg(o,i,s),Oe=null,xt=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(a){fe(s,e,a)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wg(e,t),e=e.sibling}function wg(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Tt(e,t),Bt(t),r&4){try{Hs(3,t,t.return),Tl(3,t)}catch(v){fe(t,t.return,v)}try{Hs(5,t,t.return)}catch(v){fe(t,t.return,v)}}break;case 1:Tt(e,t),Bt(t),r&512&&n!==null&&Gr(n,n.return);break;case 5:if(Tt(e,t),Bt(t),r&512&&n!==null&&Gr(n,n.return),t.flags&32){var s=t.stateNode;try{to(s,"")}catch(v){fe(t,t.return,v)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Bp(s,o),su(l,i);var a=su(l,o);for(i=0;i<u.length;i+=2){var f=u[i],c=u[i+1];f==="style"?Qp(s,c):f==="dangerouslySetInnerHTML"?Hp(s,c):f==="children"?to(s,c):yc(s,f,c,a)}switch(l){case"input":Za(s,o);break;case"textarea":jp(s,o);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Br(s,!!o.multiple,h,!1):d!==!!o.multiple&&(o.defaultValue!=null?Br(s,!!o.multiple,o.defaultValue,!0):Br(s,!!o.multiple,o.multiple?[]:"",!1))}s[co]=o}catch(v){fe(t,t.return,v)}}break;case 6:if(Tt(e,t),Bt(t),r&4){if(t.stateNode===null)throw Error(C(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(v){fe(t,t.return,v)}}break;case 3:if(Tt(e,t),Bt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{oo(e.containerInfo)}catch(v){fe(t,t.return,v)}break;case 4:Tt(e,t),Bt(t);break;case 13:Tt(e,t),Bt(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(qc=_e())),r&4&&ah(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Me=(a=Me)||f,Tt(e,t),Me=a):Tt(e,t),Bt(t),r&8192){if(a=t.memoizedState!==null,(t.stateNode.isHidden=a)&&!f&&t.mode&1)for(O=t,f=t.child;f!==null;){for(c=O=f;O!==null;){switch(d=O,h=d.child,d.tag){case 0:case 11:case 14:case 15:Hs(4,d,d.return);break;case 1:Gr(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){fe(r,n,v)}}break;case 5:Gr(d,d.return);break;case 22:if(d.memoizedState!==null){ch(c);continue}}h!==null?(h.return=d,O=h):ch(c)}f=f.sibling}e:for(f=null,c=t;;){if(c.tag===5){if(f===null){f=c;try{s=c.stateNode,a?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=c.stateNode,u=c.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Yp("display",i))}catch(v){fe(t,t.return,v)}}}else if(c.tag===6){if(f===null)try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(v){fe(t,t.return,v)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===t)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:Tt(e,t),Bt(t),r&4&&ah(t);break;case 21:break;default:Tt(e,t),Bt(t)}}function Bt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(vg(n)){var r=n;break e}n=n.return}throw Error(C(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(to(s,""),r.flags&=-33);var o=lh(t);Iu(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=lh(t);Ru(t,l,i);break;default:throw Error(C(161))}}catch(u){fe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function V0(t,e,n){O=t,Sg(t)}function Sg(t,e,n){for(var r=(t.mode&1)!==0;O!==null;){var s=O,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||ui;if(!i){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Me;l=ui;var a=Me;if(ui=i,(Me=u)&&!a)for(O=s;O!==null;)i=O,u=i.child,i.tag===22&&i.memoizedState!==null?dh(s):u!==null?(u.return=i,O=u):dh(s);for(;o!==null;)O=o,Sg(o),o=o.sibling;O=s,ui=l,Me=a}uh(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,O=o):uh(t)}}function uh(t){for(;O!==null;){var e=O;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Me||Tl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Me)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Dt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Yf(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Yf(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var a=e.alternate;if(a!==null){var f=a.memoizedState;if(f!==null){var c=f.dehydrated;c!==null&&oo(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(C(163))}Me||e.flags&512&&Nu(e)}catch(d){fe(e,e.return,d)}}if(e===t){O=null;break}if(n=e.sibling,n!==null){n.return=e.return,O=n;break}O=e.return}}function ch(t){for(;O!==null;){var e=O;if(e===t){O=null;break}var n=e.sibling;if(n!==null){n.return=e.return,O=n;break}O=e.return}}function dh(t){for(;O!==null;){var e=O;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Tl(4,e)}catch(u){fe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){fe(e,s,u)}}var o=e.return;try{Nu(e)}catch(u){fe(e,o,u)}break;case 5:var i=e.return;try{Nu(e)}catch(u){fe(e,i,u)}}}catch(u){fe(e,e.return,u)}if(e===t){O=null;break}var l=e.sibling;if(l!==null){l.return=e.return,O=l;break}O=e.return}}var G0=Math.ceil,Yi=gn.ReactCurrentDispatcher,Qc=gn.ReactCurrentOwner,St=gn.ReactCurrentBatchConfig,H=0,Ae=null,ve=null,Ne=0,st=0,Wr=qn(0),Se=0,yo=null,gr=0,Al=0,Kc=0,Ys=null,Qe=null,qc=0,rs=1/0,en=null,Qi=!1,Lu=null,Rn=null,ci=!1,kn=null,Ki=0,Qs=0,$u=null,Ci=-1,ki=0;function je(){return H&6?_e():Ci!==-1?Ci:Ci=_e()}function In(t){return t.mode&1?H&2&&Ne!==0?Ne&-Ne:C0.transition!==null?(ki===0&&(ki=im()),ki):(t=K,t!==0||(t=window.event,t=t===void 0?16:hm(t.type)),t):1}function It(t,e,n,r){if(50<Qs)throw Qs=0,$u=null,Error(C(185));No(t,n,r),(!(H&2)||t!==Ae)&&(t===Ae&&(!(H&2)&&(Al|=n),Se===4&&Pn(t,Ne)),tt(t,r),n===1&&H===0&&!(e.mode&1)&&(rs=_e()+500,Cl&&Xn()))}function tt(t,e){var n=t.callbackNode;Cv(t,e);var r=Ni(t,t===Ae?Ne:0);if(r===0)n!==null&&Ef(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ef(n),e===1)t.tag===0?P0(fh.bind(null,t)):Nm(fh.bind(null,t)),v0(function(){!(H&6)&&Xn()}),n=null;else{switch(lm(r)){case 1:n=Sc;break;case 4:n=sm;break;case 16:n=Oi;break;case 536870912:n=om;break;default:n=Oi}n=xg(n,Pg.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Pg(t,e){if(Ci=-1,ki=0,H&6)throw Error(C(327));var n=t.callbackNode;if(Qr()&&t.callbackNode!==n)return null;var r=Ni(t,t===Ae?Ne:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=qi(t,r);else{e=r;var s=H;H|=2;var o=kg();(Ae!==t||Ne!==e)&&(en=null,rs=_e()+500,ur(t,e));do try{j0();break}catch(l){Cg(t,l)}while(!0);Lc(),Yi.current=o,H=s,ve!==null?e=0:(Ae=null,Ne=0,e=Se)}if(e!==0){if(e===2&&(s=uu(t),s!==0&&(r=s,e=Mu(t,s))),e===1)throw n=yo,ur(t,0),Pn(t,r),tt(t,_e()),n;if(e===6)Pn(t,r);else{if(s=t.current.alternate,!(r&30)&&!W0(s)&&(e=qi(t,r),e===2&&(o=uu(t),o!==0&&(r=o,e=Mu(t,o))),e===1))throw n=yo,ur(t,0),Pn(t,r),tt(t,_e()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(C(345));case 2:nr(t,Qe,en);break;case 3:if(Pn(t,r),(r&130023424)===r&&(e=qc+500-_e(),10<e)){if(Ni(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){je(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=yu(nr.bind(null,t,Qe,en),e);break}nr(t,Qe,en);break;case 4:if(Pn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-Rt(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=_e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*G0(r/1960))-r,10<r){t.timeoutHandle=yu(nr.bind(null,t,Qe,en),r);break}nr(t,Qe,en);break;case 5:nr(t,Qe,en);break;default:throw Error(C(329))}}}return tt(t,_e()),t.callbackNode===n?Pg.bind(null,t):null}function Mu(t,e){var n=Ys;return t.current.memoizedState.isDehydrated&&(ur(t,e).flags|=256),t=qi(t,e),t!==2&&(e=Qe,Qe=n,e!==null&&Uu(e)),t}function Uu(t){Qe===null?Qe=t:Qe.push.apply(Qe,t)}function W0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!$t(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pn(t,e){for(e&=~Kc,e&=~Al,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Rt(e),r=1<<n;t[n]=-1,e&=~r}}function fh(t){if(H&6)throw Error(C(327));Qr();var e=Ni(t,0);if(!(e&1))return tt(t,_e()),null;var n=qi(t,e);if(t.tag!==0&&n===2){var r=uu(t);r!==0&&(e=r,n=Mu(t,r))}if(n===1)throw n=yo,ur(t,0),Pn(t,e),tt(t,_e()),n;if(n===6)throw Error(C(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nr(t,Qe,en),tt(t,_e()),null}function Xc(t,e){var n=H;H|=1;try{return t(e)}finally{H=n,H===0&&(rs=_e()+500,Cl&&Xn())}}function yr(t){kn!==null&&kn.tag===0&&!(H&6)&&Qr();var e=H;H|=1;var n=St.transition,r=K;try{if(St.transition=null,K=1,t)return t()}finally{K=r,St.transition=n,H=e,!(H&6)&&Xn()}}function Jc(){st=Wr.current,se(Wr)}function ur(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_0(n)),ve!==null)for(n=ve.return;n!==null;){var r=n;switch(Nc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Mi();break;case 3:ts(),se(Ze),se(Fe),Gc();break;case 5:Vc(r);break;case 4:ts();break;case 13:se(ae);break;case 19:se(ae);break;case 10:$c(r.type._context);break;case 22:case 23:Jc()}n=n.return}if(Ae=t,ve=t=Ln(t.current,null),Ne=st=e,Se=0,yo=null,Kc=Al=gr=0,Qe=Ys=null,ir!==null){for(e=0;e<ir.length;e++)if(n=ir[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}ir=null}return t}function Cg(t,e){do{var n=ve;try{if(Lc(),wi.current=Hi,zi){for(var r=ce.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}zi=!1}if(mr=0,Ce=Ee=ce=null,zs=!1,po=0,Qc.current=null,n===null||n.return===null){Se=1,yo=e,ve=null;break}e:{var o=t,i=n.return,l=n,u=e;if(e=Ne,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var a=u,f=l,c=f.tag;if(!(f.mode&1)&&(c===0||c===11||c===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=Zf(i);if(h!==null){h.flags&=-257,eh(h,i,l,o,e),h.mode&1&&Jf(o,a,e),e=h,u=a;var m=e.updateQueue;if(m===null){var v=new Set;v.add(u),e.updateQueue=v}else m.add(u);break e}else{if(!(e&1)){Jf(o,a,e),Zc();break e}u=Error(C(426))}}else if(ie&&l.mode&1){var w=Zf(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),eh(w,i,l,o,e),Rc(ns(u,l));break e}}o=u=ns(u,l),Se!==4&&(Se=2),Ys===null?Ys=[o]:Ys.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var y=lg(o,u,e);Hf(o,y);break e;case 1:l=u;var p=o.type,g=o.stateNode;if(!(o.flags&128)&&(typeof p.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Rn===null||!Rn.has(g)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=ag(o,l,e);Hf(o,S);break e}}o=o.return}while(o!==null)}Tg(n)}catch(P){e=P,ve===n&&n!==null&&(ve=n=n.return);continue}break}while(!0)}function kg(){var t=Yi.current;return Yi.current=Hi,t===null?Hi:t}function Zc(){(Se===0||Se===3||Se===2)&&(Se=4),Ae===null||!(gr&268435455)&&!(Al&268435455)||Pn(Ae,Ne)}function qi(t,e){var n=H;H|=2;var r=kg();(Ae!==t||Ne!==e)&&(en=null,ur(t,e));do try{B0();break}catch(s){Cg(t,s)}while(!0);if(Lc(),H=n,Yi.current=r,ve!==null)throw Error(C(261));return Ae=null,Ne=0,Se}function B0(){for(;ve!==null;)bg(ve)}function j0(){for(;ve!==null&&!mv();)bg(ve)}function bg(t){var e=Dg(t.alternate,t,st);t.memoizedProps=t.pendingProps,e===null?Tg(t):ve=e,Qc.current=null}function Tg(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=M0(n,e),n!==null){n.flags&=32767,ve=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Se=6,ve=null;return}}else if(n=$0(n,e,st),n!==null){ve=n;return}if(e=e.sibling,e!==null){ve=e;return}ve=e=t}while(e!==null);Se===0&&(Se=5)}function nr(t,e,n){var r=K,s=St.transition;try{St.transition=null,K=1,z0(t,e,n,r)}finally{St.transition=s,K=r}return null}function z0(t,e,n,r){do Qr();while(kn!==null);if(H&6)throw Error(C(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(C(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(kv(t,o),t===Ae&&(ve=Ae=null,Ne=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ci||(ci=!0,xg(Oi,function(){return Qr(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=St.transition,St.transition=null;var i=K;K=1;var l=H;H|=4,Qc.current=null,F0(t,n),wg(n,t),d0(mu),Ri=!!pu,mu=pu=null,t.current=n,V0(n),gv(),H=l,K=i,St.transition=o}else t.current=n;if(ci&&(ci=!1,kn=t,Ki=s),o=t.pendingLanes,o===0&&(Rn=null),vv(n.stateNode),tt(t,_e()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Qi)throw Qi=!1,t=Lu,Lu=null,t;return Ki&1&&t.tag!==0&&Qr(),o=t.pendingLanes,o&1?t===$u?Qs++:(Qs=0,$u=t):Qs=0,Xn(),null}function Qr(){if(kn!==null){var t=lm(Ki),e=St.transition,n=K;try{if(St.transition=null,K=16>t?16:t,kn===null)var r=!1;else{if(t=kn,kn=null,Ki=0,H&6)throw Error(C(331));var s=H;for(H|=4,O=t.current;O!==null;){var o=O,i=o.child;if(O.flags&16){var l=o.deletions;if(l!==null){for(var u=0;u<l.length;u++){var a=l[u];for(O=a;O!==null;){var f=O;switch(f.tag){case 0:case 11:case 15:Hs(8,f,o)}var c=f.child;if(c!==null)c.return=f,O=c;else for(;O!==null;){f=O;var d=f.sibling,h=f.return;if(_g(f),f===a){O=null;break}if(d!==null){d.return=h,O=d;break}O=h}}}var m=o.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}O=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,O=i;else e:for(;O!==null;){if(o=O,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Hs(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,O=y;break e}O=o.return}}var p=t.current;for(O=p;O!==null;){i=O;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,O=g;else e:for(i=p;O!==null;){if(l=O,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Tl(9,l)}}catch(P){fe(l,l.return,P)}if(l===i){O=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,O=S;break e}O=l.return}}if(H=s,Xn(),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(vl,t)}catch{}r=!0}return r}finally{K=n,St.transition=e}}return!1}function hh(t,e,n){e=ns(n,e),e=lg(t,e,1),t=Nn(t,e,1),e=je(),t!==null&&(No(t,1,e),tt(t,e))}function fe(t,e,n){if(t.tag===3)hh(t,t,n);else for(;e!==null;){if(e.tag===3){hh(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rn===null||!Rn.has(r))){t=ns(n,t),t=ag(e,t,1),e=Nn(e,t,1),t=je(),e!==null&&(No(e,1,t),tt(e,t));break}}e=e.return}}function H0(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=je(),t.pingedLanes|=t.suspendedLanes&n,Ae===t&&(Ne&n)===n&&(Se===4||Se===3&&(Ne&130023424)===Ne&&500>_e()-qc?ur(t,0):Kc|=n),tt(t,e)}function Ag(t,e){e===0&&(t.mode&1?(e=ei,ei<<=1,!(ei&130023424)&&(ei=4194304)):e=1);var n=je();t=dn(t,e),t!==null&&(No(t,e,n),tt(t,n))}function Y0(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Ag(t,n)}function Q0(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(C(314))}r!==null&&r.delete(e),Ag(t,n)}var Dg;Dg=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ze.current)Xe=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xe=!1,L0(t,e,n);Xe=!!(t.flags&131072)}else Xe=!1,ie&&e.flags&1048576&&Rm(e,Vi,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Pi(t,e),t=e.pendingProps;var s=Jr(e,Fe.current);Yr(e,n),s=Bc(null,e,r,t,s,n);var o=jc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,et(r)?(o=!0,Ui(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Uc(e),s.updater=bl,e.stateNode=s,s._reactInternals=e,Cu(e,r,t,n),e=Tu(null,e,r,!0,o,n)):(e.tag=0,ie&&o&&Oc(e),Ge(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Pi(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=q0(r),t=Dt(r,t),s){case 0:e=bu(null,e,r,t,n);break e;case 1:e=rh(null,e,r,t,n);break e;case 11:e=th(null,e,r,t,n);break e;case 14:e=nh(null,e,r,Dt(r.type,t),n);break e}throw Error(C(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dt(r,s),bu(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dt(r,s),rh(t,e,r,s,n);case 3:e:{if(fg(e),t===null)throw Error(C(387));r=e.pendingProps,o=e.memoizedState,s=o.element,Fm(t,e),Bi(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=ns(Error(C(423)),e),e=sh(t,e,r,n,s);break e}else if(r!==s){s=ns(Error(C(424)),e),e=sh(t,e,r,n,s);break e}else for(it=On(e.stateNode.containerInfo.firstChild),lt=e,ie=!0,Ot=null,n=Mm(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Zr(),r===s){e=fn(t,e,n);break e}Ge(t,e,r,n)}e=e.child}return e;case 5:return Vm(e),t===null&&wu(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,gu(r,s)?i=null:o!==null&&gu(r,o)&&(e.flags|=32),dg(t,e),Ge(t,e,i,n),e.child;case 6:return t===null&&wu(e),null;case 13:return hg(t,e,n);case 4:return Fc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=es(e,null,r,n):Ge(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dt(r,s),th(t,e,r,s,n);case 7:return Ge(t,e,e.pendingProps,n),e.child;case 8:return Ge(t,e,e.pendingProps.children,n),e.child;case 12:return Ge(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,te(Gi,r._currentValue),r._currentValue=i,o!==null)if($t(o.value,i)){if(o.children===s.children&&!Ze.current){e=fn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=on(-1,n&-n),u.tag=2;var a=o.updateQueue;if(a!==null){a=a.shared;var f=a.pending;f===null?u.next=u:(u.next=f.next,f.next=u),a.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Su(o.return,n,e),l.lanes|=n;break}u=u.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(C(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Su(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Ge(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Yr(e,n),s=Pt(s),r=r(s),e.flags|=1,Ge(t,e,r,n),e.child;case 14:return r=e.type,s=Dt(r,e.pendingProps),s=Dt(r.type,s),nh(t,e,r,s,n);case 15:return ug(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dt(r,s),Pi(t,e),e.tag=1,et(r)?(t=!0,Ui(e)):t=!1,Yr(e,n),ig(e,r,s),Cu(e,r,s,n),Tu(null,e,r,!0,t,n);case 19:return pg(t,e,n);case 22:return cg(t,e,n)}throw Error(C(156,e.tag))};function xg(t,e){return rm(t,e)}function K0(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vt(t,e,n,r){return new K0(t,e,n,r)}function ed(t){return t=t.prototype,!(!t||!t.isReactComponent)}function q0(t){if(typeof t=="function")return ed(t)?1:0;if(t!=null){if(t=t.$$typeof,t===vc)return 11;if(t===Ec)return 14}return 2}function Ln(t,e){var n=t.alternate;return n===null?(n=vt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function bi(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")ed(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Nr:return cr(n.children,s,o,e);case _c:i=8,s|=8;break;case Qa:return t=vt(12,n,e,s|2),t.elementType=Qa,t.lanes=o,t;case Ka:return t=vt(13,n,e,s),t.elementType=Ka,t.lanes=o,t;case qa:return t=vt(19,n,e,s),t.elementType=qa,t.lanes=o,t;case Vp:return Dl(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Up:i=10;break e;case Fp:i=9;break e;case vc:i=11;break e;case Ec:i=14;break e;case En:i=16,r=null;break e}throw Error(C(130,t==null?t:typeof t,""))}return e=vt(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function cr(t,e,n,r){return t=vt(7,t,r,e),t.lanes=n,t}function Dl(t,e,n,r){return t=vt(22,t,r,e),t.elementType=Vp,t.lanes=n,t.stateNode={isHidden:!1},t}function xa(t,e,n){return t=vt(6,t,null,e),t.lanes=n,t}function Oa(t,e,n){return e=vt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function X0(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=da(0),this.expirationTimes=da(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=da(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function td(t,e,n,r,s,o,i,l,u){return t=new X0(t,e,n,l,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=vt(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uc(o),t}function J0(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Or,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Og(t){if(!t)return Gn;t=t._reactInternals;e:{if(Pr(t)!==t||t.tag!==1)throw Error(C(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(et(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(C(171))}if(t.tag===1){var n=t.type;if(et(n))return Om(t,n,e)}return e}function Ng(t,e,n,r,s,o,i,l,u){return t=td(n,r,!0,t,s,o,i,l,u),t.context=Og(null),n=t.current,r=je(),s=In(n),o=on(r,s),o.callback=e??null,Nn(n,o,s),t.current.lanes=s,No(t,s,r),tt(t,r),t}function xl(t,e,n,r){var s=e.current,o=je(),i=In(s);return n=Og(n),e.context===null?e.context=n:e.pendingContext=n,e=on(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Nn(s,e,i),t!==null&&(It(t,s,i,o),Ei(t,s,i)),i}function Xi(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ph(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function nd(t,e){ph(t,e),(t=t.alternate)&&ph(t,e)}function Z0(){return null}var Rg=typeof reportError=="function"?reportError:function(t){console.error(t)};function rd(t){this._internalRoot=t}Ol.prototype.render=rd.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(C(409));xl(t,e,null,null)};Ol.prototype.unmount=rd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yr(function(){xl(null,t,null,null)}),e[cn]=null}};function Ol(t){this._internalRoot=t}Ol.prototype.unstable_scheduleHydration=function(t){if(t){var e=cm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Sn.length&&e!==0&&e<Sn[n].priority;n++);Sn.splice(n,0,t),n===0&&fm(t)}};function sd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Nl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mh(){}function eE(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var a=Xi(i);o.call(a)}}var i=Ng(e,r,t,0,null,!1,!1,"",mh);return t._reactRootContainer=i,t[cn]=i.current,ao(t.nodeType===8?t.parentNode:t),yr(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var a=Xi(u);l.call(a)}}var u=td(t,0,!1,null,null,!1,!1,"",mh);return t._reactRootContainer=u,t[cn]=u.current,ao(t.nodeType===8?t.parentNode:t),yr(function(){xl(e,u,n,r)}),u}function Rl(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var u=Xi(i);l.call(u)}}xl(e,i,t,s)}else i=eE(n,e,t,s,r);return Xi(i)}am=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ms(e.pendingLanes);n!==0&&(Pc(e,n|1),tt(e,_e()),!(H&6)&&(rs=_e()+500,Xn()))}break;case 13:yr(function(){var r=dn(t,1);if(r!==null){var s=je();It(r,t,1,s)}}),nd(t,1)}};Cc=function(t){if(t.tag===13){var e=dn(t,134217728);if(e!==null){var n=je();It(e,t,134217728,n)}nd(t,134217728)}};um=function(t){if(t.tag===13){var e=In(t),n=dn(t,e);if(n!==null){var r=je();It(n,t,e,r)}nd(t,e)}};cm=function(){return K};dm=function(t,e){var n=K;try{return K=t,e()}finally{K=n}};iu=function(t,e,n){switch(e){case"input":if(Za(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Pl(r);if(!s)throw Error(C(90));Wp(r),Za(r,s)}}}break;case"textarea":jp(t,n);break;case"select":e=n.value,e!=null&&Br(t,!!n.multiple,e,!1)}};Xp=Xc;Jp=yr;var tE={usingClientEntryPoint:!1,Events:[Io,$r,Pl,Kp,qp,Xc]},xs={findFiberByHostInstance:or,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nE={bundleType:xs.bundleType,version:xs.version,rendererPackageName:xs.rendererPackageName,rendererConfig:xs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=tm(t),t===null?null:t.stateNode},findFiberByHostInstance:xs.findFiberByHostInstance||Z0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var di=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!di.isDisabled&&di.supportsFiber)try{vl=di.inject(nE),Ht=di}catch{}}ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tE;ft.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sd(e))throw Error(C(200));return J0(t,e,null,n)};ft.createRoot=function(t,e){if(!sd(t))throw Error(C(299));var n=!1,r="",s=Rg;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=td(t,1,!1,null,null,n,!1,r,s),t[cn]=e.current,ao(t.nodeType===8?t.parentNode:t),new rd(e)};ft.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(C(188)):(t=Object.keys(t).join(","),Error(C(268,t)));return t=tm(e),t=t===null?null:t.stateNode,t};ft.flushSync=function(t){return yr(t)};ft.hydrate=function(t,e,n){if(!Nl(e))throw Error(C(200));return Rl(null,t,e,!0,n)};ft.hydrateRoot=function(t,e,n){if(!sd(t))throw Error(C(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=Rg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=Ng(e,null,t,1,n??null,s,!1,o,i),t[cn]=e.current,ao(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ol(e)};ft.render=function(t,e,n){if(!Nl(e))throw Error(C(200));return Rl(null,t,e,!1,n)};ft.unmountComponentAtNode=function(t){if(!Nl(t))throw Error(C(40));return t._reactRootContainer?(yr(function(){Rl(null,null,t,!1,function(){t._reactRootContainer=null,t[cn]=null})}),!0):!1};ft.unstable_batchedUpdates=Xc;ft.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Nl(n))throw Error(C(200));if(t==null||t._reactInternals===void 0)throw Error(C(38));return Rl(t,e,n,!1,r)};ft.version="18.3.1-next-f1338f8080-20240426";function Ig(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ig)}catch(t){console.error(t)}}Ig(),Ip.exports=ft;var rE=Ip.exports,gh=rE;Ha.createRoot=gh.createRoot,Ha.hydrateRoot=gh.hydrateRoot;const sE=()=>{};var yh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k=function(t,e){if(!t)throw ms(e)},ms=function(t){return new Error("Firebase Database ("+Lg.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},oE=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],i=t[n++],l=t[n++],u=((s&7)<<18|(o&63)<<12|(i&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const o=t[n++],i=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},od={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],i=s+1<t.length,l=i?t[s+1]:0,u=s+2<t.length,a=u?t[s+2]:0,f=o>>2,c=(o&3)<<4|l>>4;let d=(l&15)<<2|a>>6,h=a&63;u||(h=64,i||(d=64)),r.push(n[f],n[c],n[d],n[h])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray($g(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):oE(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const a=s<t.length?n[t.charAt(s)]:64;++s;const c=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||l==null||a==null||c==null)throw new iE;const d=o<<2|l>>4;if(r.push(d),a!==64){const h=l<<4&240|a>>2;if(r.push(h),c!==64){const m=a<<6&192|c;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class iE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Mg=function(t){const e=$g(t);return od.encodeByteArray(e,!0)},Ji=function(t){return Mg(t).replace(/\./g,"")},Zi=function(t){try{return od.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(t){return _o(void 0,t)}function _o(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!aE(n)||(t[n]=_o(t[n],e[n]));return t}function aE(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE=()=>Ug().__FIREBASE_DEFAULTS__,cE=()=>{if(typeof process>"u"||typeof yh>"u")return;const t=yh.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},dE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Zi(t[1]);return e&&JSON.parse(e)},fE=()=>{try{return sE()||uE()||cE()||dE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},id=()=>{var t;return(t=fE())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hE(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ji(JSON.stringify(n)),Ji(JSON.stringify(i)),""].join(".")}const Ks={};function mE(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ks))Ks[e]?t.emulator.push(e):t.prod.push(e);return t}function gE(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let _h=!1;function yE(t,e){if(typeof window>"u"||typeof document>"u"||!ld(window.location.host)||Ks[t]===e||Ks[t]||_h)return;Ks[t]=e;function n(d){return`__firebase__banner__${d}`}const r="__firebase__banner",o=mE().prod.length>0;function i(){const d=document.getElementById(r);d&&d.remove()}function l(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function u(d,h){d.setAttribute("width","24"),d.setAttribute("id",h),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function a(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{_h=!0,i()},d}function f(d,h){d.setAttribute("id",h),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function c(){const d=gE(r),h=n("text"),m=document.getElementById(h)||document.createElement("span"),v=n("learnmore"),w=document.getElementById(v)||document.createElement("a"),y=n("preprendIcon"),p=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const g=d.element;l(g),f(w,v);const S=a();u(p,y),g.append(p,m,w,S),document.body.appendChild(g)}o?(m.innerText="Preview backend disconnected.",p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",h)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",c):c()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Fg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_E())}function vE(){return typeof window<"u"||Vg()}function Vg(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function EE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wE(){return Lg.NODE_ADMIN===!0}function SE(){try{return typeof indexedDB=="object"}catch{return!1}}function PE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE="FirebaseError";class gs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=CE,Object.setPrototypeOf(this,gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Il.prototype.create)}}class Il{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?kE(o,r):"Error",l=`${this.serviceName}: ${i} (${s}).`;return new gs(s,l,r)}}function kE(t,e){return t.replace(bE,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const bE=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(t){return JSON.parse(t)}function we(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg=function(t){let e={},n={},r={},s="";try{const o=t.split(".");e=vo(Zi(o[0])||""),n=vo(Zi(o[1])||""),s=o[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},TE=function(t){const e=Gg(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},AE=function(t){const e=Gg(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _r(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Fu(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function el(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function tl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(vh(o)&&vh(i)){if(!tl(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function vh(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let c=0;c<16;c++)r[c]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let c=0;c<16;c++)r[c]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let c=16;c<80;c++){const d=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=(d<<1|d>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],i=this.chain_[2],l=this.chain_[3],u=this.chain_[4],a,f;for(let c=0;c<80;c++){c<40?c<20?(a=l^o&(i^l),f=1518500249):(a=o^i^l,f=1859775393):c<60?(a=o&i|l&(o|i),f=2400959708):(a=o^i^l,f=3395469782);const d=(s<<5|s>>>27)+a+u+f+r[c]&4294967295;u=l,l=i,i=(o<<30|o>>>2)&4294967295,o=s,s=d}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+i&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const o=this.buf_;let i=this.inbuf_;for(;s<n;){if(i===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(o[i]=e.charCodeAt(s),++i,++s,i===this.blockSize){this.compress_(o),i=0;break}}else for(;s<n;)if(o[i]=e[s],++i,++s,i===this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[s]>>o&255,++r;return e}}function OE(t,e){const n=new NE(t,e);return n.subscribe.bind(n)}class NE{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");RE(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Na),s.error===void 0&&(s.error=Na),s.complete===void 0&&(s.complete=Na);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function RE(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Na(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L=function(t,e,n,r){let s;if(r<e?s="at least "+e:r>n&&(s=n===0?"none":"no more than "+n),s){const o=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(o)}};function nt(t,e){return`${t} failed: ${e} argument `}function ke(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(nt(t,e)+"must be a valid function.")}function Eh(t,e,n,r){if(n&&(typeof n!="object"||n===null))throw new Error(nt(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const o=s-55296;r++,k(r<t.length,"Surrogate pair missing trail surrogate.");const i=t.charCodeAt(r)-56320;s=65536+(o<<10)+i}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Ll=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(t){return t&&t._delegate?t._delegate:t}class hn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ke;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($E(e))try{this.getOrInitializeService({instanceIdentifier:rr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=rr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rr){return this.instances.has(e)}getOptions(e=rr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);r===l&&i.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:LE(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=rr){return this.component?this.component.multipleInstances?e:rr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function LE(t){return t===rr?void 0:t}function $E(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Vu(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ud=[];var J;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(J||(J={}));const Wg={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},ME=J.INFO,UE={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},FE=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=UE[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $l{constructor(e){this.name=e,this._logLevel=ME,this._logHandler=FE,this._userLogHandler=null,ud.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in J))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Wg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...e),this._logHandler(this,J.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...e),this._logHandler(this,J.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,J.INFO,...e),this._logHandler(this,J.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,J.WARN,...e),this._logHandler(this,J.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...e),this._logHandler(this,J.ERROR,...e)}}function VE(t){ud.forEach(e=>{e.setLogLevel(t)})}function GE(t,e){for(const n of ud){let r=null;e&&e.level&&(r=Wg[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,o,...i)=>{const l=i.map(u=>{if(u==null)return null;if(typeof u=="string")return u;if(typeof u=="number"||typeof u=="boolean")return u.toString();if(u instanceof Error)return u.message;try{return JSON.stringify(u)}catch{return null}}).filter(u=>u).join(" ");o>=(r??s.logLevel)&&t({level:J[o].toLowerCase(),message:l,args:i,type:s.name})}}}const WE=(t,e)=>e.some(n=>t instanceof n);let wh,Sh;function BE(){return wh||(wh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jE(){return Sh||(Sh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bg=new WeakMap,Gu=new WeakMap,jg=new WeakMap,Ra=new WeakMap,cd=new WeakMap;function zE(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{n($n(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&Bg.set(n,t)}).catch(()=>{}),cd.set(e,t),e}function HE(t){if(Gu.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});Gu.set(t,e)}let Wu={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Gu.get(t);if(e==="objectStoreNames")return t.objectStoreNames||jg.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $n(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function YE(t){Wu=t(Wu)}function QE(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ia(this),e,...n);return jg.set(r,e.sort?e.sort():[e]),$n(r)}:jE().includes(t)?function(...e){return t.apply(Ia(this),e),$n(Bg.get(this))}:function(...e){return $n(t.apply(Ia(this),e))}}function KE(t){return typeof t=="function"?QE(t):(t instanceof IDBTransaction&&HE(t),WE(t,BE())?new Proxy(t,Wu):t)}function $n(t){if(t instanceof IDBRequest)return zE(t);if(Ra.has(t))return Ra.get(t);const e=KE(t);return e!==t&&(Ra.set(t,e),cd.set(e,t)),e}const Ia=t=>cd.get(t);function qE(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(t,e),l=$n(i);return r&&i.addEventListener("upgradeneeded",u=>{r($n(i.result),u.oldVersion,u.newVersion,$n(i.transaction),u)}),n&&i.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{o&&u.addEventListener("close",()=>o()),s&&u.addEventListener("versionchange",a=>s(a.oldVersion,a.newVersion,a))}).catch(()=>{}),l}const XE=["get","getKey","getAll","getAllKeys","count"],JE=["put","add","delete","clear"],La=new Map;function Ph(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(La.get(e))return La.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=JE.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||XE.includes(n)))return;const o=async function(i,...l){const u=this.transaction(i,s?"readwrite":"readonly");let a=u.store;return r&&(a=a.index(l.shift())),(await Promise.all([a[n](...l),s&&u.done]))[0]};return La.set(e,o),o}YE(t=>({...t,get:(e,n,r)=>Ph(e,n)||t.get(e,n,r),has:(e,n)=>!!Ph(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(ew(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function ew(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nl="@firebase/app",Bu="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn=new $l("@firebase/app"),tw="@firebase/app-compat",nw="@firebase/analytics-compat",rw="@firebase/analytics",sw="@firebase/app-check-compat",ow="@firebase/app-check",iw="@firebase/auth",lw="@firebase/auth-compat",aw="@firebase/database",uw="@firebase/data-connect",cw="@firebase/database-compat",dw="@firebase/functions",fw="@firebase/functions-compat",hw="@firebase/installations",pw="@firebase/installations-compat",mw="@firebase/messaging",gw="@firebase/messaging-compat",yw="@firebase/performance",_w="@firebase/performance-compat",vw="@firebase/remote-config",Ew="@firebase/remote-config-compat",ww="@firebase/storage",Sw="@firebase/storage-compat",Pw="@firebase/firestore",Cw="@firebase/ai",kw="@firebase/firestore-compat",bw="firebase",Tw="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="[DEFAULT]",Aw={[nl]:"fire-core",[tw]:"fire-core-compat",[rw]:"fire-analytics",[nw]:"fire-analytics-compat",[ow]:"fire-app-check",[sw]:"fire-app-check-compat",[iw]:"fire-auth",[lw]:"fire-auth-compat",[aw]:"fire-rtdb",[uw]:"fire-data-connect",[cw]:"fire-rtdb-compat",[dw]:"fire-fn",[fw]:"fire-fn-compat",[hw]:"fire-iid",[pw]:"fire-iid-compat",[mw]:"fire-fcm",[gw]:"fire-fcm-compat",[yw]:"fire-perf",[_w]:"fire-perf-compat",[vw]:"fire-rc",[Ew]:"fire-rc-compat",[ww]:"fire-gcs",[Sw]:"fire-gcs-compat",[Pw]:"fire-fst",[kw]:"fire-fst-compat",[Cw]:"fire-vertex","fire-js":"fire-js",[bw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn=new Map,ss=new Map,os=new Map;function Eo(t,e){try{t.container.addComponent(e)}catch(n){pn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function zg(t,e){t.container.addOrOverwriteComponent(e)}function is(t){const e=t.name;if(os.has(e))return pn.debug(`There were multiple attempts to register component ${e}.`),!1;os.set(e,t);for(const n of Bn.values())Eo(n,t);for(const n of ss.values())Eo(n,t);return!0}function Hg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Dw(t,e,n=Wn){Hg(t,e).clearInstance(n)}function dd(t){return t.options!==void 0}function Yg(t){return dd(t)?!1:"authIdToken"in t||"appCheckToken"in t||"releaseOnDeref"in t||"automaticDataCollectionEnabled"in t}function Qg(t){return t==null?!1:t.settings!==void 0}function xw(){os.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},at=new Il("app","Firebase",Ow);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kg=class{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw at.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ch(t,e){const n=Zi(t.split(".")[1]);if(n===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(n).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const s=JSON.parse(n).exp*1e3,o=new Date().getTime();s-o<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class Nw extends Kg{constructor(e,n,r,s){const o=n.automaticDataCollectionEnabled!==void 0?n.automaticDataCollectionEnabled:!0,i={name:r,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,i,s);else{const l=e;super(l.options,i,s)}this._serverConfig={automaticDataCollectionEnabled:o,...n},this._serverConfig.authIdToken&&Ch(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Ch(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,ln(nl,Bu,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){pd(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw at.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=Tw;function hd(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Wn,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw at.create("bad-app-name",{appName:String(s)});if(n||(n=id()),!n)throw at.create("no-options");const o=Bn.get(s);if(o){if(tl(n,o.options)&&tl(r,o.config))return o;throw at.create("duplicate-app",{appName:s})}const i=new ad(s);for(const u of os.values())i.addComponent(u);const l=new Kg(n,r,i);return Bn.set(s,l),l}function Rw(t,e={}){if(vE()&&!Vg())throw at.create("invalid-server-app-environment");let n,r=e||{};if(t&&(dd(t)?n=t.options:Yg(t)?r=t:n=t),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),n||(n=id()),!n)throw at.create("no-options");const s={...r,...n};s.releaseOnDeref!==void 0&&delete s.releaseOnDeref;const o=f=>[...f].reduce((c,d)=>Math.imul(31,c)+d.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw at.create("finalization-registry-not-supported",{});const i=""+o(JSON.stringify(s)),l=ss.get(i);if(l)return l.incRefCount(r.releaseOnDeref),l;const u=new ad(i);for(const f of os.values())u.addComponent(f);const a=new Nw(n,r,i,u);return ss.set(i,a),a}function Iw(t=Wn){const e=Bn.get(t);if(!e&&t===Wn&&id())return hd();if(!e)throw at.create("no-app",{appName:t});return e}function Lw(){return Array.from(Bn.values())}async function pd(t){let e=!1;const n=t.name;Bn.has(n)?(e=!0,Bn.delete(n)):ss.has(n)&&t.decRefCount()<=0&&(ss.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function ln(t,e,n){let r=Aw[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const i=[`Unable to register library "${r}" with version "${e}":`];s&&i.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&i.push("and"),o&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pn.warn(i.join(" "));return}is(new hn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function qg(t,e){if(t!==null&&typeof t!="function")throw at.create("invalid-log-argument");GE(t,e)}function Xg(t){VE(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="firebase-heartbeat-database",Mw=1,wo="firebase-heartbeat-store";let $a=null;function Jg(){return $a||($a=qE($w,Mw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(wo)}catch(n){console.warn(n)}}}}).catch(t=>{throw at.create("idb-open",{originalErrorMessage:t.message})})),$a}async function Uw(t){try{const n=(await Jg()).transaction(wo),r=await n.objectStore(wo).get(Zg(t));return await n.done,r}catch(e){if(e instanceof gs)pn.warn(e.message);else{const n=at.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pn.warn(n.message)}}}async function kh(t,e){try{const r=(await Jg()).transaction(wo,"readwrite");await r.objectStore(wo).put(e,Zg(t)),await r.done}catch(n){if(n instanceof gs)pn.warn(n.message);else{const r=at.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});pn.warn(r.message)}}}function Zg(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw=1024,Vw=30;class Gw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Bw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=bh();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(i=>i.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>Vw){const i=jw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){pn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=bh(),{heartbeatsToSend:r,unsentEntries:s}=Ww(this._heartbeatsCache.heartbeats),o=Ji(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return pn.warn(n),""}}}function bh(){return new Date().toISOString().substring(0,10)}function Ww(t,e=Fw){const n=[];let r=t.slice();for(const s of t){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),Th(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Th(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Bw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SE()?PE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Uw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return kh(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return kh(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Th(t){return Ji(JSON.stringify({version:2,heartbeats:t})).length}function jw(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(t){is(new hn("platform-logger",e=>new ZE(e),"PRIVATE")),is(new hn("heartbeat",e=>new Gw(e),"PRIVATE")),ln(nl,Bu,t),ln(nl,Bu,"esm2020"),ln("fire-js","")}zw("");const Hw=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:gs,SDK_VERSION:fd,_DEFAULT_ENTRY_NAME:Wn,_addComponent:Eo,_addOrOverwriteComponent:zg,_apps:Bn,_clearComponents:xw,_components:os,_getProvider:Hg,_isFirebaseApp:dd,_isFirebaseServerApp:Qg,_isFirebaseServerAppSettings:Yg,_registerComponent:is,_removeServiceInstance:Dw,_serverApps:ss,deleteApp:pd,getApp:Iw,getApps:Lw,initializeApp:hd,initializeServerApp:Rw,onLog:qg,registerVersion:ln,setLogLevel:Xg},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(e,n){this._delegate=e,this.firebase=n,Eo(e,new hn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),pd(this._delegate)))}_getService(e,n=Wn){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())==null?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=Wn){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Eo(this._delegate,e)}_addOrOverwriteComponent(e){zg(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Ah=new Il("app-compat","Firebase",Qw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(t){const e={},n={__esModule:!0,initializeApp:o,app:s,registerVersion:ln,setLogLevel:Xg,onLog:qg,apps:null,SDK_VERSION:fd,INTERNAL:{registerComponent:l,removeApp:r,useAsService:u,modularAPIs:Hw}};n.default=n,Object.defineProperty(n,"apps",{get:i});function r(a){delete e[a]}function s(a){if(a=a||Wn,!ct(e,a))throw Ah.create("no-app",{appName:a});return e[a]}s.App=t;function o(a,f={}){const c=hd(a,f);if(ct(e,c.name))return e[c.name];const d=new t(c,n);return e[c.name]=d,d}function i(){return Object.keys(e).map(a=>e[a])}function l(a){const f=a.name,c=f.replace("-compat","");if(is(a)&&a.type==="PUBLIC"){const d=(h=s())=>{if(typeof h[c]!="function")throw Ah.create("invalid-app-argument",{appName:f});return h[c]()};a.serviceProps!==void 0&&_o(d,a.serviceProps),n[c]=d,t.prototype[c]=function(...h){return this._getService.bind(this,f).apply(this,a.multipleInstances?h:[])}}return a.type==="PUBLIC"?n[c]:null}function u(a,f){return f==="serverAuth"?null:f}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(){const t=Kw(Yw);t.INTERNAL={...t.INTERNAL,createFirebaseNamespace:ey,extendNamespace:e,createSubscribe:OE,ErrorFactory:Il,deepExtend:_o};function e(n){_o(t,n)}return t}const qw=ey();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new $l("@firebase/app-compat"),Xw="@firebase/app-compat",Jw="0.5.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(t){ln(Xw,Jw,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const t=Ug();if(t.firebase!==void 0){Dh.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=t.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Dh.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const md=qw;Zw();var eS="firebase",tS="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */md.registerVersion(eS,tS,"app-compat");var xh={};const Oh="@firebase/database",Nh="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ty="";function ny(t){ty=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),we(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:vo(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return ct(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new nS(e)}}catch{}return new rS},ar=ry("localStorage"),ju=ry("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr=new $l("@firebase/database"),sy=function(){let t=1;return function(){return t++}}(),oy=function(t){const e=IE(t),n=new xE;n.update(e);const r=n.digest();return od.encodeByteArray(r)},$o=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=$o.apply(null,r):typeof r=="object"?e+=we(r):e+=r,e+=" "}return e};let dr=null,Rh=!0;const iy=function(t,e){k(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Kr.logLevel=J.VERBOSE,dr=Kr.log.bind(Kr),e&&ju.set("logging_enabled",!0)):typeof t=="function"?dr=t:(dr=null,ju.remove("logging_enabled"))},Te=function(...t){if(Rh===!0&&(Rh=!1,dr===null&&ju.get("logging_enabled")===!0&&iy(!0)),dr){const e=$o.apply(null,t);dr(e)}},Mo=function(t){return function(...e){Te(t,...e)}},zu=function(...t){const e="FIREBASE INTERNAL ERROR: "+$o(...t);Kr.error(e)},Kt=function(...t){const e=`FIREBASE FATAL ERROR: ${$o(...t)}`;throw Kr.error(e),new Error(e)},Ue=function(...t){const e="FIREBASE WARNING: "+$o(...t);Kr.warn(e)},sS=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ue("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ml=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},oS=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},jn="[MIN_NAME]",mn="[MAX_NAME]",Cr=function(t,e){if(t===e)return 0;if(t===jn||e===mn)return-1;if(e===jn||t===mn)return 1;{const n=Ih(t),r=Ih(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},iS=function(t,e){return t===e?0:t<e?-1:1},Os=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+we(e))},gd=function(t){if(typeof t!="object"||t===null)return we(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=we(e[r]),n+=":",n+=gd(t[e[r]]);return n+="}",n},ly=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function De(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ay=function(t){k(!Ml(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,o,i,l,u;t===0?(o=0,i=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),o=l+r,i=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(o=0,i=Math.round(t/Math.pow(2,1-r-n))));const a=[];for(u=n;u;u-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(u=e;u;u-=1)a.push(o%2?1:0),o=Math.floor(o/2);a.push(s?1:0),a.reverse();const f=a.join("");let c="";for(u=0;u<64;u+=8){let d=parseInt(f.substr(u,8),2).toString(16);d.length===1&&(d="0"+d),c=c+d}return c.toLowerCase()},lS=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},aS=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function uS(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const cS=new RegExp("^-?(0*)\\d{1,10}$"),dS=-2147483648,fS=2147483647,Ih=function(t){if(cS.test(t)){const e=Number(t);if(e>=dS&&e<=fS)return e}return null},ys=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ue("Exception was thrown by user callback.",n),e},Math.floor(0))}},hS=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qs=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,Qg(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ue(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Te("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ue(e)}}class qr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}qr.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd="5",uy="v",cy="s",dy="r",fy="f",hy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,py="ls",my="p",Hu="ac",gy="websocket",yy="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,n,r,s,o=!1,i="",l=!1,u=!1,a=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=i,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=u,this.emulatorOptions=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ar.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ar.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function gS(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function vy(t,e,n){k(typeof e=="string","typeof type must == string"),k(typeof n=="object","typeof params must == object");let r;if(e===gy)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===yy)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);gS(t)&&(n.ns=t.namespace);const s=[];return De(n,(o,i)=>{s.push(o+"="+i)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(){this.counters_={}}incrementCounter(e,n=1){ct(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return lE(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma={},Ua={};function _d(t){const e=t.toString();return Ma[e]||(Ma[e]=new yS),Ma[e]}function _S(t,e){const n=t.toString();return Ua[n]||(Ua[n]=e()),Ua[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&ys(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="start",ES="close",wS="pLPCommand",SS="pRTLPCB",Ey="id",wy="pw",Sy="ser",PS="cb",CS="seg",kS="ts",bS="d",TS="dframe",Py=1870,Cy=30,AS=Py-Cy,DS=25e3,xS=3e4;class bn{constructor(e,n,r,s,o,i,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.transportSessionId=i,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Mo(e),this.stats_=_d(n),this.urlFn=u=>(this.appCheckToken&&(u[Hu]=this.appCheckToken),vy(n,yy,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new vS(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(xS)),oS(()=>{if(this.isClosed_)return;this.scriptTagHolder=new vd((...o)=>{const[i,l,u,a,f]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,i===Lh)this.id=l,this.password=u;else if(i===ES)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+i)},(...o)=>{const[i,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(i,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[Lh]="t",r[Sy]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[PS]=this.scriptTagHolder.uniqueCallbackIdentifier),r[uy]=yd,this.transportSessionId&&(r[cy]=this.transportSessionId),this.lastSessionId&&(r[py]=this.lastSessionId),this.applicationId&&(r[my]=this.applicationId),this.appCheckToken&&(r[Hu]=this.appCheckToken),typeof location<"u"&&location.hostname&&hy.test(location.hostname)&&(r[dy]=fy);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){bn.forceAllow_=!0}static forceDisallow(){bn.forceDisallow_=!0}static isAvailable(){return bn.forceAllow_?!0:!bn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!lS()&&!aS()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=we(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Mg(n),s=ly(r,AS);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[TS]="t",r[Ey]=e,r[wy]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=we(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class vd{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=sy(),window[wS+this.uniqueCallbackIdentifier]=e,window[SS+this.uniqueCallbackIdentifier]=n,this.myIFrame=vd.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(l){Te("frame writing exception"),l.stack&&Te(l.stack),Te(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Te("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Ey]=this.myID,e[wy]=this.myPW,e[Sy]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Cy+r.length<=Py;){const i=this.pendingSegs.shift();r=r+"&"+CS+s+"="+i.seg+"&"+kS+s+"="+i.ts+"&"+bS+s+"="+i.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(DS)),o=()=>{clearTimeout(s),r()};this.addTag(e,o)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Te("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=16384,NS=45e3;let rl=null;typeof MozWebSocket<"u"?rl=MozWebSocket:typeof WebSocket<"u"&&(rl=WebSocket);class _t{constructor(e,n,r,s,o,i,l){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Mo(this.connId),this.stats_=_d(n),this.connURL=_t.connectionURL_(n,i,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,o){const i={};return i[uy]=yd,typeof location<"u"&&location.hostname&&hy.test(location.hostname)&&(i[dy]=fy),n&&(i[cy]=n),r&&(i[py]=r),s&&(i[Hu]=s),o&&(i[my]=o),vy(e,gy,i)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ar.set("previous_websocket_failure",!0);try{let r;wE(),this.mySock=new rl(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){_t.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&rl!==null&&!_t.forceDisallow_}static previouslyFailed(){return ar.isInMemoryStorage||ar.get("previous_websocket_failure")===!0}markConnectionHealthy(){ar.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=vo(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(k(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=we(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=ly(n,OS);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(NS))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}_t.responsesRequiredToBeHealthy=2;_t.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{static get ALL_TRANSPORTS(){return[bn,_t]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=_t&&_t.isAvailable();let r=n&&!_t.previouslyFailed();if(e.webSocketOnly&&(n||Ue("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[_t];else{const s=this.transports_=[];for(const o of ls.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);ls.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ls.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=6e4,IS=5e3,LS=10*1024,$S=100*1024,Fa="t",$h="d",MS="s",Mh="r",US="e",Uh="o",Fh="a",Vh="n",Gh="p",FS="h";class VS{constructor(e,n,r,s,o,i,l,u,a,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=i,this.onReady_=l,this.onDisconnect_=u,this.onKill_=a,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Mo("c:"+this.id+":"),this.transportManager_=new ls(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=qs(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>$S?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>LS?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Fa in e){const n=e[Fa];n===Fh?this.upgradeIfSecondaryHealthy_():n===Mh?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Uh&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Os("t",e),r=Os("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Gh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Fh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Vh,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Os("t",e),r=Os("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Os(Fa,e);if($h in e){const r=e[$h];if(n===FS){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===Vh){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===MS?this.onConnectionShutdown_(r):n===Mh?this.onReset_(r):n===US?zu("Server Error: "+r):n===Uh?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):zu("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),yd!==r&&Ue("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),qs(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(RS))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qs(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(IS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Gh,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ar.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e){this.allowedEvents_=e,this.listeners_={},k(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===n&&(!r||r===s[o].context)){s.splice(o,1);return}}validateEventType_(e){k(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl extends by{static getInstance(){return new sl}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Fg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return k(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh=32,Bh=768;class Q{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Y(){return new Q("")}function V(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function zn(t){return t.pieces_.length-t.pieceNum_}function Z(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Q(t.pieces_,e)}function Ed(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function GS(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function So(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Ty(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Q(e,0)}function le(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Q)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Q(n,0)}function G(t){return t.pieceNum_>=t.pieces_.length}function We(t,e){const n=V(t),r=V(e);if(n===null)return e;if(n===r)return We(Z(t),Z(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function WS(t,e){const n=So(t,0),r=So(e,0);for(let s=0;s<n.length&&s<r.length;s++){const o=Cr(n[s],r[s]);if(o!==0)return o}return n.length===r.length?0:n.length<r.length?-1:1}function wd(t,e){if(zn(t)!==zn(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Et(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(zn(t)>zn(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class BS{constructor(e,n){this.errorPrefix_=n,this.parts_=So(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Ll(this.parts_[r]);Ay(this)}}function jS(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Ll(e),Ay(t)}function zS(t){const e=t.parts_.pop();t.byteLength_-=Ll(e),t.parts_.length>0&&(t.byteLength_-=1)}function Ay(t){if(t.byteLength_>Bh)throw new Error(t.errorPrefix_+"has a key path longer than "+Bh+" bytes ("+t.byteLength_+").");if(t.parts_.length>Wh)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Wh+") or object contains a cycle "+sr(t))}function sr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd extends by{static getInstance(){return new Sd}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return k(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns=1e3,HS=60*5*1e3,jh=30*1e3,YS=1.3,QS=3e4,KS="server_kill",zh=3;class an extends ky{constructor(e,n,r,s,o,i,l,u){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=i,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=an.nextPersistentConnectionId_++,this.log_=Mo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ns,this.maxReconnectDelay_=HS,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Sd.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&sl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,o={r:s,a:e,b:n};this.log_(we(o)),k(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Ke,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:i=>{const l=i.d;i.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),n.promise}listen(e,n,r,s){this.initConnection_();const o=e._queryIdentifier,i=e._path.toString();this.log_("Listen called for "+i+" "+o),this.listens.has(i)||this.listens.set(i,new Map),k(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),k(!this.listens.get(i).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(i).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const o={p:r},i="q";e.tag&&(o.q=n._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(i,o,l=>{const u=l.d,a=l.s;an.warnOnListenWarnings_(u,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",l),a!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(a,u))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&ct(e,"w")){const r=_r(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',o=n._path.toString();Ue(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||AE(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=jh)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=TE(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const o=s.s,i=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),k(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const o={p:e},i="n";s&&(o.q=r,o.t=s),this.sendRequest(i,o)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const o={p:n,d:r};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,i=>{s&&setTimeout(()=>{s(i.s,i.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,o){this.initConnection_();const i={p:n,d:r};o!==void 0&&(i.h=o),this.outstandingPuts_.push({action:e,request:i,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,o=>{this.log_(n+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+we(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):zu("Unrecognized action received from server: "+we(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){k(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ns,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ns,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>QS&&(this.reconnectDelay_=Ns),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*YS)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+an.nextConnectionId_++,o=this.lastSessionId;let i=!1,l=null;const u=function(){l?l.close():(i=!0,r())},a=function(c){k(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(c)};this.realtime_={close:u,sendRequest:a};const f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[c,d]=await Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);i?Te("getToken() completed but was canceled"):(Te("getToken() completed. Creating connection."),this.authToken_=c&&c.accessToken,this.appCheckToken_=d&&d.token,l=new VS(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,h=>{Ue(h+" ("+this.repoInfo_.toString()+")"),this.interrupt(KS)},o))}catch(c){this.log_("Failed to get token: "+c),i||(this.repoInfo_.nodeAdmin&&Ue(c),u())}}}interrupt(e){Te("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Te("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Fu(this.interruptReasons_)&&(this.reconnectDelay_=Ns,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(o=>gd(o)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Q(e).toString();let s;if(this.listens.has(r)){const o=this.listens.get(r);s=o.get(n),o.delete(n),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){Te("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=zh&&(this.reconnectDelay_=jh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Te("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=zh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+ty.replace(/\./g,"-")]=1,Fg()?e["framework.cordova"]=1:EE()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=sl.getInstance().currentlyOnline();return Fu(this.interruptReasons_)&&e}}an.nextPersistentConnectionId_=0;an.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new B(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new B(jn,e),s=new B(jn,n);return this.compare(r,s)!==0}minPost(){return B.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fi;class Dy extends Ul{static get __EMPTY_NODE(){return fi}static set __EMPTY_NODE(e){fi=e}compare(e,n){return Cr(e.name,n.name)}isDefinedOn(e){throw ms("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return B.MIN}maxPost(){return new B(mn,fi)}makePost(e,n){return k(typeof e=="string","KeyIndex indexValue must always be a string."),new B(e,fi)}toString(){return".key"}}const Qt=new Dy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n,r,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let i=1;for(;!e.isEmpty();)if(e=e,i=n?r(e.key,n):1,s&&(i*=-1),i<0)this.isReverse_?e=e.left:e=e.right;else if(i===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class be{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??be.RED,this.left=s??Je.EMPTY_NODE,this.right=o??Je.EMPTY_NODE}copy(e,n,r,s,o){return new be(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Je.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Je.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,be.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,be.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}be.RED=!0;be.BLACK=!1;class qS{copy(e,n,r,s,o){return this}insert(e,n,r){return new be(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Je{constructor(e,n=Je.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Je(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,be.BLACK,null,null))}remove(e){return new Je(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,be.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new hi(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new hi(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new hi(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new hi(this.root_,null,this.comparator_,!0,e)}}Je.EMPTY_NODE=new qS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t,e){return Cr(t.name,e.name)}function Pd(t,e){return Cr(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yu;function JS(t){Yu=t}const xy=function(t){return typeof t=="number"?"number:"+ay(t):"string:"+t},Oy=function(t){if(t.isLeafNode()){const e=t.val();k(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ct(e,".sv"),"Priority must be a string or number.")}else k(t===Yu||t.isEmpty(),"priority of unexpected type.");k(t===Yu||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hh;class Pe{static set __childrenNodeConstructor(e){Hh=e}static get __childrenNodeConstructor(){return Hh}constructor(e,n=Pe.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,k(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Oy(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Pe(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Pe.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return G(e)?this:V(e)===".priority"?this.priorityNode_:Pe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Pe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=V(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(k(r!==".priority"||zn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Pe.__childrenNodeConstructor.EMPTY_NODE.updateChild(Z(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+xy(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ay(this.value_):e+=this.value_,this.lazyHash_=oy(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Pe.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Pe.__childrenNodeConstructor?-1:(k(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Pe.VALUE_TYPE_ORDER.indexOf(n),o=Pe.VALUE_TYPE_ORDER.indexOf(r);return k(s>=0,"Unknown leaf type: "+n),k(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Pe.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ny,Ry;function ZS(t){Ny=t}function eP(t){Ry=t}class tP extends Ul{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),o=r.compareTo(s);return o===0?Cr(e.name,n.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return B.MIN}maxPost(){return new B(mn,new Pe("[PRIORITY-POST]",Ry))}makePost(e,n){const r=Ny(e);return new B(n,new Pe("[PRIORITY-POST]",r))}toString(){return".priority"}}const ne=new tP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP=Math.log(2);class rP{constructor(e){const n=o=>parseInt(Math.log(o)/nP,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ol=function(t,e,n,r){t.sort(e);const s=function(u,a){const f=a-u;let c,d;if(f===0)return null;if(f===1)return c=t[u],d=n?n(c):c,new be(d,c.node,be.BLACK,null,null);{const h=parseInt(f/2,10)+u,m=s(u,h),v=s(h+1,a);return c=t[h],d=n?n(c):c,new be(d,c.node,be.BLACK,m,v)}},o=function(u){let a=null,f=null,c=t.length;const d=function(m,v){const w=c-m,y=c;c-=m;const p=s(w+1,y),g=t[w],S=n?n(g):g;h(new be(S,g.node,v,null,p))},h=function(m){a?(a.left=m,a=m):(f=m,a=m)};for(let m=0;m<u.count;++m){const v=u.nextBitIsOne(),w=Math.pow(2,u.count-(m+1));v?d(w,be.BLACK):(d(w,be.BLACK),d(w,be.RED))}return f},i=new rP(t.length),l=o(i);return new Je(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Va;const Dr={};class sn{static get Default(){return k(Dr&&ne,"ChildrenNode.ts has not been loaded"),Va=Va||new sn({".priority":Dr},{".priority":ne}),Va}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=_r(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Je?n:null}hasIndex(e){return ct(this.indexSet_,e.toString())}addIndex(e,n){k(e!==Qt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const o=n.getIterator(B.Wrap);let i=o.getNext();for(;i;)s=s||e.isDefinedOn(i.node),r.push(i),i=o.getNext();let l;s?l=ol(r,e.getCompare()):l=Dr;const u=e.toString(),a={...this.indexSet_};a[u]=e;const f={...this.indexes_};return f[u]=l,new sn(f,a)}addToIndexes(e,n){const r=el(this.indexes_,(s,o)=>{const i=_r(this.indexSet_,o);if(k(i,"Missing index implementation for "+o),s===Dr)if(i.isDefinedOn(e.node)){const l=[],u=n.getIterator(B.Wrap);let a=u.getNext();for(;a;)a.name!==e.name&&l.push(a),a=u.getNext();return l.push(e),ol(l,i.getCompare())}else return Dr;else{const l=n.get(e.name);let u=s;return l&&(u=u.remove(new B(e.name,l))),u.insert(e,e.node)}});return new sn(r,this.indexSet_)}removeFromIndexes(e,n){const r=el(this.indexes_,s=>{if(s===Dr)return s;{const o=n.get(e.name);return o?s.remove(new B(e.name,o)):s}});return new sn(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rs;class I{static get EMPTY_NODE(){return Rs||(Rs=new I(new Je(Pd),null,sn.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Oy(this.priorityNode_),this.children_.isEmpty()&&k(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Rs}updatePriority(e){return this.children_.isEmpty()?this:new I(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Rs:n}}getChild(e){const n=V(e);return n===null?this:this.getImmediateChild(n).getChild(Z(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(k(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new B(e,n);let s,o;n.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));const i=s.isEmpty()?Rs:this.priorityNode_;return new I(s,i,o)}}updateChild(e,n){const r=V(e);if(r===null)return n;{k(V(e)!==".priority"||zn(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Z(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,o=!0;if(this.forEachChild(ne,(i,l)=>{n[i]=l.val(e),r++,o&&I.INTEGER_REGEXP_.test(i)?s=Math.max(s,Number(i)):o=!1}),!e&&o&&s<2*r){const i=[];for(const l in n)i[l]=n[l];return i}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+xy(this.getPriority().val())+":"),this.forEachChild(ne,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":oy(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const o=s.getPredecessorKey(new B(e,n));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new B(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new B(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,B.Wrap);let o=s.peek();for(;o!=null&&n.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,B.Wrap);let o=s.peek();for(;o!=null&&n.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Uo?-1:0}withIndex(e){if(e===Qt||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new I(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Qt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(ne),s=n.getIterator(ne);let o=r.getNext(),i=s.getNext();for(;o&&i;){if(o.name!==i.name||!o.node.equals(i.node))return!1;o=r.getNext(),i=s.getNext()}return o===null&&i===null}else return!1;else return!1}}resolveIndex_(e){return e===Qt?null:this.indexMap_.get(e.toString())}}I.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class sP extends I{constructor(){super(new Je(Pd),I.EMPTY_NODE,sn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return I.EMPTY_NODE}isEmpty(){return!1}}const Uo=new sP;Object.defineProperties(B,{MIN:{value:new B(jn,I.EMPTY_NODE)},MAX:{value:new B(mn,Uo)}});Dy.__EMPTY_NODE=I.EMPTY_NODE;Pe.__childrenNodeConstructor=I;JS(Uo);eP(Uo);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=!0;function ue(t,e=null){if(t===null)return I.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),k(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Pe(n,ue(e))}if(!(t instanceof Array)&&oP){const n=[];let r=!1;if(De(t,(i,l)=>{if(i.substring(0,1)!=="."){const u=ue(l);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new B(i,u)))}}),n.length===0)return I.EMPTY_NODE;const o=ol(n,XS,i=>i.name,Pd);if(r){const i=ol(n,ne.getCompare());return new I(o,ue(e),new sn({".priority":i},{".priority":ne}))}else return new I(o,ue(e),sn.Default)}else{let n=I.EMPTY_NODE;return De(t,(r,s)=>{if(ct(t,r)&&r.substring(0,1)!=="."){const o=ue(s);(o.isLeafNode()||!o.isEmpty())&&(n=n.updateImmediateChild(r,o))}}),n.updatePriority(ue(e))}}ZS(ue);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd extends Ul{constructor(e){super(),this.indexPath_=e,k(!G(e)&&V(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),o=r.compareTo(s);return o===0?Cr(e.name,n.name):o}makePost(e,n){const r=ue(e),s=I.EMPTY_NODE.updateChild(this.indexPath_,r);return new B(n,s)}maxPost(){const e=I.EMPTY_NODE.updateChild(this.indexPath_,Uo);return new B(mn,e)}toString(){return So(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP extends Ul{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Cr(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return B.MIN}maxPost(){return B.MAX}makePost(e,n){const r=ue(e);return new B(n,r)}toString(){return".value"}}const kd=new iP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(t){return{type:"value",snapshotNode:t}}function as(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Po(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Co(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function lP(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e){this.index_=e}updateChild(e,n,r,s,o,i){k(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(r.getChild(s))&&l.isEmpty()===r.isEmpty()||(i!=null&&(r.isEmpty()?e.hasChild(n)?i.trackChildChange(Po(n,l)):k(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?i.trackChildChange(as(n,r)):i.trackChildChange(Co(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ne,(s,o)=>{n.hasChild(s)||r.trackChildChange(Po(s,o))}),n.isLeafNode()||n.forEachChild(ne,(s,o)=>{if(e.hasChild(s)){const i=e.getImmediateChild(s);i.equals(o)||r.trackChildChange(Co(s,o,i))}else r.trackChildChange(as(s,o))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?I.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this.indexedFilter_=new bd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ko.getStartPost_(e),this.endPost_=ko.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,o,i){return this.matches(new B(n,r))||(r=I.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,o,i)}updateFullNode(e,n,r){n.isLeafNode()&&(n=I.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(I.EMPTY_NODE);const o=this;return n.forEachChild(ne,(i,l)=>{o.matches(new B(i,l))||(s=s.updateImmediateChild(i,I.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ko(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,o,i){return this.rangedFilter_.matches(new B(n,r))||(r=I.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,o,i):this.fullLimitUpdateChild_(e,n,r,o,i)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=I.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=I.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let i=0;for(;o.hasNext()&&i<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),i++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(I.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let i=0;for(;o.hasNext();){const l=o.getNext();i<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?i++:s=s.updateImmediateChild(l.name,I.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,o){let i;if(this.reverse_){const c=this.index_.getCompare();i=(d,h)=>c(h,d)}else i=this.index_.getCompare();const l=e;k(l.numChildren()===this.limit_,"");const u=new B(n,r),a=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),f=this.rangedFilter_.matches(u);if(l.hasChild(n)){const c=l.getImmediateChild(n);let d=s.getChildAfterChild(this.index_,a,this.reverse_);for(;d!=null&&(d.name===n||l.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);const h=d==null?1:i(d,u);if(f&&!r.isEmpty()&&h>=0)return o!=null&&o.trackChildChange(Co(n,r,c)),l.updateImmediateChild(n,r);{o!=null&&o.trackChildChange(Po(n,c));const v=l.updateImmediateChild(n,I.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(o!=null&&o.trackChildChange(as(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}}else return r.isEmpty()?e:f&&i(a,u)>=0?(o!=null&&(o.trackChildChange(Po(a.name,a.node)),o.trackChildChange(as(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(a.name,I.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ne}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return k(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return k(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:jn}hasEnd(){return this.endSet_}getIndexEndValue(){return k(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return k(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:mn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return k(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ne}copy(){const e=new Fl;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function uP(t){return t.loadsAllData()?new bd(t.getIndex()):t.hasLimit()?new aP(t):new ko(t)}function cP(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function dP(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Qu(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function fP(t,e,n){let r;return t.index_===Qt||n?r=Qu(t,e,n):r=Qu(t,e,mn),r.startAfterSet_=!0,r}function Ku(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function hP(t,e,n){let r;return t.index_===Qt||n?r=Ku(t,e,n):r=Ku(t,e,jn),r.endBeforeSet_=!0,r}function Vl(t,e){const n=t.copy();return n.index_=e,n}function Yh(t){const e={};if(t.isDefault())return e;let n;if(t.index_===ne?n="$priority":t.index_===kd?n="$value":t.index_===Qt?n="$key":(k(t.index_ instanceof Cd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=we(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=we(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+we(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=we(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+we(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Qh(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ne&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il extends ky{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(k(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Mo("p:rest:"),this.listens_={}}listen(e,n,r,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const i=il.getListenId_(e,r),l={};this.listens_[i]=l;const u=Yh(e._queryParams);this.restRequest_(o+".json",u,(a,f)=>{let c=f;if(a===404&&(c=null,a=null),a===null&&this.onDataUpdate_(o,c,!1,r),_r(this.listens_,i)===l){let d;a?a===401?d="permission_denied":d="rest_error:"+a:d="ok",s(d,null)}})}unlisten(e,n){const r=il.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Yh(e._queryParams),r=e._path.toString(),s=new Ke;return this.restRequest_(r+".json",n,(o,i)=>{let l=i;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(r,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(n.auth=s.accessToken),o&&o.token&&(n.ac=o.token);const i=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+DE(n);this.log_("Sending REST request for "+i);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+i+" received. status:",l.status,"response:",l.responseText);let u=null;if(l.status>=200&&l.status<300){try{u=vo(l.responseText)}catch{Ue("Failed to parse JSON response for "+i+": "+l.responseText)}r(null,u)}else l.status!==401&&l.status!==404&&Ue("Got unsuccessful REST response for "+i+" Status: "+l.status),r(l.status);r=null}},l.open("GET",i,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(){this.rootNode_=I.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(){return{value:null,children:new Map}}function _s(t,e,n){if(G(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=V(e);t.children.has(r)||t.children.set(r,ll());const s=t.children.get(r);e=Z(e),_s(s,e,n)}}function qu(t,e){if(G(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(ne,(r,s)=>{_s(t,new Q(r),s)}),qu(t,e)}}else if(t.children.size>0){const n=V(e);return e=Z(e),t.children.has(n)&&qu(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Xu(t,e,n){t.value!==null?n(e,t.value):mP(t,(r,s)=>{const o=new Q(e.toString()+"/"+r);Xu(s,o,n)})}function mP(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&De(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh=10*1e3,yP=30*1e3,_P=5*60*1e3;class vP{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new gP(e);const r=Kh+(yP-Kh)*Math.random();qs(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;De(e,(s,o)=>{o>0&&ct(this.statsToReport_,s)&&(n[s]=o,r=!0)}),r&&this.server_.reportStats(n),qs(this.reportStats_.bind(this),Math.floor(Math.random()*2*_P))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Nt||(Nt={}));function Td(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ad(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Dd(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Nt.ACK_USER_WRITE,this.source=Td()}operationForChild(e){if(G(this.path)){if(this.affectedTree.value!=null)return k(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Q(e));return new al(Y(),n,this.revert)}}else return k(V(this.path)===e,"operationForChild called for unrelated child."),new al(Z(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,n){this.source=e,this.path=n,this.type=Nt.LISTEN_COMPLETE}operationForChild(e){return G(this.path)?new bo(this.source,Y()):new bo(this.source,Z(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Nt.OVERWRITE}operationForChild(e){return G(this.path)?new vr(this.source,Y(),this.snap.getImmediateChild(e)):new vr(this.source,Z(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Nt.MERGE}operationForChild(e){if(G(this.path)){const n=this.children.subtree(new Q(e));return n.isEmpty()?null:n.value?new vr(this.source,Y(),n.value):new us(this.source,Y(),n)}else return k(V(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new us(this.source,Z(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(G(e))return this.isFullyInitialized()&&!this.filtered_;const n=V(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function wP(t,e,n,r){const s=[],o=[];return e.forEach(i=>{i.type==="child_changed"&&t.index_.indexedValueChanged(i.oldSnap,i.snapshotNode)&&o.push(lP(i.childName,i.snapshotNode))}),Is(t,s,"child_removed",e,r,n),Is(t,s,"child_added",e,r,n),Is(t,s,"child_moved",o,r,n),Is(t,s,"child_changed",e,r,n),Is(t,s,"value",e,r,n),s}function Is(t,e,n,r,s,o){const i=r.filter(l=>l.type===n);i.sort((l,u)=>PP(t,l,u)),i.forEach(l=>{const u=SP(t,l,o);s.forEach(a=>{a.respondsTo(l.type)&&e.push(a.createEvent(u,t.query_))})})}function SP(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function PP(t,e,n){if(e.childName==null||n.childName==null)throw ms("Should only compare child_ events.");const r=new B(e.childName,e.snapshotNode),s=new B(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(t,e){return{eventCache:t,serverCache:e}}function Xs(t,e,n,r){return Gl(new Hn(e,n,r),t.serverCache)}function Ly(t,e,n,r){return Gl(t.eventCache,new Hn(e,n,r))}function ul(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Er(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ga;const CP=()=>(Ga||(Ga=new Je(iS)),Ga);class ee{static fromObject(e){let n=new ee(null);return De(e,(r,s)=>{n=n.set(new Q(r),s)}),n}constructor(e,n=CP()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Y(),value:this.value};if(G(e))return null;{const r=V(e),s=this.children.get(r);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Z(e),n);return o!=null?{path:le(new Q(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(G(e))return this;{const n=V(e),r=this.children.get(n);return r!==null?r.subtree(Z(e)):new ee(null)}}set(e,n){if(G(e))return new ee(n,this.children);{const r=V(e),o=(this.children.get(r)||new ee(null)).set(Z(e),n),i=this.children.insert(r,o);return new ee(this.value,i)}}remove(e){if(G(e))return this.children.isEmpty()?new ee(null):new ee(null,this.children);{const n=V(e),r=this.children.get(n);if(r){const s=r.remove(Z(e));let o;return s.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,s),this.value===null&&o.isEmpty()?new ee(null):new ee(this.value,o)}else return this}}get(e){if(G(e))return this.value;{const n=V(e),r=this.children.get(n);return r?r.get(Z(e)):null}}setTree(e,n){if(G(e))return n;{const r=V(e),o=(this.children.get(r)||new ee(null)).setTree(Z(e),n);let i;return o.isEmpty()?i=this.children.remove(r):i=this.children.insert(r,o),new ee(this.value,i)}}fold(e){return this.fold_(Y(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,o)=>{r[s]=o.fold_(le(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Y(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(G(e))return null;{const o=V(e),i=this.children.get(o);return i?i.findOnPath_(Z(e),le(n,o),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Y(),n)}foreachOnPath_(e,n,r){if(G(e))return this;{this.value&&r(n,this.value);const s=V(e),o=this.children.get(s);return o?o.foreachOnPath_(Z(e),le(n,s),r):new ee(null)}}foreach(e){this.foreach_(Y(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(le(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.writeTree_=e}static empty(){return new Lt(new ee(null))}}function Js(t,e,n){if(G(e))return new Lt(new ee(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let o=r.value;const i=We(s,e);return o=o.updateChild(i,n),new Lt(t.writeTree_.set(s,o))}else{const s=new ee(n),o=t.writeTree_.setTree(e,s);return new Lt(o)}}}function Ju(t,e,n){let r=t;return De(n,(s,o)=>{r=Js(r,le(e,s),o)}),r}function qh(t,e){if(G(e))return Lt.empty();{const n=t.writeTree_.setTree(e,new ee(null));return new Lt(n)}}function Zu(t,e){return kr(t,e)!=null}function kr(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(We(n.path,e)):null}function Xh(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ne,(r,s)=>{e.push(new B(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new B(r,s.value))}),e}function Mn(t,e){if(G(e))return t;{const n=kr(t,e);return n!=null?new Lt(new ee(n)):new Lt(t.writeTree_.subtree(e))}}function ec(t){return t.writeTree_.isEmpty()}function cs(t,e){return $y(Y(),t.writeTree_,e)}function $y(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(k(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):n=$y(le(t,s),o,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(le(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t,e){return Vy(e,t)}function kP(t,e,n,r,s){k(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Js(t.visibleWrites,e,n)),t.lastWriteId=r}function bP(t,e,n,r){k(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Ju(t.visibleWrites,e,n),t.lastWriteId=r}function TP(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function AP(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);k(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,o=!1,i=t.allWrites.length-1;for(;s&&i>=0;){const l=t.allWrites[i];l.visible&&(i>=n&&DP(l,r.path)?s=!1:Et(r.path,l.path)&&(o=!0)),i--}if(s){if(o)return xP(t),!0;if(r.snap)t.visibleWrites=qh(t.visibleWrites,r.path);else{const l=r.children;De(l,u=>{t.visibleWrites=qh(t.visibleWrites,le(r.path,u))})}return!0}else return!1}function DP(t,e){if(t.snap)return Et(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Et(le(t.path,n),e))return!0;return!1}function xP(t){t.visibleWrites=My(t.allWrites,OP,Y()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function OP(t){return t.visible}function My(t,e,n){let r=Lt.empty();for(let s=0;s<t.length;++s){const o=t[s];if(e(o)){const i=o.path;let l;if(o.snap)Et(n,i)?(l=We(n,i),r=Js(r,l,o.snap)):Et(i,n)&&(l=We(i,n),r=Js(r,Y(),o.snap.getChild(l)));else if(o.children){if(Et(n,i))l=We(n,i),r=Ju(r,l,o.children);else if(Et(i,n))if(l=We(i,n),G(l))r=Ju(r,Y(),o.children);else{const u=_r(o.children,V(l));if(u){const a=u.getChild(Z(l));r=Js(r,Y(),a)}}}else throw ms("WriteRecord should have .snap or .children")}}return r}function Uy(t,e,n,r,s){if(!r&&!s){const o=kr(t.visibleWrites,e);if(o!=null)return o;{const i=Mn(t.visibleWrites,e);if(ec(i))return n;if(n==null&&!Zu(i,Y()))return null;{const l=n||I.EMPTY_NODE;return cs(i,l)}}}else{const o=Mn(t.visibleWrites,e);if(!s&&ec(o))return n;if(!s&&n==null&&!Zu(o,Y()))return null;{const i=function(a){return(a.visible||s)&&(!r||!~r.indexOf(a.writeId))&&(Et(a.path,e)||Et(e,a.path))},l=My(t.allWrites,i,e),u=n||I.EMPTY_NODE;return cs(l,u)}}}function NP(t,e,n){let r=I.EMPTY_NODE;const s=kr(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(ne,(o,i)=>{r=r.updateImmediateChild(o,i)}),r;if(n){const o=Mn(t.visibleWrites,e);return n.forEachChild(ne,(i,l)=>{const u=cs(Mn(o,new Q(i)),l);r=r.updateImmediateChild(i,u)}),Xh(o).forEach(i=>{r=r.updateImmediateChild(i.name,i.node)}),r}else{const o=Mn(t.visibleWrites,e);return Xh(o).forEach(i=>{r=r.updateImmediateChild(i.name,i.node)}),r}}function RP(t,e,n,r,s){k(r||s,"Either existingEventSnap or existingServerSnap must exist");const o=le(e,n);if(Zu(t.visibleWrites,o))return null;{const i=Mn(t.visibleWrites,o);return ec(i)?s.getChild(n):cs(i,s.getChild(n))}}function IP(t,e,n,r){const s=le(e,n),o=kr(t.visibleWrites,s);if(o!=null)return o;if(r.isCompleteForChild(n)){const i=Mn(t.visibleWrites,s);return cs(i,r.getNode().getImmediateChild(n))}else return null}function LP(t,e){return kr(t.visibleWrites,e)}function $P(t,e,n,r,s,o,i){let l;const u=Mn(t.visibleWrites,e),a=kr(u,Y());if(a!=null)l=a;else if(n!=null)l=cs(u,n);else return[];if(l=l.withIndex(i),!l.isEmpty()&&!l.isLeafNode()){const f=[],c=i.getCompare(),d=o?l.getReverseIteratorFrom(r,i):l.getIteratorFrom(r,i);let h=d.getNext();for(;h&&f.length<s;)c(h,r)!==0&&f.push(h),h=d.getNext();return f}else return[]}function MP(){return{visibleWrites:Lt.empty(),allWrites:[],lastWriteId:-1}}function cl(t,e,n,r){return Uy(t.writeTree,t.treePath,e,n,r)}function xd(t,e){return NP(t.writeTree,t.treePath,e)}function Jh(t,e,n,r){return RP(t.writeTree,t.treePath,e,n,r)}function dl(t,e){return LP(t.writeTree,le(t.treePath,e))}function UP(t,e,n,r,s,o){return $P(t.writeTree,t.treePath,e,n,r,s,o)}function Od(t,e,n){return IP(t.writeTree,t.treePath,e,n)}function Fy(t,e){return Vy(le(t.treePath,e),t.writeTree)}function Vy(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;k(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),k(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const o=s.type;if(n==="child_added"&&o==="child_removed")this.changeMap.set(r,Co(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&o==="child_changed")this.changeMap.set(r,Po(r,s.oldSnap));else if(n==="child_changed"&&o==="child_added")this.changeMap.set(r,as(r,e.snapshotNode));else if(n==="child_changed"&&o==="child_changed")this.changeMap.set(r,Co(r,e.snapshotNode,s.oldSnap));else throw ms("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const Gy=new VP;class Nd{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Hn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Od(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Er(this.viewCache_),o=UP(this.writes_,s,n,1,r,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GP(t){return{filter:t}}function WP(t,e){k(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),k(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function BP(t,e,n,r,s){const o=new FP;let i,l;if(n.type===Nt.OVERWRITE){const a=n;a.source.fromUser?i=tc(t,e,a.path,a.snap,r,s,o):(k(a.source.fromServer,"Unknown source."),l=a.source.tagged||e.serverCache.isFiltered()&&!G(a.path),i=fl(t,e,a.path,a.snap,r,s,l,o))}else if(n.type===Nt.MERGE){const a=n;a.source.fromUser?i=zP(t,e,a.path,a.children,r,s,o):(k(a.source.fromServer,"Unknown source."),l=a.source.tagged||e.serverCache.isFiltered(),i=nc(t,e,a.path,a.children,r,s,l,o))}else if(n.type===Nt.ACK_USER_WRITE){const a=n;a.revert?i=QP(t,e,a.path,r,s,o):i=HP(t,e,a.path,a.affectedTree,r,s,o)}else if(n.type===Nt.LISTEN_COMPLETE)i=YP(t,e,n.path,r,o);else throw ms("Unknown operation type: "+n.type);const u=o.getChanges();return jP(e,i,u),{viewCache:i,changes:u}}function jP(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=ul(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Iy(ul(e)))}}function Wy(t,e,n,r,s,o){const i=e.eventCache;if(dl(r,n)!=null)return e;{let l,u;if(G(n))if(k(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const a=Er(e),f=a instanceof I?a:I.EMPTY_NODE,c=xd(r,f);l=t.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const a=cl(r,Er(e));l=t.filter.updateFullNode(e.eventCache.getNode(),a,o)}else{const a=V(n);if(a===".priority"){k(zn(n)===1,"Can't have a priority with additional path components");const f=i.getNode();u=e.serverCache.getNode();const c=Jh(r,n,f,u);c!=null?l=t.filter.updatePriority(f,c):l=i.getNode()}else{const f=Z(n);let c;if(i.isCompleteForChild(a)){u=e.serverCache.getNode();const d=Jh(r,n,i.getNode(),u);d!=null?c=i.getNode().getImmediateChild(a).updateChild(f,d):c=i.getNode().getImmediateChild(a)}else c=Od(r,a,e.serverCache);c!=null?l=t.filter.updateChild(i.getNode(),a,c,f,s,o):l=i.getNode()}}return Xs(e,l,i.isFullyInitialized()||G(n),t.filter.filtersNodes())}}function fl(t,e,n,r,s,o,i,l){const u=e.serverCache;let a;const f=i?t.filter:t.filter.getIndexedFilter();if(G(n))a=f.updateFullNode(u.getNode(),r,null);else if(f.filtersNodes()&&!u.isFiltered()){const h=u.getNode().updateChild(n,r);a=f.updateFullNode(u.getNode(),h,null)}else{const h=V(n);if(!u.isCompleteForPath(n)&&zn(n)>1)return e;const m=Z(n),w=u.getNode().getImmediateChild(h).updateChild(m,r);h===".priority"?a=f.updatePriority(u.getNode(),w):a=f.updateChild(u.getNode(),h,w,m,Gy,null)}const c=Ly(e,a,u.isFullyInitialized()||G(n),f.filtersNodes()),d=new Nd(s,c,o);return Wy(t,c,n,s,d,l)}function tc(t,e,n,r,s,o,i){const l=e.eventCache;let u,a;const f=new Nd(s,e,o);if(G(n))a=t.filter.updateFullNode(e.eventCache.getNode(),r,i),u=Xs(e,a,!0,t.filter.filtersNodes());else{const c=V(n);if(c===".priority")a=t.filter.updatePriority(e.eventCache.getNode(),r),u=Xs(e,a,l.isFullyInitialized(),l.isFiltered());else{const d=Z(n),h=l.getNode().getImmediateChild(c);let m;if(G(d))m=r;else{const v=f.getCompleteChild(c);v!=null?Ed(d)===".priority"&&v.getChild(Ty(d)).isEmpty()?m=v:m=v.updateChild(d,r):m=I.EMPTY_NODE}if(h.equals(m))u=e;else{const v=t.filter.updateChild(l.getNode(),c,m,d,f,i);u=Xs(e,v,l.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function Zh(t,e){return t.eventCache.isCompleteForChild(e)}function zP(t,e,n,r,s,o,i){let l=e;return r.foreach((u,a)=>{const f=le(n,u);Zh(e,V(f))&&(l=tc(t,l,f,a,s,o,i))}),r.foreach((u,a)=>{const f=le(n,u);Zh(e,V(f))||(l=tc(t,l,f,a,s,o,i))}),l}function ep(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function nc(t,e,n,r,s,o,i,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,a;G(n)?a=r:a=new ee(null).setTree(n,r);const f=e.serverCache.getNode();return a.children.inorderTraversal((c,d)=>{if(f.hasChild(c)){const h=e.serverCache.getNode().getImmediateChild(c),m=ep(t,h,d);u=fl(t,u,new Q(c),m,s,o,i,l)}}),a.children.inorderTraversal((c,d)=>{const h=!e.serverCache.isCompleteForChild(c)&&d.value===null;if(!f.hasChild(c)&&!h){const m=e.serverCache.getNode().getImmediateChild(c),v=ep(t,m,d);u=fl(t,u,new Q(c),v,s,o,i,l)}}),u}function HP(t,e,n,r,s,o,i){if(dl(s,n)!=null)return e;const l=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(G(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return fl(t,e,n,u.getNode().getChild(n),s,o,l,i);if(G(n)){let a=new ee(null);return u.getNode().forEachChild(Qt,(f,c)=>{a=a.set(new Q(f),c)}),nc(t,e,n,a,s,o,l,i)}else return e}else{let a=new ee(null);return r.foreach((f,c)=>{const d=le(n,f);u.isCompleteForPath(d)&&(a=a.set(f,u.getNode().getChild(d)))}),nc(t,e,n,a,s,o,l,i)}}function YP(t,e,n,r,s){const o=e.serverCache,i=Ly(e,o.getNode(),o.isFullyInitialized()||G(n),o.isFiltered());return Wy(t,i,n,r,Gy,s)}function QP(t,e,n,r,s,o){let i;if(dl(r,n)!=null)return e;{const l=new Nd(r,e,s),u=e.eventCache.getNode();let a;if(G(n)||V(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=cl(r,Er(e));else{const c=e.serverCache.getNode();k(c instanceof I,"serverChildren would be complete if leaf node"),f=xd(r,c)}f=f,a=t.filter.updateFullNode(u,f,o)}else{const f=V(n);let c=Od(r,f,e.serverCache);c==null&&e.serverCache.isCompleteForChild(f)&&(c=u.getImmediateChild(f)),c!=null?a=t.filter.updateChild(u,f,c,Z(n),l,o):e.eventCache.getNode().hasChild(f)?a=t.filter.updateChild(u,f,I.EMPTY_NODE,Z(n),l,o):a=u,a.isEmpty()&&e.serverCache.isFullyInitialized()&&(i=cl(r,Er(e)),i.isLeafNode()&&(a=t.filter.updateFullNode(a,i,o)))}return i=e.serverCache.isFullyInitialized()||dl(r,Y())!=null,Xs(e,a,i,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new bd(r.getIndex()),o=uP(r);this.processor_=GP(o);const i=n.serverCache,l=n.eventCache,u=s.updateFullNode(I.EMPTY_NODE,i.getNode(),null),a=o.updateFullNode(I.EMPTY_NODE,l.getNode(),null),f=new Hn(u,i.isFullyInitialized(),s.filtersNodes()),c=new Hn(a,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=Gl(c,f),this.eventGenerator_=new EP(this.query_)}get query(){return this.query_}}function qP(t){return t.viewCache_.serverCache.getNode()}function XP(t){return ul(t.viewCache_)}function JP(t,e){const n=Er(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!G(e)&&!n.getImmediateChild(V(e)).isEmpty())?n.getChild(e):null}function tp(t){return t.eventRegistrations_.length===0}function ZP(t,e){t.eventRegistrations_.push(e)}function np(t,e,n){const r=[];if(n){k(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(o=>{const i=o.createCancelEvent(n,s);i&&r.push(i)})}if(e){let s=[];for(let o=0;o<t.eventRegistrations_.length;++o){const i=t.eventRegistrations_[o];if(!i.matches(e))s.push(i);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(o+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function rp(t,e,n,r){e.type===Nt.MERGE&&e.source.queryId!==null&&(k(Er(t.viewCache_),"We should always have a full cache before handling merges"),k(ul(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,o=BP(t.processor_,s,e,n,r);return WP(t.processor_,o.viewCache),k(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,By(t,o.changes,o.viewCache.eventCache.getNode(),null)}function e1(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ne,(o,i)=>{r.push(as(o,i))}),n.isFullyInitialized()&&r.push(Iy(n.getNode())),By(t,r,n.getNode(),e)}function By(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return wP(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl;class jy{constructor(){this.views=new Map}}function t1(t){k(!hl,"__referenceConstructor has already been defined"),hl=t}function n1(){return k(hl,"Reference.ts has not been loaded"),hl}function r1(t){return t.views.size===0}function Rd(t,e,n,r){const s=e.source.queryId;if(s!==null){const o=t.views.get(s);return k(o!=null,"SyncTree gave us an op for an invalid query."),rp(o,e,n,r)}else{let o=[];for(const i of t.views.values())o=o.concat(rp(i,e,n,r));return o}}function zy(t,e,n,r,s){const o=e._queryIdentifier,i=t.views.get(o);if(!i){let l=cl(n,s?r:null),u=!1;l?u=!0:r instanceof I?(l=xd(n,r),u=!1):(l=I.EMPTY_NODE,u=!1);const a=Gl(new Hn(l,u,!1),new Hn(r,s,!1));return new KP(e,a)}return i}function s1(t,e,n,r,s,o){const i=zy(t,e,r,s,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,i),ZP(i,n),e1(i,n)}function o1(t,e,n,r){const s=e._queryIdentifier,o=[];let i=[];const l=Yn(t);if(s==="default")for(const[u,a]of t.views.entries())i=i.concat(np(a,n,r)),tp(a)&&(t.views.delete(u),a.query._queryParams.loadsAllData()||o.push(a.query));else{const u=t.views.get(s);u&&(i=i.concat(np(u,n,r)),tp(u)&&(t.views.delete(s),u.query._queryParams.loadsAllData()||o.push(u.query)))}return l&&!Yn(t)&&o.push(new(n1())(e._repo,e._path)),{removed:o,events:i}}function Hy(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Un(t,e){let n=null;for(const r of t.views.values())n=n||JP(r,e);return n}function Yy(t,e){if(e._queryParams.loadsAllData())return Bl(t);{const r=e._queryIdentifier;return t.views.get(r)}}function Qy(t,e){return Yy(t,e)!=null}function Yn(t){return Bl(t)!=null}function Bl(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl;function i1(t){k(!pl,"__referenceConstructor has already been defined"),pl=t}function l1(){return k(pl,"Reference.ts has not been loaded"),pl}let a1=1;class sp{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ee(null),this.pendingWriteTree_=MP(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Id(t,e,n,r,s){return kP(t.pendingWriteTree_,e,n,r,s),s?vs(t,new vr(Td(),e,n)):[]}function u1(t,e,n,r){bP(t.pendingWriteTree_,e,n,r);const s=ee.fromObject(n);return vs(t,new us(Td(),e,s))}function Tn(t,e,n=!1){const r=TP(t.pendingWriteTree_,e);if(AP(t.pendingWriteTree_,e)){let o=new ee(null);return r.snap!=null?o=o.set(Y(),!0):De(r.children,i=>{o=o.set(new Q(i),!0)}),vs(t,new al(r.path,o,n))}else return[]}function Fo(t,e,n){return vs(t,new vr(Ad(),e,n))}function c1(t,e,n){const r=ee.fromObject(n);return vs(t,new us(Ad(),e,r))}function d1(t,e){return vs(t,new bo(Ad(),e))}function f1(t,e,n){const r=Ld(t,n);if(r){const s=$d(r),o=s.path,i=s.queryId,l=We(o,e),u=new bo(Dd(i),l);return Md(t,o,u)}else return[]}function ml(t,e,n,r,s=!1){const o=e._path,i=t.syncPointTree_.get(o);let l=[];if(i&&(e._queryIdentifier==="default"||Qy(i,e))){const u=o1(i,e,n,r);r1(i)&&(t.syncPointTree_=t.syncPointTree_.remove(o));const a=u.removed;if(l=u.events,!s){const f=a.findIndex(d=>d._queryParams.loadsAllData())!==-1,c=t.syncPointTree_.findOnPath(o,(d,h)=>Yn(h));if(f&&!c){const d=t.syncPointTree_.subtree(o);if(!d.isEmpty()){const h=m1(d);for(let m=0;m<h.length;++m){const v=h[m],w=v.query,y=Jy(t,v);t.listenProvider_.startListening(Zs(w),To(t,w),y.hashFn,y.onComplete)}}}!c&&a.length>0&&!r&&(f?t.listenProvider_.stopListening(Zs(e),null):a.forEach(d=>{const h=t.queryToTagMap.get(zl(d));t.listenProvider_.stopListening(Zs(d),h)}))}g1(t,a)}return l}function Ky(t,e,n,r){const s=Ld(t,r);if(s!=null){const o=$d(s),i=o.path,l=o.queryId,u=We(i,e),a=new vr(Dd(l),u,n);return Md(t,i,a)}else return[]}function h1(t,e,n,r){const s=Ld(t,r);if(s){const o=$d(s),i=o.path,l=o.queryId,u=We(i,e),a=ee.fromObject(n),f=new us(Dd(l),u,a);return Md(t,i,f)}else return[]}function rc(t,e,n,r=!1){const s=e._path;let o=null,i=!1;t.syncPointTree_.foreachOnPath(s,(d,h)=>{const m=We(d,s);o=o||Un(h,m),i=i||Yn(h)});let l=t.syncPointTree_.get(s);l?(i=i||Yn(l),o=o||Un(l,Y())):(l=new jy,t.syncPointTree_=t.syncPointTree_.set(s,l));let u;o!=null?u=!0:(u=!1,o=I.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((h,m)=>{const v=Un(m,Y());v&&(o=o.updateImmediateChild(h,v))}));const a=Qy(l,e);if(!a&&!e._queryParams.loadsAllData()){const d=zl(e);k(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const h=y1();t.queryToTagMap.set(d,h),t.tagToQueryMap.set(h,d)}const f=Wl(t.pendingWriteTree_,s);let c=s1(l,e,n,f,o,u);if(!a&&!i&&!r){const d=Yy(l,e);c=c.concat(_1(t,e,d))}return c}function jl(t,e,n){const s=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(e,(i,l)=>{const u=We(i,e),a=Un(l,u);if(a)return a});return Uy(s,e,o,n,!0)}function p1(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(a,f)=>{const c=We(a,n);r=r||Un(f,c)});let s=t.syncPointTree_.get(n);s?r=r||Un(s,Y()):(s=new jy,t.syncPointTree_=t.syncPointTree_.set(n,s));const o=r!=null,i=o?new Hn(r,!0,!1):null,l=Wl(t.pendingWriteTree_,e._path),u=zy(s,e,l,o?i.getNode():I.EMPTY_NODE,o);return XP(u)}function vs(t,e){return qy(e,t.syncPointTree_,null,Wl(t.pendingWriteTree_,Y()))}function qy(t,e,n,r){if(G(t.path))return Xy(t,e,n,r);{const s=e.get(Y());n==null&&s!=null&&(n=Un(s,Y()));let o=[];const i=V(t.path),l=t.operationForChild(i),u=e.children.get(i);if(u&&l){const a=n?n.getImmediateChild(i):null,f=Fy(r,i);o=o.concat(qy(l,u,a,f))}return s&&(o=o.concat(Rd(s,t,r,n))),o}}function Xy(t,e,n,r){const s=e.get(Y());n==null&&s!=null&&(n=Un(s,Y()));let o=[];return e.children.inorderTraversal((i,l)=>{const u=n?n.getImmediateChild(i):null,a=Fy(r,i),f=t.operationForChild(i);f&&(o=o.concat(Xy(f,l,u,a)))}),s&&(o=o.concat(Rd(s,t,r,n))),o}function Jy(t,e){const n=e.query,r=To(t,n);return{hashFn:()=>(qP(e)||I.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?f1(t,n._path,r):d1(t,n._path);{const o=uS(s,n);return ml(t,n,null,o)}}}}function To(t,e){const n=zl(e);return t.queryToTagMap.get(n)}function zl(t){return t._path.toString()+"$"+t._queryIdentifier}function Ld(t,e){return t.tagToQueryMap.get(e)}function $d(t){const e=t.indexOf("$");return k(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Q(t.substr(0,e))}}function Md(t,e,n){const r=t.syncPointTree_.get(e);k(r,"Missing sync point for query tag that we're tracking");const s=Wl(t.pendingWriteTree_,e);return Rd(r,n,s,null)}function m1(t){return t.fold((e,n,r)=>{if(n&&Yn(n))return[Bl(n)];{let s=[];return n&&(s=Hy(n)),De(r,(o,i)=>{s=s.concat(i)}),s}})}function Zs(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(l1())(t._repo,t._path):t}function g1(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=zl(r),o=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(o)}}}function y1(){return a1++}function _1(t,e,n){const r=e._path,s=To(t,e),o=Jy(t,n),i=t.listenProvider_.startListening(Zs(e),s,o.hashFn,o.onComplete),l=t.syncPointTree_.subtree(r);if(s)k(!Yn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const u=l.fold((a,f,c)=>{if(!G(a)&&f&&Yn(f))return[Bl(f).query];{let d=[];return f&&(d=d.concat(Hy(f).map(h=>h.query))),De(c,(h,m)=>{d=d.concat(m)}),d}});for(let a=0;a<u.length;++a){const f=u[a];t.listenProvider_.stopListening(Zs(f),To(t,f))}}return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Ud(n)}node(){return this.node_}}class Fd{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=le(this.path_,e);return new Fd(this.syncTree_,n)}node(){return jl(this.syncTree_,this.path_)}}const v1=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},op=function(t,e,n){if(!t||typeof t!="object")return t;if(k(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return E1(t[".sv"],e,n);if(typeof t[".sv"]=="object")return w1(t[".sv"],e);k(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},E1=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:k(!1,"Unexpected server value: "+t)}},w1=function(t,e,n){t.hasOwnProperty("increment")||k(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&k(!1,"Unexpected increment value: "+r);const s=e.node();if(k(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const i=s.getValue();return typeof i!="number"?r:i+r},Zy=function(t,e,n,r){return Gd(e,new Fd(n,t),r)},Vd=function(t,e,n){return Gd(t,new Ud(e),n)};function Gd(t,e,n){const r=t.getPriority().val(),s=op(r,e.getImmediateChild(".priority"),n);let o;if(t.isLeafNode()){const i=t,l=op(i.getValue(),e,n);return l!==i.getValue()||s!==i.getPriority().val()?new Pe(l,ue(s)):t}else{const i=t;return o=i,s!==i.getPriority().val()&&(o=o.updatePriority(new Pe(s))),i.forEachChild(ne,(l,u)=>{const a=Gd(u,e.getImmediateChild(l),n);a!==u&&(o=o.updateImmediateChild(l,a))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Hl(t,e){let n=e instanceof Q?e:new Q(e),r=t,s=V(n);for(;s!==null;){const o=_r(r.node.children,s)||{children:{},childCount:0};r=new Wd(s,r,o),n=Z(n),s=V(n)}return r}function br(t){return t.node.value}function Bd(t,e){t.node.value=e,sc(t)}function e_(t){return t.node.childCount>0}function S1(t){return br(t)===void 0&&!e_(t)}function Yl(t,e){De(t.node.children,(n,r)=>{e(new Wd(n,t,r))})}function t_(t,e,n,r){n&&e(t),Yl(t,s=>{t_(s,e,!0)})}function P1(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Vo(t){return new Q(t.parent===null?t.name:Vo(t.parent)+"/"+t.name)}function sc(t){t.parent!==null&&C1(t.parent,t.name,t)}function C1(t,e,n){const r=S1(n),s=ct(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,sc(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,sc(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1=/[\[\].#$\/\u0000-\u001F\u007F]/,b1=/[\[\].#$\u0000-\u001F\u007F]/,Wa=10*1024*1024,Ql=function(t){return typeof t=="string"&&t.length!==0&&!k1.test(t)},n_=function(t){return typeof t=="string"&&t.length!==0&&!b1.test(t)},T1=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),n_(t)},Ao=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Ml(t)||t&&typeof t=="object"&&ct(t,".sv")},qt=function(t,e,n,r){r&&e===void 0||Go(nt(t,"value"),e,n)},Go=function(t,e,n){const r=n instanceof Q?new BS(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+sr(r));if(typeof e=="function")throw new Error(t+"contains a function "+sr(r)+" with contents = "+e.toString());if(Ml(e))throw new Error(t+"contains "+e.toString()+" "+sr(r));if(typeof e=="string"&&e.length>Wa/3&&Ll(e)>Wa)throw new Error(t+"contains a string greater than "+Wa+" utf8 bytes "+sr(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(De(e,(i,l)=>{if(i===".value")s=!0;else if(i!==".priority"&&i!==".sv"&&(o=!0,!Ql(i)))throw new Error(t+" contains an invalid key ("+i+") "+sr(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);jS(r,i),Go(t,l,r),zS(r)}),s&&o)throw new Error(t+' contains ".value" child '+sr(r)+" in addition to actual children.")}},A1=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const o=So(r);for(let i=0;i<o.length;i++)if(!(o[i]===".priority"&&i===o.length-1)){if(!Ql(o[i]))throw new Error(t+"contains an invalid key ("+o[i]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(WS);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&Et(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},r_=function(t,e,n,r){const s=nt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];De(e,(i,l)=>{const u=new Q(i);if(Go(s,l,le(n,u)),Ed(u)===".priority"&&!Ao(l))throw new Error(s+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(u)}),A1(s,o)},jd=function(t,e,n){if(Ml(e))throw new Error(nt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ao(e))throw new Error(nt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Wo=function(t,e,n,r){if(n!==void 0&&!Ql(n))throw new Error(nt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Do=function(t,e,n,r){if(!n_(n))throw new Error(nt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},D1=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Do(t,e,n)},wt=function(t,e){if(V(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},s_=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ql(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!T1(n))throw new Error(nt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Kl(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],o=s.getPath();n!==null&&!wd(o,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:o}),n.events.push(s)}n&&t.eventLists_.push(n)}function o_(t,e,n){Kl(t,n),i_(t,r=>wd(r,e))}function dt(t,e,n){Kl(t,n),i_(t,r=>Et(r,e)||Et(e,r))}function i_(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const o=s.path;e(o)?(O1(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function O1(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();dr&&Te("event: "+n.toString()),ys(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_="repo_interrupt",N1=25;class R1{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new x1,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ll(),this.transactionQueueTree_=new Wd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function I1(t,e,n){if(t.stats_=_d(t.repoInfo_),t.forceRestClient_||hS())t.server_=new il(t.repoInfo_,(r,s,o,i)=>{ip(t,r,s,o,i)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>lp(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{we(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new an(t.repoInfo_,e,(r,s,o,i)=>{ip(t,r,s,o,i)},r=>{lp(t,r)},r=>{L1(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=_S(t.repoInfo_,()=>new vP(t.stats_,t.server_)),t.infoData_=new pP,t.infoSyncTree_=new sp({startListening:(r,s,o,i)=>{let l=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(l=Fo(t.infoSyncTree_,r._path,u),setTimeout(()=>{i("ok")},0)),l},stopListening:()=>{}}),zd(t,"connected",!1),t.serverSyncTree_=new sp({startListening:(r,s,o,i)=>(t.server_.listen(r,o,s,(l,u)=>{const a=i(l,u);dt(t.eventQueue_,r._path,a)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function a_(t){const n=t.infoData_.getNode(new Q(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Bo(t){return v1({timestamp:a_(t)})}function ip(t,e,n,r,s){t.dataUpdateCount++;const o=new Q(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let i=[];if(s)if(r){const u=el(n,a=>ue(a));i=h1(t.serverSyncTree_,o,u,s)}else{const u=ue(n);i=Ky(t.serverSyncTree_,o,u,s)}else if(r){const u=el(n,a=>ue(a));i=c1(t.serverSyncTree_,o,u)}else{const u=ue(n);i=Fo(t.serverSyncTree_,o,u)}let l=o;i.length>0&&(l=ds(t,o)),dt(t.eventQueue_,l,i)}function lp(t,e){zd(t,"connected",e),e===!1&&U1(t)}function L1(t,e){De(e,(n,r)=>{zd(t,n,r)})}function zd(t,e,n){const r=new Q("/.info/"+e),s=ue(n);t.infoData_.updateSnapshot(r,s);const o=Fo(t.infoSyncTree_,r,s);dt(t.eventQueue_,r,o)}function ql(t){return t.nextWriteId_++}function $1(t,e,n){const r=p1(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const o=ue(s).withIndex(e._queryParams.getIndex());rc(t.serverSyncTree_,e,n,!0);let i;if(e._queryParams.loadsAllData())i=Fo(t.serverSyncTree_,e._path,o);else{const l=To(t.serverSyncTree_,e);i=Ky(t.serverSyncTree_,e._path,o,l)}return dt(t.eventQueue_,e._path,i),ml(t.serverSyncTree_,e,n,null,!0),o},s=>(Es(t,"get for query "+we(e)+" failed: "+s),Promise.reject(new Error(s))))}function Hd(t,e,n,r,s){Es(t,"set",{path:e.toString(),value:n,priority:r});const o=Bo(t),i=ue(n,r),l=jl(t.serverSyncTree_,e),u=Vd(i,l,o),a=ql(t),f=Id(t.serverSyncTree_,e,u,a,!0);Kl(t.eventQueue_,f),t.server_.put(e.toString(),i.val(!0),(d,h)=>{const m=d==="ok";m||Ue("set at "+e+" failed: "+d);const v=Tn(t.serverSyncTree_,a,!m);dt(t.eventQueue_,e,v),Qn(t,s,d,h)});const c=Qd(t,e);ds(t,c),dt(t.eventQueue_,c,[])}function M1(t,e,n,r){Es(t,"update",{path:e.toString(),value:n});let s=!0;const o=Bo(t),i={};if(De(n,(l,u)=>{s=!1,i[l]=Zy(le(e,l),ue(u),t.serverSyncTree_,o)}),s)Te("update() called with empty data.  Don't do anything."),Qn(t,r,"ok",void 0);else{const l=ql(t),u=u1(t.serverSyncTree_,e,i,l);Kl(t.eventQueue_,u),t.server_.merge(e.toString(),n,(a,f)=>{const c=a==="ok";c||Ue("update at "+e+" failed: "+a);const d=Tn(t.serverSyncTree_,l,!c),h=d.length>0?ds(t,e):e;dt(t.eventQueue_,h,d),Qn(t,r,a,f)}),De(n,a=>{const f=Qd(t,le(e,a));ds(t,f)}),dt(t.eventQueue_,e,[])}}function U1(t){Es(t,"onDisconnectEvents");const e=Bo(t),n=ll();Xu(t.onDisconnect_,Y(),(s,o)=>{const i=Zy(s,o,t.serverSyncTree_,e);_s(n,s,i)});let r=[];Xu(n,Y(),(s,o)=>{r=r.concat(Fo(t.serverSyncTree_,s,o));const i=Qd(t,s);ds(t,i)}),t.onDisconnect_=ll(),dt(t.eventQueue_,Y(),r)}function F1(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&qu(t.onDisconnect_,e),Qn(t,n,r,s)})}function ap(t,e,n,r){const s=ue(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,i)=>{o==="ok"&&_s(t.onDisconnect_,e,s),Qn(t,r,o,i)})}function V1(t,e,n,r,s){const o=ue(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(i,l)=>{i==="ok"&&_s(t.onDisconnect_,e,o),Qn(t,s,i,l)})}function G1(t,e,n,r){if(Fu(n)){Te("onDisconnect().update() called with empty data.  Don't do anything."),Qn(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,o)=>{s==="ok"&&De(n,(i,l)=>{const u=ue(l);_s(t.onDisconnect_,le(e,i),u)}),Qn(t,r,s,o)})}function W1(t,e,n){let r;V(e._path)===".info"?r=rc(t.infoSyncTree_,e,n):r=rc(t.serverSyncTree_,e,n),o_(t.eventQueue_,e._path,r)}function oc(t,e,n){let r;V(e._path)===".info"?r=ml(t.infoSyncTree_,e,n):r=ml(t.serverSyncTree_,e,n),o_(t.eventQueue_,e._path,r)}function u_(t){t.persistentConnection_&&t.persistentConnection_.interrupt(l_)}function B1(t){t.persistentConnection_&&t.persistentConnection_.resume(l_)}function Es(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Te(n,...e)}function Qn(t,e,n,r){e&&ys(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let o=s;r&&(o+=": "+r);const i=new Error(o);i.code=s,e(i)}})}function j1(t,e,n,r,s,o){Es(t,"transaction on "+e);const i={path:e,update:n,onComplete:r,status:null,order:sy(),applyLocally:o,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Yd(t,e,void 0);i.currentInputSnapshot=l;const u=i.update(l.val());if(u===void 0)i.unwatcher(),i.currentOutputSnapshotRaw=null,i.currentOutputSnapshotResolved=null,i.onComplete&&i.onComplete(null,!1,i.currentInputSnapshot);else{Go("transaction failed: Data returned ",u,i.path),i.status=0;const a=Hl(t.transactionQueueTree_,e),f=br(a)||[];f.push(i),Bd(a,f);let c;typeof u=="object"&&u!==null&&ct(u,".priority")?(c=_r(u,".priority"),k(Ao(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=(jl(t.serverSyncTree_,e)||I.EMPTY_NODE).getPriority().val();const d=Bo(t),h=ue(u,c),m=Vd(h,l,d);i.currentOutputSnapshotRaw=h,i.currentOutputSnapshotResolved=m,i.currentWriteId=ql(t);const v=Id(t.serverSyncTree_,e,m,i.currentWriteId,i.applyLocally);dt(t.eventQueue_,e,v),Xl(t,t.transactionQueueTree_)}}function Yd(t,e,n){return jl(t.serverSyncTree_,e,n)||I.EMPTY_NODE}function Xl(t,e=t.transactionQueueTree_){if(e||Jl(t,e),br(e)){const n=d_(t,e);k(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&z1(t,Vo(e),n)}else e_(e)&&Yl(e,n=>{Xl(t,n)})}function z1(t,e,n){const r=n.map(a=>a.currentWriteId),s=Yd(t,e,r);let o=s;const i=s.hash();for(let a=0;a<n.length;a++){const f=n[a];k(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const c=We(e,f.path);o=o.updateChild(c,f.currentOutputSnapshotRaw)}const l=o.val(!0),u=e;t.server_.put(u.toString(),l,a=>{Es(t,"transaction put response",{path:u.toString(),status:a});let f=[];if(a==="ok"){const c=[];for(let d=0;d<n.length;d++)n[d].status=2,f=f.concat(Tn(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&c.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Jl(t,Hl(t.transactionQueueTree_,e)),Xl(t,t.transactionQueueTree_),dt(t.eventQueue_,e,f);for(let d=0;d<c.length;d++)ys(c[d])}else{if(a==="datastale")for(let c=0;c<n.length;c++)n[c].status===3?n[c].status=4:n[c].status=0;else{Ue("transaction at "+u.toString()+" failed: "+a);for(let c=0;c<n.length;c++)n[c].status=4,n[c].abortReason=a}ds(t,e)}},i)}function ds(t,e){const n=c_(t,e),r=Vo(n),s=d_(t,n);return H1(t,s,r),r}function H1(t,e,n){if(e.length===0)return;const r=[];let s=[];const i=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const u=e[l],a=We(n,u.path);let f=!1,c;if(k(a!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)f=!0,c=u.abortReason,s=s.concat(Tn(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=N1)f=!0,c="maxretry",s=s.concat(Tn(t.serverSyncTree_,u.currentWriteId,!0));else{const d=Yd(t,u.path,i);u.currentInputSnapshot=d;const h=e[l].update(d.val());if(h!==void 0){Go("transaction failed: Data returned ",h,u.path);let m=ue(h);typeof h=="object"&&h!=null&&ct(h,".priority")||(m=m.updatePriority(d.getPriority()));const w=u.currentWriteId,y=Bo(t),p=Vd(m,d,y);u.currentOutputSnapshotRaw=m,u.currentOutputSnapshotResolved=p,u.currentWriteId=ql(t),i.splice(i.indexOf(w),1),s=s.concat(Id(t.serverSyncTree_,u.path,p,u.currentWriteId,u.applyLocally)),s=s.concat(Tn(t.serverSyncTree_,w,!0))}else f=!0,c="nodata",s=s.concat(Tn(t.serverSyncTree_,u.currentWriteId,!0))}dt(t.eventQueue_,n,s),s=[],f&&(e[l].status=2,function(d){setTimeout(d,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(c==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(c),!1,null))))}Jl(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)ys(r[l]);Xl(t,t.transactionQueueTree_)}function c_(t,e){let n,r=t.transactionQueueTree_;for(n=V(e);n!==null&&br(r)===void 0;)r=Hl(r,n),e=Z(e),n=V(e);return r}function d_(t,e){const n=[];return f_(t,e,n),n.sort((r,s)=>r.order-s.order),n}function f_(t,e,n){const r=br(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Yl(e,s=>{f_(t,s,n)})}function Jl(t,e){const n=br(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,Bd(e,n.length>0?n:void 0)}Yl(e,r=>{Jl(t,r)})}function Qd(t,e){const n=Vo(c_(t,e)),r=Hl(t.transactionQueueTree_,e);return P1(r,s=>{Ba(t,s)}),Ba(t,r),t_(r,s=>{Ba(t,s)}),n}function Ba(t,e){const n=br(e);if(n){const r=[];let s=[],o=-1;for(let i=0;i<n.length;i++)n[i].status===3||(n[i].status===1?(k(o===i-1,"All SENT items should be at beginning of queue."),o=i,n[i].status=3,n[i].abortReason="set"):(k(n[i].status===0,"Unexpected transaction status in abort"),n[i].unwatcher(),s=s.concat(Tn(t.serverSyncTree_,n[i].currentWriteId,!0)),n[i].onComplete&&r.push(n[i].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Bd(e,void 0):n.length=o+1,dt(t.eventQueue_,Vo(e),s);for(let i=0;i<r.length;i++)ys(r[i])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function Q1(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ue(`Invalid query segment '${n}' in query '${t}'`)}return e}const ic=function(t,e){const n=K1(t),r=n.namespace;n.domain==="firebase.com"&&Kt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Kt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||sS();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new _y(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Q(n.pathString)}},K1=function(t){let e="",n="",r="",s="",o="",i=!0,l="https",u=443;if(typeof t=="string"){let a=t.indexOf("//");a>=0&&(l=t.substring(0,a-1),t=t.substring(a+2));let f=t.indexOf("/");f===-1&&(f=t.length);let c=t.indexOf("?");c===-1&&(c=t.length),e=t.substring(0,Math.min(f,c)),f<c&&(s=Y1(t.substring(f,c)));const d=Q1(t.substring(Math.min(t.length,c)));a=e.indexOf(":"),a>=0?(i=l==="https"||l==="wss",u=parseInt(e.substring(a+1),10)):a=e.length;const h=e.slice(0,a);if(h.toLowerCase()==="localhost")n="localhost";else if(h.split(".").length<=2)n=h;else{const m=e.indexOf(".");r=e.substring(0,m).toLowerCase(),n=e.substring(m+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:i,scheme:l,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",q1=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=up.charAt(n%64),n=Math.floor(n/64);k(n===0,"Cannot push at time == 0");let i=o.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)i+=up.charAt(e[s]);return k(i.length===20,"nextPushId: Length should be 20."),i}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+we(this.snapshot.exportVal())}}class p_{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return k(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X1=class{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Ke;return F1(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){wt("OnDisconnect.remove",this._path);const e=new Ke;return ap(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){wt("OnDisconnect.set",this._path),qt("OnDisconnect.set",e,this._path,!1);const n=new Ke;return ap(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){wt("OnDisconnect.setWithPriority",this._path),qt("OnDisconnect.setWithPriority",e,this._path,!1),jd("OnDisconnect.setWithPriority",n);const r=new Ke;return V1(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){wt("OnDisconnect.update",this._path),r_("OnDisconnect.update",e,this._path);const n=new Ke;return G1(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return G(this._path)?null:Ed(this._path)}get ref(){return new kt(this._repo,this._path)}get _queryIdentifier(){const e=Qh(this._queryParams),n=gd(e);return n==="{}"?"default":n}get _queryObject(){return Qh(this._queryParams)}isEqual(e){if(e=pt(e),!(e instanceof rt))return!1;const n=this._repo===e._repo,r=wd(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+GS(this._path)}}function Zl(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Jn(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Qt){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==jn)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==mn)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===ne){if(e!=null&&!Ao(e)||n!=null&&!Ao(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(k(t.getIndex()instanceof Cd||t.getIndex()===kd,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ea(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class kt extends rt{constructor(e,n){super(e,n,new Fl,!1)}get parent(){const e=Ty(this._path);return e===null?null:new kt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let ta=class lc{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Q(e),r=wr(this.ref,e);return new lc(this._node.getChild(n),r,ne)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new lc(s,wr(this.ref,r),ne)))}hasChild(e){const n=new Q(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function m_(t,e){return t=pt(t),t._checkNotDeleted("ref"),e!==void 0?wr(t._root,e):t._root}function cp(t,e){t=pt(t),t._checkNotDeleted("refFromURL");const n=ic(e,t._repo.repoInfo_.nodeAdmin);s_("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Kt("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),m_(t,n.path.toString())}function wr(t,e){return t=pt(t),V(t._path)===null?D1("child","path",e):Do("child","path",e),new kt(t._repo,le(t._path,e))}function J1(t,e){t=pt(t),wt("push",t._path),qt("push",e,t._path,!0);const n=a_(t._repo),r=q1(n),s=wr(t,r),o=wr(t,r);let i;return e!=null?i=qd(o,e).then(()=>o):i=Promise.resolve(o),s.then=i.then.bind(i),s.catch=i.then.bind(i,void 0),s}function Z1(t){return wt("remove",t._path),qd(t,null)}function qd(t,e){t=pt(t),wt("set",t._path),qt("set",e,t._path,!1);const n=new Ke;return Hd(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function eC(t,e){t=pt(t),wt("setPriority",t._path),jd("setPriority",e);const n=new Ke;return Hd(t._repo,le(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function tC(t,e,n){if(wt("setWithPriority",t._path),qt("setWithPriority",e,t._path,!1),jd("setWithPriority",n),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new Ke;return Hd(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function nC(t,e){r_("update",e,t._path);const n=new Ke;return M1(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function rC(t){t=pt(t);const e=new Kd(()=>{}),n=new jo(e);return $1(t._repo,t,n).then(r=>new ta(r,new kt(t._repo,t._path),t._queryParams.getIndex()))}class jo{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new h_("value",this,new ta(e.snapshotNode,new kt(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new p_(this,e,n):null}matches(e){return e instanceof jo?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class na{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new p_(this,e,n):null}createEvent(e,n){k(e.childName!=null,"Child events should have a childName.");const r=wr(new kt(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new h_(e.type,this,new ta(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof na?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function zo(t,e,n,r,s){let o;if(typeof r=="object"&&(o=void 0,s=r),typeof r=="function"&&(o=r),s&&s.onlyOnce){const u=n,a=(f,c)=>{oc(t._repo,t,l),u(f,c)};a.userCallback=n.userCallback,a.context=n.context,n=a}const i=new Kd(n,o||void 0),l=e==="value"?new jo(i):new na(e,i);return W1(t._repo,t,l),()=>oc(t._repo,t,l)}function ac(t,e,n,r){return zo(t,"value",e,n,r)}function dp(t,e,n,r){return zo(t,"child_added",e,n,r)}function fp(t,e,n,r){return zo(t,"child_changed",e,n,r)}function hp(t,e,n,r){return zo(t,"child_moved",e,n,r)}function pp(t,e,n,r){return zo(t,"child_removed",e,n,r)}function mp(t,e,n){let r=null;const s=n?new Kd(n):null;e==="value"?r=new jo(s):e&&(r=new na(e,s)),oc(t._repo,t,r)}class Mt{}class g_ extends Mt{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){qt("endAt",this._value,e._path,!0);const n=Ku(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new rt(e._repo,e._path,n,e._orderByCalled)}}function sC(t,e){return Wo("endAt","key",e),new g_(t,e)}class oC extends Mt{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){qt("endBefore",this._value,e._path,!1);const n=hP(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new rt(e._repo,e._path,n,e._orderByCalled)}}function iC(t,e){return Wo("endBefore","key",e),new oC(t,e)}class y_ extends Mt{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){qt("startAt",this._value,e._path,!0);const n=Qu(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new rt(e._repo,e._path,n,e._orderByCalled)}}function lC(t=null,e){return Wo("startAt","key",e),new y_(t,e)}class aC extends Mt{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){qt("startAfter",this._value,e._path,!1);const n=fP(e._queryParams,this._value,this._key);if(ea(n),Jn(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new rt(e._repo,e._path,n,e._orderByCalled)}}function uC(t,e){return Wo("startAfter","key",e),new aC(t,e)}class cC extends Mt{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new rt(e._repo,e._path,cP(e._queryParams,this._limit),e._orderByCalled)}}function dC(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new cC(t)}class fC extends Mt{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new rt(e._repo,e._path,dP(e._queryParams,this._limit),e._orderByCalled)}}function hC(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new fC(t)}class pC extends Mt{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Zl(e,"orderByChild");const n=new Q(this._path);if(G(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new Cd(n),s=Vl(e._queryParams,r);return Jn(s),new rt(e._repo,e._path,s,!0)}}function mC(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Do("orderByChild","path",t),new pC(t)}class gC extends Mt{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Zl(e,"orderByKey");const n=Vl(e._queryParams,Qt);return Jn(n),new rt(e._repo,e._path,n,!0)}}function yC(){return new gC}class _C extends Mt{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Zl(e,"orderByPriority");const n=Vl(e._queryParams,ne);return Jn(n),new rt(e._repo,e._path,n,!0)}}function vC(){return new _C}class EC extends Mt{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Zl(e,"orderByValue");const n=Vl(e._queryParams,kd);return Jn(n),new rt(e._repo,e._path,n,!0)}}function wC(){return new EC}class SC extends Mt{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(qt("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new g_(this._value,this._key)._apply(new y_(this._value,this._key)._apply(e))}}function PC(t,e){return Wo("equalTo","key",e),new SC(t,e)}function At(t,...e){let n=pt(t);for(const r of e)n=r._apply(n);return n}t1(kt);i1(kt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC="FIREBASE_DATABASE_EMULATOR_HOST",uc={};let kC=!1;function bC(t,e,n,r){const s=e.lastIndexOf(":"),o=e.substring(0,s),i=ld(o);t.repoInfo_=new _y(e,i,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function __(t,e,n,r,s){let o=r||t.options.databaseURL;o===void 0&&(t.options.projectId||Kt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Te("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let i=ic(o,s),l=i.repoInfo,u,a;typeof process<"u"&&xh&&(a=xh[CC]),a?(u=!0,o=`http://${a}?ns=${l.namespace}`,i=ic(o,s),l=i.repoInfo):u=!i.repoInfo.secure;const f=s&&u?new qr(qr.OWNER):new mS(t.name,t.options,e);s_("Invalid Firebase Database URL",i),G(i.path)||Kt("Database URL must point to the root of a Firebase Database (not including a child path).");const c=AC(l,t,f,new pS(t,n));return new DC(c,t)}function TC(t,e){const n=uc[e];(!n||n[t.key]!==t)&&Kt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),u_(t),delete n[t.key]}function AC(t,e,n,r){let s=uc[e.name];s||(s={},uc[e.name]=s);let o=s[t.toURLString()];return o&&Kt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new R1(t,kC,n,r),s[t.toURLString()]=o,o}let DC=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(I1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new kt(this._repo,Y())),this._rootInternal}_delete(){return this._rootInternal!==null&&(TC(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Kt("Cannot call "+e+" on a deleted database.")}};function v_(){ls.IS_TRANSPORT_INITIALIZED&&Ue("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function xC(){v_(),bn.forceDisallow()}function OC(){v_(),_t.forceDisallow(),bn.forceAllow()}function NC(t,e,n,r={}){t=pt(t),t._checkNotDeleted("useEmulator");const s=`${e}:${n}`,o=t._repoInternal;if(t._instanceStarted){if(s===t._repoInternal.repoInfo_.host&&tl(r,o.repoInfo_.emulatorOptions))return;Kt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let i;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&Kt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new qr(qr.OWNER);else if(r.mockUserToken){const l=typeof r.mockUserToken=="string"?r.mockUserToken:pE(r.mockUserToken,t.app.options.projectId);i=new qr(l)}ld(e)&&(hE(e),yE("Database",!0)),bC(o,s,r,i)}function RC(t){t=pt(t),t._checkNotDeleted("goOffline"),u_(t._repo)}function IC(t){t=pt(t),t._checkNotDeleted("goOnline"),B1(t._repo)}function LC(t,e){iy(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(t){ny(fd),is(new hn("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return __(r,s,o,n)},"PUBLIC").setMultipleInstances(!0)),ln(Oh,Nh,t),ln(Oh,Nh,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC={".sv":"timestamp"};function UC(){return MC}function FC(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VC=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function GC(t,e,n){if(t=pt(t),wt("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(n==null?void 0:n.applyLocally)??!0,s=new Ke,o=(l,u,a)=>{let f=null;l?s.reject(l):(f=new ta(a,new kt(t._repo,t._path),ne),s.resolve(new VC(u,f)))},i=ac(t,()=>{});return j1(t._repo,t._path,e,o,i,r),s.promise}an.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};an.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};$C();const WC="@firebase/database-compat",BC="2.1.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=new $l("@firebase/database-compat"),E_=function(t){const e="FIREBASE WARNING: "+t;jC.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zC=function(t,e,n,r){if(n!==void 0&&typeof n!="boolean")throw new Error(nt(t,e)+"must be a boolean.")},HC=function(t,e,n){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(nt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e){this._delegate=e}cancel(e){L("OnDisconnect.cancel",0,1,arguments.length),ke("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){L("OnDisconnect.remove",0,1,arguments.length),ke("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){L("OnDisconnect.set",1,2,arguments.length),ke("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){L("OnDisconnect.setWithPriority",2,3,arguments.length),ke("OnDisconnect.setWithPriority","onComplete",r,!0);const s=this._delegate.setWithPriority(e,n);return r&&s.then(()=>r(null),o=>r(o)),s}update(e,n){if(L("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,E_("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ke("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),s=>n(s)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return L("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n){this._database=e,this._delegate=n}val(){return L("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return L("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return L("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return L("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return L("DataSnapshot.child",0,1,arguments.length),e=String(e),Do("DataSnapshot.child","path",e),new Fn(this._database,this._delegate.child(e))}hasChild(e){return L("DataSnapshot.hasChild",1,1,arguments.length),Do("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return L("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return L("DataSnapshot.forEach",1,1,arguments.length),ke("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Fn(this._database,n)))}hasChildren(){return L("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return L("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return L("DataSnapshot.ref",0,0,arguments.length),new ot(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class xe{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,s){var u;L("Query.on",2,4,arguments.length),ke("Query.on","callback",n,!1);const o=xe.getCancelAndContextArgs_("Query.on",r,s),i=(a,f)=>{n.call(o.context,new Fn(this.database,a),f)};i.userCallback=n,i.context=o.context;const l=(u=o.cancel)==null?void 0:u.bind(o.context);switch(e){case"value":return ac(this._delegate,i,l),n;case"child_added":return dp(this._delegate,i,l),n;case"child_removed":return pp(this._delegate,i,l),n;case"child_changed":return fp(this._delegate,i,l),n;case"child_moved":return hp(this._delegate,i,l),n;default:throw new Error(nt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(L("Query.off",0,3,arguments.length),HC("Query.off",e),ke("Query.off","callback",n,!0),Eh("Query.off","context",r),n){const s=()=>{};s.userCallback=n,s.context=r,mp(this._delegate,e,s)}else mp(this._delegate,e)}get(){return rC(this._delegate).then(e=>new Fn(this.database,e))}once(e,n,r,s){L("Query.once",1,4,arguments.length),ke("Query.once","callback",n,!0);const o=xe.getCancelAndContextArgs_("Query.once",r,s),i=new Ke,l=(a,f)=>{const c=new Fn(this.database,a);n&&n.call(o.context,c,f),i.resolve(c)};l.userCallback=n,l.context=o.context;const u=a=>{o.cancel&&o.cancel.call(o.context,a),i.reject(a)};switch(e){case"value":ac(this._delegate,l,u,{onlyOnce:!0});break;case"child_added":dp(this._delegate,l,u,{onlyOnce:!0});break;case"child_removed":pp(this._delegate,l,u,{onlyOnce:!0});break;case"child_changed":fp(this._delegate,l,u,{onlyOnce:!0});break;case"child_moved":hp(this._delegate,l,u,{onlyOnce:!0});break;default:throw new Error(nt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return i.promise}limitToFirst(e){return L("Query.limitToFirst",1,1,arguments.length),new xe(this.database,At(this._delegate,dC(e)))}limitToLast(e){return L("Query.limitToLast",1,1,arguments.length),new xe(this.database,At(this._delegate,hC(e)))}orderByChild(e){return L("Query.orderByChild",1,1,arguments.length),new xe(this.database,At(this._delegate,mC(e)))}orderByKey(){return L("Query.orderByKey",0,0,arguments.length),new xe(this.database,At(this._delegate,yC()))}orderByPriority(){return L("Query.orderByPriority",0,0,arguments.length),new xe(this.database,At(this._delegate,vC()))}orderByValue(){return L("Query.orderByValue",0,0,arguments.length),new xe(this.database,At(this._delegate,wC()))}startAt(e=null,n){return L("Query.startAt",0,2,arguments.length),new xe(this.database,At(this._delegate,lC(e,n)))}startAfter(e=null,n){return L("Query.startAfter",0,2,arguments.length),new xe(this.database,At(this._delegate,uC(e,n)))}endAt(e=null,n){return L("Query.endAt",0,2,arguments.length),new xe(this.database,At(this._delegate,sC(e,n)))}endBefore(e=null,n){return L("Query.endBefore",0,2,arguments.length),new xe(this.database,At(this._delegate,iC(e,n)))}equalTo(e,n){return L("Query.equalTo",1,2,arguments.length),new xe(this.database,At(this._delegate,PC(e,n)))}toString(){return L("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return L("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(L("Query.isEqual",1,1,arguments.length),!(e instanceof xe)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const s={cancel:void 0,context:void 0};if(n&&r)s.cancel=n,ke(e,"cancel",s.cancel,!0),s.context=r,Eh(e,"context",s.context);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(nt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new ot(this.database,new kt(this._delegate._repo,this._delegate._path))}}class ot extends xe{constructor(e,n){super(e,new rt(n._repo,n._path,new Fl,!1)),this.database=e,this._delegate=n}getKey(){return L("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return L("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new ot(this.database,wr(this._delegate,e))}getParent(){L("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new ot(this.database,e):null}getRoot(){return L("Reference.root",0,0,arguments.length),new ot(this.database,this._delegate.root)}set(e,n){L("Reference.set",1,2,arguments.length),ke("Reference.set","onComplete",n,!0);const r=qd(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}update(e,n){if(L("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,E_("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wt("Reference.update",this._delegate._path),ke("Reference.update","onComplete",n,!0);const r=nC(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){L("Reference.setWithPriority",2,3,arguments.length),ke("Reference.setWithPriority","onComplete",r,!0);const s=tC(this._delegate,e,n);return r&&s.then(()=>r(null),o=>r(o)),s}remove(e){L("Reference.remove",0,1,arguments.length),ke("Reference.remove","onComplete",e,!0);const n=Z1(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){L("Reference.transaction",1,3,arguments.length),ke("Reference.transaction","transactionUpdate",e,!1),ke("Reference.transaction","onComplete",n,!0),zC("Reference.transaction","applyLocally",r);const s=GC(this._delegate,e,{applyLocally:r}).then(o=>new QC(o.committed,new Fn(this.database,o.snapshot)));return n&&s.then(o=>n(null,o.committed,o.snapshot),o=>n(o,!1,null)),s}setPriority(e,n){L("Reference.setPriority",1,2,arguments.length),ke("Reference.setPriority","onComplete",n,!0);const r=eC(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}push(e,n){L("Reference.push",0,2,arguments.length),ke("Reference.push","onComplete",n,!0);const r=J1(this._delegate,e),s=r.then(i=>new ot(this.database,i));n&&s.then(()=>n(null),i=>n(i));const o=new ot(this.database,r);return o.then=s.then.bind(s),o.catch=s.catch.bind(s,void 0),o}onDisconnect(){return wt("Reference.onDisconnect",this._delegate._path),new YC(new X1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:xC,forceLongPolling:OC}}useEmulator(e,n,r={}){NC(this._delegate,e,n,r)}ref(e){if(L("database.ref",0,1,arguments.length),e instanceof ot){const n=cp(this._delegate,e.toString());return new ot(this,n)}else{const n=m_(this._delegate,e);return new ot(this,n)}}refFromURL(e){L("database.refFromURL",1,1,arguments.length);const r=cp(this._delegate,e);return new ot(this,r)}goOffline(){return L("database.goOffline",0,0,arguments.length),RC(this._delegate)}goOnline(){return L("database.goOnline",0,0,arguments.length),IC(this._delegate)}}xo.ServerValue={TIMESTAMP:UC(),increment:t=>FC(t)};function KC({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:s,namespace:o,nodeAdmin:i=!1}){ny(n);const l=new ad("database-standalone"),u=new Vu("auth-internal",l);u.setComponent(new hn("auth-internal",()=>r,"PRIVATE"));let a;return s&&(a=new Vu("app-check-internal",l),a.setComponent(new hn("app-check-internal",()=>s,"PRIVATE"))),{instance:new xo(__(t,u,a,e,i),t),namespace:o}}var qC=Object.freeze({__proto__:null,initStandalone:KC});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC=xo.ServerValue;function JC(t){t.INTERNAL.registerComponent(new hn("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new xo(s,r)},"PUBLIC").setServiceProps({Reference:ot,Query:xe,Database:xo,DataSnapshot:Fn,enableLogging:LC,INTERNAL:qC,ServerValue:XC}).setMultipleInstances(!0)),t.registerVersion(WC,BC)}JC(md);window.firebase=md;const ZC=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],gp=5,ek=1e3;function w_(t=4){return[...ZC].sort(()=>Math.random()-.5).slice(0,t)}const yp={red:{title:"Patron Manipulation",icon:"",actions:[{id:"gain3red",title:"Gain 3 ",description:"",round:1},{id:"gain2red",title:"Gain 2 ",description:"",round:1},{id:"redHybrid1",title:"+1  + Swap Patrons",description:"(Both execute their new action)",round:1},{id:"redRepeatAction",title:"Repeat an Action",description:"(That one of your patrons is on)",round:1},{id:"redVPFocus",title:"Gain 1, +1 VP Per Red Patron",description:"(for each red action where you have a patron)",round:2},{id:"redHybrid2",title:"+1  + Swap Patrons",description:"(Only you execute your new action)",round:2},{id:"redRepeatAll",title:"Repeat all actions where you have a patron",description:"(In any order you choose)",round:3}]},yellow:{title:"Resource Manipulation",icon:"",actions:[{id:"gain3yellow",title:"Gain 3 resources",description:"(any colors)",round:1},{id:"gain2yellow",title:"Gain 2 resources",description:"(any colors)",round:1},{id:"steal2Gems",title:"Trade all resources for new ones",description:"(keep same total count)",round:1},{id:"yellowHybrid1",title:"Gain 2 resources",description:"(any colors)",round:1},{id:"steal3Gems",title:"Steal 3 resources from a player",description:"(any colors)",round:2},{id:"yellowHybrid2",title:"+1  + Double your next gain",description:"(doesn't stack with shop)",round:2},{id:"yellowSwapResources",title:"Swap all your resources with another player",description:"",round:3}]},blue:{title:"Shop Control",icon:"",actions:[{id:"gain3blue",title:"Gain 3 ",description:"",round:1},{id:"gain2blue",title:"Gain 2 ",description:"",round:1},{id:"blueR1ShopBenefit",title:"Gain an R1 Shop Benefit",description:"(Even if closed)",round:1},{id:"blueReduceCosts",title:"+1  + Reduce All Shop Costs",description:"(By 1  this round)",round:1},{id:"blueIncreaseCosts",title:"Increase All Shop Costs",description:"(By 2  for other players)",round:2},{id:"blueToggleShops",title:"+1  + Toggle All Shop Status",description:"(Including victory shops)",round:2},{id:"blueAnyShopBenefit",title:"Gain Any Shop Benefit",description:"(Even if closed)",round:3}]},purple:{title:"Timing/Order",icon:"",actions:[{id:"gain4purpleSkip",title:"Gain 4 , Skip Next Turn",description:"",round:1},{id:"gain3purple",title:"Gain 3 ",description:"",round:1},{id:"gain2purpleTakeBack",title:"Gain 2 , Take Back Patron",description:"(From different quad)",round:1},{id:"playTwoWorkers",title:"Place 2 More Patrons",description:"(This turn)",round:1},{id:"gain5purpleSkip",title:"Gain 5 , Skip Turn",description:"",round:2},{id:"playThreeWorkers",title:"Place 3 More Patrons",description:"(This turn)",round:2},{id:"gain4purpleWaitAll",title:"Gain 4 , Take Another Turn",description:"(After this one)",round:3}]},gold:{title:"Victory Points",icon:"",actions:[{id:"gain2gold",title:"Gain 2 Gold",description:"",round:1},{id:"convert2AnyTo2Gold",title:"Trade: 2 resources  2 Gold",description:"(any colors)",round:1},{id:"gain1gold",title:"Gain 1 Gold",description:"",round:1},{id:"convert1AnyTo1Gold",title:"Trade: 1 resource  1 Gold",description:"(any color)",round:1},{id:"gain3goldSkip",title:"Gain 3 Gold, skip your next turn",description:"",round:2},{id:"convert3AnyTo3Gold",title:"Trade: 3 resources  3 Gold",description:"(any colors)",round:2},{id:"goldVPPerGold",title:"Gain 1 VP for each Gold you have",description:"",round:3}]},white:{title:"White - VP Trading",icon:"",actions:[{id:"gain3vp",title:"Gain 3 VP",description:"",round:1},{id:"gain2vp",title:"Gain 2 VP",description:"",round:1},{id:"spend1AnyFor2VP",title:"Trade: 1 resource  2 VP",description:"(any color)",round:1},{id:"spend2AnyFor3VP",title:"Trade: 2 resources  3 VP",description:"(any colors)",round:1},{id:"lose1VPGain2Any",title:"Lose 1 VP, gain 2 resources",description:"(any colors)",round:2},{id:"lose2VPGain4Any",title:"Lose 2 VP, gain 4 resources",description:"(any colors)",round:2},{id:"gain5VPAnd5Any",title:"Gain 5 VP and 5 resources",description:"(any colors)",round:3}]},black:{title:"Destruction/Penalty",icon:"",actions:[{id:"gain3black",title:"Gain 3 ",description:"",round:1},{id:"gain2black",title:"Gain 2 ",description:"",round:1},{id:"blackSteal1VP",title:"+1 , steal 1 VP from a player",description:"",round:1},{id:"blackSteal2Any",title:"Steal 2 resources from a player",description:"(any colors)",round:1},{id:"blackStealWorker",title:"+1 , steal 4 resources from a player",description:"(any colors)",round:2},{id:"blackAllLose2VP",title:"All other players lose 2 VP",description:"",round:2},{id:"blackAllLose4VP",title:"+2 , all other players lose 4 VP",description:"",round:3}]},silver:{title:"Information/Planning",icon:"",actions:[{id:"silver4Others1",title:"+4 Silver for you, +1 for all others",description:"",round:1},{id:"silver3Others1",title:"+3 Silver for you, +1 for all others",description:"",round:1},{id:"silver2Plus1Others",title:"+2 Silver + 1 resource for you",description:"(others get 1 of same color)",round:1},{id:"silver2VPBoth",title:"+2 VP for you, pick a player for +2 VP",description:"",round:1},{id:"silverTakeBack2",title:"+2 Silver, take back 2 patrons",description:"(others take back 1)",round:2},{id:"silver3Plus2Others1",title:"+3 Silver + 2 resources for you",description:"(others get 1 of that color)",round:2},{id:"silver8VPOthers3S",title:"+8 VP for you, +3 Silver for all others",description:"",round:3}]}};function gl(t,e="advanced"){let n;e==="basic"?n=["red","yellow","blue","purple"]:n=Object.keys(yp);const r=[...n];for(let i=r.length-1;i>0;i--){const l=Math.floor(Math.random()*(i+1));[r[i],r[l]]=[r[l],r[i]]}const s=r.slice(0,t),o={};return s.forEach(i=>{o[i]=yp[i]}),o}const Fs=w_(4),yl={currentPlayer:1,turnDirection:1,gameMode:null,players:[{id:1,name:"Player 1",emoji:Fs[0],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0},{id:2,name:"Player 2",emoji:Fs[1],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0},{id:3,name:"Player 3",emoji:Fs[2],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0},{id:4,name:"Player 4",emoji:Fs[3],resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0,vpSources:{},shopCostModifier:0}],occupiedSpaces:{},round:1,turnOrder:[1,2,3,4],workerPlacedThisTurn:!1,workersToPlace:1,shopUsedAfterWorkers:!1,modal:null,actionLog:[],gameLayers:null,automaticVPs:{},closedShops:{},skippedTurns:{},playersOutOfWorkers:[],waitingForOthers:{},roundActions:[],roundAdvancing:!1,roomCode:null,myPlayerId:null,myPlayerName:"",connectedPlayers:{},isHost:!1,gameStarted:!1,connectionStatus:"disconnected",gameOver:!1,syncingFromFirebase:!1,stateVersion:0,notifications:[],pendingPlacements:{}};function tk(t,e){console.log("Reducer called with action:",e.type,e);const n=(()=>{var r,s,o,i;switch(e.type){case"PLACE_WORKER":const l=e.playerId||t.currentPlayer,u=l===t.currentPlayer,a=u?Math.max(0,t.workersToPlace-1):t.workersToPlace,f=t.players.find(E=>E.id===l),c=Math.max(0,f.workersLeft-1),d=(f.effects||[]).some(E=>E.includes("Can place")&&E.includes("more workers this turn")),h=a===0&&d;return{...t,occupiedSpaces:{...t.occupiedSpaces,[e.actionId]:l},players:t.players.map(E=>{if(E.id===l){const D={...E,workersLeft:c};return h&&u&&(D.effects=(D.effects||[]).filter(M=>!M.includes("Can place")&&!M.includes("more workers this turn"))),D}return E}),workerPlacedThisTurn:u?!0:t.workerPlacedThisTurn,workersToPlace:a,roundActions:[...t.roundActions,{playerId:l,actionId:e.actionId}]};case"UPDATE_RESOURCES":console.log("UPDATE_RESOURCES reducer called with:",{playerId:e.playerId,resources:e.resources,currentPlayers:t.players.map(E=>({id:E.id,resources:E.resources}))});const m={...t,players:t.players.map(E=>{if(E.id===e.playerId){const D={red:E.resources.red+(e.resources.red||0),yellow:E.resources.yellow+(e.resources.yellow||0),blue:E.resources.blue+(e.resources.blue||0),purple:E.resources.purple+(e.resources.purple||0),gold:E.resources.gold+(e.resources.gold||0),white:E.resources.white+(e.resources.white||0),black:E.resources.black+(e.resources.black||0),silver:E.resources.silver+(e.resources.silver||0)};return console.log("UPDATE_RESOURCES - Updating player",E.id,"from",E.resources,"to",D),{...E,resources:D}}return E})};return console.log("UPDATE_RESOURCES - Updated state players:",m.players.map(E=>({id:E.id,resources:E.resources}))),console.log("UPDATE_RESOURCES - Returning updated state"),m;case"SET_RESOURCES":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,resources:e.resources}:E)};case"ADD_VICTORY_POINTS":return{...t,players:t.players.map(E=>{var D;return E.id===e.playerId?{...E,victoryPoints:E.victoryPoints+e.points,vpSources:{...E.vpSources,victoryShop:(((D=E.vpSources)==null?void 0:D.victoryShop)||0)+e.points}}:E})};case"UPDATE_VP":return{...t,players:t.players.map(E=>{var D;return E.id===e.playerId?{...E,victoryPoints:E.victoryPoints+e.vp,vpSources:{...E.vpSources,[e.source||"other"]:(((D=E.vpSources)==null?void 0:D[e.source||"other"])||0)+e.vp}}:E})};case"ADD_EFFECT":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,effects:[...E.effects||[],e.effect]}:E)};case"UPDATE_PLAYER_EFFECTS":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,effects:e.effects}:E)};case"SET_WORKERS_TO_PLACE":return{...t,workersToPlace:e.count,workerPlacedThisTurn:!1};case"ADD_WORKERS_TO_PLACE":return{...t,workersToPlace:t.workersToPlace+e.count};case"END_TURN":const v=t.players.find(E=>E.id===t.currentPlayer);let w=[...t.playersOutOfWorkers];v.workersLeft===0&&!w.includes(t.currentPlayer)&&w.push(t.currentPlayer);const y=[],p=t.players.filter(E=>E.workersLeft>0);if(w.length===1&&w[0]===t.currentPlayer&&y.push({playerId:t.currentPlayer,vp:3,reason:"first to run out of workers"}),p.length===1&&v.workersLeft===0){const E=p[0];w.includes(E.id)||(w.push(E.id),y.push({playerId:E.id,vp:3,reason:"last to run out of workers"}))}const g=t.turnOrder.indexOf(t.currentPlayer);let S=!1;t.turnDirection===1?g===t.turnOrder.length-1&&(S=!0,t.turnOrder[g]):g===0&&(S=!0,t.turnOrder[g]);const P=v.effects.some(E=>E.includes("Will take an extra turn after this one")),b=(v.extraTurns||0)>0,A=P||b,T=t.skippedTurns[t.currentPlayer]>0;if(A&&!S){const E={...t.skippedTurns};let D="";T?(E[t.currentPlayer]--,D=`Player ${t.currentPlayer}: Extra turn consumed by skip (${E[t.currentPlayer]} skips remaining)`):D=`Player ${t.currentPlayer}: Taking extra turn!`;const M=t.players.map(N=>{var q,Jt;const W=y.find(Ie=>Ie.playerId===N.id);return N.id===t.currentPlayer?{...N,effects:(N.effects||[]).filter(Ie=>Ie.includes("Can place")&&Ie.includes("more workers this turn")&&t.workersToPlace>0?!0:!Ie.includes("Will take an extra turn after this one")&&!Ie.includes("more workers this turn")&&!Ie.includes("Can place")&&!Ie.includes("Next gain will be doubled")),extraTurns:Math.max(0,(N.extraTurns||0)-1),victoryPoints:N.victoryPoints+(W?W.vp:0),vpSources:W?{...N.vpSources,purpleWorkers:(((q=N.vpSources)==null?void 0:q.purpleWorkers)||0)+W.vp}:N.vpSources}:{...N,victoryPoints:N.victoryPoints+(W?W.vp:0),vpSources:W?{...N.vpSources,purpleWorkers:(((Jt=N.vpSources)==null?void 0:Jt.purpleWorkers)||0)+W.vp}:N.vpSources}});if(!T){const W=(M.find(q=>q.id===t.currentPlayer).effects||[]).some(q=>q.includes("Can place")&&q.includes("more workers this turn"));return{...t,players:M,workerPlacedThisTurn:!1,workersToPlace:W?t.workersToPlace:1,shopUsedAfterWorkers:!1,playersOutOfWorkers:w,skippedTurns:E,actionLog:[...t.actionLog.slice(-9),D,...y.map(q=>`Player ${q.playerId}: +${q.vp} VP (${q.reason})`)].filter(Boolean)}}}else if(A&&S){console.log(`Player ${t.currentPlayer}: Snake draft reversal - extra turn preserved`);const E=`Player ${t.currentPlayer}: At end of snake draft - gets another turn naturally (extra turn preserved)`;t.actionLog.push(E)}const j=A&&T&&!S?{...t.skippedTurns,[t.currentPlayer]:t.skippedTurns[t.currentPlayer]-1}:t.skippedTurns,R=A&&!S?t.players.map(E=>{var M,N;const D=y.find(W=>W.playerId===E.id);return E.id===t.currentPlayer?{...E,effects:(E.effects||[]).filter(W=>W.includes("Can place")&&W.includes("more workers this turn")&&t.workersToPlace>0?!0:!W.includes("Will take an extra turn after this one")&&!W.includes("more workers this turn")&&!W.includes("Can place")&&!W.includes("Next gain will be doubled")),extraTurns:Math.max(0,(E.extraTurns||0)-1),victoryPoints:E.victoryPoints+(D?D.vp:0),vpSources:D?{...E.vpSources,purpleWorkers:(((M=E.vpSources)==null?void 0:M.purpleWorkers)||0)+D.vp}:E.vpSources}:{...E,victoryPoints:E.victoryPoints+(D?D.vp:0),vpSources:D?{...E.vpSources,purpleWorkers:(((N=E.vpSources)==null?void 0:N.purpleWorkers)||0)+D.vp}:E.vpSources}}):t.players.map(E=>{var M;const D=y.find(N=>N.playerId===E.id);return D?{...E,victoryPoints:E.victoryPoints+D.vp,vpSources:{...E.vpSources,purpleWorkers:(((M=E.vpSources)==null?void 0:M.purpleWorkers)||0)+D.vp}}:E}),he=[];A&&T&&he.push(`Player ${t.currentPlayer}: Extra turn consumed by skip (${j[t.currentPlayer]} skips remaining)`);let Ut=[],Ft={...t.waitingForOthers};t.players.filter(E=>!t.waitingForOthers[E.id]&&E.workersLeft>0).length===0&&Object.keys(t.waitingForOthers).forEach(E=>{if(t.waitingForOthers[E]){const D=t.players.find(M=>M.id===parseInt(E));D&&D.workersLeft>0&&(Ut.push({playerId:parseInt(E),workers:D.workersLeft}),delete Ft[E])}});let X,Ye=t.turnDirection,Zn=0;const x=t.players.length*2,$={...j},F=[];console.log("END_TURN: Skip turns state",{effectiveSkippedTurns:j,tempSkippedTurns:$,currentPlayer:t.currentPlayer,turnOrder:t.turnOrder,turnDirection:t.turnDirection}),t.turnDirection===1?g===t.turnOrder.length-1?(Ye=-1,X=t.turnOrder[g]):X=t.turnOrder[g+1]:g===0?(Ye=1,X=t.turnOrder[g]):X=t.turnOrder[g-1];do{if(Zn++,Zn>x)break;if($[X]>0){console.log(`Player ${X} should skip turn. Skips remaining: ${$[X]}`),F.push(X),$[X]--;const M=t.turnOrder.indexOf(X);Ye===1?M===t.turnOrder.length-1?(Ye=-1,X=t.turnOrder[M]):X=t.turnOrder[M+1]:M===0?(Ye=1,X=t.turnOrder[M]):X=t.turnOrder[M-1];continue}const E=Ft[X],D=t.players.find(M=>M.id===X).workersLeft>0;if(E||!D){const M=t.turnOrder.indexOf(X);Ye===1?M===t.turnOrder.length-1?(Ye=-1,X=t.turnOrder[M-1]):X=t.turnOrder[M+1]:M===0?(Ye=1,X=t.turnOrder[M+1]):X=t.turnOrder[M-1];continue}break}while(Zn<x);const oe={...$};F.length>0&&console.log("Skip turn debug:",{skippedPlayers:F,currentPlayer:t.currentPlayer,nextPlayer:X,turnDirection:t.turnDirection,nextDirection:Ye,skippedTurns:oe});const pe=Ut.find(E=>E.playerId===X),yn=R.find(E=>E.id===X),Xt=((yn==null?void 0:yn.effects)||[]).some(E=>E.includes("Can place")&&E.includes("more workers this turn")),ws=pe?pe.workers:Xt?t.workersToPlace:1,Vt=R.reduce((E,D)=>Ft[D.id]?E:E+D.workersLeft,0);if(Vt===0&&t.round===3&&!R.some(D=>(D.extraTurns||0)>0||(D.effects||[]).some(M=>M.includes("Will take an extra turn after this one")))){const D=[],M=R.map(N=>{var Jt,Ie;let W=0;const q={...N.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const U=Object.entries(N.resources).filter(([Wt,_n])=>_n>0).length;U>0&&(W+=U,q.yellowDiversity=(((Jt=N.vpSources)==null?void 0:Jt.yellowDiversity)||0)+U,D.push(`Player ${N.id}: +${U} VP for ${U} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const U=N.resources.gold||0;U>0&&(W+=U,q.goldAutomatic=(((Ie=N.vpSources)==null?void 0:Ie.goldAutomatic)||0)+U,D.push(`Player ${N.id}: +${U} VP for ${U} gold resources`))}return W>0?{...N,victoryPoints:N.victoryPoints+W,vpSources:q}:N});return{...t,players:M,gameOver:!0,actionLog:[...t.actionLog.slice(-9),...D,"Game Over! All players are out of workers."]}}if(Vt===0&&t.round<3&&!t.roundAdvancing){const E=[],D=R.map(U=>{var me,Zt;let Wt=0;const _n={...U.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const bt=Object.entries(U.resources).filter(([qk,x_])=>x_>0).length;bt>0&&(Wt+=bt,_n.yellowDiversity=(((me=U.vpSources)==null?void 0:me.yellowDiversity)||0)+bt,E.push(`Player ${U.id}: +${bt} VP for ${bt} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const bt=U.resources.gold||0;bt>0&&(Wt+=bt,_n.goldAutomatic=(((Zt=U.vpSources)==null?void 0:Zt.goldAutomatic)||0)+bt,E.push(`Player ${U.id}: +${bt} VP for ${bt} gold resources`))}return Wt>0?{...U,victoryPoints:U.victoryPoints+Wt,vpSources:_n}:U});let M=D;if(t.gameLayers&&t.gameLayers.silver){let U=Math.max(...D.map(me=>me.victoryPoints));const _n=D.filter(me=>me.victoryPoints===U).map(me=>me.id);M=D.map(me=>{var Zt;return _n.includes(me.id)?(E.push(`Player ${me.id}: +3 Silver (most VP)`),{...me,resources:{...me.resources,silver:(me.resources.silver||0)+3}}):(E.push(`Player ${me.id}: +2 VP (Silver automatic)`),{...me,victoryPoints:me.victoryPoints+2,vpSources:{...me.vpSources,silverAutomatic:(((Zt=me.vpSources)==null?void 0:Zt.silverAutomatic)||0)+2}})})}const N=t.round+1,W={...t.closedShops};["red","yellow","blue","purple","gold","white","black","silver"].forEach(U=>{delete W[`${U}${N}`]});const Jt=M.map(U=>({id:U.id,vp:U.victoryPoints}));Jt.sort((U,Wt)=>U.vp-Wt.vp);const Ie=Jt.map(U=>U.id);return{...t,round:N,roundAdvancing:!0,closedShops:W,players:M.map(U=>{const Wt=3+N,me=(U.effects||[]).some(Zt=>Zt.includes("Will get 2 extra workers next round"))?2:0;return{...U,workersLeft:Wt+me,effects:(U.effects||[]).filter(Zt=>!Zt.includes("Will get 2 extra workers next round"))}}),occupiedSpaces:{},turnOrder:Ie,currentPlayer:Ie[0],turnDirection:1,workerPlacedThisTurn:!1,workersToPlace:1,shopUsedAfterWorkers:!1,shopCostModifier:0,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],actionLog:[...t.actionLog.slice(-9),...he,...y.map(U=>`Player ${U.playerId}: +${U.vp} VP (${U.reason})`),...Ut.map(U=>`Player ${U.playerId}: Can now play all ${U.workers} workers!`),...E,`Round ${N} started automatically! Extra workers applied.`].filter(Boolean)}}return{...t,currentPlayer:X,turnDirection:Ye,workerPlacedThisTurn:!1,workersToPlace:ws,shopUsedAfterWorkers:!1,skippedTurns:oe,waitingForOthers:Ft,playersOutOfWorkers:w,players:R,actionLog:[...t.actionLog.slice(-9),...he,...y.map(E=>`Player ${E.playerId}: +${E.vp} VP (${E.reason})`),...Ut.map(E=>`Player ${E.playerId}: Can now play all ${E.workers} workers!`),...F.map(E=>`Player ${E}: Turn skipped (${$[E]} skips remaining)`)].filter(Boolean)};case"ADVANCE_ROUND":if(t.round>=3)return console.log("ADVANCE_ROUND: Already at round 3, ignoring"),t;console.log("ADVANCE_ROUND reducer called, current state:",{round:t.round,occupiedSpaces:t.occupiedSpaces,players:t.players.map(E=>({id:E.id,workersLeft:E.workersLeft}))});const Gt=[],Ho=t.players.map(E=>{var N,W;let D=0;const M={...E.vpSources};if(t.gameLayers&&t.gameLayers.yellow){const q=Object.entries(E.resources).filter(([Jt,Ie])=>Ie>0).length;q>0&&(D+=q,M.yellowDiversity=(((N=E.vpSources)==null?void 0:N.yellowDiversity)||0)+q,Gt.push(`Player ${E.id}: +${q} VP for ${q} different color resources`))}if(t.gameLayers&&t.gameLayers.gold){const q=E.resources.gold||0;q>0&&(D+=q,M.goldAutomatic=(((W=E.vpSources)==null?void 0:W.goldAutomatic)||0)+q,Gt.push(`Player ${E.id}: +${q} VP for ${q} gold resources`))}return D>0?{...E,victoryPoints:E.victoryPoints+D,vpSources:M}:E});let sa=Ho;if(t.gameLayers&&t.gameLayers.silver){let E=Math.max(...Ho.map(N=>N.victoryPoints));const M=Ho.filter(N=>N.victoryPoints===E).map(N=>N.id);sa=Ho.map(N=>{var W;return M.includes(N.id)?(Gt.push(`Player ${N.id}: +3 Silver (most VP)`),{...N,resources:{...N.resources,silver:(N.resources.silver||0)+3}}):(Gt.push(`Player ${N.id}: +2 VP (Silver automatic)`),{...N,victoryPoints:N.victoryPoints+2,vpSources:{...N.vpSources,silverAutomatic:(((W=N.vpSources)==null?void 0:W.silverAutomatic)||0)+2}})})}const Yo=t.round+1,Xd={...t.closedShops};(t.gameLayers?Object.keys(t.gameLayers):[]).forEach(E=>{const D=`${E}${Yo}`;console.log(`Opening shop ${D} for round ${Yo}`),delete Xd[D]});const Jd=[...sa].sort((E,D)=>E.victoryPoints-D.victoryPoints).map(E=>E.id),Zd=Yo>3;Zd&&console.log("ADVANCE_ROUND: Game is over! Setting gameOver to true");const Tr={...t,round:Yo,gameOver:Zd,closedShops:Xd,players:sa.map(E=>{const D=3+(t.round+1),N=(E.effects||[]).some(W=>W.includes("Will get 2 extra workers next round"))?2:0;return{...E,workersLeft:D+N,effects:(E.effects||[]).filter(W=>!W.includes("Will get 2 extra workers next round")&&!W.includes("more workers this turn")),shopCostModifier:0}}),occupiedSpaces:{},turnOrder:Jd,currentPlayer:Jd[0],turnDirection:1,workerPlacedThisTurn:!1,workersToPlace:1,shopUsedAfterWorkers:!1,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],roundAdvancing:!1,actionLog:[...t.actionLog.slice(-9),...Gt,`Round ${t.round+1} started! Extra workers applied.`]};return console.log("ADVANCE_ROUND - New state:",{round:Tr.round,occupiedSpaces:Tr.occupiedSpaces,players:Tr.players.map(E=>({id:E.id,workersLeft:E.workersLeft})),turnOrder:Tr.turnOrder,currentPlayer:Tr.currentPlayer}),Tr;case"ADD_LOG":return{...t,actionLog:[...t.actionLog.slice(-9),e.message]};case"ADD_NOTIFICATION":return!t.roomCode||!e.notification?t:{...t,notifications:[...t.notifications,{id:Date.now(),...e.notification,timestamp:Date.now()}].slice(-5)};case"CLEAR_NOTIFICATION":return{...t,notifications:t.notifications.filter(E=>E.id!==e.id)};case"RESET_GAME":const b_=w_(4);return{...yl,players:yl.players.map((E,D)=>({...E,emoji:e.preserveEmojis&&t.players[D]?t.players[D].emoji:b_[D]}))};case"SHOW_MODAL":const T_=((r=e.modal)==null?void 0:r.targetPlayerId)&&e.modal.targetPlayerId!==t.myPlayerId&&t.myPlayerId===t.currentPlayer;return{...t,modal:e.modal,waitingForPlayer:T_?e.modal.targetPlayerId:null};case"HIDE_MODAL":return{...t,modal:null,waitingForPlayer:null};case"UNDO_LAST_WORKER":const ef={...t.occupiedSpaces};return delete ef[e.actionId],{...t,occupiedSpaces:ef,players:t.players.map(E=>E.id===e.playerId?{...E,workersLeft:E.workersLeft+1}:E),workerPlacedThisTurn:!1,workersToPlace:Math.min(t.workersToPlace+1,1)};case"UPDATE_OCCUPIED_SPACES":return{...t,occupiedSpaces:e.occupiedSpaces};case"SET_TURN_ORDER":return{...t,turnOrder:e.turnOrder};case"CLOSE_SHOP":return console.log("CLOSE_SHOP action:",e.shopId),{...t,closedShops:{...t.closedShops,[e.shopId]:!0}};case"OPEN_SHOP":console.log("OPEN_SHOP action:",e.shopId);const tf={...t.closedShops};return delete tf[e.shopId],{...t,closedShops:tf};case"FLIP_ALL_SHOPS":const Qo={},A_=t.gameLayers?Object.keys(t.gameLayers):["red","yellow","blue","purple"],D_=[1,2,3];return A_.forEach(E=>{D_.forEach(M=>{const N=`${E}${M}`;Qo[N]=!t.closedShops[N]});const D=`${E}vp`;Qo[D]=!t.closedShops[D]}),t.roomCode&&e.playerId&&e.playerId!==t.myPlayerId?{...t,closedShops:Qo,notifications:[...t.notifications,{id:Date.now(),type:"shop_toggle",icon:"",title:"All Shops Toggled!",message:`${e.playerName||`Player ${e.playerId}`} flipped all shop statuses`,timestamp:Date.now()}].slice(-5)}:{...t,closedShops:Qo};case"ADD_SHOP_COST_MODIFIER":return{...t,players:t.players.map(E=>E.id===e.playerId?{...E,shopCostModifier:(E.shopCostModifier||0)+e.modifier}:E)};case"USE_SHOP":return{...t,shopUsedAfterWorkers:!0};case"SET_ROOM_INFO":return{...t,roomCode:e.roomCode,isHost:e.isHost};case"SET_MY_PLAYER_INFO":return{...t,myPlayerId:e.playerId,myPlayerName:e.playerName};case"UPDATE_CONNECTED_PLAYERS":return{...t,connectedPlayers:e.connectedPlayers};case"START_GAME":const oa={};(t.gameLayers?Object.keys(t.gameLayers):["red","yellow","blue","purple"]).forEach(E=>{oa[`${E}2`]=!0,oa[`${E}3`]=!0});let nf=t.players;t.gameLayers&&t.gameLayers.white&&(nf=t.players.map(E=>({...E,victoryPoints:E.victoryPoints+5,vpSources:{...E.vpSources,whiteStarting:5}})));const er=[...t.turnOrder];for(let E=er.length-1;E>0;E--){const D=Math.floor(Math.random()*(E+1));[er[E],er[D]]=[er[D],er[E]]}return{...t,gameStarted:!0,closedShops:oa,players:nf,turnOrder:er,currentPlayer:er[0]};case"SET_GAME_LAYERS":const rf={};return e.layers.blue&&(rf.blue=!0),{...t,gameLayers:e.layers,automaticVPs:rf};case"SET_GAME_MODE":return{...t,gameMode:e.mode};case"UPDATE_CONNECTION_STATUS":return{...t,connectionStatus:e.status};case"SET_SKIPPED_TURNS":return{...t,skippedTurns:e.skippedTurns};case"SET_WAITING_FOR_OTHERS":return{...t,waitingForOthers:e.waitingForOthers};case"REMOVE_WORKER":const sf={...t.occupiedSpaces};return delete sf[e.actionId],{...t,occupiedSpaces:sf,players:t.players.map(E=>E.id===e.playerId?{...E,workersLeft:E.workersLeft+1}:E)};case"CLEAR_SYNC_FLAG":return{...t,justSyncedFromFirebase:!1};case"SYNC_GAME_STATE":if(console.log("SYNC_GAME_STATE reducer called with:",{round:e.gameState.round,currentPlayer:e.gameState.currentPlayer,myPlayerId:t.myPlayerId,gameStarted:e.gameState.gameStarted,gameLayers:e.gameState.gameLayers?Object.keys(e.gameState.gameLayers):null,occupiedSpaces:e.gameState.occupiedSpaces,closedShops:e.gameState.closedShops,players:(s=e.gameState.players)==null?void 0:s.map(E=>({id:E.id,resources:E.resources,workersLeft:E.workersLeft}))}),e.gameState.players&&(console.log("SYNC_GAME_STATE - Player 1 resources from Firebase:",(o=e.gameState.players.find(E=>E.id===1))==null?void 0:o.resources),console.log("SYNC_GAME_STATE - All players from Firebase:",e.gameState.players)),console.log("SYNC_GAME_STATE - Echo detection:",{lastUpdatedBy:e.gameState.lastUpdatedBy,myPlayerId:t.myPlayerId,isOurUpdate:e.gameState.lastUpdatedBy===t.myPlayerId}),e.gameState.lastUpdatedBy&&t.myPlayerId&&e.gameState.lastUpdatedBy===t.myPlayerId)return console.log("SYNC_GAME_STATE - Ignoring our own update echo"),t;const Ss={...t,...e.gameState,syncingFromFirebase:!0,occupiedSpaces:e.gameState.occupiedSpaces||{},players:e.gameState.players?e.gameState.players.map(E=>({...E,effects:E.effects||[],emoji:E.emoji||Fs[E.id-1]||"",resources:E.resources||{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},vpSources:E.vpSources||{},shopCostModifier:E.shopCostModifier!==void 0?E.shopCostModifier:0})):t.players,roomCode:t.roomCode,myPlayerId:t.myPlayerId,myPlayerName:t.myPlayerName,connectedPlayers:t.connectedPlayers,isHost:t.isHost,gameStarted:e.gameState.gameStarted!==void 0?e.gameState.gameStarted:t.gameStarted,connectionStatus:t.connectionStatus,gameLayers:e.gameState.gameLayers||t.gameLayers,closedShops:e.gameState.closedShops||t.closedShops,automaticVPs:e.gameState.automaticVPs||t.automaticVPs,pendingPlacements:e.gameState.pendingPlacements||{},lastSyncTimestamp:e.gameState.timestamp||Date.now(),justSyncedFromFirebase:!0};return console.log("SYNC_GAME_STATE - After merge, new state:",{round:Ss.round,gameOver:Ss.gameOver,occupiedSpaces:Ss.occupiedSpaces,players:(i=Ss.players)==null?void 0:i.map(E=>({id:E.id,resources:E.resources,workersLeft:E.workersLeft}))}),Ss;case"SET_PENDING_PLACEMENT":return{...t,pendingPlacements:{...t.pendingPlacements,[e.actionId]:e.playerId}};case"CLEAR_PENDING_PLACEMENT":const of={...t.pendingPlacements};return delete of[e.actionId],{...t,pendingPlacements:of};default:return t}})();return n!==t&&console.log("Reducer returning new state for action:",e.type),n}const nk={apiKey:"AIzaSyB0c0iUOG3llUzLd9FhQ6Qc1qCB0DoajVw",authDomain:"cornycolonies.firebaseapp.com",databaseURL:"https://cornycolonies-default-rtdb.firebaseio.com",projectId:"cornycolonies",storageBucket:"cornycolonies.firebasestorage.app",messagingSenderId:"566795956627",appId:"1:566795956627:web:585b66a3277696f3b0b866"};let Be=null;try{typeof firebase<"u"&&(firebase.initializeApp(nk),Be=firebase.database())}catch{console.log("Firebase not available, using local mode")}const S_=qe.createContext();function rk({children:t}){const[e,n]=qe.useReducer(tk,yl);return(window.location.search.includes("test=true")||window.location.search.includes("debug=true"))&&(window.lastKnownState=e,window.lastKnownDispatch=n),_.createElement(S_.Provider,{value:{state:e,dispatch:n}},t)}function Ve(){const t=qe.useContext(S_);if(!t)throw new Error("useGame must be used within a GameProvider");return t}function sk(){return Math.random().toString(36).substring(2,8).toUpperCase()}function ok(t,e){const n=sk(),r=1;if(Be){t({type:"UPDATE_CONNECTION_STATUS",status:"connecting"});const s=Be.ref(`rooms/${n}`),o=setTimeout(()=>{console.error("Room creation timeout"),alert("Failed to create room - connection timeout. Please try local mode or set up Firebase."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})},5e3);s.set({host:r,gameState:{...yl,gameStarted:!1},players:{[r]:{id:r,name:e,connected:!0,joinedAt:Date.now()}}}).then(()=>{clearTimeout(o),t({type:"SET_ROOM_INFO",roomCode:n,isHost:!0}),t({type:"SET_MY_PLAYER_INFO",playerId:r,playerName:e}),t({type:"UPDATE_CONNECTION_STATUS",status:"connected"}),C_(n,t,r)}).catch(i=>{clearTimeout(o),console.error("Error creating room:",i),alert("Failed to create room. Firebase is not properly configured. Please use local mode for now."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})})}else alert("Multiplayer requires Firebase setup. Please use local mode for now."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})}function ik(t,e,n){if(Be){t({type:"UPDATE_CONNECTION_STATUS",status:"connecting"});const r=setTimeout(()=>{console.error("Room join timeout"),alert("Failed to join room - connection timeout. Please try local mode or check the room code."),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})},5e3),s=Be.ref(`rooms/${e}`);s.once("value").then(o=>{if(clearTimeout(r),o.exists()){const i=o.val(),l=i.players||{};let u=null;for(let a=1;a<=4;a++)if(!l[a]||!l[a].connected){u=a;break}u?s.child(`players/${u}`).set({id:u,name:n,connected:!0,joinedAt:Date.now()}).then(()=>{t({type:"SET_ROOM_INFO",roomCode:e,isHost:!1}),t({type:"SET_MY_PLAYER_INFO",playerId:u,playerName:n}),t({type:"UPDATE_CONNECTION_STATUS",status:"connected"}),i.gameState&&t({type:"SYNC_GAME_STATE",gameState:i.gameState}),C_(e,t,u)}):(alert("Room is full (4 players max)"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"}))}else alert("Room not found"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})}).catch(o=>{console.error("Error joining room:",o),alert("Failed to join room"),t({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"})})}else alert("Firebase not available. Using local mode.")}let Ti=null,xr=0;function P_(t,e,n){if(xr>=gp){console.error("Max reconnection attempts reached"),e({type:"UPDATE_CONNECTION_STATUS",status:"disconnected"}),alert("Connection lost. Please refresh the page to rejoin.");return}xr++;const r=ek*Math.pow(2,xr-1);console.log(`Attempting to reconnect (attempt ${xr}/${gp}) in ${r}ms...`),Ti=setTimeout(()=>{Be.ref(`rooms/${t}/players/${n}/connected`).set(!0).then(()=>{console.log("Reconnection successful"),xr=0,e({type:"UPDATE_CONNECTION_STATUS",status:"connected"})}).catch(s=>{console.error("Reconnection failed:",s),P_(t,e,n)})},r)}function C_(t,e,n){if(!Be)return;const r=Be.ref(`rooms/${t}`);r.child("players").on("value",i=>{const l=i.val()||{};e({type:"UPDATE_CONNECTED_PLAYERS",connectedPlayers:l});const u=Object.values(l).filter(f=>f.connected);!u.find(f=>f.id===1)&&u.length>0&&u.reduce((c,d)=>d.id<c.id?d:c).id===n&&(e({type:"SET_ROOM_INFO",roomCode:t,isHost:!0}),console.log(`Player ${n} is now the host`))});let s=0;r.child("gameState").on("value",i=>{var u;const l=i.val();if(l){if(l.timestamp&&l.timestamp<=s){console.log("Skipping older gameState update:",l.timestamp,"<=",s);return}console.log("Firebase gameState update received:",{round:l.round,currentPlayer:l.currentPlayer,gameOver:l.gameOver,lastUpdatedBy:l.lastUpdatedBy,timestamp:l.timestamp,occupiedSpaces:l.occupiedSpaces,players:(u=l.players)==null?void 0:u.map(a=>({id:a.id,resources:a.resources,workersLeft:a.workersLeft}))}),s=l.timestamp||Date.now(),e({type:"SYNC_GAME_STATE",gameState:l})}}),r.child(`players/${n}/connected`).onDisconnect().set(!1),Be.ref(".info/connected").on("value",i=>{i.val()===!0?(console.log("Firebase connection established"),Ti&&(clearTimeout(Ti),Ti=null),xr=0,e({type:"UPDATE_CONNECTION_STATUS",status:"connected"})):(console.log("Firebase connection lost"),e({type:"UPDATE_CONNECTION_STATUS",status:"reconnecting"}),P_(t,e,n))})}let pi=!1;function lk(t,e){var n,r;if(Be&&t&&!pi){pi=!0,console.log("syncGameState - Syncing to Firebase:",{roomCode:t,round:e.round,currentPlayer:e.currentPlayer,gameOver:e.gameOver,lastUpdatedBy:e.lastUpdatedBy,occupiedSpaces:e.occupiedSpaces,players:(n=e.players)==null?void 0:n.map(i=>({id:i.id,resources:i.resources,workersLeft:i.workersLeft}))});const s=(r=e.players)==null?void 0:r.find(i=>i.id===1);s&&console.log("syncGameState - Player 1 resources being sent:",s.resources);const o={...e,lastUpdatedBy:e.lastUpdatedBy||null,timestamp:e.timestamp||Date.now(),gameLayers:e.gameLayers||null};Be.ref(`rooms/${t}/gameState`).set(o).then(()=>{pi=!1}).catch(i=>{console.error("Failed to sync game state:",i),console.error("Problematic game state:",e),pi=!1})}}function _p(t,e=null,n="basic"){Be&&t&&Be.ref(`rooms/${t}/players`).once("value",r=>{const s=r.val()||{};Object.keys(s).length;const o=[];Object.values(s).forEach((a,f)=>{o.push({id:a.id,name:a.name,resources:{red:0,yellow:0,blue:0,purple:0,gold:0,white:0,black:0,silver:0},workersLeft:4,effects:[],victoryPoints:0})});let i={};e&&e.blue&&(i.blue=!0);let l=o;e&&e.white&&(l=o.map(a=>({...a,victoryPoints:a.victoryPoints+5})));const u={currentPlayer:1,turnDirection:1,players:l,occupiedSpaces:{},round:1,turnOrder:o.map(a=>a.id),workerPlacedThisTurn:!1,workersToPlace:1,actionLog:[],gameStarted:!0,gameLayers:e,gameMode:n,automaticVPs:i,closedShops:{},shopUsedAfterWorkers:!1,playersOutOfWorkers:[],skippedTurns:{},waitingForOthers:{},roundActions:[],gameOver:!1,timestamp:Date.now(),lastUpdatedBy:"host-start"};console.log("Starting multiplayer game with state:",{players:u.players.length,gameLayers:e?Object.keys(e):"null",gameMode:n,automaticVPs:i}),Be.ref(`rooms/${t}/gameState`).set(u).then(()=>{console.log("Game state successfully written to Firebase"),Be.ref(`rooms/${t}/lastUpdate`).set(Date.now())}).catch(a=>{console.error("Failed to write game state to Firebase:",a)})})}function ak(){const{state:t,dispatch:e}=Ve(),[n,r]=qe.useState(""),[s,o]=qe.useState(""),[i,l]=qe.useState("menu"),[u,a]=qe.useState(null),f=()=>{if(!n.trim()){alert("Please enter your name");return}ok(e,n.trim())},c=()=>{if(!n.trim()){alert("Please enter your name");return}if(!s.trim()){alert("Please enter room code");return}ik(e,s.trim().toUpperCase(),n.trim())},d=()=>{l("gameMode")},h=m=>{const v=gl(4,m);e({type:"SET_GAME_MODE",mode:m}),e({type:"SET_GAME_LAYERS",layers:v}),e({type:"START_GAME"})};return _.createElement("div",{className:"min-h-screen flex items-center justify-center p-4"},_.createElement("div",{className:"glass rounded-xl shadow-2xl p-8 max-w-md w-full"},[_.createElement("div",{key:"header",className:"text-center mb-8"},[_.createElement("h1",{key:"title",className:"text-3xl font-bold text-gray-800 mb-2"},"Patrons"),_.createElement("p",{key:"subtitle",className:"text-gray-600"},"Choose your game mode")]),i==="menu"&&_.createElement("div",{key:"menu",className:"space-y-4"},[_.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:m=>r(m.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),_.createElement("button",{key:"create",onClick:()=>l("create"),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Create Online Game"),_.createElement("button",{key:"join",onClick:()=>l("join"),className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Join Online Game"),_.createElement("button",{key:"local",onClick:d,className:"w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Play Local (Same Device)")]),i==="create"&&_.createElement("div",{key:"create",className:"space-y-4"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Create Room"),_.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:m=>r(m.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),_.createElement("button",{key:"create",onClick:f,disabled:t.connectionStatus==="connecting",className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 disabled:transform-none"},t.connectionStatus==="connecting"?"Creating...":"Create Room"),_.createElement("button",{key:"back",onClick:()=>l("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")]),i==="join"&&_.createElement("div",{key:"join",className:"space-y-4"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Join Room"),_.createElement("input",{key:"name",type:"text",placeholder:"Enter your name",value:n,onChange:m=>r(m.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),_.createElement("input",{key:"code",type:"text",placeholder:"Enter room code",value:s,onChange:m=>o(m.target.value.toUpperCase()),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"}),_.createElement("button",{key:"join",onClick:c,disabled:t.connectionStatus==="connecting",className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 disabled:transform-none"},t.connectionStatus==="connecting"?"Joining...":"Join Room"),_.createElement("button",{key:"back",onClick:()=>l("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")]),i==="gameMode"&&_.createElement("div",{key:"gameMode",className:"space-y-4"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-center mb-4"},"Select Game Mode"),_.createElement("div",{key:"description",className:"text-sm text-gray-600 text-center mb-6 space-y-2"},[_.createElement("p",{key:"basic"},"Basic: Play with the classic 4 colors (Red, Yellow, Blue, Purple)"),_.createElement("p",{key:"advanced"},"Advanced: Play with 4 randomly selected colors from all 8 available")]),_.createElement("button",{key:"basic",onClick:()=>h("basic"),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Basic Mode"),_.createElement("button",{key:"advanced",onClick:()=>h("advanced"),className:"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"}," Advanced Mode"),_.createElement("button",{key:"back",onClick:()=>l("menu"),className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Back")])]))}function vp(){const{state:t,dispatch:e}=Ve(),n=Object.keys(t.connectedPlayers).length,[r,s]=qe.useState(!1),[o,i]=qe.useState("basic"),l=()=>{n>=2?s(!0):alert("Need at least 2 players to start")},u=()=>{confirm("Are you sure you want to leave the room?")&&window.location.reload()};return t.gameStarted?null:_.createElement("div",{className:"glass rounded-lg p-4 mb-6"},[_.createElement("div",{key:"header",className:"flex justify-between items-center mb-4"},[_.createElement("div",{key:"info"},[_.createElement("h3",{key:"title",className:"text-lg font-bold text-gray-800"},`Room: ${t.roomCode}`),_.createElement("p",{key:"count",className:"text-sm text-gray-600"},`${n}/4 players connected`)]),_.createElement("button",{key:"leave",onClick:u,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm"},"Leave")]),_.createElement("div",{key:"players",className:"grid grid-cols-2 gap-2 mb-4"},Object.values(t.connectedPlayers).map(a=>_.createElement("div",{key:a.id,className:`p-2 rounded border-2 ${a.connected?"border-green-400 bg-green-50":"border-gray-300 bg-gray-50"} ${a.id===t.myPlayerId?"ring-2 ring-blue-400":""}`},[_.createElement("div",{key:"name",className:"font-semibold"},`Player ${a.id}: ${a.name}`),_.createElement("div",{key:"status",className:`text-xs ${a.connected?"text-green-600":"text-gray-500"}`},a.connected?" Connected":a.id===t.myPlayerId&&t.connectionStatus==="reconnecting"?" Reconnecting...":" Disconnected"),a.id===t.myPlayerId&&_.createElement("div",{key:"you",className:"text-xs text-blue-600 font-bold"},"(You)")]))),t.isHost&&!t.gameStarted&&!r&&_.createElement("button",{key:"start",onClick:l,disabled:n<2,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-all duration-200"},n>=2?"Start Game":"Need 2+ Players to Start"),r&&_.createElement("div",{key:"gameMode",className:"space-y-3 mt-4"},[_.createElement("h4",{key:"title",className:"text-md font-bold text-center"},"Select Game Mode"),_.createElement("div",{key:"buttons",className:"flex gap-2"},[_.createElement("button",{key:"basic",onClick:()=>{console.log("Starting game with",n,"players in basic mode");const a=gl(n,"basic");console.log("Selected layers:",Object.keys(a)),e({type:"SET_GAME_MODE",mode:"basic"}),e({type:"SET_GAME_LAYERS",layers:a}),_p(t.roomCode,a,"basic"),e({type:"START_GAME"}),console.log("Game started successfully")},className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-3 rounded-lg text-sm"},"Basic"),_.createElement("button",{key:"advanced",onClick:()=>{console.log("Starting game with",n,"players in advanced mode");const a=gl(n,"advanced");console.log("Selected layers:",Object.keys(a)),e({type:"SET_GAME_MODE",mode:"advanced"}),e({type:"SET_GAME_LAYERS",layers:a}),_p(t.roomCode,a,"advanced"),e({type:"START_GAME"}),console.log("Game started successfully")},className:"flex-1 bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-3 rounded-lg text-sm"},"Advanced"),_.createElement("button",{key:"cancel",onClick:()=>s(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 rounded-lg text-sm"},"Cancel")])])])}function uk({notifications:t,myPlayerId:e}){const n=t.filter(r=>!r.forPlayer||r.forPlayer===e);return n.length===0?null:_.createElement("div",{className:"fixed top-4 right-4 z-50 space-y-2"},n.slice(-3).map(r=>_.createElement("div",{key:r.id,className:"bg-gray-800 text-white p-4 rounded-lg shadow-lg transform transition-all duration-300 hover:scale-105",style:{minWidth:"300px"}},[_.createElement("div",{key:"header",className:"flex items-center gap-2 mb-1"},[_.createElement("span",{key:"icon",className:"text-2xl"},r.icon||""),_.createElement("span",{key:"title",className:"font-bold"},r.title)]),_.createElement("div",{key:"message",className:"text-sm opacity-90"},r.message),_.createElement("div",{key:"time",className:"text-xs opacity-60 mt-1"},`${Math.floor((Date.now()-r.timestamp)/1e3)}s ago`)])))}function ck({actionId:t,title:e,description:n,round:r,available:s=!0,compact:o=!1}){const{state:i,dispatch:l}=Ve(),u=i.occupiedSpaces[t],a=u?i.players.find(v=>v.id===u):null,f=i.pendingPlacements&&i.pendingPlacements[t],c=async()=>{if(u||!s)return;if(i.roomCode&&i.myPlayerId!==i.currentPlayer){alert("It's not your turn!");return}if(i.roomCode){if(i.pendingPlacements&&i.pendingPlacements[t]){alert("Another player is placing a patron here!");return}l({type:"SET_PENDING_PLACEMENT",actionId:t,playerId:i.myPlayerId})}const v=i.players.find(y=>y.id===i.currentPlayer);if(i.workersToPlace<=0){alert("You have already placed all your patrons this turn. End your turn or buy from shops.");return}if(v.workersLeft<=0&&i.workersToPlace<=1){alert("You have no patrons left to place!");return}if((t==="redHybrid1"||t==="redHybrid2")&&Object.entries(i.occupiedSpaces).filter(([p,g])=>g===i.currentPlayer&&p!==t).length===0){const p=[];if(Object.entries(i.gameLayers||{}).forEach(([g,S])=>{S.actions.forEach(P=>{P.round<=i.round&&!i.occupiedSpaces[P.id]&&p.push(P.id)})}),p.length>1&&!confirm("WARNING: You have no other patrons on the board to swap! This action will only give you the resource bonus. Continue anyway?"))return}if(t==="gain2purpleTakeBack"&&Object.entries(i.occupiedSpaces).filter(([p,g])=>g!==i.currentPlayer?!1:!(i.gameLayers.purple&&i.gameLayers.purple.actions.some(P=>P.id===p))).length===0){const p=[];if(Object.entries(i.gameLayers||{}).forEach(([g,S])=>{S.actions.forEach(P=>{P.round<=i.round&&!i.occupiedSpaces[P.id]&&p.push(P.id)})}),p.length>1&&!confirm("WARNING: You have no patrons on non-purple quads to take back! This action will only give you the purple resources. Continue anyway?"))return}if(t==="playTwoWorkers"&&v.workersLeft<2&&!confirm(`WARNING: You only have ${v.workersLeft} patron(s) left. You won't be able to place 2 patrons. Continue anyway?`)||t==="playThreeWorkers"&&v.workersLeft<3&&!confirm(`WARNING: You only have ${v.workersLeft} patron(s) left. You won't be able to place 3 patrons. Continue anyway?`))return;if(t==="gain4purpleWaitAll"){const y=(v.effects||[]).some(g=>g.includes("Will take an extra turn after this one")),p=(v.extraTurns||0)>0;if((y||p)&&!confirm("WARNING: You already have an extra turn queued! This action will have no additional effect. Continue anyway?"))return}if(t==="spend2AnyFor3VP"){const y=Object.values(v.resources).reduce((p,g)=>p+g,0);if(y<2&&!confirm("WARNING: You need at least 2 resources to use this action. You only have "+y+". Continue anyway?"))return}if(t==="spend1AnyFor2VP"&&Object.values(v.resources).reduce((p,g)=>p+g,0)<1&&!confirm("WARNING: You need at least 1 resource to use this action. You have none. Continue anyway?"))return;const w={actionId:t,playerId:i.currentPlayer};try{l({type:"PLACE_WORKER",actionId:t});const y={...i,occupiedSpaces:{...i.occupiedSpaces,[t]:i.currentPlayer},players:i.players.map(S=>S.id===i.currentPlayer?{...S,workersLeft:S.workersLeft-1}:S),workerPlacedThisTurn:!0,workersToPlace:Math.max(0,i.workersToPlace-1)},p=y.players.find(S=>S.id===i.currentPlayer);await yt(t,p,l,y,i.gameLayers,0,w);const g=`Action completed: ${t} for Player ${v.id}`;l({type:"ADD_LOG",message:g}),console.log(g)}finally{i.roomCode&&l({type:"CLEAR_PENDING_PLACEMENT",actionId:t})}},d=()=>r===1?"bg-gray-100 border-gray-300":r===2?"bg-green-100 border-green-500":r===3?"bg-yellow-100 border-yellow-500":"bg-gray-100 border-gray-300",h=()=>s?u?"bg-red-50 border-red-500 cursor-not-allowed":f?"bg-yellow-50 border-yellow-500 cursor-wait animate-pulse":"hover:bg-blue-50 hover:border-blue-500 hover:shadow-md cursor-pointer transition-all duration-150 border-blue-300":"opacity-60 cursor-not-allowed bg-gray-200 border-gray-400",m=()=>{const v="absolute top-0.5 left-0.5 px-1.5 py-0.5 rounded-full text-xs font-bold text-white shadow";switch(r){case 1:return`${v} bg-gray-500`;case 2:return`${v} bg-green-500`;case 3:return`${v} bg-yellow-600`;default:return`${v} bg-gray-500`}};return _.createElement("div",{className:`relative border-2 rounded-lg flex flex-col p-1.5 min-h-[60px] transition-all duration-150 shadow-sm ${d()} ${h()}`,onClick:c},[_.createElement("div",{key:"round-indicator",className:m()},`R${r}`),a&&_.createElement("div",{key:"worker",className:"absolute top-0.5 right-0.5 text-xl drop-shadow-lg"},a.emoji||a.id),_.createElement("div",{key:"title",className:`font-bold text-xs mb-0.5 px-5 text-center ${s?"text-gray-900":"text-gray-500"}`},e),_.createElement("div",{key:"desc",className:`text-xs text-center px-1 ${s?"text-gray-600":"text-gray-400"} leading-tight`},n)])}function Ep(t,e){const n=e==null?void 0:e.red;return n?n.actions.some(r=>r.id===t):!1}async function yt(t,e,n,r,s,o=0,i=null){var u;if(o>5){n({type:"ADD_LOG",message:" Max recursion depth reached - stopping to prevent infinite loop"});return}o>0&&n({type:"ADD_LOG",message:` Action chain depth: ${o}`});const l={gain3red:{red:3},gain2red:{red:2},gain3blue:{blue:3},gain2blue:{blue:2},gain3purple:{purple:3},gain2purple:{purple:2},gain2gold:{gold:2},gain1gold:{gold:1},gain3white:{white:3},gain2white:{white:2},gain3black:{black:3},gain2black:{black:2},gain3silver:{silver:3},gain2silver:{silver:2}};if(l[t]){let a={...l[t]};if((e.effects||[]).some(c=>c.includes("Next gain will be doubled"))){Object.keys(a).forEach(d=>{a[d]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))});const c=`Player ${e.id}: ${t}  +${Object.entries(a).map(([d,h])=>`${h} ${d}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:c})}else{const c=`Player ${e.id}: ${t}  +${Object.entries(a).map(([d,h])=>`${h} ${d}`).join(", ")}`;n({type:"ADD_LOG",message:c})}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:a}),t.includes("red")&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`}));return}if(t==="gain3yellow"){const a=(i==null?void 0:i.playerId)||e.id,f=r.players.find(y=>y.id===a),c=i&&i.placedBy&&i.placedBy!==a,h=await ge(n,c?"Your patron was placed! Select 3 Resources ( Colors):":"Select 3 Resources ( Colors)",3,null,i,c?a:null);if(console.log("gain3yellow - selectedGems:",h),!h){n({type:"UPDATE_RESOURCES",playerId:a,resources:{red:1,yellow:1,blue:1}});const p=`Player ${a}: gain3yellow  +1 red, +1 yellow, +1 blue (default)`;n({type:"ADD_LOG",message:p});return}const m=h;console.log("gain3yellow - resources object before processing:",m),console.log("gain3yellow - actualPlayerId:",a),console.log("gain3yellow - actualPlayer:",f);const v={};if(Object.entries(m).forEach(([y,p])=>{p>0&&(v[y]=p)}),console.log("gain3yellow - filteredResources (zeros removed):",v),(f.effects||[]).some(y=>y.includes("Next gain will be doubled"))){Object.keys(v).forEach(p=>{v[p]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:a,effects:(f.effects||[]).filter(p=>!p.includes("Next gain will be doubled"))});const y=`Player ${a}: ${t}  +${Object.entries(v).map(([p,g])=>`${g} ${p}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:y})}else{const y=`Player ${a}: ${t}  +${Object.entries(v).map(([p,g])=>`${g} ${p}`).join(", ")}`;n({type:"ADD_LOG",message:y})}console.log("gain3yellow - About to dispatch UPDATE_RESOURCES with:",{type:"UPDATE_RESOURCES",playerId:a,resources:v});try{n({type:"UPDATE_RESOURCES",playerId:a,resources:v}),console.log("gain3yellow - UPDATE_RESOURCES dispatched successfully")}catch(y){console.error("gain3yellow - Error dispatching UPDATE_RESOURCES:",y)}return}if(t==="gain2yellow"){console.log("gain2yellow - Starting for player",e.id,"workerInfo:",i);const a=(i==null?void 0:i.playerId)||e.id,f=r.players.find(w=>w.id===a);console.log("gain2yellow - actualPlayerId:",a,"actualPlayer:",f);const c=i&&i.placedBy&&i.placedBy!==a,h=await ge(n,c?"Your patron was placed! Select 2 Resources ( Colors):":"Select 2 Resources ( Colors)",2,null,i,c?a:null);if(console.log("gain2yellow - selectedGems:",h),!h){const w={red:1,yellow:1};console.log("gain2yellow - Using default resources:",w),n({type:"UPDATE_RESOURCES",playerId:a,resources:w});const y=`Player ${a}: gain2yellow  +1 red, +1 yellow (default)`;n({type:"ADD_LOG",message:y});return}const m=h;if(console.log("gain2yellow - resources object:",m),(f.effects||[]).some(w=>w.includes("Next gain will be doubled"))){Object.keys(m).forEach(y=>{m[y]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:a,effects:(f.effects||[]).filter(y=>!y.includes("Next gain will be doubled"))});const w=`Player ${a}: ${t}  +${Object.entries(m).map(([y,p])=>`${p} ${y}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:w})}else{const w=`Player ${a}: ${t}  +${Object.entries(m).map(([y,p])=>`${p} ${y}`).join(", ")}`;n({type:"ADD_LOG",message:w})}console.log("gain2yellow - About to dispatch UPDATE_RESOURCES with:",{playerId:a,resources:m}),n({type:"UPDATE_RESOURCES",playerId:a,resources:m});return}if(t==="playTwoWorkers"){const a=e.workersLeft,f=Math.min(2,a);if(f===0){const d=`Player ${e.id}: playTwoWorkers  No patrons left to place`;n({type:"ADD_LOG",message:d});return}n({type:"ADD_WORKERS_TO_PLACE",count:f}),n({type:"ADD_EFFECT",playerId:e.id,effect:`Can place ${f} more patron${f>1?"s":""} this turn`});const c=`Player ${e.id}: playTwoWorkers  Can now place ${f} MORE patron${f>1?"s":""} this turn`;n({type:"ADD_LOG",message:c}),console.log(c);return}if(t==="gain4purpleSkip"){const a=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let f=4;a&&(f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:f}});const c={...r.skippedTurns};c[e.id]=(c[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:c});const d=`Player ${e.id}: gain4purpleSkip  +${f} purple${a?" (DOUBLED!)":""}, will skip next turn (total skips: ${c[e.id]})`;n({type:"ADD_LOG",message:d});return}if(t==="gain2purpleTakeBack"){const a=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let f=2;a&&(f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:f}});const c=Object.entries(r.occupiedSpaces||{}).filter(([h,m])=>m!==e.id?!1:!(s.purple&&s.purple.actions.some(w=>w.id===h)));if(c.length>0){const h={};c.forEach(([v,w])=>{const y=Object.keys(s).find(p=>s[p].actions.some(g=>g.id===v));y&&(h[y]||(h[y]=[]),h[y].push(v))});const m=[];if(Object.entries(h).forEach(([v,w])=>{w.forEach(y=>{const p=s[v].actions.find(g=>g.id===y);p&&m.push({label:`${v} - ${p.title}`,value:y})})}),m.length>0){const v=await ye(n,"Choose a patron to take back",m);v&&(n({type:"REMOVE_WORKER",actionId:v,playerId:e.id}),n({type:"ADD_LOG",message:`Player ${e.id}: Took back patron from ${v}`}))}}const d=`Player ${e.id}: gain2purpleTakeBack  +${f} purple${a?" (DOUBLED!)":""} + take back patron`;n({type:"ADD_LOG",message:d});return}if(t==="gain5purpleSkip"){const a=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let f=5;a&&(f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:f}});const c={...r.skippedTurns};c[e.id]=(c[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:c});const d=`Player ${e.id}: gain5purpleSkip  +${f} purple${a?" (DOUBLED!)":""}, will skip next turn (total skips: ${c[e.id]})`;n({type:"ADD_LOG",message:d});return}if(t==="playThreeWorkers"){const a=e.workersLeft,f=Math.min(3,a);if(f===0){const d=`Player ${e.id}: playThreeWorkers  No patrons left to place`;n({type:"ADD_LOG",message:d});return}n({type:"ADD_WORKERS_TO_PLACE",count:f}),n({type:"ADD_EFFECT",playerId:e.id,effect:`Can place ${f} more patron${f>1?"s":""} this turn`});const c=`Player ${e.id}: playThreeWorkers  Can now place ${f} MORE patron${f>1?"s":""} this turn`;n({type:"ADD_LOG",message:c});return}if(t==="gain4purpleWaitAll"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:4}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Will take an extra turn after this one"}),n({type:"UPDATE_PLAYER",playerId:e.id,updates:{extraTurns:(e.extraTurns||0)+1}});const a=`Player ${e.id}: gain4purpleWaitAll  +4 purple + extra turn after this one`;n({type:"ADD_LOG",message:a});return}if(t==="extraWorkers"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Will get 2 extra patrons next round"}),console.log(`Player ${e.id} will get 2 extra workers next round`);return}if(t==="purpleShopHybrid"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}});const f=await ye(n,"Choose  Round 1 shop benefit",[{label:" R1: Repeat patron action",value:"red1"},{label:" R1: Double next gain",value:"yellow1"},{label:" R1: Close  shop this round",value:"blue1"},{label:" R1: Take an extra turn after this one",value:"purple1"}]);if(f){switch(f){case"red1":await k_(e,n,r,s);break;case"yellow1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Next gain will be doubled"});break;case"blue1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Can close  shop this round"});break;case"purple1":n({type:"ADD_EFFECT",playerId:e.id,effect:"Will take an extra turn after this one"}),n({type:"UPDATE_PLAYER",playerId:e.id,updates:{extraTurns:(e.extraTurns||0)+1}});break}const c={red1:"Repeat patron action",yellow1:"Double next gain",blue1:"Close shop ability",purple1:"Extra turn"},d=`Player ${e.id}: purpleShopHybrid  +1 purple + ${c[f]}`;n({type:"ADD_LOG",message:d})}return}if(t==="purpleHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{purple:1}});const f=await ye(n,"Choose new turn order for next round",[{label:"1  2  3  4",value:[1,2,3,4]},{label:"4  3  2  1",value:[4,3,2,1]},{label:"2  1  4  3",value:[2,1,4,3]},{label:"3  4  1  2",value:[3,4,1,2]}]);if(f){n({type:"SET_TURN_ORDER",turnOrder:f});const c=`Player ${e.id}: purpleHybrid2  +1 purple + set turn order to ${f.join("  ")}`;n({type:"ADD_LOG",message:c})}return}if(t==="redRepeatAction"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const a=`DEBUG: Occupied spaces: ${JSON.stringify(r.occupiedSpaces)}`;n({type:"ADD_LOG",message:a});const f=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"],c=Object.entries(r.occupiedSpaces).filter(([v,w])=>w===e.id&&!f.includes(v)).map(([v])=>v),d=`DEBUG: Player spaces to repeat: ${c.join(", ")}`;if(n({type:"ADD_LOG",message:d}),c.length===0){const v=`Player ${e.id}: redRepeatAction  +1 red (no valid patrons to repeat - swap/repeat actions excluded)`;n({type:"ADD_LOG",message:v});return}const h=c.map(v=>{let w=v;for(const y of Object.values(s)){const p=y.actions.find(g=>g.id===v);if(p){w=p.title;break}}return{label:`Repeat: ${w}`,value:v}}),m=await ye(n,"Choose an action to repeat",h);if(m){let v=m;for(const y of Object.values(s)){const p=y.actions.find(g=>g.id===m);if(p){v=p.title;break}}const w=`Player ${e.id}: redRepeatAction  +1 red + repeating ${v}`;n({type:"ADD_LOG",message:w}),await yt(m,e,n,r,s,o+1,i),Ep(m,s)&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for repeating red action`}))}return}if(t==="redHybrid1"||t==="redHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const a=Object.entries(r.occupiedSpaces);if(a.length<2){const g=`Player ${e.id}: ${t}  +1 red (not enough patrons to swap)`;n({type:"ADD_LOG",message:g});return}const f=a.filter(([g,S])=>S===e.id&&g!==t&&g!=="redHybrid1"&&g!=="redHybrid2"),c=a.filter(([g,S])=>S!==e.id&&g!==t&&g!=="redHybrid1"&&g!=="redHybrid2");if(f.length===0||c.length===0){const g=`Player ${e.id}: ${t}  +1 red (need valid patrons from both players - swap actions excluded)`;n({type:"ADD_LOG",message:g});return}const d=f.map(([g,S])=>{let P=g;for(const[b,A]of Object.entries(s)){const T=A.actions.find(j=>j.id===g);if(T){P=`${b} - ${T.title}`;break}}return{label:`Your patron on: ${P}`,value:{spaceId:g,playerId:S}}}),h=await ye(n,"Choose your patron to swap",d,!1,i);if(!h)return;const m=c.map(([g,S])=>{let P=g;for(const[T,j]of Object.entries(s)){const R=j.actions.find(he=>he.id===g);if(R){P=`${T} - ${R.title}`;break}}const b=r.players.find(T=>T.id===S);return{label:`${b?`${b.name} ${b.emoji||""}`:`Player ${S}`}'s patron on: ${P}`,value:{spaceId:g,playerId:S}}}),v=await ye(n,"Choose another player's worker to swap with",m,!1,i);if(!v)return;const w={...r.occupiedSpaces};w[h.spaceId]=v.playerId,w[v.spaceId]=h.playerId,n({type:"UPDATE_OCCUPIED_SPACES",occupiedSpaces:w}),v.playerId,n({type:"ADD_LOG",message:"Workers swapped between actions"});const y=["playTwoWorkers","playThreeWorkers"];t==="redHybrid1"?r.roomCode?(n({type:"ADD_LOG",message:"In multiplayer, only current player gets the swap benefit"}),y.includes(v.spaceId)?n({type:"ADD_LOG",message:`Player ${e.id}: Cannot execute ${v.spaceId} from swap (would interfere with swap)`}):await yt(v.spaceId,e,n,r,s,o+1)):(y.includes(h.spaceId)||await yt(h.spaceId,r.players.find(g=>g.id===v.playerId),n,r,s,o+1),y.includes(v.spaceId)||await yt(v.spaceId,r.players.find(g=>g.id===h.playerId),n,r,s,o+1)):y.includes(v.spaceId)?n({type:"ADD_LOG",message:`Player ${e.id}: Cannot execute ${v.spaceId} from swap (would interfere with swap)`}):await yt(v.spaceId,e,n,r,s,o+1);const p=`Player ${e.id}: ${t}  +1 red + swapped patrons`;n({type:"ADD_LOG",message:p});return}if(t==="redVPFocus"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{red:1}});const a=(u=r.gameLayers)==null?void 0:u.red,f=a?a.actions.map(m=>m.id):[],c=Object.entries(r.occupiedSpaces).filter(([m,v])=>v===e.id&&f.includes(m)).length,d=1+c;n({type:"UPDATE_VP",playerId:e.id,vp:d,source:"redAction"});const h=`Player ${e.id}: redVPFocus  +1, +${d} VP (${c} red patrons)`;n({type:"ADD_LOG",message:h});return}if(t==="redRepeatAll"){n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAction"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for red action`});const a=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","playTwoWorkers","playThreeWorkers","gain4purpleWaitAll","gain2purpleTakeBack","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"];console.log("redRepeatAll - All occupied spaces:",r.occupiedSpaces),console.log("redRepeatAll - Current player:",e.id);const f=Object.entries(r.occupiedSpaces).filter(([d,h])=>{const m=h===e.id,v=a.includes(d),w=d===t;return console.log(`Checking ${d}: player=${h}, isPlayerSpace=${m}, isExcluded=${v}, isCurrentAction=${w}`),m&&!v&&!w}).map(([d])=>d);if(f.length===0){const d=`Player ${e.id}: redRepeatAll  No other patrons to repeat`;n({type:"ADD_LOG",message:d});return}n({type:"ADD_LOG",message:`Player ${e.id}: redRepeatAll  Will repeat ${f.length} actions`});const c=[...f];for(;c.length>0;){const d=c.map(v=>{let w=v;for(const[y,p]of Object.entries(s)){const g=p.actions.find(S=>S.id===v);if(g){w=`${y} - ${g.title}`;break}}return{label:w,value:v}}),h=await ye(n,`Choose next action to repeat (${c.length} remaining)`,d,!1,i);if(!h){n({type:"ADD_LOG",message:`Player ${e.id}: Stopped repeating actions`});break}await yt(h,e,n,r,s,o+1),Ep(h,s)&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"redAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP for repeating red action`}));const m=c.indexOf(h);m>-1&&c.splice(m,1)}return}if(t==="steal2Gems"){const a=Object.values(e.resources).reduce((h,m)=>h+m,0);if(a===0){const h=`Player ${e.id}: Trade All  for   No resources to trade`;n({type:"ADD_LOG",message:h});return}const f=await ge(n,`Trade all ${a} resources for new ones`,a,null,i);if(!f){const h=`Player ${e.id}: Trade All  for   Cancelled`;n({type:"ADD_LOG",message:h});return}const c={};Object.keys(e.resources).forEach(h=>{e.resources[h]>0&&(c[h]=-e.resources[h])}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});const d=`Player ${e.id}: Trade All  for   Traded ${a} resources`;n({type:"ADD_LOG",message:d});return}if(t==="steal3Gems"){const f=r.players.filter(y=>y.id!==e.id);if(f.length===0){const y=`Player ${e.id}: ${t}  No other players to steal from`;n({type:"ADD_LOG",message:y});return}const c=f.filter(y=>Object.values(y.resources).some(p=>p>0)).map(y=>({label:`Player ${y.id} (${Object.entries(y.resources).filter(([,p])=>p>0).map(([p,g])=>`${g} ${p}`).join(", ")})`,value:y.id}));if(c.length===0){const y=`Player ${e.id}: ${t}  No players have resources to steal`;n({type:"ADD_LOG",message:y});return}const d=await ye(n,"Choose player to steal from",c,!1,i);if(!d){const y=`Player ${e.id}: ${t}  Cancelled`;n({type:"ADD_LOG",message:y});return}const h=f.find(y=>y.id===d),m=await ja(n,`Steal up to 3 resources from Player ${d}`,h,3,i);if(!m){const y=`Player ${e.id}: ${t}  Cancelled`;n({type:"ADD_LOG",message:y});return}const v=[];Object.entries(m).forEach(([y,p])=>{p>0&&(n({type:"UPDATE_RESOURCES",playerId:d,resources:{[y]:-p}}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[y]:p}}),v.push(`${p} ${y}`))});const w=`Player ${e.id}: ${t}  Stole ${v.join(", ")} from Player ${d}`;n({type:"ADD_LOG",message:w});return}if(t==="yellowHybrid1"){const a=await ge(n,"Choose 2 Resources ( Color)",2,null,i);if(!a){const d={yellow:2};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d}),n({type:"ADD_LOG",message:`Player ${e.id}: yellowHybrid1  +2 yellow (default)`});return}const f=a;if((e.effects||[]).some(d=>d.includes("Next gain will be doubled"))){Object.keys(f).forEach(h=>{f[h]*=2}),n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))});const d=`Player ${e.id}: yellowHybrid1  +${Object.entries(f).map(([h,m])=>`${m} ${h}`).join(", ")} (DOUBLED!)`;n({type:"ADD_LOG",message:d})}else{const d=`Player ${e.id}: yellowHybrid1  +${Object.entries(f).map(([h,m])=>`${m} ${h}`).join(", ")}`;n({type:"ADD_LOG",message:d})}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:f});return}if(t==="yellowHybrid2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{yellow:1}}),n({type:"ADD_EFFECT",playerId:e.id,effect:"Next gain will be doubled"});const a=`Player ${e.id}: yellowHybrid2  +1 yellow + next gain doubled`;n({type:"ADD_LOG",message:a});return}if(t==="yellowSwapResources"){const a=r.players.filter(d=>d.id!==e.id);if(a.length===0){const d=`Player ${e.id}: yellowSwapResources  No other players to swap with`;n({type:"ADD_LOG",message:d});return}const f=a.map(d=>({label:`Player ${d.id} (${Object.entries(d.resources).filter(([,h])=>h>0).map(([h,m])=>`${m} ${h}`).join(", ")||"no resources"})`,value:d.id})),c=await ye(n,"Choose player to swap all resources with",f,!1,i);if(c){const d=a.find(w=>w.id===c),h={...e.resources},m={...d.resources};n({type:"SET_RESOURCES",playerId:e.id,resources:m}),n({type:"SET_RESOURCES",playerId:c,resources:h});const v=`Player ${e.id}: yellowSwapResources  Swapped all resources with Player ${c}`;n({type:"ADD_LOG",message:v})}return}if(t==="blueR1ShopBenefit"){console.log("Executing blueR1ShopBenefit for player",e.id);const a=[],f=r.gameLayers?Object.keys(r.gameLayers):["red","yellow","blue","purple"];console.log("Available game layers:",f);const c={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""},d={red:"Red/Yellow",yellow:"Red/Yellow",blue:"Blue/Purple",purple:"Blue/Purple",gold:"Gold/White",white:"Gold/White",black:"Black/Silver",silver:"Black/Silver"};f.forEach(w=>{const y={red:{1:"Repeat one of your patron's actions"},yellow:{1:"Double your next gain action"},blue:{1:"Toggle any shop (open/closed)"},purple:{1:"Take an extra turn after this one"},gold:{1:"1 Gold + 1  = 2 Gold"},white:{1:"Lose 1 VP, Gain 1 "},black:{1:"Steal 1 VP from another player"},silver:{1:"Gain 2 VP"}},p=d[w];a.push({label:`${w} R1: ${y[w][1]}`,shortLabel:`${c[w]} ${y[w][1]}`,value:{color:w,round:1},group:p})});const h=()=>{const w=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","blueR1ShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"];return Object.entries(r.occupiedSpaces).filter(([p,g])=>g===e.id&&!w.includes(p)).length>0},m=a.filter(w=>w.value.color==="red"&&w.value.round===1?h():!0);if(m.length===0){n({type:"ADD_LOG",message:`Player ${e.id}: No valid R1 shop benefits available`});return}const v=await ye(n,"Choose any R1 shop benefit (ignores closed status)",m,!0,i);v?(console.log("Player chose shop:",v.color,"R",v.round),await cc(v.color,v.round,e,n,r,o+1),n({type:"ADD_LOG",message:`Player ${e.id}: Executed ${v.color} R1 shop benefit`}),r.automaticVPs&&r.automaticVPs.blue&&(n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (blue automatic VP for shop use)`}))):(console.log("Player cancelled R1 shop selection"),n({type:"ADD_LOG",message:`Player ${e.id}: Cancelled R1 shop benefit selection`}));return}if(t==="blueAnyShopBenefit"){console.log("Executing blueAnyShopBenefit for player",e.id);const a=[],f=r.gameLayers?Object.keys(r.gameLayers):["red","yellow","blue","purple"];console.log("Available game layers:",f);const c={red:{1:"Repeat one of your patron's actions",2:"Place the next player's patron for them",3:"Pick a player. Repeat all actions where they have a patron"},yellow:{1:"Double your next gain action",2:"Gain 5 ",3:"Gain 7 "},blue:{1:"Close any shop this round",2:"Toggle the status of all shops",3:"Gain any shop benefit"},purple:{1:"Take an extra turn",2:"Place 2 more patrons this turn",3:"Place all your remaining patrons now"},gold:{1:"1 gold + 1 any  2 gold",2:"2 gold + 2 any  4 gold",3:"3 gold + 3 any  2x gold"},white:{1:"Pay 1 VP  Gain 1 any gem",2:"Pay 3 VP  Skip next player",3:"Move one patron to any action"},black:{1:"Steal 1 VP from a player",2:"Steal 3 VP from a player",3:"Steal 5 VP from a player"},silver:{1:"Gain 2 VP",2:"Gain 4 VP, pick player for 4 VP",3:"Gain 7 silver, others get 2"}};f.forEach(h=>{const m=h.charAt(0).toUpperCase()+h.slice(1);a.push({label:`${h} R1: ${c[h][1]}`,shortLabel:`R1: ${c[h][1]}`,value:{color:h,round:1},group:m}),a.push({label:`${h} R2: ${c[h][2]}`,shortLabel:`R2: ${c[h][2]}`,value:{color:h,round:2},group:m}),h==="blue"&&t==="blueAnyShopBenefit"||a.push({label:`${h} R3: ${c[h][3]}`,shortLabel:`R3: ${c[h][3]}`,value:{color:h,round:3},group:m});const v={red:{cost:"5 red",vp:5},yellow:{cost:"5 ",vp:3},blue:{cost:"5 blue",vp:5},purple:{cost:"6 purple",vp:5},white:{cost:"4 white",vp:4},black:{cost:"6 black",vp:"Steal 2 from each"},silver:{cost:"6 silver",vp:8},gold:null};if(v[h]){const w=v[h];a.push({label:`Victory: ${typeof w.vp=="number"?w.vp+" VP":w.vp}`,shortLabel:`Victory: ${typeof w.vp=="number"?w.vp+" VP":w.vp}`,value:{color:h,round:"vp"},group:m})}});const d=await ye(n,"Choose any shop benefit (ignores closed status)",a,!0,i);if(d){if(d.round==="vp")if(d.color==="black")state.players.filter(m=>m.id!==e.id).forEach(m=>{const v=Math.min(2,m.victoryPoints);v>0&&(n({type:"UPDATE_VP",playerId:m.id,vp:-v,source:"blackSteal"}),n({type:"UPDATE_VP",playerId:e.id,vp:v,source:"blackSteal"}))}),n({type:"ADD_LOG",message:`Player ${e.id}: Black Victory shop  Stole 2 VP from each other player`});else{const m={red:5,yellow:3,blue:5,purple:5,white:4,silver:8}[d.color]||3;n({type:"UPDATE_VP",playerId:e.id,vp:m,source:"victoryShop"}),n({type:"ADD_LOG",message:`Player ${e.id}: ${d.color} Victory shop  +${m} VP`})}else console.log("Blue R3: About to execute shop benefit for",d.color,"R"+d.round),await cc(d.color,d.round,e,n,r,o+1),n({type:"ADD_LOG",message:`Player ${e.id}: Executed ${d.color} R${d.round} shop benefit`});n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (used a shop benefit)`})}return}if(t==="blueReduceCosts"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:1}}),n({type:"ADD_SHOP_COST_MODIFIER",playerId:e.id,modifier:-1});const a=`Player ${e.id}: blueReduceCosts  +1 blue + your shop costs reduced by 1 `;n({type:"ADD_LOG",message:a});return}if(t==="blueIncreaseCosts"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:2}}),r.players.forEach(f=>{f.id!==e.id&&n({type:"ADD_SHOP_COST_MODIFIER",playerId:f.id,modifier:2})});const a=`Player ${e.id}: blueIncreaseCosts  +2 blue, all other players' shop costs increased by 2 `;n({type:"ADD_LOG",message:a});return}if(t==="blueToggleShops"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{blue:2}}),n({type:"FLIP_ALL_SHOPS"});const a=`Player ${e.id}: blueToggleShops  +2 blue + all shops toggled`;n({type:"ADD_LOG",message:a});return}if(t==="convert2AnyTo2Gold"){const a=r.players.find(m=>m.id===e.id);if(Object.entries(a.resources).filter(([m,v])=>m!=="gold"&&v>0).reduce((m,[v,w])=>m+w,0)<2){const m=`Player ${e.id}: convert2AnyTo2Gold  Need at least 2 gems`;n({type:"ADD_LOG",message:m});return}const c=await ge(n,"Choose 2 gems to convert to Gold",2,a,i);if(!c){const m=`Player ${e.id}: convert2AnyTo2Gold  Cancelled`;n({type:"ADD_LOG",message:m});return}const d={gold:2};Object.entries(c).forEach(([m,v])=>{d[m]=-v}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const h=`Player ${e.id}: convert2AnyTo2Gold  Converted 2 gems to 2 gold`;n({type:"ADD_LOG",message:h});return}if(t==="convert1AnyTo1Gold"){const a=r.players.find(m=>m.id===e.id);if(Object.entries(a.resources).filter(([m,v])=>m!=="gold"&&v>0).reduce((m,[v,w])=>m+w,0)<1){const m=`Player ${e.id}: convert1AnyTo1Gold  Need at least 1 gem`;n({type:"ADD_LOG",message:m});return}const c=await ge(n,"Choose 1 gem to convert to Gold",1,a,i);if(!c){const m=`Player ${e.id}: convert1AnyTo1Gold  Cancelled`;n({type:"ADD_LOG",message:m});return}const d={gold:1};Object.entries(c).forEach(([m,v])=>{d[m]=-v}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const h=`Player ${e.id}: convert1AnyTo1Gold  Converted 1 gem to 1 gold`;n({type:"ADD_LOG",message:h});return}if(t==="gain3goldSkip"){const a=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));let f=3;a&&(f*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{gold:f}});const c={...r.skippedTurns};c[e.id]=(c[e.id]||0)+1,n({type:"SET_SKIPPED_TURNS",skippedTurns:c});const d=`Player ${e.id}: gain3goldSkip  +${f} gold${a?" (DOUBLED!)":""}, will skip next turn (total skips: ${c[e.id]})`;n({type:"ADD_LOG",message:d});return}if(t==="convert3AnyTo3Gold"){const a=r.players.find(m=>m.id===e.id);if(Object.entries(a.resources).filter(([m,v])=>m!=="gold"&&v>0).reduce((m,[v,w])=>m+w,0)<3){const m=`Player ${e.id}: convert3AnyTo3Gold  Need at least 3 gems`;n({type:"ADD_LOG",message:m});return}const c=await ge(n,"Choose 3 gems to convert to Gold",3,a,i);if(!c){const m=`Player ${e.id}: convert3AnyTo3Gold  Cancelled`;n({type:"ADD_LOG",message:m});return}const d={gold:3};Object.entries(c).forEach(([m,v])=>{d[m]=-v}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d});const h=`Player ${e.id}: convert3AnyTo3Gold  Converted 3 gems to 3 gold`;n({type:"ADD_LOG",message:h});return}if(t==="goldVPPerGold"){const f=r.players.find(c=>c.id===e.id).resources.gold||0;if(f>0){n({type:"UPDATE_VP",playerId:e.id,vp:f,source:"goldVPPerGold"});const c=`Player ${e.id}: goldVPPerGold  +${f} VP (1 per gold)`;n({type:"ADD_LOG",message:c})}else{const c=`Player ${e.id}: goldVPPerGold  No gold, no VP gained`;n({type:"ADD_LOG",message:c})}return}if(t==="gain3vp"){let a=3;if((e.effects||[]).some(c=>c.includes("Next gain will be doubled"))){a*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))});const c=`Player ${e.id}: gain3vp  +${a} VP (DOUBLED!)`;n({type:"ADD_LOG",message:c})}else{const c=`Player ${e.id}: gain3vp  +${a} VP`;n({type:"ADD_LOG",message:c})}n({type:"UPDATE_VP",playerId:e.id,vp:a,source:"whiteAction"});return}if(t==="gain2vp"){let a=2;if((e.effects||[]).some(c=>c.includes("Next gain will be doubled"))){a*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(d=>!d.includes("Next gain will be doubled"))});const c=`Player ${e.id}: gain2vp  +${a} VP (DOUBLED!)`;n({type:"ADD_LOG",message:c})}else{const c=`Player ${e.id}: gain2vp  +${a} VP`;n({type:"ADD_LOG",message:c})}n({type:"UPDATE_VP",playerId:e.id,vp:a,source:"whiteAction"});return}if(t==="spend1AnyFor2VP"){const a=r.players.find(m=>m.id===e.id);if(Object.values(a.resources).reduce((m,v)=>m+v,0)<1){const m=`Player ${e.id}: spend1AnyFor2VP  Need at least 1 gem`;n({type:"ADD_LOG",message:m});return}const c=await ge(n,"Choose 1 gem to spend for 2 VP",1,a,i);if(!c){const m=`Player ${e.id}: spend1AnyFor2VP  Cancelled`;n({type:"ADD_LOG",message:m});return}const d={};Object.entries(c).forEach(([m,v])=>{d[m]=-v}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d}),n({type:"UPDATE_VP",playerId:e.id,vp:2,source:"whiteAction"});const h=`Player ${e.id}: spend1AnyFor2VP  Spent 1 gem for 2 VP`;n({type:"ADD_LOG",message:h});return}if(t==="spend2AnyFor3VP"){const a=r.players.find(m=>m.id===e.id);if(Object.values(a.resources).reduce((m,v)=>m+v,0)<2){const m=`Player ${e.id}: spend2AnyFor3VP  Need at least 2 gems`;n({type:"ADD_LOG",message:m});return}const c=await ge(n,"Choose 2 gems to spend for 3 VP",2,a,i);if(!c){const m=`Player ${e.id}: spend2AnyFor3VP  Cancelled`;n({type:"ADD_LOG",message:m});return}const d={};Object.entries(c).forEach(([m,v])=>{d[m]=-v}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:d}),n({type:"UPDATE_VP",playerId:e.id,vp:3,source:"whiteAction"});const h=`Player ${e.id}: spend2AnyFor3VP  Spent 2 gems for 3 VP`;n({type:"ADD_LOG",message:h});return}if(t==="lose1VPGain2Any"){if(e.victoryPoints<1){const h=`Player ${e.id}: lose1VPGain2Any  Need at least 1 VP`;n({type:"ADD_LOG",message:h});return}n({type:"UPDATE_VP",playerId:e.id,vp:-1,source:"whiteAction"});let a=2;const f=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));f&&(a*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))}));const c=await ge(n,`Choose ${a} gems to gain`,a,null,i);if(!c){const h={},m=r.gameLayers?Object.keys(r.gameLayers):["red","blue"];for(let w=0;w<a&&w<m.length;w++)h[m[w]]=(h[m[w]]||0)+1;n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h});const v=`Player ${e.id}: lose1VPGain2Any  -1 VP, +${a} gems (default)${f?" (DOUBLED!)":""}`;n({type:"ADD_LOG",message:v});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});const d=`Player ${e.id}: lose1VPGain2Any  -1 VP, gained ${a} gems${f?" (DOUBLED!)":""}`;n({type:"ADD_LOG",message:d});return}if(t==="lose2VPGain4Any"){if(e.victoryPoints<2){const c=`Player ${e.id}: lose2VPGain4Any  Need at least 2 VP`;n({type:"ADD_LOG",message:c});return}n({type:"UPDATE_VP",playerId:e.id,vp:-2,source:"whiteAction"});const a=await ge(n,"Choose 4 gems to gain",4,null,i);if(!a){const c={red:1,yellow:1,blue:1,purple:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});const d=`Player ${e.id}: lose2VPGain4Any  -2 VP, +1 of each color (default)`;n({type:"ADD_LOG",message:d});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:a});const f=`Player ${e.id}: lose2VPGain4Any  -2 VP, gained 4 gems`;n({type:"ADD_LOG",message:f});return}if(t==="gain5VPAnd5Any"){n({type:"UPDATE_VP",playerId:e.id,vp:5,source:"whiteAction"});const a=await ge(n,"Choose 5 gems to gain",5);if(!a){const c={red:1,yellow:1,blue:1,purple:1,gold:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:c});const d=`Player ${e.id}: gain5VPAnd5Any  +5 VP, +1 of each color (default)`;n({type:"ADD_LOG",message:d});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:a});const f=`Player ${e.id}: gain5VPAnd5Any  +5 VP and 5 gems`;n({type:"ADD_LOG",message:f});return}if(t==="blackSteal1VP"){if(n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:1}}),r.players.filter(d=>d.id!==e.id).length===0){const d=`Player ${e.id}: blackSteal1VP  +1 black (no other players)`;n({type:"ADD_LOG",message:d});return}const f=await fr(n,"Choose a player to steal 1 VP from",r.players,e.id,i);if(!f){const d=`Player ${e.id}: blackSteal1VP  +1 black (cancelled)`;n({type:"ADD_LOG",message:d});return}n({type:"UPDATE_VP",playerId:f.id,vp:-1,source:"blackSteal"}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackSteal"});const c=`Player ${e.id}: blackSteal1VP  +1 black, stole 1 VP from Player ${f.id}`;n({type:"ADD_LOG",message:c}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackSteal2Any"){if(r.players.filter(w=>w.id===e.id?!1:Object.values(w.resources).reduce((p,g)=>p+g,0)>0).length===0){const w=`Player ${e.id}: blackSteal2Any  No players with gems to steal from`;n({type:"ADD_LOG",message:w});return}const f=await fr(n,"Choose a player to steal 2 gems from",r.players,e.id,i);if(!f){const w=`Player ${e.id}: blackSteal2Any  Cancelled`;n({type:"ADD_LOG",message:w});return}const c=Object.values(f.resources).reduce((w,y)=>w+y,0),d=Math.min(2,c);if(d===0){const w=`Player ${e.id}: blackSteal2Any  Player ${f.id} has no gems`;n({type:"ADD_LOG",message:w});return}const h=await ja(n,`Choose ${d} gems to steal from Player ${f.id}`,f,d,i);if(!h){const w=`Player ${e.id}: blackSteal2Any  Cancelled`;n({type:"ADD_LOG",message:w});return}const m={};Object.entries(h).forEach(([w,y])=>{m[w]=-y}),n({type:"UPDATE_RESOURCES",playerId:f.id,resources:m}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h});const v=`Player ${e.id}: blackSteal2Any  Stole ${Object.entries(h).map(([w,y])=>`${y} ${w}`).join(", ")} from Player ${f.id}`;n({type:"ADD_LOG",message:v}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackStealWorker"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:1}});const a=4,f=r.players.filter(g=>g.id!==e.id);if(f.length===0){const g=`Player ${e.id}: blackStealWorker  +1 black (no other players to steal from)`;n({type:"ADD_LOG",message:g});return}const c=f.filter(g=>Object.values(g.resources).some(S=>S>0)).map(g=>({label:`Player ${g.id} (${Object.entries(g.resources).filter(([,S])=>S>0).map(([S,P])=>`${P} ${S}`).join(", ")})`,value:g.id}));if(c.length===0){const g=`Player ${e.id}: blackStealWorker  +1 black (no players have resources to steal)`;n({type:"ADD_LOG",message:g});return}const d=await ye(n,"Choose player to steal 4 resources from",c,!1,i);if(!d){const g=`Player ${e.id}: blackStealWorker  +1 black (cancelled)`;n({type:"ADD_LOG",message:g});return}const h=f.find(g=>g.id===d),m=Object.values(h.resources).reduce((g,S)=>g+S,0),v=Math.min(a,m),w=await ja(n,`Steal up to ${v} resources from Player ${d}`,h,v,i);if(!w){const g=`Player ${e.id}: blackStealWorker  +1 black (cancelled)`;n({type:"ADD_LOG",message:g});return}const y=[];Object.entries(w).forEach(([g,S])=>{S>0&&(n({type:"UPDATE_RESOURCES",playerId:d,resources:{[g]:-S}}),n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[g]:S}}),y.push(`${S} ${g}`))});const p=`Player ${e.id}: blackStealWorker  +1 black, stole ${y.join(", ")} from Player ${d}`;n({type:"ADD_LOG",message:p}),n({type:"UPDATE_VP",playerId:e.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${e.id}: +1 VP (Black automatic: stealing bonus)`});return}if(t==="blackAllLose2VP"){r.players.filter(c=>c.id!==e.id).forEach(c=>{n({type:"UPDATE_VP",playerId:c.id,vp:-2,source:"blackPenalty"})});const f=`Player ${e.id}: blackAllLose2VP  All other players lose 2 VP`;n({type:"ADD_LOG",message:f});return}if(t==="blackAllLose4VP"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{black:2}}),r.players.filter(c=>c.id!==e.id).forEach(c=>{n({type:"UPDATE_VP",playerId:c.id,vp:-4,source:"blackPenalty"})});const f=`Player ${e.id}: blackAllLose4VP  +2 black, all other players lose 4 VP`;n({type:"ADD_LOG",message:f});return}if(t==="silver4Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:4}}),r.players.filter(c=>c.id!==e.id).forEach(c=>{n({type:"UPDATE_RESOURCES",playerId:c.id,resources:{silver:1}})});const f=`Player ${e.id}: silver4Others1  +4 silver, all other players +1 silver`;n({type:"ADD_LOG",message:f});return}if(t==="silver3Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:3}}),r.players.filter(c=>c.id!==e.id).forEach(c=>{n({type:"UPDATE_RESOURCES",playerId:c.id,resources:{silver:1}})});const f=`Player ${e.id}: silver3Others1  +3 silver, all other players +1 silver`;n({type:"ADD_LOG",message:f});return}if(t==="silver2Plus1Others"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:2}});const a=await ge(n,"Choose 1 gem (others will get the same)",1,null,i,e.id);if(!a){const h={red:1};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h}),r.players.filter(w=>w.id!==e.id).forEach(w=>{n({type:"UPDATE_RESOURCES",playerId:w.id,resources:{red:1}})});const v=`Player ${e.id}: silver2Plus1Others  +2 silver +1 red, others +1 red`;n({type:"ADD_LOG",message:v});return}n({type:"UPDATE_RESOURCES",playerId:e.id,resources:a});const f=Object.keys(a)[0];r.players.filter(h=>h.id!==e.id).forEach(h=>{n({type:"UPDATE_RESOURCES",playerId:h.id,resources:{[f]:1}})});const d=`Player ${e.id}: silver2Plus1Others  +2 silver +1 ${f}, others +1 ${f}`;n({type:"ADD_LOG",message:d});return}if(t==="silver2VPBoth"){n({type:"UPDATE_VP",playerId:e.id,vp:2,source:"silverAction"});const a=r.players.filter(d=>d.id!==e.id),f=await fr(n,"Choose a player to also gain 2 VP",r.players,e.id,i);if(!f){const d=a[0];if(d){n({type:"UPDATE_VP",playerId:d.id,vp:2,source:"silverAction"});const h=`Player ${e.id}: silver2VPBoth  +2 VP, Player ${d.id} +2 VP`;n({type:"ADD_LOG",message:h})}else{const h=`Player ${e.id}: silver2VPBoth  +2 VP (no other players)`;n({type:"ADD_LOG",message:h})}return}n({type:"UPDATE_VP",playerId:f.id,vp:2,source:"silverAction"});const c=`Player ${e.id}: silver2VPBoth  +2 VP, Player ${f.id} +2 VP`;n({type:"ADD_LOG",message:c});return}if(t==="silverTakeBack2"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:2}});const a=Object.entries(r.occupiedSpaces||{}).filter(([h,m])=>m===e.id);let f=0;for(let h=0;h<Math.min(2,a.length);h++){const[m]=a[h];n({type:"REMOVE_WORKER",actionId:m,playerId:e.id}),f++}r.players.filter(h=>h.id!==e.id).forEach(h=>{const m=Object.entries(r.occupiedSpaces||{}).filter(([v,w])=>w===h.id);if(m.length>0){const[v]=m[0];n({type:"REMOVE_WORKER",actionId:v,playerId:h.id})}});const d=`Player ${e.id}: silverTakeBack2  +2 silver, took back ${f} patrons, others took back 1`;n({type:"ADD_LOG",message:d});return}if(t==="silver3Plus2Others1"){n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{silver:3}});const a=await ge(n,"Choose 1 color to get 2 gems of (others will get 1 of that color)",1,null,i,e.id);if(!a){const h={red:2};n({type:"UPDATE_RESOURCES",playerId:e.id,resources:h}),r.players.filter(w=>w.id!==e.id).forEach(w=>{n({type:"UPDATE_RESOURCES",playerId:w.id,resources:{red:1}})});const v=`Player ${e.id}: silver3Plus2Others1  +3 silver +2 red, others +1 red`;n({type:"ADD_LOG",message:v});return}const f=Object.keys(a)[0];n({type:"UPDATE_RESOURCES",playerId:e.id,resources:{[f]:2}}),r.players.filter(h=>h.id!==e.id).forEach(h=>{n({type:"UPDATE_RESOURCES",playerId:h.id,resources:{[f]:1}})});const d=`Player ${e.id}: silver3Plus2Others1  +3 silver +2 ${f}, others +1 ${f}`;n({type:"ADD_LOG",message:d});return}if(t==="silver8VPOthers3S"){let a=8;const f=(e.effects||[]).some(h=>h.includes("Next gain will be doubled"));f&&(a*=2,n({type:"UPDATE_PLAYER_EFFECTS",playerId:e.id,effects:(e.effects||[]).filter(h=>!h.includes("Next gain will be doubled"))})),n({type:"UPDATE_VP",playerId:e.id,vp:a,source:"silverAction"}),r.players.filter(h=>h.id!==e.id).forEach(h=>{n({type:"UPDATE_RESOURCES",playerId:h.id,resources:{silver:3}})});const d=`Player ${e.id}: silver8VPOthers3S  +${a} VP${f?" (DOUBLED!)":""}, each other player +3 silver`;n({type:"ADD_LOG",message:d});return}console.log(`Player ${e.id} executed action: ${t}`)}function dk({isOpen:t,onClose:e,children:n}){return _.useEffect(()=>{if(t)return requestAnimationFrame(()=>{const r=window.innerWidth-document.documentElement.clientWidth;document.body.style.paddingRight=`${r}px`,document.documentElement.style.paddingRight=`${r}px`,document.body.classList.add("modal-open"),document.querySelectorAll('[style*="position: fixed"]').forEach(o=>{o.dataset.originalPadding=o.style.paddingRight||"",o.style.paddingRight=`${r}px`})}),()=>{document.body.classList.remove("modal-open"),document.body.style.paddingRight="",document.documentElement.style.paddingRight="",document.querySelectorAll('[style*="position: fixed"]').forEach(s=>{s.style.paddingRight=s.dataset.originalPadding||"",delete s.dataset.originalPadding})}},[t]),t?_.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-hidden",onClick:e},_.createElement("div",{className:"glass rounded-xl p-6 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto",onClick:r=>r.stopPropagation()},n)):null}function fk({title:t,options:e,onSelect:n,onCancel:r,columnMode:s=!1}){const{dispatch:o}=Ve(),i=u=>{o({type:"HIDE_MODAL"}),n(u)},l=()=>{o({type:"HIDE_MODAL"}),r&&r()};if(s&&e.some(u=>u.group)){const u=e.reduce((f,c)=>{const d=c.group||"Other";return f[d]||(f[d]=[]),f[d].push(c),f},{}),a={"Red/Yellow":"from-red-400 to-yellow-400","Blue/Purple":"from-blue-400 to-purple-400","Gold/White":"from-yellow-500 to-gray-100","Black/Silver":"from-gray-800 to-gray-400","Red Quad":"from-red-400 to-red-500","Yellow Quad":"from-yellow-400 to-yellow-500","Blue Quad":"from-blue-400 to-blue-500","Purple Quad":"from-purple-400 to-purple-500","Gold Quad":"from-yellow-500 to-yellow-600","White Quad":"from-gray-100 to-gray-200","Black Quad":"from-gray-800 to-gray-900","Silver Quad":"from-gray-400 to-gray-500"};return _.createElement("div",{className:"text-center"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-4"},t),_.createElement("div",{key:"columns",className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 max-h-96 overflow-y-auto"},Object.entries(u).map(([f,c])=>_.createElement("div",{key:f,className:"space-y-2"},[_.createElement("h4",{key:"header",className:`text-sm font-bold text-gray-700 mb-2 p-1 rounded bg-gradient-to-r ${a[f]||"from-gray-200 to-gray-300"}`},f),...c.map((d,h)=>_.createElement("button",{key:`${f}-${h}`,onClick:()=>i(d.value||d),className:"w-full text-xs bg-gradient-to-r from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 text-gray-800 font-semibold py-1 px-2 rounded-md shadow-sm hover:shadow-md transform hover:scale-105 transition-all duration-200 text-left",title:d.label||d},d.label||d.shortLabel||d))]))),_.createElement("button",{key:"cancel",onClick:l,className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel")])}return _.createElement("div",{className:"text-center"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-4"},t),_.createElement("div",{key:"options",className:"space-y-2 mb-6"},e.map((u,a)=>_.createElement("button",{key:a,onClick:()=>i(u.value||u),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},u.label||u))),_.createElement("button",{key:"cancel",onClick:l,className:"w-full bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel")])}function hk({title:t,message:e,onConfirm:n,onCancel:r}){const{dispatch:s}=Ve(),o=()=>{s({type:"HIDE_MODAL"}),n()},i=()=>{s({type:"HIDE_MODAL"}),r&&r()};return _.createElement("div",{className:"text-center"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),_.createElement("p",{key:"message",className:"text-gray-600 mb-6"},e),_.createElement("div",{key:"buttons",className:"flex gap-3"},[_.createElement("button",{key:"cancel",onClick:i,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),_.createElement("button",{key:"confirm",onClick:o,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Confirm")])])}function pk({round:t,players:e}){const{state:n,dispatch:r}=Ve(),s=()=>{r({type:"HIDE_MODAL"}),r({type:"ADVANCE_ROUND"})},o=l=>Object.entries(l.resources).filter(([u,a])=>a>0).map(([u,a])=>`${a}${{red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""}[u]}`).join(" "),i=[...e].sort((l,u)=>u.victoryPoints-l.victoryPoints);return _.createElement("div",{className:"text-center max-w-2xl"},[_.createElement("h2",{key:"title",className:"text-3xl font-bold text-gray-800 mb-6"},`Starting Round ${t}`),_.createElement("h3",{key:"subtitle",className:"text-xl font-semibold text-gray-700 mb-4"},"Current Standings"),_.createElement("div",{key:"players",className:"space-y-3 mb-6"},i.map((l,u)=>_.createElement("div",{key:l.id,className:`p-4 rounded-lg ${u===0?"bg-yellow-100 border-2 border-yellow-400":"bg-gray-100"}`},[_.createElement("div",{key:"header",className:"flex items-center justify-between mb-2"},[_.createElement("div",{key:"name",className:"flex items-center gap-2"},[_.createElement("span",{key:"emoji",className:"text-2xl"},l.emoji||""),_.createElement("span",{key:"text",className:"font-semibold text-lg"},l.name||`Player ${l.id}`),u===0&&_.createElement("span",{key:"crown",className:"text-xl"},"")]),_.createElement("div",{key:"vp-section",className:"space-y-1"},[_.createElement("div",{key:"total",className:"text-xl font-bold text-green-600"},`${l.victoryPoints} VP`),_.createElement("div",{key:"breakdown",className:"text-xs text-gray-600"},Vk(l.vpSources))])]),_.createElement("div",{key:"resources",className:"text-sm text-gray-600"},o(l)||"No resources")]))),_.createElement("button",{key:"close",onClick:s,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200"},"Continue to Round "+t)])}function mk({title:t,maxGems:e,onSelect:n,onCancel:r,availableResources:s}){const{state:o,dispatch:i}=Ve(),[l,u]=_.useState({}),[a,f]=_.useState(0),c=o.gameLayers?Object.keys(o.gameLayers):["red","yellow","blue","purple"];_.useEffect(()=>{const p={};c.forEach(g=>{p[g]=0}),u(p)},[]);const d={red:{emoji:"",gradient:"from-red-500 to-red-600"},yellow:{emoji:"",gradient:"from-yellow-400 to-yellow-500"},blue:{emoji:"",gradient:"from-blue-500 to-blue-600"},purple:{emoji:"",gradient:"from-purple-500 to-purple-600"},gold:{emoji:"",gradient:"from-yellow-600 to-yellow-700"},white:{emoji:"",gradient:"from-gray-200 to-gray-300"},black:{emoji:"",gradient:"from-gray-700 to-gray-900"},silver:{emoji:"",gradient:"from-gray-400 to-gray-500"}},h=c.map(p=>({color:p,emoji:d[p].emoji,gradient:d[p].gradient})),m=p=>{const g=l[p]||0,S=s?s[p]||0:1/0;if(a<e&&g<S){const P={...l,[p]:l[p]+1},b=a+1;u(P),f(b),b===e&&setTimeout(()=>{i({type:"HIDE_MODAL"}),n(P)},300)}},v=p=>{l[p]>0&&(u({...l,[p]:l[p]-1}),f(a-1))},w=()=>{i({type:"HIDE_MODAL"}),n(l)},y=()=>{i({type:"HIDE_MODAL"}),r&&r()};return _.createElement("div",{className:"text-center"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),_.createElement("p",{key:"progress",className:"text-gray-600 mb-4"},`Selected: ${a}/${e}`),_.createElement("div",{key:"gem-grid",className:"grid grid-cols-4 gap-4 mb-4"},h.map(({color:p,emoji:g,gradient:S})=>{const P=l[p]||0,b=s?s[p]||0:1/0,A=a<e&&P<b;return _.createElement("div",{key:p,className:"text-center"},[_.createElement("button",{key:`${p}-button`,onClick:()=>m(p),disabled:!A,className:`w-16 h-16 rounded-lg bg-gradient-to-r ${S} ${A?"hover:scale-110":"opacity-50 cursor-not-allowed"} transition-all duration-200 flex items-center justify-center text-2xl shadow-lg relative`},[_.createElement("span",{key:"emoji"},g),s&&b>0&&_.createElement("span",{key:"count",className:"absolute -bottom-2 right-0 bg-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md"},b-P)]),_.createElement("div",{key:`${p}-count`,className:"mt-2 font-semibold text-gray-700"},l[p]>0?`${l[p]}`:"")])})),a>0&&_.createElement("div",{key:"selected-display",className:"mb-4 p-3 bg-gray-100 rounded-lg"},[_.createElement("p",{key:"selected-label",className:"text-sm text-gray-600 mb-2"},"Selected gems:"),_.createElement("div",{key:"selected-gems",className:"flex justify-center gap-2 flex-wrap"},Object.entries(l).flatMap(([p,g])=>Array(g).fill(null).map((S,P)=>{const b=h.find(A=>A.color===p);return _.createElement("button",{key:`${p}-${P}`,onClick:()=>v(p),className:"text-xl hover:scale-125 transition-transform cursor-pointer",title:"Click to remove"},b.emoji)})))]),_.createElement("div",{key:"buttons",className:"flex gap-3"},[_.createElement("button",{key:"cancel",onClick:y,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),_.createElement("button",{key:"confirm",onClick:w,disabled:a===0,className:`flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 ${a===0?"opacity-50 cursor-not-allowed":""}`},"Confirm")])])}function gk({title:t,targetPlayer:e,maxGems:n,onSelect:r,onCancel:s}){const{state:o,dispatch:i}=Ve(),[l,u]=_.useState({}),[a,f]=_.useState(0),c=o.gameLayers?Object.keys(o.gameLayers):["red","yellow","blue","purple"];_.useEffect(()=>{const p={};c.forEach(g=>{p[g]=0}),u(p)},[]);const d={red:{emoji:"",gradient:"from-red-500 to-red-600"},yellow:{emoji:"",gradient:"from-yellow-400 to-yellow-500"},blue:{emoji:"",gradient:"from-blue-500 to-blue-600"},purple:{emoji:"",gradient:"from-purple-500 to-purple-600"},gold:{emoji:"",gradient:"from-yellow-600 to-yellow-700"},white:{emoji:"",gradient:"from-gray-200 to-gray-300"},black:{emoji:"",gradient:"from-gray-700 to-gray-900"},silver:{emoji:"",gradient:"from-gray-400 to-gray-500"}},h=c.map(p=>({color:p,emoji:d[p].emoji,gradient:d[p].gradient})),m=p=>{const g=e.resources[p]||0,S=l[p];if(a<n&&S<g){const P={...l,[p]:l[p]+1},b=a+1;u(P),f(b),b===n&&setTimeout(()=>{i({type:"HIDE_MODAL"}),r(P)},300)}},v=p=>{l[p]>0&&(u({...l,[p]:l[p]-1}),f(a-1))},w=()=>{i({type:"HIDE_MODAL"}),r(l)},y=()=>{i({type:"HIDE_MODAL"}),s&&s()};return _.createElement("div",{className:"text-center"},[_.createElement("h3",{key:"title",className:"text-xl font-bold text-gray-800 mb-2"},t),_.createElement("p",{key:"target",className:"text-gray-600 mb-2"},`Stealing from Player ${e.id}`),_.createElement("p",{key:"progress",className:"text-gray-600 mb-4"},`Selected: ${a}/${n}`),_.createElement("div",{key:"available-label",className:"text-sm text-gray-600 mb-2"},"Available gems:"),_.createElement("div",{key:"gem-grid",className:"grid grid-cols-4 gap-4 mb-4"},h.map(({color:p,emoji:g,gradient:S})=>{const P=e.resources[p]||0,b=l[p],A=P-b,T=a<n&&A>0;return _.createElement("div",{key:p,className:"text-center"},[_.createElement("button",{key:`${p}-button`,onClick:()=>m(p),disabled:!T,className:`w-16 h-16 rounded-lg bg-gradient-to-r ${S} ${T?"hover:scale-110":"opacity-50 cursor-not-allowed"} transition-all duration-200 flex items-center justify-center text-2xl shadow-lg relative`},[_.createElement("span",{key:"emoji"},g),P>0&&_.createElement("span",{key:"count",className:"absolute -top-2 -right-2 bg-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center shadow-md"},P)]),_.createElement("div",{key:`${p}-info`,className:"mt-2 text-sm text-gray-700"},b>0?`Taking ${b}`:A>0?`${A} left`:"None")])})),a>0&&_.createElement("div",{key:"selected-display",className:"mb-4 p-3 bg-gray-100 rounded-lg"},[_.createElement("p",{key:"selected-label",className:"text-sm text-gray-600 mb-2"},"Gems to steal:"),_.createElement("div",{key:"selected-gems",className:"flex justify-center gap-2 flex-wrap"},Object.entries(l).flatMap(([p,g])=>Array(g).fill(null).map((S,P)=>{const b=h.find(A=>A.color===p);return _.createElement("button",{key:`${p}-${P}`,onClick:()=>v(p),className:"text-xl hover:scale-125 transition-transform cursor-pointer",title:"Click to remove"},b.emoji)})))]),_.createElement("div",{key:"buttons",className:"flex gap-3"},[_.createElement("button",{key:"cancel",onClick:y,className:"flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"},"Cancel"),_.createElement("button",{key:"confirm",onClick:w,disabled:a===0,className:`flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 ${a===0?"opacity-50 cursor-not-allowed":""}`},"Confirm")])])}function ye(t,e,n,r=!1,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"choice",title:e,options:n,columnMode:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}function yk(t,e,n,r=null){return new Promise(s=>{t({type:"SHOW_MODAL",modal:{type:"confirm",title:e,message:n,onConfirm:()=>s(!0),onCancel:()=>{r&&t({type:"UNDO_LAST_WORKER",...r}),s(!1)}}})})}function ge(t,e,n,r,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"gemSelection",title:e,maxGems:n,availableResources:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}function ja(t,e,n,r,s=null,o=null){return new Promise(i=>{t({type:"SHOW_MODAL",modal:{type:"stealGems",title:e,targetPlayer:n,maxGems:r,targetPlayerId:o,onSelect:i,onCancel:()=>{s&&t({type:"UNDO_LAST_WORKER",...s}),i(null)}}})})}async function fr(t,e,n,r,s=null){const o=n.filter(u=>u.id!==r);if(o.length===0)return null;const i=o.map(u=>{const a=Object.entries(u.resources).filter(([,f])=>f>0).map(([f,c])=>`${c} ${f}`).join(", ")||"no resources";return{label:`${u.name||`Player ${u.id}`} ${u.emoji||""} (${a}, ${u.victoryPoints||0} VP)`,value:u.id}}),l=await ye(t,e,i,!1,s);return l?n.find(u=>u.id===l):null}function _k({onEndTurn:t}){const{state:e,dispatch:n}=Ve(),r=e.players.find(u=>u.id===e.currentPlayer),s=()=>e.workersToPlace===0&&!e.shopUsedAfterWorkers?" Skip Shopping & End Turn":"End Turn",o=r&&r.workersLeft===0,i=!e.workerPlacedThisTurn&&!o,l=e.workersToPlace===0&&e.workerPlacedThisTurn;return _.createElement("button",{onClick:t,disabled:i,className:`font-bold py-1.5 px-3 rounded-lg shadow-lg transition-all duration-200 whitespace-nowrap text-sm ${i?"bg-gray-400 text-gray-200 cursor-not-allowed":l?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white hover:shadow-xl":"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white hover:shadow-xl"}`},s())}async function k_(t,e,n,r,s=0){const o=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","blueR1ShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"],i=Object.entries(n.occupiedSpaces).filter(([l,u])=>u===t.id&&!o.includes(l)).map(([l])=>l);if(i.length===0){const l=`Player ${t.id}: Red shop  No valid workers to repeat (swap/repeat actions excluded)`;return e({type:"ADD_LOG",message:l}),!1}if(i.length>=1){const l=i.map(a=>{let f=a;for(const c of Object.values(r)){const d=c.actions.find(h=>h.id===a);if(d){f=d.title;break}}return{label:`Repeat: ${f}`,value:a}}),u=await ye(e,"Choose an action to repeat",l);if(u){let a=u;for(const h of Object.values(r)){const m=h.actions.find(v=>v.id===u);if(m){a=m.title;break}}const f=`Player ${t.id}: Red shop  Repeating ${a}`;e({type:"ADD_LOG",message:f}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"redAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP for red action`});const c=n.players.find(h=>h.id===t.id),d={...n,players:n.players.map(h=>h.id===t.id?c:h)};return await yt(u,c,e,d,r,s+1),!0}}return!1}async function vk(t,e,n){console.log("executeYellow3Shop - Starting for player",t.id);const r=await ge(e,"Choose 7 gems of any color",7);if(!r){const u=`Player ${t.id}: Yellow R3 shop  Cancelled`;e({type:"ADD_LOG",message:u});return}console.log("executeYellow3Shop - Player",t.id,"selected gems:",r);const s=(t.effects||[]).some(u=>u.includes("Next gain will be doubled"));let o={...r};s&&(Object.keys(o).forEach(u=>{o[u]*=2}),e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(u=>!u.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=Object.values(o).reduce((u,a)=>u+a,0),l=`Player ${t.id}: Yellow R3 shop  Gained ${i} gems${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:l})}async function Ek(t,e,n){console.log("executeYellow2Shop - Starting for player",t.id);const r=await ge(e,"Choose 5 gems of any color",5);if(!r){const u=`Player ${t.id}: Yellow R2 shop  Cancelled`;e({type:"ADD_LOG",message:u});return}console.log("executeYellow2Shop - Player",t.id,"selected gems:",r);const s=(t.effects||[]).some(u=>u.includes("Next gain will be doubled"));let o={...r};s&&(Object.keys(o).forEach(u=>{o[u]*=2}),e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(u=>!u.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=Object.values(o).reduce((u,a)=>u+a,0),l=`Player ${t.id}: Yellow R2 shop  Gained ${i} gems${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:l})}async function wk(t,e,n){const r=[],s=n.gameLayers?Object.keys(n.gameLayers):["red","yellow","blue","purple"],o={red:{1:"1+2",2:"2+2",3:"4+4"},yellow:{1:"1+1",2:"2+2",3:"3+3"},blue:{1:"1+1",2:"2+2",3:"3+3"},purple:{1:"1+2",2:"2+2",3:"3+3"},gold:{1:"1+1",2:"2+2",3:"3+3"},white:{1:"1VP",2:"2VP",3:"3VP"},black:{1:"1+1",2:"2+2",3:"3+3"},silver:{1:"1+1",2:"2+2",3:"3+3"}},i={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""},l={red:"Red Quad",yellow:"Yellow Quad",blue:"Blue Quad",purple:"Purple Quad",gold:"Gold Quad",white:"White Quad",black:"Black Quad",silver:"Silver Quad"};s.forEach(a=>{const f=l[a]||a,c=n.closedShops[`${a}1`];n.round>=1,r.push({label:`${i[a]} R1 ${c?" Closed":" Open"}`,shortLabel:`${c?"":""} R1: ${o[a][1]}`,value:`${a}1`,group:f});const d=n.closedShops[`${a}2`],h=n.round>=2;r.push({label:`${i[a]} R2 ${d?" Closed":" Open"}${h?"":" (Round 2+)"}`,shortLabel:`${d?"":""} R2: ${o[a][2]}`,value:`${a}2`,group:f});const m=n.closedShops[`${a}3`],v=n.round>=3;r.push({label:`${i[a]} R3 ${m?" Closed":" Open"}${v?"":" (Round 3)"}`,shortLabel:`${m?"":""} R3: ${o[a][3]}`,value:`${a}3`,group:f});const w=n.closedShops[`${a}vp`];r.push({label:`${i[a]} VP ${w?" Closed":" Open"}`,shortLabel:`${w?"":""} VP`,value:`${a}vp`,group:f})});const u=await ye(e,"Choose a shop to toggle (Closed/Open)",r,!0);u&&(n.closedShops[u]?(e({type:"OPEN_SHOP",shopId:u}),e({type:"ADD_LOG",message:`Player ${t.id}: Opened ${u} shop`})):(e({type:"CLOSE_SHOP",shopId:u}),e({type:"ADD_LOG",message:`Player ${t.id}: Closed ${u} shop`})))}async function Sk(t,e,n,r=0){await yt("blueAnyShopBenefit",t,e,n,n.gameLayers,r)}async function Pk(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((c,d)=>c+d,0);if(r<1||s<2){const c=`Player ${t.id}: Gold R1 shop  Need 1 gold + 1  resource`;e({type:"ADD_LOG",message:c});return}const o=Object.entries(t.resources).filter(([c,d])=>c!=="gold"&&d>0).reduce((c,[,d])=>c+d,0);let i;if(o===0&&r>=2)i={gold:1};else if(i=await ge(e,"Choose 1  resource to pay",1,t),!i){const c=`Player ${t.id}: Gold R1 shop  Cancelled`;e({type:"ADD_LOG",message:c});return}const l={gold:-1};Object.entries(i).forEach(([c,d])=>{l[c]=l[c]?l[c]-d:-d}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:l});const u=(t.effects||[]).some(c=>c.includes("Next gain will be doubled"));let a=2;u&&(a*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:a}});const f=`Player ${t.id}: Gold R1 shop  Paid 1 gold + 1 resource, gained ${a} gold${u?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:f})}async function Ck(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((f,c)=>f+c,0);if(r<2||s<4){const f=`Player ${t.id}: Gold R2 shop  Need 2 gold + 2  resources`;e({type:"ADD_LOG",message:f});return}const o=await ge(e,"Choose 2  resources to pay",2,t);if(!o){const f=`Player ${t.id}: Gold R2 shop  Cancelled`;e({type:"ADD_LOG",message:f});return}const i={gold:-2};Object.entries(o).forEach(([f,c])=>{i[f]=i[f]?i[f]-c:-c}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:i});const l=(t.effects||[]).some(f=>f.includes("Next gain will be doubled"));let u=4;l&&(u*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(f=>!f.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:u}});const a=`Player ${t.id}: Gold R2 shop  Paid 2 gold + 2 resources, gained ${u} gold${l?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:a})}async function kk(t,e,n){const r=t.resources.gold||0,s=Object.values(t.resources).reduce((c,d)=>c+d,0);if(r<3||s<6){const c=`Player ${t.id}: Gold R3 shop  Need 3 gold + 3  resources`;e({type:"ADD_LOG",message:c});return}const o=await ge(e,"Choose 3  resources to pay",3,t);if(!o){const c=`Player ${t.id}: Gold R3 shop  Cancelled`;e({type:"ADD_LOG",message:c});return}const i={gold:-3};Object.entries(o).forEach(([c,d])=>{i[c]=i[c]?i[c]-d:-d}),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:i});const l=(t.effects||[]).some(c=>c.includes("Next gain will be doubled"));let u=r*2;l&&(u*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(c=>!c.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{gold:u}});const a=r-3+u,f=`Player ${t.id}: Gold R3 shop  Paid 3 gold + 3 resources, gold went from ${r} to ${a}${l?" (DOUBLE DOUBLED!)":""}`;e({type:"ADD_LOG",message:f})}async function bk(t,e,n){if(t.victoryPoints<1){const l=`Player ${t.id}: White R1 shop  Need at least 1 VP`;e({type:"ADD_LOG",message:l});return}e({type:"UPDATE_VP",playerId:t.id,vp:-1,source:"whiteShop"});let r=1;const s=(t.effects||[]).some(l=>l.includes("Next gain will be doubled"));s&&(r*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(l=>!l.includes("Next gain will be doubled"))}));const o=await ge(e,`Choose ${r} gem${r>1?"s":""} to gain`,r);if(!o){const l={red:r};e({type:"UPDATE_RESOURCES",playerId:t.id,resources:l});const u=`Player ${t.id}: White R1 shop  -1 VP, +${r} red (default)${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:u});return}e({type:"UPDATE_RESOURCES",playerId:t.id,resources:o});const i=`Player ${t.id}: White R1 shop  -1 VP, gained ${r} gem${r>1?"s":""}${s?" (DOUBLED!)":""}`;e({type:"ADD_LOG",message:i})}async function Tk(t,e,n){if(t.victoryPoints<3){const u=`Player ${t.id}: White R2 shop  Need at least 3 VP`;e({type:"ADD_LOG",message:u});return}e({type:"UPDATE_VP",playerId:t.id,vp:-3,source:"whiteShop"});const s=(n.turnOrder.indexOf(n.currentPlayer)+n.turnDirection+n.turnOrder.length)%n.turnOrder.length,o=n.turnOrder[s],i={...n.skippedTurns};i[o]=(i[o]||0)+1,e({type:"SET_SKIPPED_TURNS",skippedTurns:i});const l=`Player ${t.id}: White R2 shop  -2 VP, Player ${o} will skip next turn`;e({type:"ADD_LOG",message:l})}async function Ak(t,e,n){if(t.victoryPoints<3){const c=`Player ${t.id}: White R3 shop  Need at least 3 VP`;e({type:"ADD_LOG",message:c});return}const r=Object.entries(n.occupiedSpaces).filter(([c,d])=>d===t.id).map(([c])=>c);if(r.length===0){const c=`Player ${t.id}: White R3 shop  No workers to move`;e({type:"ADD_LOG",message:c});return}const s=r.map(c=>{let d=c;for(const[h,m]of Object.entries(n.gameLayers||{})){const v=m.actions.find(w=>w.id===c);if(v){d=`${h} - ${v.title}`;break}}return{label:d,value:c}}),o=await ye(e,"Choose a worker to move",s);if(!o)return;const i=[];if(Object.entries(n.gameLayers||{}).forEach(([c,d])=>{d.actions.forEach(h=>{h.round<=n.round&&!n.occupiedSpaces[h.id]&&i.push({label:`${c} - ${h.title}`,value:h.id,color:c})})}),i.length===0){const c=`Player ${t.id}: White R3 shop  No unclaimed actions available`;e({type:"ADD_LOG",message:c});return}const l=await ye(e,"Choose an unclaimed action to move to",i);if(!l)return;e({type:"UPDATE_VP",playerId:t.id,vp:-3,source:"whiteShop"});const u={...n.occupiedSpaces};delete u[o],u[l]=t.id,e({type:"UPDATE_OCCUPIED_SPACES",occupiedSpaces:u});const a={...n,occupiedSpaces:u};await yt(l,t,e,a,n.gameLayers,0);const f=`Player ${t.id}: White R3 shop  -3 VP, moved worker to ${l}`;e({type:"ADD_LOG",message:f})}async function Dk(t,e,n){if(n.players.filter(o=>o.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  No other players`});return}const s=await fr(e,"Choose a player to steal 1 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  Cancelled`});return}e({type:"UPDATE_VP",playerId:s.id,vp:-1,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R1 shop  Stole 1 VP from Player ${s.id}`}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function xk(t,e,n){if(n.players.filter(i=>i.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  No other players`});return}const s=await fr(e,"Choose a player to steal 3 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  Cancelled`});return}const o=Math.min(3,s.victoryPoints);e({type:"UPDATE_VP",playerId:s.id,vp:-o,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:o,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R2 shop  Stole ${o} VP from Player ${s.id}`}),n.roomCode&&e({type:"ADD_NOTIFICATION",notification:{type:"steal",icon:"",title:"VP Stolen!",message:`${t.name||`Player ${t.id}`} stole ${o} VP from you`,forPlayer:s.id}}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function Ok(t,e,n){if(n.players.filter(i=>i.id!==t.id).length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  No other players`});return}const s=await fr(e,"Choose a player to steal 5 VP from",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  Cancelled`});return}const o=Math.min(5,s.victoryPoints);e({type:"UPDATE_VP",playerId:s.id,vp:-o,source:"blackShop"}),e({type:"UPDATE_VP",playerId:t.id,vp:o,source:"blackShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Black R3 shop  Stole ${o} VP from Player ${s.id}`}),e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"blackAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP (Black automatic: stealing bonus)`})}async function Nk(t,e,n){e({type:"UPDATE_VP",playerId:t.id,vp:4,source:"silverShop"});const r=n.players.filter(o=>o.id!==t.id);if(r.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP (no other players)`});return}if(r.length===1){const o=r[0];e({type:"UPDATE_VP",playerId:o.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${o.id} +4 VP`});return}const s=await fr(e,"Choose a player to give 4 VP",n.players,t.id);if(!s){e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP (gift cancelled)`});return}if(n.roomCode&&s.id!==t.id){const o=`${t.name||`Player ${t.id}`} ${t.emoji||""}`;await ye(e,`${o} wants to give you 4 VP! `,[{label:"Graciously Accept (+4 VP)",value:!0},{label:"Politely Decline",value:!1}],!1,null,s.id)?(e({type:"UPDATE_VP",playerId:s.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${s.id} accepted +4 VP gift! `})):e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, Player ${s.id} declined the gift`})}else e({type:"UPDATE_VP",playerId:s.id,vp:4,source:"silverShop"}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R2 shop  +4 VP, gave Player ${s.id} +4 VP`})}async function Rk(t,e,n){const r=(t.effects||[]).some(i=>i.includes("Next gain will be doubled"));let s=7;r&&(s*=2,e({type:"UPDATE_PLAYER_EFFECTS",playerId:t.id,effects:(t.effects||[]).filter(i=>!i.includes("Next gain will be doubled"))})),e({type:"UPDATE_RESOURCES",playerId:t.id,resources:{silver:s}}),n.players.filter(i=>i.id!==t.id).forEach(i=>{e({type:"UPDATE_RESOURCES",playerId:i.id,resources:{silver:2}})}),e({type:"ADD_LOG",message:`Player ${t.id}: Silver R3 shop  +${s} silver${r?" (DOUBLED!)":""}, all other players +2 silver`})}async function cc(t,e,n,r,s,o=0){const i=`${t}${e}`;switch(i){case"red1":if(!await k_(n,r,s,s.gameLayers,o))return!1;break;case"red2":await Ik(n,r,s);break;case"red3":await Lk(n,r,s,o);break;case"yellow1":r({type:"ADD_EFFECT",playerId:n.id,effect:"Next gain will be doubled"}),r({type:"ADD_LOG",message:`Player ${n.id}: Yellow R1 shop  Next gain will be doubled`});break;case"yellow2":await Ek(n,r);break;case"yellow3":await vk(n,r);break;case"blue1":await wk(n,r,s),r({type:"ADD_LOG",message:`Player ${n.id}: Blue R1 shop  Toggle any shop (open/closed)`});break;case"blue2":r({type:"FLIP_ALL_SHOPS",playerId:n.id,playerName:n.name}),r({type:"ADD_LOG",message:`Player ${n.id}: Blue R2 shop  All shops toggled!`});break;case"blue3":await Sk(n,r,s);break;case"purple1":r({type:"ADD_EFFECT",playerId:n.id,effect:"Will take an extra turn after this one"}),r({type:"UPDATE_PLAYER",playerId:n.id,updates:{extraTurns:(n.extraTurns||0)+1}}),r({type:"ADD_LOG",message:`Player ${n.id}: Purple R1 shop  Will take an extra turn after this one`});break;case"purple2":const u=n.workersLeft,a=Math.min(2,u);if(a===0){r({type:"ADD_LOG",message:`Player ${n.id}: Purple R2 shop  No patrons left to place`});break}r({type:"ADD_WORKERS_TO_PLACE",count:a}),r({type:"ADD_EFFECT",playerId:n.id,effect:`Can place ${a} more patron${a>1?"s":""} this turn`}),r({type:"ADD_LOG",message:`Player ${n.id}: Can place ${a} more patron${a>1?"s":""}${a<2?" (limited by available patrons)":""} this turn!`});break;case"purple3":const f=n.workersLeft;f>0&&(r({type:"ADD_WORKERS_TO_PLACE",count:f}),r({type:"ADD_EFFECT",playerId:n.id,effect:`Can place ${f} more patrons this turn`}),r({type:"ADD_LOG",message:`Player ${n.id}: Can place all ${f} remaining patrons!`}));break;case"gold1":await Pk(n,r);break;case"gold2":await Ck(n,r);break;case"gold3":await kk(n,r);break;case"white1":await bk(n,r);break;case"white2":await Tk(n,r,s);break;case"white3":await Ak(n,r,s);break;case"black1":await Dk(n,r,s);break;case"black2":await xk(n,r,s);break;case"black3":await Ok(n,r,s);break;case"silver1":r({type:"UPDATE_VP",playerId:n.id,vp:2,source:"silverShop"}),r({type:"ADD_LOG",message:`Player ${n.id}: Silver R1 shop benefit  +2 VP`});break;case"silver2":await Nk(n,r,s);break;case"silver3":await Rk(n,r,s);break;default:r({type:"ADD_LOG",message:`Player ${n.id}: Shop benefit ${i} not implemented yet`})}return!0}async function Ik(t,e,n){let s=n.turnOrder.indexOf(t.id),o=null,i=null,l=0,u=n.turnDirection;for(;!o&&l<n.players.length;){s=s+u,u===1&&s>=n.turnOrder.length?(u=-1,s=n.turnOrder.length-1):u===-1&&s<0&&(u=1,s=0),i=n.turnOrder[s];const c=n.players.find(d=>d.id===i);if(c&&c.workersLeft>0&&(!n.skippedTurns||n.skippedTurns[i]===0)){o=c;break}l++}if(!o){e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  No players with workers remaining in turn order`});return}const a=[];if(Object.entries(n.gameLayers||{}).forEach(([c,d])=>{d.actions.forEach(h=>{h.round<=n.round&&!n.occupiedSpaces[h.id]&&a.push({label:`${c} - ${h.title}`,value:h.id,color:c})})}),a.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  No available actions`});return}const f=await ye(e,`Choose where to place Player ${i}'s worker (they have ${o.workersLeft} workers left)`,a);if(f){e({type:"PLACE_WORKER",actionId:f,playerId:i}),e({type:"UPDATE_PLAYER",playerId:i,updates:{workersLeft:o.workersLeft-1}});const c={actionId:f,playerId:i,placedBy:t.id};await yt(f,o,e,n,n.gameLayers,0,c);let d=f;for(const[h,m]of Object.entries(n.gameLayers||{})){const v=m.actions.find(w=>w.id===f);if(v){d=`${h} - ${v.title}`;break}}e({type:"ADD_LOG",message:`Player ${t.id}: Red R2 shop  Placed Player ${i}'s patron on ${d}`}),n.roomCode&&e({type:"ADD_NOTIFICATION",notification:{type:"worker_placed",icon:"",title:"Worker Placed For You!",message:`${t.name||`Player ${t.id}`} placed your worker on ${d}`,forPlayer:i}})}}async function Lk(t,e,n,r=0){var h;const s=[],o={};Object.entries(n.occupiedSpaces).forEach(([m,v])=>{o[v]||(o[v]=[],s.push(v)),o[v].push(m)});const i=s.filter(m=>m!==t.id);if(i.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  No other players have workers!`});return}const l=i.map(m=>{const v=o[m].length;return{label:`Player ${m} (${v} worker${v>1?"s":""})`,value:m}}),u=await ye(e,"Choose which player's actions to repeat",l);if(!u){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Cancelled`});return}const a=o[u],f=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","playTwoWorkers","playThreeWorkers","gain4purpleWaitAll","gain2purpleTakeBack","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"],c=a.filter(m=>!f.includes(m)).map(m=>{let v=m,w="";return Object.entries(n.gameLayers||{}).forEach(([y,p])=>{const g=p.actions.find(S=>S.id===m);g&&(v=g.title,w=y)}),{label:`${w} - ${v}`,value:m}});if(c.length===0){e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  No valid actions to repeat from Player ${u}`});return}e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Will repeat ${c.length} actions from Player ${u}`});const d=[...c];for(;d.length>0;){const m=await ye(e,`Choose next action to repeat (${d.length} remaining)`,d,!1);if(!m){e({type:"ADD_LOG",message:`Player ${t.id}: Stopped repeating actions`});break}console.log(`Red R3 shop - Player ${t.id} repeating ${m} from Player ${u}`),await yt(m,t,e,n,n.gameLayers,r+1);const v=(h=n.gameLayers)==null?void 0:h.red;v&&v.actions.some(p=>p.id===m)&&(e({type:"UPDATE_VP",playerId:t.id,vp:1,source:"redAutomatic"}),e({type:"ADD_LOG",message:`Player ${t.id}: +1 VP for repeating red action`}));const y=d.findIndex(p=>p.value===m);y>-1&&d.splice(y,1)}e({type:"ADD_LOG",message:`Player ${t.id}: Red R3 shop  Completed copying Player ${u}'s actions!`})}function $k(t=[]){return t.map(e=>e.includes("Next gain will be doubled")?{type:"double_gain",label:"2 Next Gain",trigger:"Next Turn",icon:"",color:"bg-yellow-100 text-yellow-800"}:e.includes("Skip next turn")||e.includes("skip turn")?{type:"skip_turn",label:"Skip Next Turn",trigger:"Next Turn",icon:"",color:"bg-purple-100 text-purple-800"}:e.includes("extra turn")||e.includes("Take another turn")?{type:"extra_turn",label:"Extra Turn",trigger:"After This Turn",icon:"",color:"bg-green-100 text-green-800"}:e.includes("play")&&e.includes("more workers")?{type:"extra_workers",label:"Extra Workers",trigger:"This Turn",icon:"",color:"bg-blue-100 text-blue-800"}:{type:"other",label:e.substring(0,20),trigger:"Pending",icon:"",color:"bg-gray-100 text-gray-800"}).filter(Boolean)}function Mk({effects:t}){const e=$k(t);return e.length===0?null:_.createElement("div",{key:"active-effects",className:"space-y-1"},[_.createElement("div",{key:"header",className:"text-xs font-semibold text-gray-700 mb-1"}," Active Effects"),...e.map((n,r)=>_.createElement("div",{key:r,className:`text-xs px-2 py-1 rounded ${n.color} flex justify-between items-center`},[_.createElement("span",{key:"label",className:"font-semibold"},`${n.icon} ${n.label}`),_.createElement("span",{key:"trigger",className:"text-xs opacity-75"},n.trigger)]))])}function wp({player:t,isCurrentPlayer:e,onEndTurn:n,turnPosition:r}){const{state:s,dispatch:o}=Ve(),i=s.gameLayers?Object.keys(s.gameLayers):["red","yellow","blue","purple"],l={red:"",yellow:"",blue:"",purple:"",gold:"",white:"",black:"",silver:""};return _.createElement("div",{className:`flex flex-col gap-2 px-4 py-3 rounded-lg glass shadow ${e?"ring-2 ring-blue-400":""}`},[_.createElement("div",{key:"row1",className:"flex items-center gap-3"},[_.createElement("div",{key:"name",className:"font-bold text-base whitespace-nowrap"},[_.createElement("span",{key:"emoji",className:"text-xl mr-1"},t.emoji||""),t.name,e&&_.createElement("span",{key:"indicator",className:"ml-1"},"")]),_.createElement("div",{key:"vp",className:"text-lg font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded whitespace-nowrap"},`${t.victoryPoints}VP`)]),t.effects&&t.effects.length>0&&_.createElement(Mk,{key:"effects",effects:t.effects}),e&&(()=>{let u="",a="";return s.workersToPlace>0?(u=`Workers to Place: ${s.workersToPlace}`,a="bg-blue-100 text-blue-800"):s.shopUsedAfterWorkers?(u="Ready to End Turn",a="bg-green-100 text-green-800"):(u="Shopping Phase (Optional)",a="bg-purple-100 text-purple-800"),_.createElement("div",{key:"phase",className:`text-sm font-semibold px-3 py-1.5 rounded-lg ${a} text-center`},u)})(),_.createElement("div",{key:"row2",className:"flex items-center gap-3"},[_.createElement("div",{key:"resources",className:"flex gap-1"},i.map(u=>_.createElement("div",{key:u,className:"text-sm font-medium"},`${l[u]}${t.resources[u]||0}`))),_.createElement("div",{key:"workers",className:"text-base whitespace-nowrap font-medium"},t.workersLeft>0?`${t.emoji||""}  ${t.workersLeft}`:""),e&&s.workersToPlace===0&&_.createElement(_k,{key:"end-turn",onEndTurn:n})])])}function Uk({color:t,title:e,icon:n,actions:r,round:s}){const{state:o}=Ve();o.players.find(a=>a.id===o.currentPlayer);const i=()=>{const a="glass rounded-lg shadow-md p-3 border-t-8 hover:shadow-lg transition-all duration-200 h-full flex flex-col";switch(t){case"red":return`${a} border-t-red-500 bg-red-50 bg-opacity-30`;case"yellow":return`${a} border-t-yellow-500 bg-yellow-50 bg-opacity-30`;case"blue":return`${a} border-t-blue-500 bg-blue-50 bg-opacity-30`;case"purple":return`${a} border-t-purple-500 bg-purple-50 bg-opacity-30`;case"gold":return`${a} border-t-yellow-600 bg-yellow-50 bg-opacity-30`;case"white":return`${a} border-t-gray-300 bg-gray-50 bg-opacity-30`;case"black":return`${a} border-t-gray-800 bg-gray-100 bg-opacity-30`;case"silver":return`${a} border-t-gray-400 bg-gray-50 bg-opacity-30`;default:return`${a} border-t-gray-500`}},l=()=>{switch(t){case"red":return"text-red-500";case"yellow":return"text-yellow-500";case"blue":return"text-blue-500";case"purple":return"text-purple-500";case"gold":return"text-yellow-600";case"white":return"text-gray-600";case"black":return"text-gray-800";case"silver":return"text-gray-400";default:return"text-gray-500"}},u=r;return _.createElement("div",{className:i()},[_.createElement("div",{key:"header",className:"flex justify-between items-center mb-2"},[_.createElement("h2",{key:"title",className:`text-lg font-bold ${l()}`},`${n} ${t.charAt(0).toUpperCase()+t.slice(1)}`),_.createElement("div",{key:"auto-vp",className:"text-sm font-bold text-gray-900 flex items-center gap-1"},[_.createElement("span",{key:"trophy"},""),_.createElement("span",{key:"text"},Fk(t))]),_.createElement("span",{key:"round",className:"text-gray-700 text-xs bg-white px-2 py-0.5 rounded shadow-sm font-semibold"},`R${s}`)]),_.createElement("div",{key:"shops",className:"mb-1.5 bg-white bg-opacity-20 rounded-lg p-1.5"},[_.createElement("div",{key:"shop-header",className:"text-xs font-semibold text-gray-800 mb-1 px-0.5"}," Shops"),_.createElement("div",{key:"shop-grid",className:"grid grid-cols-4 gap-1"},[_.createElement(za,{key:"shop-r1",color:t,round:1,label:"R1",currentRound:s}),_.createElement(za,{key:"shop-r2",color:t,round:2,label:"R2",currentRound:s}),_.createElement(za,{key:"shop-r3",color:t,round:3,label:"R3",currentRound:s}),_.createElement(Wk,{key:"shop-vp",color:t})])]),_.createElement("div",{key:"actions-section",className:"flex-1"},[_.createElement("h3",{key:"actions-title",className:"text-xs font-semibold mb-1 text-gray-800 px-0.5"}," Actions"),_.createElement("div",{key:"actions",className:"grid grid-cols-3 gap-1"},u.map(a=>_.createElement(ck,{key:a.id,actionId:a.id,title:a.title,description:a.description,round:a.round,available:a.round<=s,compact:!0})))])])}function Fk(t){switch(t){case"red":return" +1 VP each time you use or repeat a RED action";case"yellow":return" +1 VP per different color gem at end of each round";case"blue":return" Get 1 VP when you activate a shop effect";case"purple":return" First & last to run out of workers each round get 4 VP";case"white":return" All players start game with 5 VP when white is in play";case"gold":return" +1 VP per gold gem at end of each round";case"black":return" +1 VP whenever you steal from another player";case"silver":return" End of Round: Most VP get 3 Silver, others get 2 VP";default:return""}}function Vk(t){return!t||Object.keys(t).length===0?_.createElement("div",{},"No VP yet"):_.createElement("div",{},Object.entries(t).map(([e,n])=>_.createElement("div",{key:e},`${Gk(e)}: ${n} VP`)))}function Gk(t){switch(t){case"redAction":return" Red Actions";case"yellowDiversity":return" Resource Diversity";case"blueShopUsage":return" Shop Usage";case"purpleWorkers":return" Worker Timing";case"victoryShop":return" Victory Shops";case"shopPurchase":return" Shop Purchases";case"whiteStarting":return" Starting VP";case"whiteAction":return" White Actions";case"whiteShop":return" White Shops";case"goldAutomatic":return" Gold Resources";case"goldVPPerGold":return" Gold Action";case"blackAutomatic":return" Stealing Bonus";case"blackSteal":return" Stolen VP";case"blackShop":return" Black Shop";case"blackVictoryShop":return" Victory Shop";case"blackPenalty":return" Black Penalty";case"silverAutomatic":return" Silver Automatic";case"silverAction":return" Silver Actions";case"silverShop":return" Silver Shops";default:return" Other"}}function za({color:t,round:e,label:n,currentRound:r}){const{state:s,dispatch:o}=Ve(),l={red:{1:{cost:{red:1,any:2},effect:"Repeat one of your patron's actions"},2:{cost:{red:2,any:2},effect:"Place the next player's patron for them"},3:{cost:{red:4,any:4},effect:"Pick a player. Repeat all actions where they have a patron"}},yellow:{1:{cost:{yellow:1,any:1},effect:"Double your next resource gain"},2:{cost:{yellow:2,any:2},effect:"Gain 5 resources (any colors)"},3:{cost:{yellow:3,any:3},effect:"Gain 7 resources (any colors)"}},blue:{1:{cost:{blue:1,any:1},effect:"Open or close any one shop"},2:{cost:{blue:2,any:2},effect:"Flip all shops (open  closed)"},3:{cost:{blue:3,any:3},effect:"Use any shop benefit for free"}},purple:{1:{cost:{purple:1,any:2},effect:"Take an extra turn after this one"},2:{cost:{purple:2,any:2},effect:"Place 2 more patrons this turn"},3:{cost:{purple:3,any:3},effect:"Place all your remaining patrons now"}},gold:{1:{cost:{gold:1,any:1},effect:"Trade: 1 Gold + 1 Any  2 Gold"},2:{cost:{gold:2,any:2},effect:"Trade: 2 Gold + 2 Any  4 Gold"},3:{cost:{gold:3,any:3},effect:"Trade: 3 Gold + 3 Any  Double your Gold"}},white:{1:{cost:{vp:1},effect:"Lose 1 VP, gain 1 resource (any color)"},2:{cost:{vp:2},effect:"Lose 3 VP, next player skips their turn"},3:{cost:{vp:3},effect:"Lose 5 VP, move one patron to any action"}},black:{1:{cost:{black:1,any:1},effect:"Steal 1 VP from any player"},2:{cost:{black:2,any:2},effect:"Steal 3 VP from any player"},3:{cost:{black:3,any:3},effect:"Steal 5 VP from any player"}},silver:{1:{cost:{silver:1,any:1},effect:"Gain 2 VP"},2:{cost:{silver:2,any:2},effect:"You and another player each gain 4 VP"},3:{cost:{silver:3,any:3},effect:"Gain 7 Silver, all others gain 2 Silver"}}}[t][e],u=`${t}${e}`,a=s.closedShops[u],f=!a,c=l.cost.vp||0,d=l.cost[t]||0,h=s.players.find(g=>g.id===s.currentPlayer),m=Math.max(0,(l.cost.any||0)+((h==null?void 0:h.shopCostModifier)||0)),v=async()=>{if(a){alert("This shop is closed!");return}if(s.roomCode&&s.myPlayerId!==s.currentPlayer){alert("It's not your turn!");return}if(s.workersToPlace>0){alert("You must finish placing all your patrons before using a shop!");return}if(s.shopUsedAfterWorkers){alert("You have already used a shop this turn!");return}const g=s.players.find(T=>T.id===s.currentPlayer);if(c>0){if(g.victoryPoints<c){alert(`Need ${c} VP. You have ${g.victoryPoints}.`);return}}else if(g.resources[t]<d){alert(`Need ${d} ${t} gems.`);return}const S=Object.values(g.resources).reduce((T,j)=>T+j,0);if((c>0?S:S-d)<m){alert(`Need ${m} additional gems.`);return}if(t==="red"&&e===1){const T=["redRepeatAction","redRepeatAll","redHybrid1","redHybrid2","blueAnyShopBenefit","blueR1ShopBenefit","redVictoryShop","yellowVictoryShop","blueVictoryShop","purpleVictoryShop","goldVictoryShop","whiteVictoryShop","blackVictoryShop","silverVictoryShop"];if(Object.entries(s.occupiedSpaces).filter(([R,he])=>he===g.id&&!T.includes(R)).length===0){alert("You have no valid patrons to repeat! Swap and repeat actions cannot be repeated.");return}}const b={};if(d>0&&(b[t]=-d),m>0){const T={...g.resources};d>0&&t in T&&(T[t]=Math.max(0,T[t]-d));const j=await ge(o,`Choose ${m} ${m===1?"gem":"gems"} to spend`,m,T);if(j)Object.entries(j).forEach(([R,he])=>{b[R]=(b[R]||0)-he});else return}if(c>0&&o({type:"UPDATE_VP",playerId:g.id,vp:-c,source:"shopCost"}),o({type:"UPDATE_RESOURCES",playerId:g.id,resources:b}),!await cc(t,e,g,o,s,0)){c>0&&o({type:"UPDATE_VP",playerId:g.id,vp:c,source:"shopRefund"});const T={};Object.entries(b).forEach(([j,R])=>{T[j]=-R}),o({type:"UPDATE_RESOURCES",playerId:g.id,resources:T}),o({type:"ADD_LOG",message:`Player ${g.id}: Shop purchase cancelled - costs refunded`});return}o({type:"USE_SHOP"}),o({type:"UPDATE_VP",playerId:g.id,vp:1,source:"blueShopUsage"}),o({type:"ADD_LOG",message:`Player ${g.id}: +1 VP (activated a shop effect)`})},w=()=>{switch(t){case"red":return"";case"yellow":return"";case"blue":return"";case"purple":return"";case"gold":return"";case"white":return"";case"black":return"";case"silver":return"";default:return""}},y=()=>{if(!f)return"bg-gray-100";switch(t){case"red":return"bg-gradient-to-br from-red-50 to-red-100";case"yellow":return"bg-gradient-to-br from-yellow-50 to-yellow-100";case"blue":return"bg-gradient-to-br from-blue-50 to-blue-100";case"purple":return"bg-gradient-to-br from-purple-50 to-purple-100";case"gold":return"bg-gradient-to-br from-yellow-100 to-amber-100";case"white":return"bg-gradient-to-br from-gray-50 to-gray-100";case"black":return"bg-gradient-to-br from-gray-700 to-gray-800";case"silver":return"bg-gradient-to-br from-gray-200 to-gray-300";default:return"bg-white"}},p=()=>{if(!f)return"border-gray-300";switch(t){case"red":return"border-red-300";case"yellow":return"border-yellow-300";case"blue":return"border-blue-300";case"purple":return"border-purple-300";case"gold":return"border-amber-400";case"white":return"border-gray-400";case"black":return"border-gray-600";case"silver":return"border-gray-400";default:return"border-gray-300"}};return _.createElement("div",{className:`relative rounded-lg ${y()} ${p()} border-2 transition-all flex flex-col shadow hover:shadow-md overflow-hidden ${f?"":"opacity-60"}`},[_.createElement("div",{key:"header",className:"bg-white bg-opacity-80 px-2 py-1 flex items-center justify-between border-b "+p()},[_.createElement("span",{key:"round-label",className:"text-xs font-bold text-gray-900"},`R${e}`),_.createElement("div",{key:"cost",className:"text-sm font-bold flex items-center gap-0.5"},c>0?[_.createElement("span",{key:"vp",className:"text-purple-700"},`${c}VP`),m>0&&_.createElement("span",{key:"any",className:"text-gray-600"},`+${m}`)]:[d>0&&_.createElement("span",{key:"color"},`${d}${w()}`),d>0&&m>0&&_.createElement("span",{key:"plus",className:"text-gray-600"},"+"),m>0&&_.createElement("span",{key:"any",className:"text-gray-600"},`${m}`)])]),_.createElement("div",{key:"effect",className:`p-1.5 text-xs font-medium ${t==="black"?"text-white":"text-gray-900"} leading-tight text-center min-h-[45px] flex items-center justify-center`},l.effect),_.createElement("button",{key:"btn",onClick:v,className:`py-1 text-xs font-bold transition-all ${f?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-400 cursor-not-allowed text-gray-600"}`,disabled:!f},f?"BUY":"")])}function Wk({color:t}){const{state:e,dispatch:n}=Ve(),r={red:{cost:4,vp:5},yellow:{cost:4,vp:3},blue:{cost:4,vp:5},purple:{cost:4,vp:5},white:{cost:4,vp:4},black:{cost:6,vp:0,special:"steal2FromEach"},silver:{cost:6,vp:8}};if(t==="gold")return null;const s=r[t],o=`${t}vp`,i=e.closedShops[o],l=e.players.find(h=>h.id===e.currentPlayer),u=t==="black"||t==="white"?s.cost:Math.max(0,s.cost+((l==null?void 0:l.shopCostModifier)||0)),a=()=>{if(i){alert("This shop is closed!");return}if(e.roomCode&&e.myPlayerId!==e.currentPlayer){alert("It's not your turn!");return}if(e.workersToPlace>0){alert("You must finish placing all your patrons before using a shop!");return}if(e.shopUsedAfterWorkers){alert("You have already used a shop this turn!");return}const h=e.players.find(w=>w.id===e.currentPlayer),m=t==="black"||t==="white"?s.cost:Math.max(0,s.cost+(h.shopCostModifier||0));if(t==="yellow"){if(Object.values(h.resources).reduce((y,p)=>y+p,0)<m){alert(`Need ${m} gems total.`);return}}else if(h.resources[t]<m){alert(`Need ${m} ${t} gems.`);return}const v={};if(t==="yellow"){let w=m;["red","yellow","blue","purple"].forEach(y=>{const p=Math.min(h.resources[y],w);p>0&&(v[y]=-p,w-=p)})}else v[t]=-m;if(n({type:"UPDATE_RESOURCES",playerId:h.id,resources:v}),t==="black"&&s.special==="steal2FromEach"){const w=e.players.filter(p=>p.id!==h.id);let y=0;w.forEach(p=>{const g=Math.min(2,p.victoryPoints);g>0&&(n({type:"UPDATE_VP",playerId:p.id,vp:-g,source:"blackVictoryShop"}),y+=g)}),y>0?(n({type:"UPDATE_VP",playerId:h.id,vp:y,source:"blackVictoryShop"}),n({type:"ADD_LOG",message:`Player ${h.id}: Black Victory Shop  Stole ${y} VP (2 from each player)`}),n({type:"UPDATE_VP",playerId:h.id,vp:1,source:"blackAutomatic"}),n({type:"ADD_LOG",message:`Player ${h.id}: +1 VP (Black automatic: stealing bonus)`})):n({type:"ADD_LOG",message:`Player ${h.id}: Black Victory Shop  No VP to steal`})}else n({type:"UPDATE_VP",playerId:h.id,vp:s.vp,source:"victoryShop"});n({type:"USE_SHOP"}),n({type:"UPDATE_VP",playerId:h.id,vp:1,source:"blueShopUsage"}),n({type:"ADD_LOG",message:`Player ${h.id}: +1 VP (activated a shop effect)`})},f=()=>{switch(t){case"red":return"";case"yellow":return"";case"blue":return"";case"purple":return"";case"gold":return"";case"white":return"";case"black":return"";case"silver":return"";default:return""}},c=()=>i?"bg-gray-100":"bg-gradient-to-br from-emerald-50 to-emerald-100",d=()=>t==="black"&&s.special==="steal2FromEach"?"Steal 2 VP from each player":`Gain ${s.vp} Victory Points`;return _.createElement("div",{className:`p-2 rounded-lg ${c()} border-2 border-emerald-400 transition-all flex flex-col shadow-sm hover:shadow-md ${i?"opacity-50":""}`},[_.createElement("div",{key:"header",className:"flex items-center justify-between mb-1"},[_.createElement("div",{key:"vp-label",className:"text-xs font-bold text-emerald-700"}," VP"),_.createElement("div",{key:"cost",className:"text-xs font-bold"},t==="yellow"?`${u}`:`${u}${f()}`)]),_.createElement("div",{key:"effect",className:"text-xs text-gray-700 font-medium leading-tight mb-2 min-h-[2rem]"},d()),_.createElement("button",{key:"btn",onClick:a,className:`text-xs py-1 px-2 rounded font-semibold transition-all ${i?"bg-gray-300 cursor-not-allowed text-gray-500":"bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm hover:shadow"}`,disabled:i},"Buy")])}function Bk(){var l;const{state:t,dispatch:e}=Ve(),n=_.useRef(null),r=_.useRef(t);r.current=t,qe.useEffect(()=>{if(t.justSyncedFromFirebase){const u=setTimeout(()=>{e({type:"CLEAR_SYNC_FLAG"})},100);return()=>clearTimeout(u)}},[t.justSyncedFromFirebase]),qe.useEffect(()=>(t.roomCode&&t.gameStarted&&!t.justSyncedFromFirebase&&(n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{const u=r.current,a={currentPlayer:u.currentPlayer,turnDirection:u.turnDirection,players:u.players,occupiedSpaces:u.occupiedSpaces,round:u.round,turnOrder:u.turnOrder,workerPlacedThisTurn:u.workerPlacedThisTurn,workersToPlace:u.workersToPlace,actionLog:u.actionLog,gameStarted:u.gameStarted,gameLayers:u.gameLayers,closedShops:u.closedShops,shopUsedAfterWorkers:u.shopUsedAfterWorkers,playersOutOfWorkers:u.playersOutOfWorkers,skippedTurns:u.skippedTurns,waitingForOthers:u.waitingForOthers,roundActions:u.roundActions,gameOver:u.gameOver,automaticVPs:u.automaticVPs,pendingPlacements:u.pendingPlacements||{},lastUpdatedBy:u.myPlayerId,timestamp:Date.now()};console.log("Syncing game state to Firebase:",{myPlayerId:u.myPlayerId,currentPlayer:a.currentPlayer,gameLayers:a.gameLayers?Object.keys(a.gameLayers):null,gameStarted:a.gameStarted}),lk(u.roomCode,a)},200)),()=>{n.current&&clearTimeout(n.current)}),[t.currentPlayer,t.players,t.occupiedSpaces,t.round,t.actionLog,t.workersToPlace,t.gameLayers,t.closedShops,t.shopUsedAfterWorkers,t.playersOutOfWorkers,t.skippedTurns,t.waitingForOthers,t.roundActions,t.gameOver,t.automaticVPs,t.pendingPlacements]);const s=async()=>{if(t.roomCode&&t.myPlayerId!==t.currentPlayer){alert("It's not your turn!");return}if(t.players.find(u=>u.id===t.currentPlayer),t.workersToPlace>0){const u=t.workersToPlace;if(!await yk(e,"End Turn Early?",`You can still place ${u} more worker${u>1?"s":""} this turn. Are you sure you want to end your turn?`))return}e({type:"END_TURN"})},o=()=>{t.round<3?e({type:"SHOW_MODAL",modal:{type:"roundTransition",round:t.round+1,players:t.players}}):alert("Game is already at Round 3 (final round)")},i=()=>{e({type:"RESET_GAME",preserveEmojis:!0})};if(!t.gameLayers){if(console.log("No game layers found. State:",{roomCode:t.roomCode,gameStarted:t.gameStarted,gameLayers:t.gameLayers,myPlayerId:t.myPlayerId,currentPlayer:t.currentPlayer}),!t.roomCode){console.log("Local play - selecting 4 layers");const u=gl(4);e({type:"SET_GAME_LAYERS",layers:u})}return _.createElement("div",{className:"min-h-screen flex items-center justify-center"},_.createElement("div",{className:"text-center glass rounded-xl p-8"},[_.createElement("h2",{key:"title",className:"text-2xl font-bold mb-4"},"Setting up game layers..."),_.createElement("div",{key:"spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),_.createElement("div",{key:"debug",className:"text-sm text-gray-600 mt-4"},[_.createElement("div",{key:"line1"},`Room: ${t.roomCode||"None"}, Started: ${t.gameStarted}`),_.createElement("div",{key:"line2"},`You are Player ${t.myPlayerId}, Current Turn: Player ${t.currentPlayer}`)])]))}return console.log("GameBoard rendering with layers:",Object.keys(t.gameLayers)),t.players.reduce((u,a)=>u+a.workersLeft,0),Object.values(t.gameLayers).reduce((u,a)=>u+a.actions.filter(f=>f.round<=t.round).length,0),_.createElement("div",{className:"min-h-screen p-4 overflow-x-hidden w-full max-w-full"},[_.createElement(uk,{key:"notifications",notifications:t.notifications,myPlayerId:t.myPlayerId}),_.createElement("div",{key:"container",className:"w-full px-6"},[_.createElement("div",{key:"top-bar",className:"flex items-stretch gap-3 mb-4"},[_.createElement("div",{key:"round",className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-3 rounded-lg shadow flex items-center gap-2"},[_.createElement("span",{key:"icon",className:"text-lg"},""),_.createElement("span",{key:"text",className:"text-base font-bold"},`Round ${t.round}`)]),t.currentPlayer&&_.createElement("div",{key:"current-turn",className:"bg-gray-700 text-white px-4 py-3 rounded-lg shadow flex items-center gap-2"},[_.createElement("span",{key:"icon",className:"text-base"},""),_.createElement("span",{key:"text",className:"text-base font-bold"},`${(l=t.players.find(u=>u.id===t.currentPlayer))==null?void 0:l.name}'s Turn`)]),t.roomCode&&_.createElement("div",{key:"room-badge",className:"bg-gray-700 text-white px-4 py-3 rounded-lg shadow flex items-center gap-2"},[_.createElement("span",{key:"icon",className:"text-base"},""),_.createElement("span",{key:"text",className:"text-base font-bold"},`Room: ${t.roomCode}`)]),...t.turnOrder.map((u,a)=>{const f=t.players.find(c=>c.id===u);return _.createElement(wp,{key:f.id,player:f,isCurrentPlayer:f.id===t.currentPlayer,onEndTurn:s,turnPosition:a+1})})]),_.createElement("div",{key:"game-area",className:"w-full"},[_.createElement("div",{key:"players-placeholder",className:"hidden"},t.turnOrder.map((u,a)=>{const f=t.players.find(c=>c.id===u);return _.createElement(wp,{key:f.id,player:f,isCurrentPlayer:f.id===t.currentPlayer,onEndTurn:s,turnPosition:a+1})})),_.createElement("div",{key:"layers",className:"grid grid-cols-2 gap-6 mb-6"},Object.entries(t.gameLayers).map(([u,a])=>_.createElement(Uk,{key:u,color:u,title:a.title,icon:a.icon,actions:a.actions,round:t.round}))),_.createElement("div",{key:"controls",className:"text-center glass rounded-lg p-4 shadow-lg"},[_.createElement("button",{key:"advance",onClick:o,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-2 px-4 rounded-lg mr-3 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},`Advance to Round ${Math.min(t.round+1,3)}`),_.createElement("button",{key:"reset",onClick:i,className:"bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200"},"Reset Game"),_.createElement("div",{key:"instructions",className:"text-gray-600 mt-3 text-sm"},"Place worker  Buy from shops  End turn (button under current player)"),t.actionLog.length>0&&_.createElement("div",{key:"action-log",className:"mt-4 p-3 bg-gray-100 rounded-lg max-h-32 overflow-y-auto"},[_.createElement("div",{key:"log-title",className:"font-bold text-gray-700 mb-2 text-sm"},"Action Log (Last 10):"),...t.actionLog.map((u,a)=>_.createElement("div",{key:a,className:"text-xs text-gray-600 mb-1 font-mono"},u))])])]),t.waitingForPlayer&&t.myPlayerId===t.currentPlayer&&_.createElement("div",{key:"waiting-indicator",className:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-yellow-100 border-2 border-yellow-400 rounded-lg p-4 shadow-lg z-50"},[_.createElement("div",{className:"flex items-center space-x-3"},[_.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"}),_.createElement("div",{className:"text-yellow-800 font-semibold"},`Waiting for Player ${t.waitingForPlayer} to make a choice...`)])]),t.modal&&t.roomCode&&t.modal.targetPlayerId&&t.modal.targetPlayerId!==t.myPlayerId&&_.createElement("div",{key:"modal-waiting-indicator",className:"fixed bottom-4 right-4 bg-blue-100 border-2 border-blue-400 rounded-lg p-3 shadow-lg z-40"},[_.createElement("div",{className:"flex items-center space-x-2"},[_.createElement("div",{className:"animate-pulse rounded-full h-3 w-3 bg-blue-600"}),_.createElement("div",{className:"text-blue-800 text-sm font-medium"},`Player ${t.modal.targetPlayerId} is making a decision...`)])]),t.modal&&(!t.roomCode||t.myPlayerId===t.currentPlayer||t.modal.targetPlayerId===t.myPlayerId)&&_.createElement(dk,{key:"modal",isOpen:!0,onClose:()=>e({type:"HIDE_MODAL"})},t.modal.type==="choice"?_.createElement(fk,t.modal):t.modal.type==="gemSelection"?_.createElement(mk,t.modal):t.modal.type==="stealGems"?_.createElement(gk,t.modal):t.modal.type==="roundTransition"?_.createElement(pk,t.modal):_.createElement(hk,t.modal))])])}function jk(){const{state:t,dispatch:e}=Ve(),n=[...t.players].sort((o,i)=>i.victoryPoints-o.victoryPoints),r=n[0],s=()=>{t.roomCode?e({type:"RESET_GAME"}):window.location.reload()};return _.createElement("div",{className:"min-h-screen bg-gradient-to-br from-yellow-100 via-purple-100 to-blue-100 flex items-center justify-center p-4"},_.createElement("div",{className:"glass rounded-xl p-8 max-w-2xl w-full text-center"},[_.createElement("h1",{key:"title",className:"text-4xl font-bold mb-2 bg-gradient-to-r from-yellow-600 to-purple-600 bg-clip-text text-transparent"},"Game Over!"),_.createElement("div",{key:"winner",className:"text-6xl mb-4"},""),_.createElement("h2",{key:"winner-name",className:"text-3xl font-bold mb-6"},`${r.name} ${r.emoji||""} Wins!`),_.createElement("div",{key:"winner-score",className:"text-2xl mb-8 text-gray-700"},`Final Score: ${r.victoryPoints} VP`),_.createElement("div",{key:"standings",className:"mb-8"},[_.createElement("h3",{key:"standings-title",className:"text-xl font-semibold mb-4"},"Final Standings"),_.createElement("div",{key:"players-list",className:"space-y-3"},n.map((o,i)=>_.createElement("div",{key:o.id,className:`glass rounded-lg p-3 flex items-center justify-between ${i===0?"ring-2 ring-yellow-400":""}`},[_.createElement("div",{key:"left",className:"flex items-center gap-3"},[_.createElement("div",{key:"rank",className:"text-2xl font-bold"},i===0?"":i===1?"":i===2?"":`${i+1}.`),_.createElement("div",{key:"name",className:"text-lg"},`${o.name} ${o.emoji||""}`)]),_.createElement("div",{key:"score",className:"text-xl font-semibold"},`${o.victoryPoints} VP`)])))]),_.createElement("button",{key:"play-again",onClick:s,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-8 py-3 rounded-lg font-semibold text-lg transform hover:scale-105 transition-all"},t.roomCode?"Back to Lobby":"Play Again")]))}function zk(){return _.createElement(rk,{},_.createElement(Hk,{}))}function Hk(){const{state:t}=Ve();try{return t.gameStarted?t.gameOver?_.createElement(jk,{}):_.createElement("div",{className:"min-h-screen"},[t.roomCode&&_.createElement(vp,{key:"players"}),_.createElement(Bk,{key:"game"})]):t.roomCode?_.createElement("div",{className:"min-h-screen p-4 overflow-x-hidden w-full max-w-full"},[_.createElement(vp,{key:"players"}),_.createElement("div",{key:"waiting",className:"text-center mt-8"},[_.createElement("div",{key:"spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),_.createElement("h2",{key:"text",className:"text-xl text-gray-600"},t.isHost?"Waiting for you to start the game...":"Waiting for host to start the game...")])]):_.createElement(ak,{})}catch(e){return console.error("Render error:",e),console.error("Error stack:",e.stack),console.error("Game state at error:",t),_.createElement("div",{className:"min-h-screen flex items-center justify-center p-4"},_.createElement("div",{className:"glass rounded-xl p-8 text-center"},[_.createElement("h1",{key:"title",className:"text-2xl font-bold text-red-600 mb-4"},"Game Error"),_.createElement("p",{key:"message",className:"text-gray-600 mb-4"},"Something went wrong. Check browser console for details."),_.createElement("div",{key:"error-details",className:"text-sm text-gray-500 mb-4 p-2 bg-gray-100 rounded"},`Error: ${e.message}`),_.createElement("button",{key:"reload",onClick:()=>window.location.reload(),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded"},"Reload Game")]))}}const Sp=new URLSearchParams(window.location.search);(Sp.get("test")==="true"||Sp.get("debug")==="true")&&(window.debugGetState=()=>{const t=document.getElementById("root")._reactRootContainer;if(!t)return null;let e=null;const n=r=>{r&&(r.memoizedState&&r.memoizedState.element&&r.memoizedState.element.type&&r.memoizedState.element.type.name==="App"&&r.memoizedState.memoizedState&&(e=r.memoizedState.memoizedState[0]),r.child&&n(r.child),r.sibling&&n(r.sibling))};return t._internalRoot&&n(t._internalRoot.current),e||window.lastKnownState||null},window.debugDispatch=t=>window.lastKnownDispatch?(window.lastKnownDispatch(t),!0):!1,window.debugLog=t=>{console.log("[DEBUG]",t)},console.log("Debug mode enabled. Available functions: debugGetState(), debugDispatch(action), debugLog(message)"));Ha.createRoot(document.getElementById("root")).render(cf.jsx(_.StrictMode,{children:cf.jsx(zk,{})}));
